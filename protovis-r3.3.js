// ed37040
var a;if(!Array.prototype.map)Array.prototype.map=function(b,d){for(var f=this.length,c=new Array(f),e=0;e<f;e++)if(e in this)c[e]=b.call(d,this[e],e,this);return c};if(!Array.prototype.filter)Array.prototype.filter=function(b,d){for(var f=this.length,c=[],e=0;e<f;e++)if(e in this){var g=this[e];b.call(d,g,e,this)&&c.push(g)}return c};if(!Array.prototype.forEach)Array.prototype.forEach=function(b,d){for(var f=this.length>>>0,c=0;c<f;c++)c in this&&b.call(d,this[c],c,this)};
if(!Array.prototype.reduce)Array.prototype.reduce=function(b,d){var f=this.length;if(!f&&arguments.length==1)throw new Error("reduce: empty array, no initial value");var c=0;if(arguments.length<2)for(;;){if(c in this){d=this[c++];break}if(++c>=f)throw new Error("reduce: no values, no initial value");}for(;c<f;c++)if(c in this)d=b(d,this[c],c,this);return d};
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(b,d){var f=this.length>>>0;for(d=!isFinite(d)||d<0?0:d>this.length?this.length:d;d<f;d++)if(this[d]===b)return d;return-1};var pv={};pv.version={major:3,minor:3};pv.identity=function(b){return b};pv.index=function(){return this.index};pv.child=function(){return this.childIndex};pv.parent=function(){return this.parent.index};
(function(){pv.extend=Object.create?function(c){return Object.create(c.prototype||c)}:function(c){function e(){}e.prototype=c.prototype||c;return new e};pv.extendType=function(c,e){return(c.prototype=pv.extend(e)).constructor=c};pv.parse=function(c){for(var e=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),g,h,i=0,j="";g=e.exec(c);){g=g.index+g[0].length;if(c.charAt(g)!="{"){j+=c.substring(i,g)+"{return ";i=g;for(var k=0;k>=0&&g<c.length;g++){var l=c.charAt(g);switch(l){case '"':case "'":for(;++g<
c.length&&(h=c.charAt(g))!=l;)h=="\\"&&g++;break;case "[":case "(":k++;break;case "]":case ")":k--;break;case ";":case ",":k==0&&k--;break}}j+=pv.parse(c.substring(i,--g))+";}";i=g}e.lastIndex=g}j+=c.substring(i);return j};pv.error=function(c){typeof console==="undefined"||!console.error?alert(c):console.error(c)};pv.listen=function(c,e,g){g=pv.listener(g);if(e==="load"||e==="onload")return pv.listenForPageLoad(g);if(c.addEventListener)c.addEventListener(e,g,false);else{if(c===window)c=document.documentElement;
c.attachEvent("on"+e,g)}return g};pv.unlisten=function(c,e,g){if(g.$listener)g=g.$listener;c.removeEventListener?c.removeEventListener(e,g,false):c.detachEvent("on"+e,g)};pv.listener=function(c){return c.$listener||(c.$listener=function(e){try{pv.event=e=e&&pv.fixEvent(e);return c.call(this,e)}catch(g){pv.error(g)}finally{delete pv.event}})};pv.fixEvent=function(c){if(c.pageX==null&&c.clientX!=null){var e=c.target&&c.target.ownerDocument||document,g=e.documentElement;e=e.body;c.pageX=c.clientX*1+
(g&&g.scrollLeft||e&&e.scrollLeft||0)-(g&&g.clientLeft||e&&e.clientLeft||0);c.pageY=c.clientY*1+(g&&g.scrollTop||e&&e.scrollTop||0)-(g&&g.clientTop||e&&e.clientTop||0)}return c};pv.ancestor=function(c,e){for(;e;){if(e==c)return true;e=e.parentNode}return false};pv.getWindow=function(c){return c!=null&&c==c.window?c:c.nodeType===9?c.defaultView||c.parentWindow:false};var b=/\-([a-z])/g;pv.hiphen2camel=function(c){if(b.test(c))return c.replace(b,function(e,g){return g.toUpperCase()});return c};var d=
window.getComputedStyle;pv.css=function(c,e){return d?d.call(window,c,null).getPropertyValue(e):c.currentStyle[e==="float"?"styleFloat":pv.hiphen2camel(e)]};pv.cssStyle=function(c){var e;if(d){e=d.call(window,c,null);return function(g){return e.getPropertyValue(g)}}e=c.currentStyle;return function(g){return e[g==="float"?"styleFloat":pv.hiphen2camel(g)]}};pv._getElementsByClass=function(c,e){if(e==null)e=document;var g=[];e=e.getElementsByTagName("*");var h=e.length;c=new RegExp("(^|\\s)"+c+"(\\s|$)");
var i,j;for(j=i=0;i<h;i++)if(c.test(e[i].className)){g[j]=e[i];j++}return g};pv.getElementsByClassName=function(c,e){return c.getElementsByClassName?c.getElementsByClassName(e):pv._getElementsByClass(e,c)};pv.elementOffset=function(c){var e,g,h,i,j={top:0,left:0};if(h=c&&c.ownerDocument){g=h.body;if(g!==c){e=h.documentElement;if(typeof c.getBoundingClientRect!=="undefined")j=c.getBoundingClientRect();c=pv.getWindow(h);h=e.clientTop||g.clientTop||0;g=e.clientLeft||g.clientLeft||0;i=c.pageYOffset||
e.scrollTop;return{top:j.top+i-h,left:j.left+(c.pageXOffset||e.scrollLeft)-g}}}};pv.listenForPageLoad=function(c){document.readyState==="complete"&&c(null);if(pv.renderer()==="svgweb")window.addEventListener("SVGLoad",c,false);else if(document.addEventListener)window.addEventListener("load",c,false);else document.attachEvent&&window.attachEvent("onload",c)};pv.renderer=function(){var c=typeof document.svgImplementation!=="undefined"?document.svgImplementation:typeof window.svgweb==="undefined"?"nativesvg":
"svgweb";pv.renderer=function(){return c};return c};pv.id=function(){var c=1;return function(){return c++}}();pv.functor=function(c){return typeof c=="function"?c:function(){return c}};pv.get=function(c,e,g){var h;return c&&(h=c[e])!=null?h:g};var f=Object.prototype.hasOwnProperty;pv.lazyArrayOwn=function(c,e){var g;return c&&f.call(c,e)&&(g=c[e])?g:(c[e]=[])}})();
pv.renderer()!=="batik"&&pv.listen(window,"load",function(){pv.$={i:0,x:document.getElementsByTagName("script")};for(pv.$.xlen=pv.$.x.length;pv.$.i<pv.$.xlen;pv.$.i++){pv.$.s=pv.$.x[pv.$.i];if(pv.$.s.type=="text/javascript+protovis")try{window.eval(pv.parse(pv.$.s.text))}catch(b){pv.error(b)}}delete pv.$});pv.Format={};pv.Format.re=function(b){return b.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")};pv.Format.pad=function(b,d,f){d=d-String(f).length;return d<1?f:(new Array(d+1)).join(b)+f};
pv.Format.date=function(b){function d(c){return b.replace(/%[a-zA-Z0-9]/g,function(e){switch(e){case "%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][c.getDay()];case "%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][c.getDay()];case "%h":case "%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][c.getMonth()];case "%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][c.getMonth()];
case "%c":return c.toLocaleString();case "%C":return f("0",2,Math.floor(c.getFullYear()/100)%100);case "%d":return f("0",2,c.getDate());case "%x":case "%D":return f("0",2,c.getMonth()+1)+"/"+f("0",2,c.getDate())+"/"+f("0",2,c.getFullYear()%100);case "%e":return f(" ",2,c.getDate());case "%H":return f("0",2,c.getHours());case "%I":return(e=c.getHours()%12)?f("0",2,e):12;case "%m":return f("0",2,c.getMonth()+1);case "%M":return f("0",2,c.getMinutes());case "%n":return"\n";case "%p":return c.getHours()<
12?"AM":"PM";case "%T":case "%X":case "%r":e=c.getHours()%12;return(e?f("0",2,e):12)+":"+f("0",2,c.getMinutes())+":"+f("0",2,c.getSeconds())+" "+(c.getHours()<12?"AM":"PM");case "%R":return f("0",2,c.getHours())+":"+f("0",2,c.getMinutes());case "%S":return f("0",2,c.getSeconds());case "%Q":return f("0",3,c.getMilliseconds());case "%t":return"\t";case "%u":return(e=c.getDay())?e:1;case "%w":return c.getDay();case "%y":return f("0",2,c.getFullYear()%100);case "%Y":return c.getFullYear();case "%%":return"%"}return e})}
var f=pv.Format.pad;d.format=d;d.parse=function(c){var e=1970,g=0,h=1,i=0,j=0,k=0,l=[function(){}],n=pv.Format.re(b).replace(/%[a-zA-Z0-9]/g,function(p){switch(p){case "%b":l.push(function(m){g={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[m]});return"([A-Za-z]+)";case "%h":case "%B":l.push(function(m){g={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[m]});return"([A-Za-z]+)";case "%e":case "%d":l.push(function(m){h=
m});return"([0-9]+)";case "%I":case "%H":l.push(function(m){i=m});return"([0-9]+)";case "%m":l.push(function(m){g=m-1});return"([0-9]+)";case "%M":l.push(function(m){j=m});return"([0-9]+)";case "%p":l.push(function(m){if(i==12){if(m=="am")i=0}else if(m=="pm")i=Number(i)+12});return"(am|pm)";case "%S":l.push(function(m){k=m});return"([0-9]+)";case "%y":l.push(function(m){m=Number(m);e=m+(0<=m&&m<69?2E3:m>=69&&m<100?1900:0)});return"([0-9]+)";case "%Y":l.push(function(m){e=m});return"([0-9]+)";case "%%":l.push(function(){});
return"%"}return p});(c=c.match(n))&&c.forEach(function(p,m){l[m](p)});return new Date(e,g,h,i,j,k)};return d};
pv.Format.time=function(b){function d(c){c=Number(c);switch(b){case "short":if(c>=31536E6)return(c/31536E6).toFixed(1)+" years";else if(c>=6048E5)return(c/6048E5).toFixed(1)+" weeks";else if(c>=864E5)return(c/864E5).toFixed(1)+" days";else if(c>=36E5)return(c/36E5).toFixed(1)+" hours";else if(c>=6E4)return(c/6E4).toFixed(1)+" minutes";return(c/1E3).toFixed(1)+" seconds";case "long":var e=[],g=c%36E5/6E4>>0;e.push(f("0",2,c%6E4/1E3>>0));if(c>=36E5){var h=c%864E5/36E5>>0;e.push(f("0",2,g));if(c>=864E5){e.push(f("0",
2,h));e.push(Math.floor(c/864E5).toFixed())}else e.push(h.toFixed())}else e.push(g.toFixed());return e.reverse().join(":")}}var f=pv.Format.pad;d.format=d;d.parse=function(c){switch(b){case "short":for(var e=/([0-9,.]+)\s*([a-z]+)/g,g,h=0;g=e.exec(c);){var i=parseFloat(g[0].replace(",","")),j=0;switch(g[2].toLowerCase()){case "year":case "years":j=31536E6;break;case "week":case "weeks":j=6048E5;break;case "day":case "days":j=864E5;break;case "hour":case "hours":j=36E5;break;case "minute":case "minutes":j=
6E4;break;case "second":case "seconds":j=1E3;break}h+=i*j}return h;case "long":g=c.replace(",","").split(":").reverse();h=0;if(g.length)h+=parseFloat(g[0])*1E3;if(g.length>1)h+=parseFloat(g[1])*6E4;if(g.length>2)h+=parseFloat(g[2])*36E5;if(g.length>3)h+=parseFloat(g[3])*864E5;return h}};return d};
pv.Format.number=function(){function b(o){if(Infinity>g)o=Math.round(o*h)/h;var q=String(Math.abs(o)).split("."),s=q[0];if(s.length>f)s=s.substring(s.length-f);if(k&&s.length<d)s=(new Array(d-s.length+1)).join(i)+s;if(s.length>3)s=s.replace(/\B(?=(?:\d{3})+(?!\d))/g,n);if(!k&&s.length<c)s=(new Array(c-s.length+1)).join(i)+s;q[0]=o<0?p+s+m:s;o=q[1]||"";if(o.length>g)o=q[1]=o.substr(0,g);if(o.length<e)q[1]=o+(new Array(e-o.length+1)).join(j);return q.join(l)}var d=0,f=Infinity,c=0,e=0,g=0,h=1,i="0",
j="0",k=true,l=".",n=",",p="\u2212",m="";b.format=b;b.parse=function(o){var q=pv.Format.re;o=String(o).split(l);if(o.length==1)o[1]="";o[0].replace(new RegExp("^("+q(i)+")*"),"");o[1].replace(new RegExp("("+q(j)+")*$"),"");q=o[0].replace(new RegExp(q(n),"g"),"");if(q.length>f)q=q.substring(q.length-f);o=o[1]?Number("0."+o[1]):0;if(Infinity>g)o=Math.round(o*h)/h;return Math.round(q)+o};b.integerDigits=function(o,q){if(arguments.length){d=Number(o);f=arguments.length>1?Number(q):d;c=d+Math.floor(d/
3)*n.length;return this}return[d,f]};b.fractionDigits=function(o,q){if(arguments.length){e=Number(o);g=arguments.length>1?Number(q):e;h=Math.pow(10,g);return this}return[e,g]};b.integerPad=function(o){if(arguments.length){i=String(o);k=/\d/.test(i);return this}return i};b.fractionPad=function(o){if(arguments.length){j=String(o);return this}return j};b.decimal=function(o){if(arguments.length){l=String(o);return this}return l};b.group=function(o){if(arguments.length){n=o?String(o):"";c=d+Math.floor(d/
3)*n.length;return this}return n};b.negativeAffix=function(o,q){if(arguments.length){p=String(o||"");m=String(q||"");return this}return[p,m]};return b};
(function(){var b;pv.Text={};pv.Text.createCache=function(){return new d};pv.Text.usingCache=function(c,e,g){if(!(c instanceof d))throw new Error("Not a valid cache.");var h=b;b=c;try{return e.call(g)}finally{b=h}};pv.Text.measure=function(c,e){c=c==null?"":""+c;var g=b&&b.get(e,c);if(!g){g=c?this.measureCore(c,e):{width:0,height:0};b&&b.put(e,c,g)}return g};pv.Text.fontHeight=function(c){return pv.Text.measure("M",c).height};pv.Text.measureCore=function(){function c(){return g||(g=e())}function e(){var i=
document.createElement("div");i.id="pvSVGText_"+(new Date).getTime();var j=i.style;j.position="absolute";j.visibility="hidden";j.width=0;j.height=0;j.left=0;j.top=0;var k=pv.SvgScene.create("svg");k.setAttribute("font-size","10px");k.setAttribute("font-family","sans-serif");i.appendChild(k);j=pv.SvgScene.create("text");k.appendChild(j);k=pv.renderer()==="svgweb"?document.createTextNode("",true):document.createTextNode("");j.appendChild(k);document.body.appendChild(i);return j}var g,h="10px sans-serif";
return function(i,j){j||(j=null);var k=c();if(h!==j){h=j;pv.SvgScene.setStyle(k,{font:j})}k.firstChild.nodeValue=""+i;var l;try{l=k.getBBox()}catch(n){typeof console.error==="function"&&console.error("GetBBox failed: ",n);throw n;}return{width:l.width,height:l.height}}}();var d=function(){this._fontsCache={}},f=Object.prototype.hasOwnProperty;d.prototype._getFont=function(c){c=c||"";return f.call(this._fontsCache,c)?this._fontsCache[c]:(this._fontsCache[c]={})};d.prototype.get=function(c,e){e=e||
"";c=this._getFont(c);return f.call(c,e)?c[e]:null};d.prototype.put=function(c,e,g){return this._getFont(c)[e||""]=g}})();pv.map=function(b,d){var f={};return d?b.map(function(c,e){f.index=e;return d.call(f,c)}):b.slice()};pv.repeat=function(b,d){if(arguments.length==1)d=2;return pv.blend(pv.range(d).map(function(){return b}))};pv.array=function(b,d){var f=b>=0?new Array(b):[];if(d!==undefined)for(var c=0;c<b;c++)f[c]=d;return f};
pv.cross=function(b,d){for(var f=[],c=0,e=b.length,g=d.length;c<e;c++)for(var h=0,i=b[c];h<g;h++)f.push([i,d[h]]);return f};pv.blend=function(b){return Array.prototype.concat.apply([],b)};
pv.transpose=function(b){var d=b.length,f=pv.max(b,function(h){return h.length});if(f>d){b.length=f;for(var c=d;c<f;c++)b[c]=new Array(d);for(c=0;c<d;c++)for(var e=c+1;e<f;e++){var g=b[c][e];b[c][e]=b[e][c];b[e][c]=g}}else{for(c=0;c<f;c++)b[c].length=d;for(c=0;c<d;c++)for(e=0;e<c;e++){g=b[c][e];b[c][e]=b[e][c];b[e][c]=g}}b.length=f;for(c=0;c<f;c++)b[c].length=d;return b};pv.normalize=function(b,d){b=pv.map(b,d);d=pv.sum(b);for(var f=0;f<b.length;f++)b[f]/=d;return b};
pv.permute=function(b,d,f){if(!f)f=pv.identity;var c=new Array(d.length),e={};d.forEach(function(g,h){e.index=g;c[h]=f.call(e,b[g])});return c};pv.numerate=function(b,d){if(!d)d=pv.identity;var f={},c={};b.forEach(function(e,g){c.index=g;f[d.call(c,e)]=g});return f};pv.uniq=function(b,d){if(!d)d=pv.identity;var f={},c=[],e={},g;b.forEach(function(h,i){e.index=i;g=d.call(e,h);g in f||(f[g]=c.push(g))});return c};pv.naturalOrder=function(b,d){return b<d?-1:b>d?1:0};
pv.reverseOrder=function(b,d){return d<b?-1:d>b?1:0};pv.search=function(b,d,f){if(!f)f=pv.identity;for(var c=0,e=b.length-1;c<=e;){var g=c+e>>1,h=f(b[g]);if(h<d)c=g+1;else if(h>d)e=g-1;else return g}return-c-1};pv.search.index=function(b,d,f){b=pv.search(b,d,f);return b<0?-b-1:b};
pv.range=function(b,d,f){if(arguments.length==1){d=b;b=0}if(f==undefined)f=1;if((d-b)/f==Infinity)throw new Error("range must be finite");var c=[],e=0,g;d-=(d-b)*1.0E-10;if(f<0)for(;(g=b+f*e++)>d;)c.push(g);else for(;(g=b+f*e++)<d;)c.push(g);return c};pv.random=function(b,d,f){if(arguments.length==1){d=b;b=0}if(f==undefined)f=1;return f?Math.floor(Math.random()*(d-b)/f)*f+b:Math.random()*(d-b)+b};
pv.sum=function(b,d){var f={};return b.reduce(d?function(c,e,g){f.index=g;return c+d.call(f,e)}:function(c,e){return c+e},0)};pv.max=function(b,d){if(d==pv.index)return b.length-1;return Math.max.apply(null,d?pv.map(b,d):b)};pv.max.index=function(b,d){if(!b.length)return-1;if(d==pv.index)return b.length-1;if(!d)d=pv.identity;for(var f=0,c=-Infinity,e={},g=0;g<b.length;g++){e.index=g;var h=d.call(e,b[g]);if(h>c){c=h;f=g}}return f};
pv.min=function(b,d){if(d==pv.index)return 0;return Math.min.apply(null,d?pv.map(b,d):b)};pv.min.index=function(b,d){if(!b.length)return-1;if(d==pv.index)return 0;if(!d)d=pv.identity;for(var f=0,c=Infinity,e={},g=0;g<b.length;g++){e.index=g;var h=d.call(e,b[g]);if(h<c){c=h;f=g}}return f};pv.mean=function(b,d){return pv.sum(b,d)/b.length};
pv.median=function(b,d){if(d==pv.index)return(b.length-1)/2;b=pv.map(b,d).sort(pv.naturalOrder);if(b.length%2)return b[Math.floor(b.length/2)];d=b.length/2;return(b[d-1]+b[d])/2};pv.variance=function(b,d){if(b.length<1)return NaN;if(b.length==1)return 0;var f=pv.mean(b,d),c=0,e={};if(!d)d=pv.identity;for(var g=0;g<b.length;g++){e.index=g;var h=d.call(e,b[g])-f;c+=h*h}return c};pv.deviation=function(b,d){return Math.sqrt(pv.variance(b,d)/(b.length-1))};pv.log=function(b,d){return Math.log(b)/Math.log(d)};
pv.logSymmetric=function(b,d){return b==0?0:b<0?-pv.log(-b,d):pv.log(b,d)};pv.logAdjusted=function(b,d){if(!isFinite(b))return b;var f=b<0;if(b<d)b+=(d-b)/d;return f?-pv.log(b,d):pv.log(b,d)};pv.logFloor=function(b,d){return b>0?Math.pow(d,Math.floor(pv.log(b,d))):-Math.pow(d,-Math.floor(-pv.log(-b,d)))};pv.logCeil=function(b,d){return b>0?Math.pow(d,Math.ceil(pv.log(b,d))):-Math.pow(d,-Math.ceil(-pv.log(-b,d)))};
(function(){var b=Math.PI/180,d=180/Math.PI;pv.radians=function(f){return b*f};pv.degrees=function(f){return d*f}})();pv.keys=function(b){var d=[];for(var f in b)d.push(f);return d};pv.entries=function(b){var d=[];for(var f in b)d.push({key:f,value:b[f]});return d};pv.values=function(b){var d=[];for(var f in b)d.push(b[f]);return d};pv.dict=function(b,d){for(var f={},c={},e=0;e<b.length;e++)if(e in b){var g=b[e];c.index=e;f[g]=d.call(c,g)}return f};pv.hasOwnProp=Object.prototype.hasOwnProperty;
pv.copyOwn=function(b,d){if(d){var f=pv.hasOwnProp;for(var c in d)if(f.call(d,c))b[c]=d[c]}return b};pv.dom=function(b){return new pv.Dom(b)};pv.Dom=function(b){this.$map=b};pv.Dom.prototype.$leaf=function(b){return typeof b!="object"};pv.Dom.prototype.leaf=function(b){if(arguments.length){this.$leaf=b;return this}return this.$leaf};
pv.Dom.prototype.root=function(b){function d(e){var g=new pv.Dom.Node;for(var h in e){var i=e[h];g.appendChild(f(i)?new pv.Dom.Node(i):d(i)).nodeName=h}return g}var f=this.$leaf,c=d(this.$map);c.nodeName=b;return c};pv.Dom.prototype.nodes=function(){return this.root().nodes()};pv.Dom.Node=function(b){if(b!==undefined)this.nodeValue=b};a=pv.Dom.Node.prototype;a.nodeValue=undefined;a.childNodes=[];a.parentNode=null;a.firstChild=null;a.lastChild=null;a.previousSibling=null;a.nextSibling=null;
a._firstDirtyChildIndex=Infinity;a._childIndex=-1;a.findChildIndex=function(b){if(!b)throw new Error("Argument 'n' required");if(b.parentNode===this){b=b.childIndex(true);if(b>-1)return b}throw new Error("child not found");};a._childRemoved=function(){};a._childAdded=function(){};a.removeChild=function(b){return this.removeAt(this.findChildIndex(b))};
a.appendChild=function(b){var d=b.parentNode;d&&d.removeChild(b);d=this.lastChild;b.parentNode=this;if(b.previousSibling=d){d.nextSibling=b;b._childIndex=d._childIndex+1}else{this.firstChild=b;b._childIndex=0}this.lastChild=b;d=pv.lazyArrayOwn(this,"childNodes").push(b);this._childAdded(b,d-1);return b};a.insertBefore=function(b,d){if(!d)return this.appendChild(b);d=this.findChildIndex(d);return this.insertAt(b,d)};
a.insertAt=function(b,d){if(d==null)return this.appendChild(b);var f=this.childNodes,c=f.length;if(d===c)return this.appendChild(b);if(d<0||d>c)throw new Error("Index out of range.");(c=b.parentNode)&&c.removeChild(b);c=d+1;if(c<this._firstDirtyChildIndex)this._firstDirtyChildIndex=c;c=f[d];b.parentNode=this;b.nextSibling=c;b._childIndex=d;var e=b.previousSibling=c.previousSibling;c.previousSibling=b;if(e)e.nextSibling=b;else{if(c===this.lastChild)this.lastChild=b;this.firstChild=b}f.splice(d,0,b);
this._childAdded(b,d);return b};a.removeAt=function(b){var d=this.childNodes,f=d.length;if(!(b<0||b>=f)){var c=d[b];d.splice(b,1);if(b<f-1&&b<this._firstDirtyChildIndex)this._firstDirtyChildIndex=b;d=c.previousSibling;f=c.nextSibling;if(d)d.nextSibling=f;else this.firstChild=f;if(f)f.previousSibling=d;else this.lastChild=d;c.nextSibling=c.previousSibling=c.parentNode=null;this._childRemoved(c,b);return c}};
a.replaceChild=function(b,d){var f=this.findChildIndex(d),c=b.parentNode;c&&c.removeChild(b);b.parentNode=this;b.nextSibling=d.nextSibling;b._childIndex=d._childIndex;if(c=b.previousSibling=d.previousSibling)c.nextSibling=b;else this.firstChild=b;if(c=d.nextSibling)c.previousSibling=b;else this.lastChild=b;this.childNodes[f]=b;this._childRemoved(d,f);this._childAdded(b,f);return d};
a.childIndex=function(b){var d=this.parentNode;if(d){var f=d._firstDirtyChildIndex;if(f<Infinity){var c=d.childNodes;if(!b)return c.indexOf(this);if(f<c.length)for(b=c[f];b;b=b.nextSibling)b._childIndex=f++;d._firstDirtyChildIndex=Infinity}return this._childIndex}return-1};a.visitBefore=function(b){function d(f,c){b(f,c);for(f=f.firstChild;f;f=f.nextSibling)d(f,c+1)}d(this,0)};a.visitAfter=function(b){function d(f,c){for(var e=f.firstChild;e;e=e.nextSibling)d(e,c+1);b(f,c)}d(this,0)};
a.sort=function(b){if(this.firstChild){this._firstDirtyChildIndex=Infinity;var d=this.childNodes;d.sort(b);var f=this.firstChild=d[0],c;delete f.previousSibling;f._childIndex=0;for(var e=1,g=d.length;e<g;e++){f.sort(b);c=d[e];c._childIndex=e;c.previousSibling=f;f=f.nextSibling=c}this.lastChild=f;delete f.nextSibling;f.sort(b)}return this};
a.reverse=function(){var b=[];this.visitAfter(function(d){this._firstDirtyChildIndex=Infinity;for(var f;f=d.lastChild;)b.push(d.removeChild(f));if(b.length)for(;f=b.pop();)d.insertBefore(f,d.firstChild)});return this};a.nodes=function(){var b=[];this.visitBefore(function(d){b.push(d)});return b};
a.toggle=function(b){if(b)return this.toggled?this.visitBefore(function(f){f.toggled&&f.toggle()}):this.visitAfter(function(f){f.toggled||f.toggle()});var d=this;if(d.toggled){for(;b=d.toggled.pop();)d.appendChild(b);delete d.toggled}else if(b=d.lastChild){d.toggled=[];do d.toggled.push(d.removeChild(b));while(b=d.lastChild)}};pv.nodes=function(b){for(var d=new pv.Dom.Node,f=0,c=b.length;f<c;f++)d.appendChild(new pv.Dom.Node(b[f]));return d.nodes()};pv.tree=function(b){return new pv.Tree(b)};
pv.Tree=function(b){this.array=b};pv.Tree.prototype.keys=function(b){this.k=b;return this};pv.Tree.prototype.value=function(b){this.v=b;return this};pv.Tree.prototype.map=function(){for(var b={},d={},f=0;f<this.array.length;f++){d.index=f;for(var c=this.array[f],e=this.k.call(d,c),g=b,h=0;h<e.length-1;h++)g=g[e[h]]||(g[e[h]]={});g[e[h]]=this.v?this.v.call(d,c):c}return b};pv.nest=function(b){return new pv.Nest(b)};pv.Nest=function(b){this.array=b;this.keys=[]};a=pv.Nest.prototype;
a.key=function(b){this.keys.push(b);return this};a.sortKeys=function(b){this.keys[this.keys.length-1].order=b||pv.naturalOrder;return this};a.sortValues=function(b){this.order=b||pv.naturalOrder;return this};a.map=function(){for(var b={},d=[],f,c=0;c<this.array.length;c++){var e=this.array[c],g=b;for(f=0;f<this.keys.length-1;f++){var h=this.keys[f](e);g[h]||(g[h]={});g=g[h]}h=this.keys[f](e);if(!g[h]){f=[];d.push(f);g[h]=f}g[h].push(e)}if(this.order)for(f=0;f<d.length;f++)d[f].sort(this.order);return b};
a.entries=function(){function b(f){var c=[];for(var e in f){var g=f[e];c.push({key:e,values:g instanceof Array?g:b(g)})}return c}function d(f,c){var e=this.keys[c].order;e&&f.sort(function(h,i){return e(h.key,i.key)});if(++c<this.keys.length)for(var g=0;g<f.length;g++)d.call(this,f[g].values,c);return f}return d.call(this,b(this.map()),0)};a.rollup=function(b){function d(f){for(var c in f){var e=f[c];if(e instanceof Array)f[c]=b(e);else d(e)}return f}return d(this.map())};pv.flatten=function(b){return new pv.Flatten(b)};
pv.Flatten=function(b){this.map=b;this.keys=[]};pv.Flatten.prototype.key=function(b,d){this.keys.push({name:b,value:d});delete this.$leaf;return this};pv.Flatten.prototype.leaf=function(b){this.keys.length=0;this.$leaf=b;return this};
pv.Flatten.prototype.array=function(){function b(h,i){if(i<c.length-1)for(var j in h){f.push(j);b(h[j],i+1);f.pop()}else d.push(f.concat(h))}var d=[],f=[],c=this.keys,e=this.$leaf;if(e){function g(h,i){if(e(h))d.push({keys:f.slice(),value:h});else for(var j in h){f.push(j);g(h[j],i+1);f.pop()}}g(this.map,0);return d}b(this.map,0);return d.map(function(h){for(var i={},j=0;j<c.length;j++){var k=c[j],l=h[j];i[k.name]=k.value?k.value.call(null,l):l}return i})};pv.Transform=function(){};
pv.Transform.prototype={k:1,x:0,y:0};pv.Transform.identity=new pv.Transform;pv.Transform.prototype.translate=function(b,d){var f=new pv.Transform;f.k=this.k;f.x=this.k*b+this.x;f.y=this.k*d+this.y;return f};pv.Transform.prototype.scale=function(b){var d=new pv.Transform;d.k=this.k*b;d.x=this.x;d.y=this.y;return d};pv.Transform.prototype.invert=function(){var b=new pv.Transform,d=1/this.k;b.k=d;b.x=-this.x*d;b.y=-this.y*d;return b};
pv.Transform.prototype.times=function(b){var d=new pv.Transform;d.k=this.k*b.k;d.x=this.k*b.x+this.x;d.y=this.k*b.y+this.y;return d};pv.Scale=function(){};
pv.Scale.interpolator=function(b,d){if(typeof b=="number")return function(e){return e*(d-b)+b};var f=b.type&&b.type!=="solid",c=d.type&&d.type!=="solid";if(f||c){b=f?b:pv.color(b).rgb();d=c?d:pv.color(d).rgb();return function(e){return e<0.5?b:d}}b=pv.color(b).rgb();d=pv.color(d).rgb();return function(e){var g=b.a*(1-e)+d.a*e;if(g<1.0E-5)g=0;return b.a==0?pv.rgb(d.r,d.g,d.b,g):d.a==0?pv.rgb(b.r,b.g,b.b,g):pv.rgb(Math.round(b.r*(1-e)+d.r*e),Math.round(b.g*(1-e)+d.g*e),Math.round(b.b*(1-e)+d.b*e),g)}};
pv.Scale.common={by:function(b){function d(){return f(b.apply(this,arguments))}var f=this;for(var c in f)d[c]=f[c];return d},by1:function(b){function d(e){return f(b.call(this,e))}var f=this;for(var c in f)d[c]=f[c];return d},transform:function(b){function d(){return b.call(this,f.apply(f,arguments))}var f=this;for(var c in f)d[c]=f[c];return d}};
pv.Scale.quantitative=function(){function b(s){return new Date(s)}function d(s){var t=pv.search(f,s);if(t<0)t=-t-2;t=Math.max(0,Math.min(g.length-1,t));return g[t]((j(s)-c[t])/(c[t+1]-c[t]))}var f=[0,1],c=[0,1],e=[0,1],g=[pv.identity],h=Number,i=false,j=pv.identity,k=pv.identity,l=String,n=null,p,m,o,q;d.transform=function(s,t){j=function(u){return i?-s(-u):s(u)};k=function(u){return i?-t(-u):t(u)};c=f.map(j);return this};d.domain=function(s,t,u){if(arguments.length){var r;if(s instanceof Array){if(arguments.length<
2)t=pv.identity;if(arguments.length<3)u=t;r=s.length&&t(s[0]);f=s.length?[pv.min(s,t),pv.max(s,u)]:[]}else{r=s;f=Array.prototype.slice.call(arguments).map(Number)}if(f.length){if(f.length==1)f=[f[0],f[0]]}else f=[-Infinity,Infinity];i=(f[0]||f[f.length-1])<0;c=f.map(j);h=r instanceof Date?b:Number;return this}return f.map(h)};d.range=function(){if(arguments.length){e=Array.prototype.slice.call(arguments);if(e.length){if(e.length==1)e=[e[0],e[0]]}else e=[-Infinity,Infinity];g=[];for(var s=0;s<e.length-
1;s++)g.push(pv.Scale.interpolator(e[s],e[s+1]));return this}return e};d.invert=function(s){var t=pv.search(e,s);if(t<0)t=-t-2;t=Math.max(0,Math.min(g.length-1,t));return h(k(c[t]+(s-e[t])/(e[t+1]-e[t])*(c[t+1]-c[t])))};d.ticks=function(s,t){var u=f[0],r=f[f.length-1],w=r<u,v=w?r:u;r=w?u:r;u=r-v;if(!u||!isFinite(u)){if(h==b)l=pv.Format.date("%x");return[h(v)]}if(h==b){function z(B,D){switch(D){case 31536E6:B.setMonth(0);case 2592E6:B.setDate(1);case 6048E5:D==6048E5&&B.setDate(B.getDate()-B.getDay());
case 864E5:B.setHours(0);case 36E5:B.setMinutes(0);case 6E4:B.setSeconds(0);case 1E3:B.setMilliseconds(0)}}var y,A,x=1;if(u>=15768E7){y=31536E6;t="%Y";A=function(B){B.setFullYear(B.getFullYear()+x)}}else if(u>=1296E7){y=2592E6;t="%m/%Y";A=function(B){B.setMonth(B.getMonth()+x)}}else if(u>=3024E6){y=6048E5;t="%m/%d";A=function(B){B.setDate(B.getDate()+7*x)}}else if(u>=432E6){y=864E5;t="%m/%d";A=function(B){B.setDate(B.getDate()+x)}}else if(u>=18E6){y=36E5;t="%I:%M %p";A=function(B){B.setHours(B.getHours()+
x)}}else if(u>=3E5){y=6E4;t="%I:%M %p";A=function(B){B.setMinutes(B.getMinutes()+x)}}else if(u>=5E3){y=1E3;t="%I:%M:%S";A=function(B){B.setSeconds(B.getSeconds()+x)}}else{y=1;t="%S.%Qs";A=function(B){B.setTime(B.getTime()+x)}}y=m?m:y;t=p?p:t;o=y;l=pv.Format.date(t);v=new Date(v);t=[];z(v,y);u=u/y;if(u>10)switch(y){case 36E5:x=u>20?6:3;v.setHours(Math.floor(v.getHours()/x)*x);break;case 2592E6:x=u>24?3:u>12?2:1;v.setMonth(Math.floor(v.getMonth()/x)*x);break;case 6048E5:x=u>15?3:u>10?2:1;v.setDate(Math.floor(v.getDate()/
(7*x))*7*x);break;case 864E5:x=u>=30?5:u>=15?3:2;v.setDate(Math.floor(v.getDate()/x)*x);break;case 6E4:x=u>30?15:u>15?10:5;v.setMinutes(Math.floor(v.getMinutes()/x)*x);break;case 1E3:x=u>90?15:u>60?10:5;v.setSeconds(Math.floor(v.getSeconds()/x)*x);break;case 1:x=u>1E3?250:u>200?100:u>100?50:u>50?25:5;v.setMilliseconds(Math.floor(v.getMilliseconds()/x)*x);break;default:x=pv.logCeil(u/15,10);if(u/x<2)x/=5;else if(u/x<5)x/=2;v.setFullYear(Math.floor(v.getFullYear()/x)*x);break}if(m){x=1;A=function(B){B.setSeconds(B.getSeconds()+
x*m/1E3)}}for(;;){A(v);if(v>r)break;t.push(new Date(v))}return w?t.reverse():t}if(s==null)s=10;y=pv.get(t,"roundInside",true);A=pv.get(t,"numberExponentMin",-Infinity);t=pv.get(t,"numberExponentMax",+Infinity);var C=Math.floor(pv.log(u/s,10)),E=false;if(C>t){C=t;E=true}else if(C<A){C=A;E=true}x=Math.pow(10,C);u=s/(u/x);if(u<=0.15&&C<t-1)x*=10;else if(u<=0.35)x*=5;else if(u<=0.75)x*=2;C=Math.floor(pv.log(x,10)+1.0E-10);u=x*Math[y?"ceil":"floor"](v/x);r=x*Math[y?"floor":"ceil"](r/x);q=Math.max(0,-C);
l=pv.Format.number().fractionDigits(q);r=pv.range(u,r+x,x);w&&r.reverse();r.roundInside=y;r.step=x;r.exponent=C;r.exponentOverflow=E;r.exponentMin=A;r.exponentMax=t;return r};d.dateTickFormat=function(){if(arguments.length){p=arguments[0];return this}return p};d.dateTickPrecision=function(){if(arguments.length){m=arguments[0];return this}return m};d.tickFormatter=function(s){if(arguments.length){n=s;return this}return n};d.tickFormat=function(s){s=n?n(s,h!==Number?o:q):l(s);return s==null?"":""+s};
d.nice=function(){if(f.length!=2)return this;var s=f[0],t=f[f.length-1],u=t<s,r=u?t:s;s=u?s:t;t=s-r;if(!t||!isFinite(t))return this;t=Math.pow(10,Math.round(Math.log(t)/Math.log(10))-1);f=[Math.floor(r/t)*t,Math.ceil(s/t)*t];u&&f.reverse();c=f.map(j);return this};pv.copyOwn(d,pv.Scale.common);d.domain.apply(d,arguments);return d};pv.Scale.linear=function(){var b=pv.Scale.quantitative();b.domain.apply(b,arguments);return b};
pv.Scale.log=function(){var b=pv.Scale.quantitative(1,10),d,f,c=function(g){return Math.log(g)/f},e=function(g){return Math.pow(d,g)};b.ticks=function(){var g=b.domain(),h=g[0]<0,i=Math.floor(h?-c(-g[0]):c(g[0])),j=Math.ceil(h?-c(-g[1]):c(g[1])),k=[];if(h)for(k.push(-e(-i));i++<j;)for(h=d-1;h>0;h--)k.push(-e(-i)*h);else{for(;i<j;i++)for(h=1;h<d;h++)k.push(e(i)*h);k.push(e(i))}for(i=0;k[i]<g[0];i++);for(j=k.length;k[j-1]>g[1];j--);return k.slice(i,j)};b.tickFormat=function(g){return g.toPrecision(1)};
b.nice=function(){var g=b.domain();return b.domain(pv.logFloor(g[0],d),pv.logCeil(g[1],d))};b.base=function(g){if(arguments.length){d=Number(g);f=Math.log(d);b.transform(c,e);return this}return d};b.domain.apply(b,arguments);return b.base(10)};pv.Scale.root=function(){var b=pv.Scale.quantitative();b.power=function(d){if(arguments.length){var f=Number(d),c=1/f;b.transform(function(e){return Math.pow(e,c)},function(e){return Math.pow(e,f)});return this}return f};b.domain.apply(b,arguments);return b.power(2)};
pv.Scale.ordinal=function(){function b(e){e in f||(f[e]=d.push(e)-1);return c[f[e]%c.length]}var d=[],f={},c=[];b.domain=function(e,g){if(arguments.length){e=e instanceof Array?arguments.length>1?pv.map(e,g):e:Array.prototype.slice.call(arguments);d=[];for(var h={},i=0;i<e.length;i++){var j=e[i];if(!(j in h)){h[j]=true;d.push(j)}}f=pv.numerate(d);return this}return d};b.range=function(e,g){if(arguments.length){c=e instanceof Array?arguments.length>1?pv.map(e,g):e:Array.prototype.slice.call(arguments);
if(typeof c[0]=="string")c=c.map(pv.fillStyle);c.min=c[0];c.max=c[c.length-1];return this}return c};b.split=function(e,g){var h=g-e,i=this.domain().length,j=0;if(h===0)c=pv.array(i,e);else if(i){j=(g-e)/i;c=pv.range(e+j/2,g,j)}c.min=e;c.max=g;c.step=j;return this};b.splitBandedCenter=function(e,g,h){b.split(e,g);if(h==null)h=1;c.band=c.step*h;c.margin=c.step-c.band;c.min=e;c.max=g;return this};b.splitBandedFlushCenter=function(e,g,h){if(h==null)h=1;var i=g-e,j=this.domain().length,k=0,l=0,n=0;if(i===
0)c=pv.array(j,e);else if(j){l=i*h/j;n=j>1?(i-j*l)/(j-1):0;k=n+l;c=pv.range(e+l/2,g,k)}c.step=k;c.band=l;c.margin=n;c.min=e;c.max=g;return this};b.splitFlush=function(e,g){var h=this.domain().length,i=(g-e)/(h-1);c=h==1?[(e+g)/2]:pv.range(e,g+i/2,i);c.min=e;c.max=g;return this};b.splitBanded=function(e,g,h){if(arguments.length<3)h=1;if(h<0){var i=this.domain().length;i=(g-e- -h*i)/(i+1);c=pv.range(e+i,g,i-h);c.band=-h}else{i=(g-e)/(this.domain().length+(1-h));c=pv.range(e+i*(1-h),g,i);c.band=i*h;
c.step=i;c.margin=i-c.band}c.min=e;c.max=g;return this};b.invertIndex=function(e,g){var h=this.domain().length;if(h===0)return-1;var i=this.range(),j=i.max-i.min;if(j===0)return 0;if(e>=i.max)return h;if(e<i.min)return 0;e=(e-i.min)/(j/h);return g?e:Math.round(e)};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);return b};
pv.Scale.quantile=function(){function b(h){return g(Math.max(0,Math.min(f,pv.search.index(c,h)-1))/f)}var d=-1,f=-1,c=[],e=[],g=pv.Scale.linear();b.quantiles=function(h){if(arguments.length){d=Number(h);if(d<0){c=[e[0]].concat(e);f=e.length-1}else{c=[];c[0]=e[0];for(var i=1;i<=d;i++)c[i]=e[~~(i*(e.length-1)/d)];f=d-1}return this}return c};b.domain=function(h,i){if(arguments.length){e=h instanceof Array?pv.map(h,i):Array.prototype.slice.call(arguments);e.sort(pv.naturalOrder);b.quantiles(d);return this}return e};
b.range=function(){if(arguments.length){g.range.apply(g,arguments);return this}return g.range()};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);return b};
pv.histogram=function(b,d){var f=true;return{bins:function(c){var e=pv.map(b,d),g=[];arguments.length||(c=pv.Scale.linear(e).ticks());for(var h=0;h<c.length-1;h++){var i=g[h]=[];i.x=c[h];i.dx=c[h+1]-c[h];i.y=0}for(h=0;h<e.length;h++){i=pv.search.index(c,e[h])-1;i=g[Math.max(0,Math.min(g.length-1,i))];i.y++;i.push(b[h])}if(!f)for(h=0;h<g.length;h++)g[h].y/=e.length;return g},frequency:function(c){if(arguments.length){f=Boolean(c);return this}return f}}};
(function(){pv.Shape=function(){};var b={x:1,y:1};pv.Shape.dist2=function(c,e,g){g=g||b;var h=c.x-e.x;c=c.y-e.y;h=h*h;c=c*c;return{cost:h+c,dist2:g.x*h+g.y*c}};var d=2*Math.PI,f=Math.atan2;pv.Shape.normalizeAngle=function(c){c%=d;if(c<0)c+=d;return c};pv.Shape.atan2Norm=function(c,e){c=f(c,e);if(c<0)c+=d;return c};pv.Shape.prototype.hasArea=function(){return true}})();
(function(){var b=pv.Shape.dist2,d=Math.cos,f=Math.sin,c=Math.sqrt;pv.vector=function(g,h){return new e(g,h)};pv.Vector=function(g,h){this.x=g;this.y=h};var e=pv.Shape.Point=pv.Vector;pv.Vector.prototype=pv.extend(pv.Shape);pv.Vector.prototype.perp=function(){return new e(-this.y,this.x)};pv.Vector.prototype.rotate=function(g){var h=d(g);g=f(g);return new e(h*this.x-g*this.y,g*this.x+h*this.y)};pv.Vector.prototype.norm=function(){var g=this.length();return this.times(g?1/g:1)};pv.Vector.prototype.length=
function(){return c(this.x*this.x+this.y*this.y)};pv.Vector.prototype.times=function(g){return new e(this.x*g,this.y*g)};pv.Vector.prototype.plus=function(g,h){return arguments.length==1?new e(this.x+g.x,this.y+g.y):new e(this.x+g,this.y+h)};pv.Vector.prototype.minus=function(g,h){return arguments.length==1?new e(this.x-g.x,this.y-g.y):new e(this.x-g,this.y-h)};pv.Vector.prototype.dot=function(g,h){return arguments.length==1?this.x*g.x+this.y*g.y:this.x*g+this.y*h};pv.Vector.prototype.hasArea=function(){return false};
pv.Vector.prototype.clone=function(){return new e(this.x,this.y)};pv.Vector.prototype.apply=function(g){return new e(g.x+g.k*this.x,g.y+g.k*this.y)};pv.Vector.prototype.intersectsRect=function(g){return this.x>=g.x&&this.x<=g.x2&&this.y>=g.y&&this.y<=g.y2};pv.Vector.prototype.containsPoint=function(g){return this.x===g.x&&this.y===g.y};pv.Vector.prototype.points=function(){return[this]};pv.Vector.prototype.edges=function(){return[]};pv.Vector.prototype.center=function(){return this};pv.Vector.prototype.distance2=
function(g,h){return b(this,g,h)}})();
(function(){var b=pv.Shape.Point,d=pv.Shape.dist2;pv.Shape.Line=function(c,e,g,h){this.x=c||0;this.y=e||0;this.x2=g||0;this.y2=h||0};var f=pv.Shape.Line;f.prototype=pv.extend(pv.Shape);f.prototype.hasArea=function(){return false};f.prototype.clone=function(){return new f(this.x,this.y,this.x2,this.x2)};f.prototype.apply=function(c){return new f(c.x+c.k*this.x,c.y+c.k*this.y,c.x+c.k*this.x2,c.y+c.k*this.y2)};f.prototype.points=function(){return[new b(this.x,this.y),new b(this.x2,this.y2)]};f.prototype.edges=
function(){return[this]};f.prototype.center=function(){return new b((this.x+this.x2)/2,(this.y+this.y2)/2)};f.prototype.normal=function(c,e){c=this.points();var g=c[1].minus(c[0]).perp().norm();if(e)if(c[0].minus(e).dot(g)<0)g=g.times(-1);return g};f.prototype.intersectsRect=function(c){var e,g,h=this.points();g=h.length;for(e=0;e<g;e++)if(h[e].intersectsRect(c))return true;c=c.edges();g=c.length;for(e=0;e<g;e++)if(this.intersectsLine(c[e]))return true;return false};f.prototype.containsPoint=function(c){var e=
this.x,g=this.x2,h=this.y,i=this.y2;return e<=c.x&&c.x<=g&&(e===g?Math.min(h,i)<=c.y&&c.y<=Math.max(h,i):Math.abs((i-h)/(g-e)*(c.x-e)+h-c.y)<=1.0E-10)};f.prototype.intersectsLine=function(c){var e=this,g=e.x2-e.x,h=e.y2-e.y,i=c.x2-c.x,j=c.y2-c.y,k=j*g-i*h;if(k===0)return false;var l=e.y-c.y;c=e.x-c.x;i=i*l-j*c;g=g*l-h*c;if(k===0)return i===0&&g===0;h=i/k;if(h<0||h>1)return false;k=g/k;if(k<0||k>1)return false;return true};f.prototype.distance2=function(c,e){var g=this,h={x:this.x2,y:this.y2},i=d(g,
h).dist2;if(i<=1.0E-10)return d(c,g,e);var j=h.x-g.x,k=h.y-g.y;i=((c.x-g.x)*j+(c.y-g.y)*k)/i;if(i<0)return d(c,g,e);if(i>1)return d(c,h,e);return d(c,{x:g.x+i*j,y:g.y+i*k},e)}})();
(function(){var b=pv.Shape.Point,d=pv.Shape.Line;pv.Shape.Polygon=function(c){this._points=c||[]};var f=pv.Shape.Polygon;f.prototype=pv.extend(pv.Shape);f.prototype.points=function(){return this._points};f.prototype.clone=function(){return new f(this.points().slice())};f.prototype.apply=function(c){for(var e=this.points(),g=e.length,h=new Array(g),i=0;i<g;i++)h[i]=e[i].apply(c);return new f(h)};f.prototype.intersectsRect=function(c){var e,g,h=this.points();g=h.length;for(e=0;e<g;e++)if(h[e].intersectsRect(c))return true;
h=this.edges();g=h.length;for(e=0;e<g;e++)if(h[e].intersectsRect(c))return true;return false};f.prototype.edges=function(){var c=this._edges;if(!c){c=this._edges=[];var e=this.points(),g=e.length;if(g){for(var h=e[0],i=h,j,k=1;k<g;k++){j=e[k];c.push(new d(h.x,h.y,j.x,j.y));h=j}g>2&&c.push(new d(j.x,j.y,i.x,i.y))}}return c};f.prototype.distance2=function(c,e){var g={cost:Infinity,dist2:Infinity};this.edges().forEach(function(h){h=h.distance2(c,e);if(h.cost<g.cost)g=h},this);return g};f.prototype.center=
function(){for(var c=this.points(),e=0,g=0,h=0,i=c.length;h<i;h++){var j=c[h];e+=j.x;g+=j.y}return new b(e/i,g/i)};f.prototype.containsPoint=function(c){var e=this.bbox();if(!e.containsPoint(c))return false;var g=new d(e.x-e.dx*0.01,c.y,c.x,c.y),h=0;this.edges().forEach(function(i){i.intersectsLine(g)&&h++});return(h&1)===1};f.prototype.bbox=function(){var c=this._bbox;if(!c){var e,g;this.points().forEach(function(h){if(e==null)e={x:h.x,y:h.y};else{if(h.x<e.x)e.x=h.x;if(h.y<e.y)e.y=h.y}if(g==null)g=
{x:h.x,y:h.y};else{if(h.x>g.x)g.x=h.x;if(h.y>g.y)g.y=h.y}});if(e)c=this._bbox=new pv.Shape.Rect(e.x,e.y,g.x-e.x,g.y-e.y)}return c}})();
(function(){var b=pv.Shape.Point,d=pv.Shape.Line;pv.Shape.Rect=function(c,e,g,h){this.x=c||0;this.y=e||0;this.dx=g||0;this.dy=h||0;if(this.dx<0){this.dx=-this.dx;this.x-=this.dx}if(this.dy<0){this.dy=-this.dy;this.y-=this.dy}this.x2=this.x+this.dx;this.y2=this.y+this.dy};var f=pv.Shape.Rect;f.prototype=pv.extend(pv.Shape.Polygon);f.prototype.clone=function(){var c=Object.create(f.prototype);c.x=this.x;c.y=this.y;c.dx=this.dx;c.dy=this.dy;c.x2=this.x2;c.y2=this.y2;return c};f.prototype.apply=function(c){return new f(c.x+
c.k*this.x,c.y+c.k*this.y,c.k*this.dx,c.k*this.dy)};f.prototype.containsPoint=function(c){return this.x<=c.x&&c.x<=this.x2&&this.y<=c.y&&c.y<=this.y2};f.prototype.intersectsRect=function(c){return this.x2>c.x&&this.x<c.x2&&this.y2>c.y&&this.y<c.y2};f.prototype.edges=function(){if(!this._edges){var c=this.x,e=this.y,g=this.x2,h=this.y2;this._edges=[new d(c,e,g,e),new d(g,e,g,h),new d(g,h,c,h),new d(c,h,c,e)]}return this._edges};f.prototype.center=function(){return new b(this.x+this.dx/2,this.y+this.dy/
2)};f.prototype.points=function(){var c=this._points;if(!c){c=this.x;var e=this.y,g=this.x2,h=this.y2;c=this._points=[new b(c,e),new b(g,e),new b(g,h),new b(c,h)]}return c};f.prototype.bbox=function(){return this.clone()}})();
(function(){var b=pv.Shape.Point,d=pv.Shape.dist2,f=Math.sqrt,c=Math.abs,e=Math.pow;pv.Shape.Circle=function(h,i,j){this.x=h||0;this.y=i||0;this.radius=j||0};var g=pv.Shape.Circle;g.prototype=pv.extend(pv.Shape);g.prototype.clone=function(){return new g(this.x,this.y,this.radius)};g.prototype.apply=function(h){return new g(h.x+h.k*this.x,h.y+h.k*this.y,h.k*this.radius)};g.prototype.intersectsRect=function(h){var i=h.dx/2,j=h.dy/2,k=this.radius,l=c(this.x-h.x-i);h=c(this.y-h.y-j);if(l>i+k||h>j+k)return false;
if(l<=i||h<=j)return true;return e(l-i,2)+e(h-j,2)<=k*k};g.prototype.intersectLine=function(h,i){var j=h.x2-h.x,k=h.y2-h.y,l=this.x-h.x,n=this.y-h.y,p=j*j+k*k,m=this.radius,o=(j*l+k*n)/p;l=o*o-(l*l+n*n-m*m)/p;if(!(l<0)){p=f(l);n=o-p;o=o+p;p=[];if(i||n>=0&&n<=1)p.push(new b(h.x+j*n,h.y+k*n));if(l!==0)if(i||o>=0&&o<=1)p.push(new b(h.x+j*o,h.y+k*o));return p}};g.prototype.points=function(){return[this.center()]};g.prototype.center=function(){return new b(this.x,this.y)};g.prototype.normal=function(h){return h.minus(this.x,
this.y).norm()};g.prototype.containsPoint=function(h){var i=h.x-this.x;h=h.y-this.y;var j=this.radius;return i*i+h*h<=j*j};g.prototype.distance2=function(h,i){var j=this.radius;j=h.minus(this).norm().times(j).plus(this);return d(h,j,i)}})();
(function(){var b=pv.Shape.Point,d=pv.Shape.dist2,f=pv.Shape.normalizeAngle,c=pv.Shape.atan2Norm,e=Math.cos,g=Math.sin,h=Math.sqrt;pv.Shape.Arc=function(k,l,n,p,m){this.x=k;this.y=l;this.radius=n;this.startAngle=f(p);this.angleSpan=f(m);this.endAngle=this.startAngle+this.angleSpan};var i=pv.Shape.Arc;i.prototype=pv.extend(pv.Shape);i.prototype.hasArea=function(){return false};i.prototype.clone=function(){var k=Object.create(i.prototype),l=this;k.x=l.x;k.y=l.y;k.radius=l.radius;k.startAngle=l.startAngle;
k.angleSpan=l.angleSpan;k.endAngle=l.endAngle;return k};i.prototype.apply=function(k){return new i(k.x+k.k*this.x,k.y+k.k*this.y,k.k*this.radius,this.startAngle,this.angleSpan)};i.prototype.containsPoint=function(k){var l=k.x-this.x;k=k.y-this.y;var n=h(l*l+k*k);if(Math.abs(n-this.radius)<=1.0E-10){l=c(k,l);return this.startAngle<=l&&l<=this.endAngle}return false};i.prototype.intersectsRect=function(k){var l,n,p=this.points();n=p.length;for(l=0;l<n;l++)if(p[l].intersectsRect(k))return true;k=k.edges();
n=k.length;for(l=0;l<n;l++)if(this.intersectLine(k[l]))return true;return false};var j=pv.Shape.Circle.prototype.intersectLine;i.prototype.intersectLine=function(k,l){if(k=j.call(this,k,l)){k=k.filter(function(n){return this.containsPoint(n)},this);if(k.length)return k}};i.prototype.points=function(){var k=this.x,l=this.y,n=this.radius,p=this.startAngle,m=this.endAngle;return[new b(k+n*e(p),l+n*g(p)),new b(k+n*e(m),l+n*g(m))]};i.prototype.center=function(){var k=this.y,l=this.radius,n=(this.startAngle+
this.endAngle)/2;return new b(this.x+l*e(n),k+l*g(n))};i.prototype.normal=function(k,l){k=k.minus(this.x,this.y).norm();if(l)if(this.center().minus(l).dot(k)<0)k=k.times(-1);return k};i.prototype.distance2=function(k,l){var n=c(k.y-this.y,k.x-this.x);if(this.startAngle<=n&&n<=this.endAngle){n=new b(this.x+this.radius*e(n),this.y+this.radius*g(n));return d(k,n,l)}var p=this.points();n=d(k,p[0],l);k=d(k,p[1],l);return n.cost<k.cost?n:k}})();
(function(){var b=pv.Shape.Arc,d=pv.Shape.Line,f=pv.Shape.Point,c=Math.cos,e=Math.sin,g=Math.sqrt,h=pv.Shape.atan2Norm,i=pv.Shape.normalizeAngle;pv.Shape.Wedge=function(k,l,n,p,m,o){this.x=k;this.y=l;this.innerRadius=n;this.outerRadius=p;this.startAngle=i(m);this.angleSpan=i(o);this.endAngle=this.startAngle+this.angleSpan};var j=pv.Shape.Wedge;j.prototype=pv.extend(pv.Shape);j.prototype.clone=function(){return new j(this.x,this.y,this.innerRadius,this.outerRadius,this.startAngle,this.angleSpan)};
j.prototype.apply=function(k){return new j(k.x+k.k*this.x,k.y+k.k*this.y,k.k*this.innerRadius,k.k*this.outerRadius,this.startAngle,this.angleSpan)};j.prototype.containsPoint=function(k){var l=k.x-this.x;k=k.y-this.y;var n=g(l*l+k*k);if(n>=this.innerRadius&&n<=this.outerRadius){l=h(k,l);return this.startAngle<=l&&l<=this.endAngle}return false};j.prototype.intersectsRect=function(k){var l,n,p=this.points();n=p.length;for(l=0;l<n;l++)if(p[l].intersectsRect(k))return true;p=k.points();n=p.length;for(l=
0;l<n;l++)if(this.containsPoint(p[l]))return true;p=this.edges();n=p.length;for(l=0;l<n;l++)if(p[l].intersectsRect(k))return true;return false};j.prototype.points=function(){this._points||this.edges();return this._points};j.prototype.edges=function(){var k=this._edges;if(!k){var l=this.x,n=this.y,p=this.innerRadius,m=this.outerRadius,o=this.startAngle,q=this.endAngle,s=this.angleSpan,t=c(o),u=e(o);k=c(q);var r=e(q),w;if(p>0){w=new f(l+p*t,n+p*u);q=new f(l+p*k,n+p*r)}else w=q=new f(l,n);t=new f(l+
m*t,n+m*u);u=new f(l+m*k,n+m*r);k=this._edges=[];p>0&&k.push(new b(l,n,p,o,s));k.push(new d(w.x,w.y,t.x,t.y),new b(l,n,m,o,s),new d(q.x,q.y,u.x,u.y));l=this._points=[w,t,u];p>0&&l.push(q)}return k};j.prototype.distance2=function(k,l){var n={cost:Infinity,dist2:Infinity};this.edges().forEach(function(p){p=p.distance2(k,l);if(p.cost<n.cost)n=p});return n};j.prototype.center=function(){var k=(this.startAngle+this.endAngle)/2,l=(this.innerRadius+this.outerRadius)/2;return new f(this.x+l*c(k),this.y+l*
e(k))}})();
(function(){var b=Math.round,d=function(g){var h=parseFloat(g);return g[g.length-1]=="%"?b(h*2.55):h},f=/([a-z]+)\((.*)\)/i,c=function(g){if(g.charAt(0)==="#"){var h,i,j;if(g.length===4){h=g.charAt(1);h+=h;i=g.charAt(2);i+=i;j=g.charAt(3);j+=j}else if(g.length===7){h=g.substring(1,3);i=g.substring(3,5);j=g.substring(5,7)}return pv.rgb(parseInt(h,16),parseInt(i,16),parseInt(j,16),1)}if(h=f.exec(g)){j=h[2].split(",");var k=1;switch(h[1]){case "hsla":case "rgba":k=parseFloat(j[3]);if(!k)return pv.Color.transparent;break}switch(h[1]){case "hsla":case "hsl":g=
parseFloat(j[0]);h=parseFloat(j[1])/100;j=parseFloat(j[2])/100;return(new pv.Color.Hsl(g,h,j,k)).rgb();case "rgba":case "rgb":h=d(j[0]);i=d(j[1]);j=d(j[2]);return pv.rgb(h,i,j,k)}}return new pv.Color(g,1)},e={};pv.color=function(g){if(g.rgb)return g.rgb();var h=pv.Color.names[g];h||(h=e[g]||(e[g]=c(g)));return h}})();pv.Color=function(b,d){this.color=b;this.opacity=d;this.key="solid "+b+" alpha("+d+")"};a=pv.Color.prototype;a.hsl=function(){return this.rgb().hsl()};a.brighter=function(b){return this.rgb().brighter(b)};
a.darker=function(b){return this.rgb().darker(b)};a.alphaBlend=function(b){var d=this.rgb(),f=d.a;if(f===1)return this;b=b?pv.color(b):pv.Color.names.white;b=b.rgb();var c=1-f;return pv.rgb(c*d.r+f*b.r,c*d.g+f*b.g,c*d.b+f*b.b,1)};a.rgbDecimal=function(b){b=this.alphaBlend(b);return b.r<<16|b.g<<8|b.b};a.isDark=function(){return this.rgbDecimal()<8388607.5};pv.rgb=function(b,d,f,c){return new pv.Color.Rgb(b,d,f,arguments.length==4?c:1)};
pv.Color.Rgb=function(b,d,f,c){pv.Color.call(this,c?"rgb("+b+","+d+","+f+")":"none",c);this.r=b;this.g=d;this.b=f;this.a=c};pv.Color.Rgb.prototype=pv.extend(pv.Color);a=pv.Color.Rgb.prototype;a.red=function(b){return pv.rgb(b,this.g,this.b,this.a)};a.green=function(b){return pv.rgb(this.r,b,this.b,this.a)};a.blue=function(b){return pv.rgb(this.r,this.g,b,this.a)};a.alpha=function(b){return pv.rgb(this.r,this.g,this.b,b)};a.rgb=function(){return this};
a.brighter=function(b){b=Math.pow(0.7,b!=null?b:1);var d=this.r,f=this.g,c=this.b;if(!d&&!f&&!c)return pv.rgb(30,30,30,this.a);if(d&&d<30)d=30;if(f&&f<30)f=30;if(c&&c<30)c=30;return pv.rgb(Math.min(255,Math.floor(d/b)),Math.min(255,Math.floor(f/b)),Math.min(255,Math.floor(c/b)),this.a)};a.darker=function(b){b=Math.pow(0.7,b!=null?b:1);return pv.rgb(Math.max(0,Math.floor(b*this.r)),Math.max(0,Math.floor(b*this.g)),Math.max(0,Math.floor(b*this.b)),this.a)};
a.hsl=function(){var b=this.r/255,d=this.g/255,f=this.b/255,c=Math.max(b,d,f),e=Math.min(b,d,f),g=(c+e)/2,h;if(c===e)h=e=0;else{var i=c-e;e=g>0.5?i/(2-c-e):i/(c+e);switch(c){case b:h=(d-f)/i+(d<f?6:0);break;case d:h=(f-b)/i+2;break;case f:h=(b-d)/i+4;break}h/=6}return pv.hsl(h*360,e,g,this.a)};a.complementary=function(){return this.hsl().complementary().rgb()};pv.hsl=function(b,d,f,c){return new pv.Color.Hsl(b,d,f,arguments.length==4?c:1)};
pv.Color.Hsl=function(b,d,f,c){pv.Color.call(this,"hsl("+b+","+d*100+"%,"+f*100+"%)",c);this.h=b;this.s=d;this.l=f;this.a=c};pv.Color.Hsl.prototype=pv.extend(pv.Color);a=pv.Color.Hsl.prototype;a.hsl=function(){return this};a.hue=function(b){return pv.hsl(b,this.s,this.l,this.a)};a.saturation=function(b){return pv.hsl(this.h,b,this.l,this.a)};a.lightness=function(b){return pv.hsl(this.h,this.s,b,this.a)};a.alpha=function(b){return pv.hsl(this.h,this.s,this.l,b)};
a.complementary=function(){return pv.hsl((this.h+180)%360,1-this.s,1-this.l,this.a)};a.rgb=function(){function b(i){if(i>360)i-=360;else if(i<0)i+=360;if(i<60)return h+(g-h)*i/60;if(i<180)return g;if(i<240)return h+(g-h)*(240-i)/60;return h}function d(i){return Math.round(b(i)*255)}var f=this.h,c=this.s,e=this.l;f%=360;if(f<0)f+=360;c=Math.max(0,Math.min(c,1));e=Math.max(0,Math.min(e,1));var g=e<=0.5?e*(1+c):e+c-e*c,h=2*e-g;return pv.rgb(d(f+120),d(f),d(f-120),this.a)};
pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)};
(function(){var b=pv.Color.names;b.none=b.transparent;for(var d in b)b[d]=pv.color(b[d])})();pv.colors=function(){var b=pv.Scale.ordinal();b.range.apply(b,arguments);return b};pv.Colors={};pv.Colors.category10=function(){var b=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");b.domain.apply(b,arguments);return b};
pv.Colors.category20=function(){var b=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");b.domain.apply(b,arguments);return b};
pv.Colors.category19=function(){var b=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");b.domain.apply(b,arguments);return b};
(function(){function b(m){var o=f(m);if(!o.length)return null;var q=Math.PI,s,t=o[0];if(t.indexOf("to ")===0){if(s=/^to\s+(?:((top|bottom)(?:\s+(left|right))?)|((left|right)(?:\\s+(top|bottom))?))$/.exec(t)){if(s[1]){q=s[2];if(s[3])q+=" "+s[3]}else{q=s[5];if(s[6])q=s[6]+" "+q}q=pv.radians(h[q]);o.shift()}}else{s=parseFloat(t);if(!isNaN(s)){q=s;if(/^.*?deg$/.test(t))q=pv.radians(q);o.shift()}}o=c(o);switch(o.length){case 0:return null;case 1:return new pv.FillStyle.Solid(o[0].color,1)}return new pv.FillStyle.LinearGradient(q,
o,m)}function d(m){var o=f(m);if(!o.length)return null;o=c(o);switch(o.length){case 0:return null;case 1:return new pv.FillStyle.Solid(o[0].color,1)}return new pv.FillStyle.RadialGradient(50,50,o,m)}function f(m){var o={},q=0;m=m.replace(/\b\w+?\(.*?\)/g,function(t){var u="__color"+q++;o[u]=t;return u});var s=m.split(/\s*,\s*/);if(!s.length)return null;q&&s.forEach(function(t,u){if(o.hasOwnProperty(t))s[u]=o[t]});return s}function c(m){function o(x){var C=u.length;if(C){var E=t;x=(x-E)/(C+1);for(var B=
0;B<C;B++){E+=x;u[B].offset=E}u.length=0}}for(var q=[],s=+Infinity,t=-Infinity,u=[],r=0,w=m.length;r<w;){var v=/^(.+?)\s*([+\-]?[e\.\d]+%)?$/i.exec(m[r++]);if(v){var z={color:pv.color(v[1])};v=parseFloat(v[2]);if(isNaN(v))if(q.length){if(r===w)v=Math.max(t,100)}else v=0;q.push(z);if(isNaN(v))u.push(z);else{z.offset=v;o(v);if(v>t)t=v;else if(v<t)v=t;if(v<s)s=v}}}if(q.length>=2&&(s<0||t>100)){var y=[],A=[];q.forEach(function(x){y.push(x.offset);A.push(x.color)});m=pv.scale.linear().domain(y).range(A);
if(s<0){for(;q.length&&q[0].offset<=0;)q.shift();q.unshift({offset:0,color:m(0)})}if(t>100){for(;q.length&&q[q.length-1].offset>=100;)q.pop();q.push({offset:100,color:m(100)})}}return q}pv.fillStyle=function(m){if(m.type)return m;var o=m.key||m,q=e[o];return q=q?q.clone():(e[o]=g(m))};var e={},g=function(m){if(m.rgb)return new pv.FillStyle.Solid(m.color,m.opacity);var o=/^\s*([a-z\-]+)\(\s*(.*?)\s*\)\s*$/.exec(m);if(o)switch(o[1]){case "linear-gradient":return b(o[2]);case "radial-gradient":return d(o[2])}return new pv.FillStyle.Solid(pv.color(m))},
h={top:0,"top right":45,right:90,"bottom right":135,bottom:180,"bottom left":225,left:270,"top left":315},i=pv.FillStyle=function(m){this.key=this.type=m};pv.extendType(i,new pv.Color("none",1));i.prototype.rgb=function(){var m=pv.color(this.color);if(this.opacity!==m.opacity)m=m.alpha(this.opacity);return m};i.prototype.alphaBlend=function(m){return this.rgb().alphaBlend(m)};i.prototype.rgbDecimal=function(m){return this.rgb().rgbDecimal(m)};i.prototype.isDark=function(){return this.rgb().isDark()};
var j=pv.FillStyle.Solid=function(m,o){i.call(this,"solid");if(m.rgb){this.color=m.color;this.opacity=m.opacity}else{this.color=m;this.opacity=o}this.key+=" "+this.color+" alpha("+this.opacity+")"};pv.extendType(j,i);j.prototype.alpha=function(m){return new j(this.color,m)};j.prototype.brighter=function(m){return new j(this.rgb().brighter(m))};j.prototype.darker=function(m){return new j(this.rgb().darker(m))};j.prototype.complementary=function(){return new j(this.rgb().complementary())};j.prototype.clone=
function(){var m=pv.extend(j);m.type=this.type;m.key=this.key;m.color=this.color;m.opacity=this.opacity;return m};pv.FillStyle.transparent=new j(pv.Color.transparent);var k=0,l=pv.FillStyle.Gradient=function(m,o){i.call(this,m);this.id=++k;this.stops=o;if(o.length)this.color=o[0].color.color;this.key+=" stops("+o.map(function(q){var s=q.color;return s.color+" alpha("+s.opacity+") at("+q.offset+")"}).join(", ")+")"};pv.extendType(l,i);l.prototype.rgb=function(){return this.stops.length?this.stops[0].color:
undefined};l.prototype.alpha=function(m){return this._cloneWithStops(this.stops.map(function(o){return{offset:o.offset,color:o.color.alpha(m)}}))};l.prototype.darker=function(m){return this._cloneWithStops(this.stops.map(function(o){return{offset:o.offset,color:o.color.darker(m)}}))};l.prototype.brighter=function(m){return this._cloneWithStops(this.stops.map(function(o){return{offset:o.offset,color:o.color.brighter(m)}}))};l.prototype.complementary=function(){return this._cloneWithStops(this.stops.map(function(m){return{offset:m.offset,
color:m.color.complementary()}}))};l.prototype.alphaBlend=function(m){return this._cloneWithStops(this.stops.map(function(o){return{offset:o.offset,color:o.color.alphaBlend(m)}}))};l.prototype.clone=function(){var m=this.constructor,o=pv.extend(m);o.constructor=m;o.id=++k;o.type=this.type;o.key=this.key;m=this.stops;o.stops=m;if(m.length)o.color=m[0].color.color;this._initClone(o);return o};var n=pv.FillStyle.LinearGradient=function(m,o){l.call(this,"lineargradient",o);this.angle=m;this.key+=" angle("+
m+")"};pv.extendType(n,l);n.prototype._cloneWithStops=function(m){return new n(this.angle,m)};n.prototype._initClone=function(m){m.angle=this.angle};var p=pv.FillStyle.RadialGradient=function(m,o,q){l.call(this,"radialgradient",q);this.cx=m;this.cy=o;this.key+=" center("+m+","+o+")"};pv.extendType(p,l);p.prototype._cloneWithStops=function(){return new p(this.cx,this.cy)};p.prototype._initClone=function(m){m.cx=this.cx;m.cy=this.cy}})();
pv.ramp=function(){var b=pv.Scale.linear();b.range.apply(b,arguments);return b};
pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter",
"stroke-linecap":"butt","stroke-miterlimit":8,"stroke-dasharray":"none"},css:{font:"10px sans-serif"}}};pv.SvgScene.updateAll=function(b){if(b.length&&b[0].reverse&&b.type!=="line"&&b.type!=="area"){for(var d=pv.extend(b),f=0,c=b.length-1;c>=0;f++,c--)d[f]=b[c];b=d}this.removeSiblings(this[b.type](b))};pv.SvgScene.create=function(b){return document.createElementNS(this.svg,b)};
pv.SvgScene.expect=function(b,d,f,c,e,g){var h;if(b){h=b.tagName;if(h==="defs"){if(b=b.nextSibling)h=b.tagName}else if(h==="a")b=b.firstChild}if(b){if(h!==d){d=this.create(d);b.parentNode.replaceChild(d,b);b=d}}else b=this.create(d);e&&this.setAttributes(b,e);g&&this.setStyle(b,g);return b};
pv.SvgScene.setAttributes=function(b,d){var f=this.implicit.svg,c=b.__attributes__;if(c===d)c=null;for(var e in d){var g=d[e];if(!c||g!==c[e])g==null||g==f[e]?b.removeAttribute(e):b.setAttribute(e,g)}b.__attributes__=d};
pv.SvgScene.setStyle=function(b,d){var f=this.implicit.css,c=b.__style__;if(c===d)c=null;switch(pv.renderer()){case "batik":for(var e in d){var g=d[e];if(!c||g!==c[e])g==null||g==f[e]?b.removeAttribute(e):b.style.setProperty(e,g)}break;case "svgweb":for(e in d){g=d[e];g==null||g==f[e]||(b.style[e]=g)}break;default:for(e in d){g=d[e];if(!c||g!==c[e])if(g==null||g==f[e])b.style.removeProperty(e);else b.style[e]=g}}b.__style__=d};
pv.SvgScene.append=function(b,d,f){b.$scene={scenes:d,index:f};b=this.title(b,d[f]);b.parentNode||d.$g.appendChild(b);return b.nextSibling};
pv.SvgScene.title=function(b,d){var f=b.parentNode;if(f&&f.tagName!="a")f=null;if(d.title){if(!f){f=this.create("a");f.setAttributeNS(this.xlink,"xlink:href","");b.parentNode&&b.parentNode.replaceChild(f,b);f.appendChild(b)}f.setAttributeNS(this.xlink,"xlink:title",d.title);for(var c=null,e=b.firstChild;e!=null;e=e.nextSibling)if(e.nodeName=="title"){c=e;break}if(c)c.removeChild(c.firstChild);else{c=this.create("title");b.appendChild(c)}pv.renderer()=="svgweb"?c.appendChild(document.createTextNode(d.title,
true)):c.appendChild(document.createTextNode(d.title));return f}f&&f.parentNode.replaceChild(b,f);return b};pv.SvgScene.dispatch=pv.listener(function(b){var d=b.target.$scene;if(d){var f=b.type;switch(f){case "DOMMouseScroll":f="mousewheel";b.wheel=-480*b.detail;break;case "mousewheel":b.wheel=(window.opera?12:1)*b.wheelDelta;break}if(pv.Mark.dispatch(f,d.scenes,d.index,b)){b.preventDefault();b.stopPropagation()}}});
pv.SvgScene.removeSiblings=function(b){for(;b;){var d=b.nextSibling;b.nodeName!=="defs"&&b.parentNode.removeChild(b);b=d}};pv.SvgScene.undefined=function(){};
(function(){var b={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},d={shortdash:[3,1],shortdot:[1,1],shortdashdot:[3,1,1,1],shortdashdotdot:[3,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};pv.SvgScene.isStandardDashStyle=function(f){return d.hasOwnProperty(f)};pv.SvgScene.translateDashStyleAlias=function(f){return b.hasOwnProperty(f)?
b[f]:f};pv.SvgScene.parseDasharray=function(f){var c=f.strokeDasharray;if(c&&c!=="none"){c=this.translateDashStyleAlias(c);var e=d[c];c=e?e:c.split(/[\s,]+/);var g=f.lineWidth,h=(f.lineCap||"butt")==="butt";c=c.map(function(i,j){i=+i;if(!h)if(j%2)i++;else i-=1;if(i<=0)i=0.001;return i*g/this.scale},this).join(" ")}else c=null;return c}})();
(function(){var b=/^url\(#/,d=1,f=Math.PI/2,c=f/2,e=Math.SQRT2/2,g=Math.abs,h=Math.sin,i=Math.cos,j=function(l){return g(l)<=1.0E-12?0:l};pv.SvgScene.addFillStyleDefinition=function(l,n){if(!(!n.type||n.type==="solid"||b.test(n.color))){var p=l.mark.root,m=p.__fillStyleMap__||(p.__fillStyleMap__={}),o=n.key,q=m[o];if(!q){q=m[o]="__pvGradient"+d++;l=k.call(this,l,n,q);p.scene.$g.$defs.appendChild(l)}n.color="url(#"+q+")"}};var k=function(l,n,p){var m=n.type==="lineargradient";l=this.create(m?"linearGradient":
"radialGradient");l.setAttribute("id",p);if(m){p=n.angle-f;m=g(p%f)-c;var o=g(e*i(m));m=o*i(p);p=o*h(p);l.setAttribute("x1",j(0.5-m));l.setAttribute("y1",j(0.5-p));l.setAttribute("x2",j(0.5+m));l.setAttribute("y2",j(0.5+p))}n=n.stops;p=n.length;for(m=0;m<p;m++){o=n[m];var q=l.appendChild(this.create("stop")),s=o.color;q.setAttribute("offset",o.offset+"%");q.setAttribute("stop-color",s.color);q.setAttribute("stop-opacity",s.opacity+"")}return l}})();
pv.SvgScene.pathBasis=function(){function b(c,e,g,h,i){return{x:c[0]*e.left+c[1]*g.left+c[2]*h.left+c[3]*i.left,y:c[0]*e.top+c[1]*g.top+c[2]*h.top+c[3]*i.top}}var d=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],f=function(c,e,g,h){var i=b(d[1],c,e,g,h),j=b(d[2],c,e,g,h);c=b(d[3],c,e,g,h);return"C"+i.x+","+i.y+","+j.x+","+j.y+","+c.x+","+c.y};f.segment=function(c,e,g,h){var i=b(d[0],c,e,g,h),j=b(d[1],c,e,g,h),k=b(d[2],c,e,g,h);c=b(d[3],c,e,g,h);return["M"+i.x+","+i.y,"C"+j.x+","+j.y+
","+k.x+","+k.y+","+c.x+","+c.y]};return f}();pv.SvgScene.curveBasis=function(b,d,f){var c;if(d==null){c=b.length;d=0;f=c-1}else c=f-d+1;if(c<=2)return"";c="";var e=b[d],g=e,h=e,i=b[d+1];c+=this.pathBasis(e,g,h,i);for(d=d+2;d<=f;d++){e=g;g=h;h=i;i=b[d];c+=this.pathBasis(e,g,h,i)}c+=this.pathBasis(g,h,i,i);c+=this.pathBasis(h,i,i,i);return c};
pv.SvgScene.curveBasisSegments=function(b,d,f){var c;if(d==null){c=b.length;d=0;f=c-1}else c=f-d+1;if(c<=2)return"";c=[];var e=b[d],g=e,h=e,i=b[d+1],j=this.pathBasis.segment(e,g,h,i);e=g;g=h;h=i;i=b[d+2];j[1]+=this.pathBasis(e,g,h,i);c.push(j);for(d=d+3;d<=f;d++){e=g;g=h;h=i;i=b[d];c.push(this.pathBasis.segment(e,g,h,i))}b=this.pathBasis.segment(g,h,i,i);b[1]+=this.pathBasis(h,i,i,i);c.push(b);return c};
pv.SvgScene.curveHermite=function(b,d,f,c){var e;if(f==null){e=b.length;f=0}else e=c-f+1;c=d.length;if(c<1||e!==c&&e!==c+2)return"";var g=e!==c;e="";var h=b[f],i=b[f+1],j=d[0],k=j,l=f+1;if(g){e+="Q"+(i.left-j.x*2/3)+","+(i.top-j.y*2/3)+","+i.left+","+i.top;h=b[f+1];l=f+2}if(c>1){k=d[1];i=b[l];l++;e+="C"+(h.left+j.x)+","+(h.top+j.y)+","+(i.left-k.x)+","+(i.top-k.y)+","+i.left+","+i.top;for(f=2;f<c;f++,l++){i=b[l];k=d[f];e+="S"+(i.left-k.x)+","+(i.top-k.y)+","+i.left+","+i.top}}if(g){b=b[l];e+="Q"+
(i.left+k.x*2/3)+","+(i.top+k.y*2/3)+","+b.left+","+b.top}return e};
pv.SvgScene.curveHermiteSegments=function(b,d,f,c){var e;if(f==null){e=b.length;f=0}else e=c-f+1;c=d.length;if(c<1||e!==c&&e!==c+2)return[];var g=e!==c;e=[];var h=b[f],i=h,j=d[0],k=j,l=f+1;if(g){i=b[f+1];e.push(["M"+h.left+","+h.top,"Q"+(i.left-k.x*2/3)+","+(i.top-k.y*2/3)+","+i.left+","+i.top]);l=f+2}for(f=1;f<c;f++,l++){h=i;j=k;i=b[l];k=d[f];e.push(["M"+h.left+","+h.top,"C"+(h.left+j.x)+","+(h.top+j.y)+","+(i.left-k.x)+","+(i.top-k.y)+","+i.left+","+i.top])}if(g){b=b[l];e.push(["M"+i.left+","+i.top,
"Q"+(i.left+k.x*2/3)+","+(i.top+k.y*2/3)+","+b.left+","+b.top])}return e};pv.SvgScene.cardinalTangents=function(b,d,f,c){if(f==null){c=b.length;f=0;c=c-1}var e=[];d=(1-d)/2;var g=b[f],h=b[f+1],i=b[f+2];for(f=f+3;f<=c;f++){e.push({x:d*(i.left-g.left),y:d*(i.top-g.top)});g=h;h=i;i=b[f]}e.push({x:d*(i.left-g.left),y:d*(i.top-g.top)});return e};
pv.SvgScene.curveCardinal=function(b,d,f,c){var e;if(f==null){e=b.length;f=0;c=e-1}else e=c-f+1;if(e<=2)return"";return this.curveHermite(b,this.cardinalTangents(b,d,f,c),f,c)};pv.SvgScene.curveCardinalSegments=function(b,d,f,c){var e;if(f==null){e=b.length;f=0;c=e-1}else e=c-f+1;if(e<=2)return"";return this.curveHermiteSegments(b,this.cardinalTangents(b,d,f,c),f,c)};
pv.SvgScene.monotoneTangents=function(b,d,f){if(d==null){f=b.length;d=0}else f=f-d+1;var c=[],e=[],g=[],h=[],i=0,j;for(i=0;i<f-1;i++){j=d+i;var k=b[j+1].left-b[j].left;e[i]=Math.abs(k)<=1.0E-12?0:(b[j+1].top-b[j].top)/k}g[0]=e[0];h[0]=b[d+1].left-b[d].left;i=1;for(j=d+i;i<f-1;i++,j++){g[i]=(e[i-1]+e[i])/2;h[i]=(b[j+1].left-b[j-1].left)/2}g[i]=e[i-1];h[i]=b[j].left-b[j-1].left;for(i=0;i<f-1;i++)if(e[i]==0){g[i]=0;g[i+1]=0}for(i=0;i<f-1;i++)if(!(Math.abs(g[i])<1.0E-5||Math.abs(g[i+1])<1.0E-5)){b=g[i]/
e[i];d=g[i+1]/e[i];j=b*b+d*d;if(j>9){j=3/Math.sqrt(j);g[i]=j*b*e[i];g[i+1]=j*d*e[i]}}for(i=0;i<f;i++){e=1+g[i]*g[i];c.push({x:h[i]/3/e,y:g[i]*h[i]/3/e})}return c};pv.SvgScene.curveMonotone=function(b,d,f){var c;if(d==null){c=b.length;d=0;f=c-1}else c=f-d+1;if(c<=2)return"";return this.curveHermite(b,this.monotoneTangents(b,d,f),d,f)};
pv.SvgScene.curveMonotoneSegments=function(b,d,f){var c;if(d==null){c=b.length;d=0;f=c-1}else c=f-d+1;if(c<=2)return"";return this.curveHermiteSegments(b,this.monotoneTangents(b,d,f),d,f)};pv.SvgScene.area=function(b){var d=b.$g.firstChild,f=b.length;if(!f)return d;var c=b[0];if(c.segmented==="smart")return this.areaSegmentedSmart(d,b);if(c.segmented)return this.areaSegmentedFull(d,b);return this.areaFixed(d,b,0,f-1,true)};
pv.SvgScene.areaFixed=function(b,d,f,c,e){if(c-f+1===1)return this.lineAreaDot(b,d,f);var g=d[f];if(!g.visible)return b;var h=g.fillStyle,i=g.strokeStyle;if(!h.opacity&&!i.opacity)return b;this.addFillStyleDefinition(d,h);this.addFillStyleDefinition(d,i);var j=false,k=false,l=false,n=false,p=false;switch(g.interpolate){case "basis":j=true;break;case "cardinal":k=true;break;case "monotone":l=true;break;case "step-after":n=true;break;case "step-before":p=true;break}k=j||k||l;j=[];var m;for(l=f;l<=c;l++){m=
d[l];if(m.width||m.height){for(var o=l+1;o<=c;o++){m=d[o];if(!m.width&&!m.height)break}l>f&&!n&&l--;o<=c&&!p&&o++;j.push((k&&o-l>2?this.areaPathCurve:this.areaPathStraight).call(this,d,l,o-1,g));l=o-1}}if(!j.length)return b;c=i.opacity;b=this.expect(b,"path",d,f,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":e?g.events:"none",cursor:g.cursor,d:"M"+j.join("ZM")+"Z",fill:h.color,"fill-opacity":h.opacity||null,stroke:i.color,"stroke-opacity":c||null,"stroke-width":c?g.lineWidth/this.scale:
null,"stroke-linecap":g.lineCap,"stroke-linejoin":g.lineJoin,"stroke-miterlimit":g.strokeMiterLimit,"stroke-dasharray":c?this.parseDasharray(g):null});g.svg&&this.setAttributes(b,g.svg);g.css&&this.setStyle(b,g.css);return this.append(b,d,f)};
pv.SvgScene.areaSegmentedSmart=function(b,d){b||(b=d.$g.appendChild(this.create("g")));var f=b;b=f.firstChild;var c=this.expect(b,"g",d,0,{"pointer-events":"none"});c.parentNode||f.appendChild(c);d.$g=c;b=c.firstChild;var e=d.mark.$hasHandlers?[]:null;b=this.eachLineAreaSegment(b,d,function(h,i,j,k){var l=this.areaSegmentPaths(i,j,k),n=l.top,p=l.bottom;e&&e.push(l);return this.eachLineAreaSegment(h,i,{breakOnKeyChange:true,from:j,to:k},function(m,o,q,s){var t=o[q],u=t.fillStyle,r=t.strokeStyle;this.addFillStyleDefinition(o,
u);this.addFillStyleDefinition(o,r);if(q===s)return this.lineAreaDotAlone(m,o,q);s=this.areaJoinPaths(n,p,q-q,s-q-1);var w=r.opacity;u={"shape-rendering":t.antialias?null:"crispEdges","pointer-events":"none",cursor:t.cursor,d:s,fill:u.color,"fill-opacity":u.opacity||null,stroke:r.color,"stroke-opacity":w||null,"stroke-width":w?t.lineWidth/this.scale:null,"stroke-linecap":t.lineCap,"stroke-linejoin":t.lineJoin,"stroke-miterlimit":t.strokeMiterLimit,"stroke-dasharray":w?this.parseDasharray(t):null};
m=this.expect(m,"path",o,q,u,t.css);return this.append(m,o,q)})});this.removeSiblings(b);var g;if(e){b=c.nextSibling;g=this.expect(b,"g",d,0);g.parentNode||f.appendChild(g);d.$g=g;b=g.firstChild;e.forEach(function(h){var i=h.from,j=h.top,k=h.bottom,l=j.length,n={"shape-rendering":"crispEdges",fill:"rgb(127,127,127)","fill-opacity":0.005,stroke:null};j.forEach(function(p,m){var o=i+m,q=d[o],s=q.events;if(s&&s!=="none"){m=k[l-m-1];var t=Object.create(n);t["pointer-events"]=s;t.cursor=q.cursor;t.d=p.join("")+
"L"+m[0].substr(1)+m[1]+"Z";b=this.expect(b,"path",d,o,t);b=this.append(b,d,o)}},this)},this);this.removeSiblings(b)}d.$g=f;return(g||c).nextSibling};pv.SvgScene.areaSegmentPaths=function(b,d,f){return this.areaSegmentCurvePaths(b,d,f)||this.areaSegmentStraightPaths(b,d,f)};
pv.SvgScene.areaSegmentCurvePaths=function(b,d,f){var c=f-d+1,e=b[d],g=e.interpolate==="basis",h=!g&&e.interpolate==="cardinal";if(g||h||e.interpolate=="monotone"){for(var i=[],j=[],k=0;k<c;k++){var l=b[f-k];i.push(b[d+k]);j.push({left:l.left+l.width,top:l.top+l.height})}if(g){b=this.curveBasisSegments(i);e=this.curveBasisSegments(j)}else if(h){b=this.curveCardinalSegments(i,e.tension);e=this.curveCardinalSegments(j,e.tension)}else{b=this.curveMonotoneSegments(i);e=this.curveMonotoneSegments(j)}if(b||
b.length)return{from:d,top:b,bottom:e}}};pv.SvgScene.areaSegmentStraightPaths=function(b,d,f){for(var c=[],e=[],g=f,h=d;d<g;d++,f--){var i=b[d],j=b[f],k=["M"+i.left+","+i.top];j=["M"+(j.left+j.width)+","+(j.top+j.height)];var l=b[d+1],n=b[f-1];switch(i.interpolate){case "step-before":k.push("V"+l.top+"H"+l.left);break;case "step-after":k.push("H"+l.left+"V"+l.top);break;default:k.push("L"+l.left+","+l.top)}j.push("L"+(n.left+n.width)+","+(n.top+n.height));c.push(k);e.push(j)}return{from:h,top:c,bottom:e}};
pv.SvgScene.areaJoinPaths=function(b,d,f,c){for(var e="",g="",h=f,i=b.length-1-c;h<=c;h++,i++){var j=b[h],k=d[i];if(h===f){j=j.join("");k="L"+k[0].substr(1)+k[1]}else{j=j[1];k=k[1]}e+=j;g+=k}return e+g+"Z"};
pv.SvgScene.areaSegmentedFull=function(b,d){var f=d.length,c,e,g=this.areaSegmentCurvePaths(d,0,f-1);if(g){c=g.top;e=g.bottom}for(g=0;g<f-1;g++){var h=d[g],i=d[g+1];if(h.visible&&i.visible){var j=h.fillStyle,k=h.strokeStyle;if(j.opacity||k.opacity){if(c){i=c[g].join("");var l="L"+e[f-g-2].join("").substr(1);i=i+l+"Z"}else{l=h;var n=i;switch(h.interpolate){case "step-before":l=i;break;case "step-after":n=h;break}i="M"+h.left+","+l.top+"L"+i.left+","+n.top+"L"+(i.left+i.width)+","+(n.top+n.height)+
"L"+(h.left+h.width)+","+(l.top+l.height)+"Z"}b=this.expect(b,"path",d,g,{"shape-rendering":h.antialias?null:"crispEdges","pointer-events":h.events,cursor:h.cursor,d:i,fill:j.color,"fill-opacity":j.opacity||null,stroke:k.color,"stroke-opacity":k.opacity||null,"stroke-width":k.opacity?h.lineWidth/this.scale:null});h.svg&&this.setAttributes(b,h.svg);h.css&&this.setStyle(b,h.css);b=this.append(b,d,g)}}}return b};
pv.SvgScene.areaPathStraight=function(b,d,f,c){for(var e=[],g=[],h=f;d<=h;d++,f--){var i=b[d],j=b[f];i=i.left+","+i.top;j=j.left+j.width+","+(j.top+j.height);if(d<h){var k=b[d+1],l=b[f-1];switch(c.interpolate){case "step-before":i+="V"+k.top;j+="H"+(l.left+l.width);break;case "step-after":i+="H"+k.left;j+="V"+(l.top+l.height);break}}e.push(i);g.push(j)}return e.concat(g).join("L")};
pv.SvgScene.areaPathCurve=function(b,d,f,c){for(var e=[],g=[],h=f;d<=h;d++,f--){var i=b[f];e.push(b[d]);g.push({left:i.left+i.width,top:i.top+i.height})}switch(c.interpolate){case "basis":b=this.curveBasis(e);c=this.curveBasis(g);break;case "cardinal":b=this.curveCardinal(e,c.tension);c=this.curveCardinal(g,c.tension);break;default:b=this.curveMonotone(e);c=this.curveMonotone(g)}return e[0].left+","+e[0].top+b+"L"+g[0].left+","+g[0].top+c};pv.SvgScene.minBarWidth=1;pv.SvgScene.minBarHeight=1;
pv.SvgScene.minBarLineWidth=0.2;
pv.SvgScene.bar=function(b){for(var d=b.$g.firstChild,f=0;f<b.length;f++){var c=b[f];if(!(!c.visible||Math.abs(c.width)<=1.0E-10||Math.abs(c.height)<=1.0E-10)){if(c.width<this.minBarWidth)c.width=this.minBarWidth;if(c.height<this.minBarHeight)c.height=this.minBarHeight;var e=c.fillStyle,g=c.strokeStyle;if(e.opacity||g.opacity){this.addFillStyleDefinition(b,e);this.addFillStyleDefinition(b,g);var h;if(g.opacity){h=c.lineWidth;h=h<1.0E-10?0:Math.max(this.minBarLineWidth,h/this.scale)}else h=null;d=
this.expect(d,"rect",b,f,{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,x:c.left,y:c.top,width:Math.max(1.0E-10,c.width),height:Math.max(1.0E-10,c.height),fill:e.color,"fill-opacity":e.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":h,"stroke-linecap":c.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(c):null});c.svg&&this.setAttributes(d,c.svg);c.css&&this.setStyle(d,c.css);d=this.append(d,b,f)}}}return d};
pv.SvgScene.dot=function(b){for(var d=b.$g.firstChild,f=0,c=b.length;f<c;f++){var e=b[f];if(e.visible){var g=e.fillStyle,h=g.opacity,i=e.strokeStyle,j=i.opacity;if(h||j){this.addFillStyleDefinition(b,g);this.addFillStyleDefinition(b,i);g={"shape-rendering":e.antialias?null:"crispEdges","pointer-events":e.events,cursor:e.cursor,fill:g.color,"fill-opacity":h||null,stroke:i.color,"stroke-opacity":j||null,"stroke-width":j?e.lineWidth/this.scale:null,"stroke-linecap":e.lineCap,"stroke-dasharray":j?this.parseDasharray(e):
null};h=e.shape||"circle";i=e.aspectRatio;j=e.shapeAngle;var k;if(h==="circle")if(i===1){g.cx=e.left;g.cy=e.top;g.r=e.shapeRadius}else{h="ellipse";g.cx=0;g.cy=0;k="translate("+e.left+","+e.top+") ";if(j)k+="rotate("+pv.degrees(j)+") ";g.rx=e._width/2;g.ry=e._height/2}else{g.d=this.renderSymbol(h,e);h="path";k="translate("+e.left+","+e.top+") ";if(j)k+="rotate("+pv.degrees(j)+") ";if(i!==1){j=1/Math.sqrt(i);k+="scale("+i*j+","+j+")"}}if(k)g.transform=k;d=this.expect(d,h,b,f,g);e.svg&&this.setAttributes(d,
e.svg);e.css&&this.setStyle(d,e.css);d=this.append(d,b,f)}}}return d};
(function(b){var d={};b.registerSymbol=function(c,e){d[c]=e;return b};b.renderSymbol=function(c,e){return d[c].call(b,e,c)};var f=2/Math.sqrt(3);b.registerSymbol("cross",function(c){c=c.shapeRadius;var e=-c;return"M"+e+","+e+"L"+c+","+c+"M"+c+","+e+"L"+e+","+c}).registerSymbol("triangle",function(c){c=c.shapeRadius;var e=c*f,g=-c;return"M0,"+c+"L"+e+","+g+" "+-e+","+g+"Z"}).registerSymbol("diamond",function(c){c=c.shapeRadius*Math.SQRT2;var e=-c;return"M0,"+e+"L"+c+",0 0,"+c+" "+e+",0Z"}).registerSymbol("square",
function(c){c=c.shapeRadius;var e=-c;return"M"+e+","+e+"L"+c+","+e+" "+c+","+c+" "+e+","+c+"Z"}).registerSymbol("tick",function(c){return"M0,0L0,"+-c.shapeSize}).registerSymbol("bar",function(c){c=c.shapeSize/2;return"M0,"+c+"L0,"+-c})})(pv.SvgScene);
pv.SvgScene.image=function(b){for(var d=b.$g.firstChild,f=0;f<b.length;f++){var c=b[f];if(c.visible){d=this.fill(d,b,f);if(c.image){d=this.expect(d,"foreignObject",b,f,{cursor:c.cursor,x:c.left,y:c.top,width:c.width,height:c.height});c.svg&&this.setAttributes(d,c.svg);c.css&&this.setStyle(d,c.css);var e=d.firstChild||d.appendChild(document.createElementNS(this.xhtml,"canvas"));e.$scene={scenes:b,index:f};e.style.width=c.width;e.style.height=c.height;e.width=c.imageWidth;e.height=c.imageHeight;e.getContext("2d").putImageData(c.image,
0,0)}else{d=this.expect(d,"image",b,f,{preserveAspectRatio:"none",cursor:c.cursor,x:c.left,y:c.top,width:c.width,height:c.height});c.svg&&this.setAttributes(d,c.svg);c.css&&this.setStyle(d,c.css);d.setAttributeNS(this.xlink,"xlink:href",c.url)}d=this.append(d,b,f);d=this.stroke(d,b,f)}}return d};
pv.SvgScene.label=function(b){for(var d=b.$g.firstChild,f=0;f<b.length;f++){var c=b[f];if(c.visible){var e=c.textStyle;if(e.opacity&&c.text){var g=0,h=0,i=0,j="start";switch(c.textBaseline){case "middle":if(pv.renderer()=="svgweb")h=3;else i=".35em";break;case "top":if(pv.renderer()=="svgweb")h=9+c.textMargin;else{i=".71em";h=c.textMargin}break;case "bottom":h="-"+c.textMargin;break}switch(c.textAlign){case "right":j="end";g="-"+c.textMargin;break;case "center":j="middle";break;case "left":g=c.textMargin;
break}d=this.expect(d,"text",b,f,{"pointer-events":c.events,cursor:c.cursor,x:g,y:h,dy:i,transform:"translate("+c.left+","+c.top+")"+(c.textAngle?" rotate("+180*c.textAngle/Math.PI+")":"")+(this.scale!=1?" scale("+1/this.scale+")":""),fill:e.color,"fill-opacity":e.opacity||null,"text-anchor":j},{font:c.font,"text-shadow":c.textShadow,"text-decoration":c.textDecoration});c.svg&&this.setAttributes(d,c.svg);c.css&&this.setStyle(d,c.css);if(d.firstChild)d.firstChild.nodeValue=c.text;else pv.renderer()==
"svgweb"?d.appendChild(document.createTextNode(c.text,true)):d.appendChild(document.createTextNode(c.text));d=this.append(d,b,f)}}}return d};pv.SvgScene.line=function(b){var d=b.$g.firstChild,f=b.length;if(!f)return d;var c=b[0];if(c.segmented==="smart")return this.lineSegmentedSmart(d,b);if(f<2)return d;if(c.segmented)return this.lineSegmentedFull(d,b);return this.lineFixed(d,b)};
pv.SvgScene.lineFixed=function(b,d){var f=d.length;if(f===1)return this.lineAreaDotAlone(b,d,0);var c=d[0];if(!c.visible)return b;var e=c.fillStyle,g=c.strokeStyle;if(!e.opacity&&!g.opacity)return b;this.addFillStyleDefinition(d,e);this.addFillStyleDefinition(d,g);var h="M"+c.left+","+c.top,i=f>2;if(i)switch(c.interpolate){case "basis":h+=this.curveBasis(d);break;case "cardinal":h+=this.curveCardinal(d,c.tension);break;case "monotone":h+=this.curveMonotone(d);break;default:i=false}if(!i)for(i=1;i<
f;i++)h+=this.lineSegmentPath(d[i-1],d[i]);f=g.opacity;e={"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,d:h,fill:e.color,"fill-opacity":e.opacity||null,stroke:g.color,"stroke-opacity":f||null,"stroke-width":f?c.lineWidth/this.scale:null,"stroke-linecap":c.lineCap,"stroke-linejoin":c.lineJoin,"stroke-miterlimit":c.strokeMiterLimit,"stroke-dasharray":f?this.parseDasharray(c):null};b=this.expect(b,"path",d,0,e,c.css);c.svg&&this.setAttributes(b,c.svg);return this.append(b,
d,0)};
pv.SvgScene.lineSegmentedSmart=function(b,d){b||(b=d.$g.appendChild(this.create("g")));var f=b;b=f.firstChild;var c=this.expect(b,"g",d,0,{"pointer-events":"none"});c.parentNode||f.appendChild(c);d.$g=c;b=c.firstChild;var e=d.mark.$hasHandlers?[]:null;b=this.eachLineAreaSegment(b,d,function(h,i,j,k){var l=this.lineSegmentPaths(i,j,k);e&&e.push({from:j,paths:l});return this.eachLineAreaSegment(h,i,{breakOnKeyChange:true,from:j,to:k},function(n,p,m,o){var q=p[m],s=q.fillStyle;this.addFillStyleDefinition(p,s);
var t=q.strokeStyle;this.addFillStyleDefinition(p,t);if(m===o)return this.lineAreaDotAlone(n,p,m);o=this.lineJoinPaths(l,m-m,o-m-1);var u=t.opacity;s={"shape-rendering":q.antialias?null:"crispEdges","pointer-events":"none",cursor:q.cursor,d:o,fill:s.color,"fill-opacity":s.opacity||null,stroke:t.color,"stroke-opacity":u||null,"stroke-width":u?q.lineWidth/this.scale:null,"stroke-linecap":q.lineCap,"stroke-linejoin":q.lineJoin,"stroke-miterlimit":q.strokeMiterLimit,"stroke-dasharray":u?this.parseDasharray(q):
null};n=this.expect(n,"path",p,m,s,q.css);return this.append(n,p,m)})});this.removeSiblings(b);var g;if(e){b=c.nextSibling;g=this.expect(b,"g",d,0);g.parentNode||f.appendChild(g);d.$g=g;b=g.firstChild;e.forEach(function(h){var i=h.from,j={"shape-rendering":"crispEdges",fill:"rgb(127,127,127)","fill-opacity":0.005,stroke:"rgb(127,127,127)","stroke-opacity":0.005,"stroke-width":10,"stroke-dasharray":null};h.paths.forEach(function(k,l){l=i+l;var n=d[l],p=n.events;if(p&&p!=="none"){var m=Object.create(j);
m["pointer-events"]=p;m.cursor=n.cursor;m.d=k.join("");b=this.expect(b,"path",d,l,m);b=this.append(b,d,l)}},this)},this);this.removeSiblings(b)}d.$g=f;return(g||c).nextSibling};
pv.SvgScene.lineSegmentedFull=function(b,d){var f=d[0],c;switch(f.interpolate){case "basis":c=this.curveBasisSegments(d);break;case "cardinal":c=this.curveCardinalSegments(d,f.tension);break;case "monotone":c=this.curveMonotoneSegments(d);break}f=0;for(var e=d.length-1;f<e;f++){var g=d[f],h=d[f+1];if(g.visible&&h.visible){var i=g.strokeStyle,j=pv.FillStyle.transparent;if(i.opacity){if(g.interpolate=="linear"&&g.lineJoin=="miter"){j=i;i=pv.FillStyle.transparent;h=this.pathJoin(d[f-1],g,h,d[f+2])}else h=
c?c[f].join(""):"M"+g.left+","+g.top+this.lineSegmentPath(g,h);b=this.expect(b,"path",d,f,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":g.events,cursor:g.cursor,d:h,fill:j.color,"fill-opacity":j.opacity||null,stroke:i.color,"stroke-opacity":i.opacity||null,"stroke-width":i.opacity?g.lineWidth/this.scale:null,"stroke-linejoin":g.lineJoin});g.svg&&this.setAttributes(b,g.svg);g.css&&this.setStyle(b,g.css);b=this.append(b,d,f)}}}return b};
pv.SvgScene.lineSegmentPath=function(b,d){var f=1;switch(b.interpolate){case "polar-reverse":f=0;case "polar":var c=d.left-b.left,e=d.top-b.top;b=1-b.eccentricity;c=Math.sqrt(c*c+e*e)/(2*b);if(b<=0||b>1)break;return"A"+c+","+c+" 0 0,"+f+" "+d.left+","+d.top;case "step-before":return"V"+d.top+"H"+d.left;case "step-after":return"H"+d.left+"V"+d.top}return"L"+d.left+","+d.top};
pv.SvgScene.lineSegmentPaths=function(b,d,f){var c=b[d],e;switch(c.interpolate){case "basis":e=this.curveBasisSegments(b,d,f);break;case "cardinal":e=this.curveCardinalSegments(b,c.tension,d,f);break;case "monotone":e=this.curveMonotoneSegments(b,d,f);break}if(!e||!e.length){e=[];for(d=d+1;d<=f;d++){c=b[d-1];e.push(["M"+c.left+","+c.top,this.lineSegmentPath(c,b[d])])}}return e};pv.strokeMiterLimit=4;
pv.SvgScene.pathJoin=function(b,d,f,c){var e=[],g,h=d.lineWidth/this.scale,i=pv.vector(d.left,d.top),j=pv.vector(f.left,f.top),k=j.minus(i),l=k.perp().norm(),n=l.times(h/2),p=i.plus(n),m=i.minus(n),o=j.plus(n);n=j.minus(n);if(!b||!b.visible)e.push(m,p);else{var q=pv.vector(b.left,b.top),s=i.minus(q),t=s.perp().norm().plus(l).norm();q=this.lineIntersect(i,t,p,k);t=this.lineIntersect(i,t,m,k);g=q.minus(t).length();b=(h+b.lineWidth/this.scale)/2;g=g/b;d=d.strokeMiterLimit||pv.strokeMiterLimit;if(g<=
d)e.push(t,q);else{d=k.times(-1);d=s.norm().plus(d.norm()).norm();i=i.plus(d.times(b/2));d.dot(l)>=0?e.push(t,i,p):e.push(m,i,q)}}if(!c||!c.visible)e.push(o,n);else{i=pv.vector(c.left,c.top).minus(j);m=i.perp().norm().plus(l).norm();p=this.lineIntersect(j,m,o,k);m=this.lineIntersect(j,m,n,k);g=p.minus(m).length();c=(c.lineWidth/this.scale+h)/2;g=g/c;d=f.strokeMiterLimit||pv.strokeMiterLimit;if(g<=d)e.push(p,m);else{f=i.times(-1);k=k.norm().plus(f.norm()).norm();j=j.plus(k.times(c/2));k.dot(l)>=0?
e.push(o,j,m):e.push(p,j,n)}}l=e.shift();return"M"+l.x+","+l.y+"L"+e.map(function(u){return u.x+","+u.y}).join(" ")};pv.SvgScene.lineIntersect=function(b,d,f,c){return b.plus(d.times(f.minus(b).dot(c.perp())/d.dot(c.perp())))};pv.SvgScene.lineJoinPaths=function(b,d,f){var c=b[d].join("");for(d=d+1;d<=f;d++)c+=b[d][1];return c};pv.SvgScene.lineAreaDotAlone=function(b){return b};
pv.SvgScene.eachLineAreaSegment=function(b,d,f,c){if(typeof f==="function"){c=f;f=null}var e=pv.get(f,"breakOnKeyChange",false),g=pv.get(f,"from")||0,h=pv.get(f,"to",d.length-1),i,j;if(e){i=[];j=[]}for(g=g;g<=h;){var k=d[g];if(this.isSceneVisible(k)){e&&this.lineAreaSceneKey(k,i);var l;for(k=g;;){var n=k+1;if(n>h){l=n;break}var p=d[n];if(!this.isSceneVisible(p)){l=n+1;break}k=n;if(e){this.lineAreaSceneKey(p,j);if(!this.equalSceneKeys(i,j)){l=k;break}}}b=c.call(this,b,d,g,k,f);g=l}else g++}return b};
pv.SvgScene.lineAreaSceneKey=function(b,d){d[0]=b.fillStyle.key;d[1]=b.strokeStyle.key;d[2]=b.lineWidth;d[3]=b.strokeDasharray||"none";d[4]=b.interpolate;return d};pv.SvgScene.isSceneVisible=function(b){return b.visible&&(b.fillStyle.opacity>0||b.strokeStyle.opacity>0)};pv.SvgScene.equalSceneKeys=function(b,d){for(var f=0,c=b.length;f<c;f++)if(b[f]!==d[f])return false;return true};
pv.SvgScene.panel=function(b){for(var d=b.$g,f=d&&d.firstChild,c=false,e=0;e<b.length;e++){var g=b[e];if(g.visible){if(!b.parent){if(pv.renderer()!=="batik")g.canvas.style.display="inline-block";if(d&&d.parentNode!=g.canvas)f=(d=g.canvas.firstChild)&&d.firstChild;if(!d){d=this.create(pv.renderer()!=="batik"?"svg":"g");d.setAttribute("font-size","10px");d.setAttribute("font-family","sans-serif");d.setAttribute("fill","none");d.setAttribute("stroke","none");d.setAttribute("stroke-width",1.5);d.setAttribute("style",
"-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");if(typeof d.onselectstart!=="undefined"){d.setAttribute("unselectable","on");d.onselectstart=function(){return false}}if(pv.renderer()==="svgweb"){d.setAttribute("width",g.width+g.left+g.right);d.setAttribute("height",g.height+g.top+g.bottom);var h=document.createDocumentFragment(true);d.addEventListener("SVGLoad",function(){var m=this;(function(){if(c){c=
false;m.appendChild(h);for(var o=0;o<pv.Scene.events.length;o++)m.addEventListener(pv.Scene.events[o],pv.SvgScene.dispatch,false);b.$g=m;b.$g.__ready=true}else setTimeout(arguments.callee,10)})()},false);svgweb.appendChild(d,g.canvas);d=h}else{for(var i=0;i<this.events.length;i++)d.addEventListener(this.events[i],this.dispatch,false);d=g.canvas.appendChild(d);d.__ready=true}d.$defs=d.appendChild(this.create("defs"));f=null}if(f&&f.tagName==="defs")f=f.nextSibling;b.$g=d;if(d.__ready){d.setAttribute("width",
g.width+g.left+g.right);d.setAttribute("height",g.height+g.top+g.bottom)}}if(g.overflow==="hidden"){i=pv.id().toString(36);var j=this.expect(f,"g",b,e,{"clip-path":"url(#"+i+")"});j.parentNode||d.appendChild(j);b.$g=d=j;f=j.firstChild;f=this.expect(f,"clipPath",b,e,{id:i});i=f.firstChild||f.appendChild(this.create("rect"));i.setAttribute("x",g.left);i.setAttribute("y",g.top);i.setAttribute("width",g.width);i.setAttribute("height",g.height);f.parentNode||d.appendChild(f);f=f.nextSibling}f=this.fill(f,
b,e);i=this.scale;var k=g.transform,l=g.left+k.x,n=g.top+k.y;this.scale*=k.k;if(g.children.length){var p={transform:"translate("+l+","+n+")"+(k.k!=1?" scale("+k.k+")":"")};this.eachChild(b,e,function(m){m.$g=f=this.expect(f,"g",b,e,p);this.updateAll(m);f.parentNode||d.appendChild(f);f=f.nextSibling})}this.scale=i;f=this.stroke(f,b,e);if(g.overflow==="hidden"){b.$g=d=j.parentNode;f=j.nextSibling}}}c=true;return f};
pv.SvgScene.eachChild=function(b,d,f,c){if(b.mark.zOrderChildCount){b=b[d].children.slice(0);b.sort(function(e,g){var h=e.mark._zOrder-g.mark._zOrder;if(h===0)h=e.childIndex-g.childIndex;return h});b.forEach(f,c||this)}else b[d].children.forEach(f,c||this)};
pv.SvgScene.fill=function(b,d,f){var c=d[f],e=c.fillStyle;if(e.opacity||c.events=="all"){this.addFillStyleDefinition(d,e);b=this.expect(b,"rect",d,f,{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,x:c.left,y:c.top,width:c.width,height:c.height,fill:e.color,"fill-opacity":e.opacity,stroke:null});b=this.append(b,d,f)}return b};
pv.SvgScene.stroke=function(b,d,f){var c=d[f],e=c.strokeStyle;if(e.opacity||c.events=="all"){b=this.expect(b,"rect",d,f,{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events=="all"?"stroke":c.events,cursor:c.cursor,x:c.left,y:c.top,width:Math.max(1.0E-10,c.width),height:Math.max(1.0E-10,c.height),fill:null,stroke:e.color,"stroke-opacity":e.opacity,"stroke-width":c.lineWidth/this.scale,"stroke-linecap":c.lineCap,"stroke-dasharray":e.opacity?this.parseDasharray(c):null});b=this.append(b,
d,f)}return b};pv.SvgScene.minRuleLineWidth=1;
pv.SvgScene.rule=function(b){for(var d=b.$g.firstChild,f=0;f<b.length;f++){var c=b[f];if(c.visible){var e=c.strokeStyle;if(e.opacity){var g=c.lineWidth;g=g<1.0E-10?0:Math.max(this.minRuleLineWidth,g/this.scale);d=this.expect(d,"line",b,f,{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,x1:c.left,y1:c.top,x2:c.left+c.width,y2:c.top+c.height,stroke:e.color,"stroke-opacity":e.opacity,"stroke-width":g,"stroke-linecap":c.lineCap,"stroke-dasharray":e.opacity?this.parseDasharray(c):
null});c.svg&&this.setAttributes(d,c.svg);c.css&&this.setStyle(d,c.css);d=this.append(d,b,f)}}}return d};
pv.SvgScene.wedge=function(b){for(var d=b.$g.firstChild,f=0;f<b.length;f++){var c=b[f];if(c.visible){var e=c.fillStyle,g=c.strokeStyle;if(e.opacity||g.opacity){var h=c.innerRadius,i=c.outerRadius,j=Math.abs(c.angle);if(j>=2*Math.PI)h=h?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z";else{var k=Math.min(c.startAngle,c.endAngle),l=Math.max(c.startAngle,c.endAngle),
n=Math.cos(k),p=Math.cos(l);k=Math.sin(k);l=Math.sin(l);h=h?"M"+i*n+","+i*k+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*p+","+i*l+"L"+h*p+","+h*l+"A"+h+","+h+" 0 "+(j<Math.PI?"0":"1")+",0 "+h*n+","+h*k+"Z":"M"+i*n+","+i*k+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*p+","+i*l+"L0,0Z"}this.addFillStyleDefinition(b,e);this.addFillStyleDefinition(b,g);d=this.expect(d,"path",b,f,{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,transform:"translate("+c.left+
","+c.top+")",d:h,fill:e.color,"fill-rule":"evenodd","fill-opacity":e.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":g.opacity?c.lineWidth/this.scale:null,"stroke-linejoin":c.lineJoin,"stroke-miterlimit":c.strokeMiterLimit,"stroke-linecap":c.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(c):null});c.svg&&this.setAttributes(d,c.svg);c.css&&this.setStyle(d,c.css);d=this.append(d,b,f)}}}return d};
pv.Mark=function(){this.$properties=[];this.$propertiesMap={};this.$handlers={}};pv.Mark.prototype.properties={};pv.Mark.cast={};pv.Mark.prototype.property=function(b,d){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;pv.Mark.prototype.propertyMethod(b,false,pv.Mark.cast[b]=d);return this};
pv.Mark.prototype.localProperty=function(b,d){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;var f=pv.Mark.cast[b];if(d)pv.Mark.cast[b]=f=d;this.propertyMethod(b,false,f);return this};pv.Mark.prototype.def=function(b,d){this.propertyMethod(b,true);return this[b](arguments.length>1?d:null)};
pv.Mark.prototype.propertyMethod=function(b,d,f){f||(f=pv.Mark.cast[b]);this[b]=function(c,e){if(d&&this.scene){var g=this.scene.defs;if(arguments.length){g[b]={id:c==null?0:pv.id(),value:c!=null&&f?f(c):c};return this}return(g=g[b])?g.value:null}if(arguments.length){this.setPropertyValue(b,c,d,f,false,e);return this}if(g=pv.propertyEval){var h=this.binds,i=h.properties[b];if(i){h=h.net;var j=h[b];if(j==null)j=h[b]=0;(i.dependents||(i.dependents={}))[g.name]=true;(pv.propertyEvalDependencies||(pv.propertyEvalDependencies=
{}))[b]=true;if(j>=pv.propertyEvalNetIndex)pv.propertyEvalNetIndex=j+1}}return this.instance()[b]}};pv.Mark.funPropertyCaller=function(b,d){var f=pv.Mark.stack;return function(){var c=b.apply(this,f);return c!=null?d(c):c}};
pv.Mark.prototype.setPropertyValue=function(b,d,f,c,e,g){f=!f<<1|typeof d==="function";if(f&1&&c)d=pv.Mark.funPropertyCaller(d,c);else if(d!=null&&c)d=c(d);var h=this.$propertiesMap;c=this.$properties;d={name:b,id:pv.id(),value:d,type:f,tag:g};g=h[b];h[b]=d;if(g)for(b=0;b<c.length;b++)if(c[b]===g){c.splice(b,1);break}c.push(d);if(e&&g&&f===3){d.proto=g;d.root=g.root||g}return d};
pv.Mark.prototype.intercept=function(b,d,f){this.setPropertyValue(b,d,false,pv.get(f,"noCast")?null:pv.Mark.cast[b],true,pv.get(f,"tag"));return this};pv.Mark.prototype.propertyValue=function(b,d){var f=this.$propertiesMap[b];if(f)return f.value;if(d){if(this.proto){d=this.proto.propertyValueRecursive(b);if(d!==undefined)return d}return this.defaults.propertyValueRecursive(b)}};pv.Mark.prototype.propertyValueRecursive=function(b){var d=this.$propertiesMap[b];if(d)return d.value;if(this.proto)return this.proto.propertyValueRecursive(b)};
pv.Mark.stack=[];pv.Mark.prototype.property("data").property("visible",Boolean).property("css",Object).property("svg",Object).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String);a=pv.Mark.prototype;a.childIndex=-1;a.index=-1;a.scale=1;a._zOrder=0;a.defaults=(new pv.Mark).data(function(b){return[b]}).visible(true).antialias(true).events("painted");
a.extend=function(b){this.proto=b;this.target=b.target;return this};a.add=function(b){return this.parent.add(b).extend(this)};a.zOrder=function(b){if(!arguments.length)return this._zOrder;b=+b||0;if(this._zOrder!==b){var d=this.parent;d&&this._zOrder!==0&&d.zOrderChildCount--;this._zOrder=b;d&&this._zOrder!==0&&d.zOrderChildCount++}return this};
a.anchor=function(b){b||(b="center");return(new pv.Anchor(this)).name(b).data(function(){return this.scene.target.map(function(d){return d.data})}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var d=this.scene.target[this.index],f=d.width||0;switch(this.name()){case "bottom":case "top":case "center":return d.left+f/2;case "left":return null}return d.left+f}).top(function(){var d=this.scene.target[this.index],
f=d.height||0;switch(this.name()){case "left":case "right":case "center":return d.top+f/2;case "top":return null}return d.top+f}).right(function(){var d=this.scene.target[this.index];return this.name()=="left"?d.right+(d.width||0):null}).bottom(function(){var d=this.scene.target[this.index];return this.name()=="top"?d.bottom+(d.height||0):null}).textAlign(function(){switch(this.name()){case "bottom":case "top":case "center":return"center";case "right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";
case "top":return"top"}return"bottom"})};a.anchorTarget=function(){return this.target};a.margin=function(b){return this.left(b).right(b).top(b).bottom(b)};a.instance=function(b){var d=this.scene||this.parent.instance(-1).children[this.childIndex];b=b==null||this.hasOwnProperty("index")?this.index:b;return d[b<0?d.length-1:b]};
a.instances=function(b){for(var d=this,f=[],c;!(c=d.scene);){b=b.parent;f.push({index:b.index,childIndex:d.childIndex});d=d.parent}for(;f.length;){b=f.pop();c=c[b.index].children[b.childIndex]}if(this.hasOwnProperty("index")){f=pv.extend(c[this.index]);f.right=f.top=f.left=f.bottom=0;return[f]}return c};a.first=function(){return this.scene[0]};a.last=function(){return this.scene[this.scene.length-1]};a.sibling=function(){return this.index==0?null:this.scene[this.index-1]};
a.cousin=function(){var b=this.parent;return(b=b&&b.sibling())&&b.children?b.children[this.childIndex][this.index]:null};a.render=function(){this.parent&&!this.root.scene?this.root.render():this.renderCore()};
a.renderCore=function(){function b(k,l,n){k.scale=n;if(l<i){var p=l>=c.length;p&&c.unshift(null);if(k.hasOwnProperty("index"))d(k,l,n,p);else{for(var m=0,o=k.scene.length;m<o;m++){k.index=m;d(k,l,n,p)}delete k.index}p&&c.shift()}else{k.build();pv.Scene.scale=n;pv.Scene.updateAll(k.scene)}delete k.scale}function d(k,l,n,p){var m=k.scene[k.index];if(m.visible){var o=k.children,q=m.children,s=g[l],t=o[s];t.scene||s++;for(k=0;k<s;k++)o[k].scene=q[k];if(p)c[0]=m.data;b(t,l+1,n*m.transform.k);for(k=0;k<
s;k++)o[k].scene=undefined}}for(var f=this.parent,c=pv.Mark.stack,e=c.length,g=[],h=this;h.parent;h=h.parent)g.unshift(h.childIndex);var i=g.length;for(this.bind();f&&!f.hasOwnProperty("index");)f=f.parent;try{this.context(f?f.scene:undefined,f?f.index:-1,function(){b(this.root,0,1)})}catch(j){if(c.length>e)c.length=e}};
a.bind=function(){function b(m){do for(var o=m.$properties,q=o.length;q--;){var s=o[q],t=s.name,u=d[t];if(u){if(u.type===3){t=u.root;u.root=s;if(t){if(!t.proto)t.proto=s}else u.proto=s}}else{d[t]=s;(g[t]||h)(s)}}while(m=m.proto)}var d={},f,c=[],e=[[],[],[],[]],g={data:function(m){f=m},visible:function(m){c.push(m)}},h=function(m){e[m.type].push(m)};g.id=g.visible;var i=e[0],j=e[1],k=e[2],l=e[3];b(this);b(this.defaults);j.reverse();l.reverse();l=this;var n=l.properties;do for(var p in n)p in d||k.push(d[p]=
{name:p,type:2,value:null});while(l=l.proto);if(i.length||j.length){i=i.concat(j);j=0;for(k=i.length;j<k;j++)this.propertyMethod(i[j].name,true)}else i=[];this.binds={properties:d,net:{},data:f,defs:i,required:c,optional:pv.blend(e)}};a.updateNet=function(b,d){function f(h,i){if(i>(g[h.name]||0)){g[h.name]=i;if(h=h.dependents){i++;for(var j in h)if(h.hasOwnProperty(j)){var k=e[j];k&&f(k,i)}}}}var c=this.binds,e=c.properties,g=c.net;f(b,d)};
a.build=function(){var b=this.scene,d=pv.Mark.stack;if(!b){b=this.scene=[];b.mark=this;b.type=this.type;b.childIndex=this.childIndex;if(this.parent){b.parent=this.parent.scene;b.parentIndex=this.parent.index}}if(this.target)b.target=this.target.instances(b);var f=this.binds.defs;if(f.length)for(var c=b.defs||(b.defs={}),e=0,g=f.length;e<g;e++){var h=f[e],i=c[h.name];if(!i||h.id>i.id)c[h.name]={id:0,value:h.type&1?h.value.apply(this,d):h.value}}f=this.evalProperty(this.binds.data);c=pv.Mark.prototype;
d.unshift(null);try{var j=b.length=f.length;for(e=0;e<j;e++){c.index=this.index=e;var k=b[e]||(b[e]={});k.data=d[0]=f[e];this.buildInstance(k)}}finally{c.index=-1;delete this.index;d.shift()}return this};a.buildProperties=function(b,d){var f=pv.Mark.stack,c=pv.propertyProto;try{for(var e=0,g=d.length;e<g;e++){var h=d[e];b[h.name]=_buildByPropType[h.type].call(this,h,f)}}finally{pv.propertyProto=c}};
var _buildByPropType=[function(b){return this.scene.defs[b.name].value},null,function(b){return b.value},function(b,d){pv.propertyProto=b.proto;return b.value.apply(this,d)}];_buildByPropType[1]=_buildByPropType[0];pv.Mark.prototype.delegate=function(b,d){var f=pv.propertyProto;if(f&&(!d||f.tag===d)){d=this.evalProperty(f);if(d!==undefined)return d}return b};pv.Mark.prototype.hasDelegate=function(b){var d=pv.propertyProto;return!!d&&(!b||d.tag===b)};var _buildByPropTypeSingle=_buildByPropType.slice();
_buildByPropTypeSingle[3]=function(b){var d=pv.propertyProto;try{pv.propertyProto=b.proto;return b.value.apply(this,pv.Mark.stack)}finally{pv.propertyProto=d}};a=pv.Mark.prototype;a.evalProperty=function(b){return _buildByPropTypeSingle[b.type].call(this,b)};
a.buildPropertiesWithDepTracking=function(b,d){var f=this.binds.net,c,e,g,h,i,j,k=pv.Mark.stack,l=d.length;try{for(;;){g=null;j={};var n=pv.propertyProto;try{for(var p=0;p<l;p++){var m=d[p],o=m.name;j[o]=true;if(!h||h[o]){var q;switch(m.type){case 3:pv.propertyEval=m;pv.propertyEvalNetIndex=c=f[o]||0;pv.propertyEvalDependencies=null;pv.propertyProto=m.proto;q=m.value.apply(this,k);e=pv.propertyEvalNetIndex;if(e>c){var s=pv.propertyEvalDependencies;for(var t in s)if(s.hasOwnProperty(t)&&!j.hasOwnProperty(o)){g||
(g={});g[t]=true}this.updateNet(m,e)}break;case 2:q=m.value;break;case 0:case 1:q=this.scene.defs[o].value;break}b[o]=q}}}finally{pv.propertyProto=n}if(!g)break;h=g;i=pv.numerate(d,function(u){return u.name});d.sort(function(u,r){var w=pv.naturalOrder(f[u.name]||0,f[r.name]||0);w||(w=pv.naturalOrder(i[u.name],i[r.name]));return w});i=null}}finally{pv.propertyEval=null;pv.propertyEvalNetIndex=null;pv.propertyEvalDependencies=null}};
a.buildInstance=function(b){this.buildProperties(b,this.binds.required);if(b.visible){this.index===0?this.buildPropertiesWithDepTracking(b,this.binds.optional):this.buildProperties(b,this.binds.optional);this.buildImplied(b)}};
a.buildImplied=function(b){var d=b.left,f=b.right,c=b.top,e=b.bottom,g=this.properties,h=g.width?b.width:0,i=g.height?b.height:0,j,k;if(h==null||f==null||d==null){j=this.parent?this.parent.instance():null;k=true;var l=j?j.width:h+d+f;if(h==null)h=l-(f=f||0)-(d=d||0);else if(f==null)if(d==null)d=f=(l-h)/2;else f=l-h-d;else d=l-h-f}if(i==null||e==null||c==null){k||(j=this.parent?this.parent.instance():null);j=j?j.height:i+c+e;if(i==null)i=j-(c=c||0)-(e=e||0);else if(e==null)e=c==null?(c=(j-i)/2):j-
i-c;else c=j-i-e}b.left=d;b.right=f;b.top=c;b.bottom=e;if(g.width)b.width=h;if(g.height)b.height=i;if(g.textStyle&&!b.textStyle)b.textStyle=pv.FillStyle.transparent;if(g.fillStyle&&!b.fillStyle)b.fillStyle=pv.FillStyle.transparent;if(g.strokeStyle&&!b.strokeStyle)b.strokeStyle=pv.FillStyle.transparent};
a.mouse=function(){var b=this.root.canvas(),d=pv.event,f=d.pageX;d=d.pageY;var c=pv.elementOffset(b);if(c){b=pv.cssStyle(b);f-=c.left+parseFloat(b("paddingLeft")||0);d-=c.top+parseFloat(b("paddingTop")||0)}b=pv.Transform.identity;var e=this.properties.transform?this:this.parent;c=[];do c.push(e);while(e=e.parent);for(;e=c.pop();){e=e.instance();b=b.translate(e.left,e.top).times(e.transform)}b=b.invert();return pv.vector(f*b.k+b.x,d*b.k+b.y)};
a.event=function(b,d){d=pv.functor(d);var f=this.$handlers[b];if(f)if(f instanceof Array)f.push(d);else f=[f,d];else f=d;this.$hasHandlers=true;this.$handlers[b]=f;return this};
a.context=function(b,d,f){function c(n,p){pv.Mark.scene=n;g.index=p;if(n){var m=n.mark,o=m,q=[];do{q.push(o);h.push(n[p].data);o.index=p;o.scene=n;if(o=o.parent){p=n.parentIndex;n=n.parent}}while(o);n=1;for(p=q.length-1;p>0;p--){o=q[p];o.scale=n;n*=o.scene[o.index].transform.k}m.scale=n;q=m.children;var s;if(q&&(s=q.length)>0){o=m.scene[m.index];n*=o.transform.k;m=o.children;for(p=0;p<s;p++){o=q[p];o.scene=m[p];o.scale=n}}}}function e(n){if(n){var p=n.mark,m=p.children;if(m)for(var o=0,q=m.length;o<
q;o++){n=m[o];n.scene=undefined;n.scale=1}n=p;do{h.pop();delete n.index;if(p=n.parent){n.scene=undefined;n.scale=1}}while(n=p)}}var g=pv.Mark.prototype,h=pv.Mark.stack,i=pv.Mark.scene,j=g.index;if(b&&b===i&&d===j)try{f.apply(this,h)}catch(k){pv.error(k);throw k;}finally{pv.Mark.scene=i;g.index=j}else{e(i,j);c(b,d);try{f.apply(this,h)}catch(l){pv.error(l);throw l;}finally{e(b,d);c(i,j)}}};
pv.Mark.getEventHandler=function(b,d,f,c){var e=d.mark.$handlers[b];if(e)return[e,b,d,f,c];if(f=d.parent)return this.getEventHandler(b,f,d.parentIndex,c)};pv.Mark.dispatch=function(b,d,f,c){var e=d.mark.root;if(e.animatingCount)return true;var g;if(e=e.$interceptors&&e.$interceptors[b])for(var h=0,i=e.length;h<i;h++){if(g=e[h](b,c))break;if(g===false)return true}if(!g){g=this.getEventHandler(b,d,f,c);if(!g)return false}return this.handle.apply(this,g)};
pv.Mark.handle=function(b,d,f,c,e){var g=f.mark;g.context(f,c,function(){var h=pv.Mark.stack.concat(e);if(b instanceof Array){var i;b.forEach(function(j){if((j=j.apply(g,h))&&j.render)(i||(i=[])).push(j)});i&&i.forEach(function(j){j.render()})}else(g=b.apply(g,h))&&g.render&&g.render()});return true};a=pv.Mark.prototype;a.addEventInterceptor=function(b,d,f){var c=this.root;if(c){c=c.$interceptors||(c.$interceptors={});b=c[b]||(c[b]=[]);f?b.unshift(d):b.push(d)}};
a.eachInstance=function(b,d){function f(h,i,j){var k=h.length;if(k>0){var l;i===g||(l=e[i]);for(var n=0;n<k;n++){var p=h[n];if(p.visible)if(i===g)b.call(d,h,n,j);else{var m=p.children[l];if(m){p=j.times(p.transform).translate(p.left,p.top);f(m,i+1,p)}}}}}for(var c=this,e=[];c.parent;){e.unshift(c.childIndex);c=c.parent}if(c=c.scene){var g=e.length;f(c,0,pv.Transform.identity)}};
a.toScreenTransform=function(){var b=pv.Transform.identity;if(this instanceof pv.Panel)b=b.translate(this.left(),this.top()).times(this.transform());var d=this.parent;if(d){do b=b.translate(d.left(),d.top()).times(d.transform());while(d=d.parent)}return b};a.transition=function(){return new pv.Transition(this)};a.on=function(b){return this["$"+b]=new pv.Transient(this)};
a.getShape=function(b,d,f){var c=b[d];if(!c.visible)return null;if(f==null)f=0;var e="_shape_inset_"+f;return c[e]||(c[e]=this.getShapeCore(b,d,f))};a.getShapeCore=function(b,d,f){var c=b[d];b=c.left;d=c.top;var e=c.width;c=c.height;if(f>0&&f<=1){var g=f*e;f=f*c;b+=g;d+=f;e-=g*2;c-=f*2}return new pv.Shape.Rect(b,d,e,c)};pv.Anchor=function(b){pv.Mark.call(this);this.target=b;this.parent=b.parent};pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String);
pv.Anchor.prototype.extend=function(b){this.proto=b;return this};pv.Area=function(){pv.Mark.call(this)};pv.Area.castSegmented=function(b){if(!b)return"";switch(b){case "smart":case "full":break;default:b="full"}return b};
pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("tension",Number);pv.Area.prototype.type="area";pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
pv.Area.prototype.buildImplied=function(b){if(b.height==null)b.height=0;if(b.width==null)b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Area.fixed={lineWidth:1,lineJoin:1,strokeMiterLimit:1,lineCap:1,strokeStyle:1,strokeDasharray:1,fillStyle:1,segmented:1,interpolate:1,tension:1};
pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);var b=this.binds,d=b.required;b=b.optional;for(var f=0,c=b.length;f<c;f++){var e=b[f];e.fixed=e.name in pv.Area.fixed;if(e.name=="segmented"){d.push(e);b.splice(f,1);f--;c--}}this.binds.$required=d;this.binds.$optional=b};
pv.Area.prototype.buildInstance=function(b){var d=this.binds;if(this.index){var f=d.fixed;if(!f){f=d.fixed=[];function c(i){return!i.fixed||(f.push(i),false)}d.required=d.required.filter(c);if(!this.scene[0].segmented)d.optional=d.optional.filter(c)}if(d=f.length)for(var e=this.scene[0],g=0;g<d;g++){var h=f[g].name;b[h]=e[h]}}else{d.required=d.$required;d.optional=d.$optional;d.fixed=null}pv.Mark.prototype.buildInstance.call(this,b)};
pv.Area.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})};
pv.Area.prototype.getShapeCore=function(b,d){var f=b[d],c=f.width||0,e=f.height||0,g=f.left;f=f.top;var h=d+1<b.length?b[d+1]:null;if(!h||!h.visible)return new pv.Shape.Line(g,f,g+c,f+e);b=h.left;d=h.top;var i=h.height||0;h=h.width||0;return new pv.Shape.Polygon([new pv.Vector(g,f),new pv.Vector(b,d),new pv.Vector(b+h,d+i),new pv.Vector(g+c,f+e)])};pv.Bar=function(){pv.Mark.call(this)};
pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Bar.prototype.type="bar";pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).lineCap("butt").strokeDasharray("none");pv.Dot=function(){pv.Mark.call(this)};
pv.Dot.prototype=pv.extend(pv.Mark).property("shape",String).property("shapeAngle",Number).property("shapeRadius",Number).property("shapeSize",Number).property("aspectRatio",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);a=pv.Dot.prototype;a.type="dot";a.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).shape("circle").aspectRatio(1).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).lineCap("butt").strokeDasharray("none");
a.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).left(function(){var d=this.scene.target[this.index];switch(this.name()){case "bottom":case "top":case "center":return d.left;case "left":return null}return d.left+d._width/2}).right(function(){var d=this.scene.target[this.index];return this.name()=="left"?d.right+d._width/2:null}).top(function(){var d=this.scene.target[this.index];switch(this.name()){case "left":case "right":case "center":return d.top;case "top":return null}return d.top+
d._height/2}).bottom(function(){var d=this.scene.target[this.index];return this.name()=="top"?d.bottom+d._height/2:null}).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "bottom":return"top"}return"bottom"})};
a.buildImplied=function(b){var d=b.shapeRadius,f=b.shapeSize,c=b.aspectRatio||1;if(d==null)if(f==null){b.shapeSize=20.25;d=b.shapeRadius=4.5}else d=b.shapeRadius=Math.sqrt(f);else if(f==null)b.shapeSize=d*d;if(c===1||c<0)d=c=2*d;else{d=2*d/Math.sqrt(c);c=c*d}b._height=d;b._width=c;pv.Mark.prototype.buildImplied.call(this,b)};a.width=function(){return this.instance()._width};a.height=function(){return this.instance()._height};
a.getShapeCore=function(b,d){b=b[d];d=b._width;var f=b._height,c=b.left,e=b.top;switch(b.shape){case "diamond":d*=Math.SQRT2;f*=Math.SQRT2;case "square":case "cross":return new pv.Shape.Rect(c-f/2,e-d/2,f,d)}return new pv.Shape.Circle(c,e,b.shapeRadius)};pv.Label=function(){pv.Mark.call(this)};
pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String);pv.Label.prototype.type="label";pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3);
pv.Label.prototype.getShapeCore=function(b,d,f){b=b[d];var c=pv.Text.measure(b.text,b.font);d=b.left;var e=b.top,g=c.width;c=c.height;if(f>0&&f<=1){var h=f*g;f=f*c;d+=h;e+=f;g-=h*2;c-=f*2}return pv.Label.getPolygon(g,c,b.textAlign,b.textBaseline,b.textAngle,b.textMargin).apply(pv.Transform.identity.translate(d,e))};
pv.Label.getPolygon=function(b,d,f,c,e,g){var h,i;switch(c){case "middle":i=d/2;break;case "top":i=g+d;break;case "bottom":i=-g;break}switch(f){case "right":h=-g-b;break;case "center":h=-b/2;break;case "left":h=g;break}f=new pv.Vector(h,i);b=f.plus(b,0);c=b.plus(0,-d);d=f.plus(0,-d);if(e!==0){f=f.rotate(e);b=b.rotate(e);d=d.rotate(e);c=c.rotate(e)}return new pv.Shape.Polygon([f,b,c,d])};pv.Line=function(){pv.Mark.call(this)};
pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeStyle",pv.fillStyle).property("strokeDasharray",String).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("eccentricity",Number).property("tension",Number);a=pv.Line.prototype;a.type="line";a.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
a.bind=pv.Area.prototype.bind;a.buildInstance=pv.Area.prototype.buildInstance;a.anchor=function(b){return pv.Area.prototype.anchor.call(this,b).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center";case "right":return"left"}}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "top":return"bottom";case "bottom":return"top"}})};
a.getShapeCore=function(b,d){var f=b[d];b=d+1<b.length?b[d+1]:null;if(b==null||!b.visible)return new pv.Shape.Point(f.left,f.top);return new pv.Shape.Line(f.left,f.top,b.left,b.top)};pv.Rule=function(){pv.Mark.call(this)};pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);a=pv.Rule.prototype;a.type="rule";a.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(false).lineCap("butt").strokeDasharray("none");
a.anchor=pv.Line.prototype.anchor;a.buildImplied=function(b){var d=b.left,f=b.right;if(b.width!=null||d==null&&f==null||f!=null&&d!=null)b.height=0;else b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};a.getShapeCore=function(b,d){b=b[d];return new pv.Shape.Line(b.left,b.top,b.left+b.width,b.top+b.height)};pv.Panel=function(){pv.Bar.call(this);this.children=[];this.root=this;this.$dom=pv.$&&pv.$.s};
pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(b){return typeof b=="string"?document.getElementById(b):b});a=pv.Panel.prototype;a.type="panel";a.animatingCount=0;a.zOrderChildCount=0;a.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible");a.anchor=function(b){b=pv.Bar.prototype.anchor.call(this,b);b.parent=this;return b};
a.add=function(b){b=new b;b.parent=this;b.root=this.root;b.childIndex=this.children.length;this.children.push(b);return b};a.bind=function(){pv.Mark.prototype.bind.call(this);for(var b=this.children,d=0,f=b.length;d<f;d++)b[d].bind()};
a.buildInstance=function(b){pv.Bar.prototype.buildInstance.call(this,b);if(b.visible){var d=this.scale*b.transform.k;pv.Mark.prototype.index=-1;for(var f=this.children,c=b.children||(b.children=[]),e=0,g=f.length;e<g;e++){b=f[e];b.scene=c[e];b.scale=d;b.build()}for(e=g;e--;){b=f[e];c[e]=b.scene;delete b.scene;delete b.scale}c.length=g}};
a.buildImplied=function(b){if(!this.parent){var d=b.canvas;if(pv.renderer()==="batik")if(d){if(d.$panel!=this){pv.Panel.updateCreateId(d);for(d.$panel=this;d.lastChild;)d.removeChild(d.lastChild)}}else d=document.lastChild;else if(d){if(d.$panel!=this){pv.Panel.updateCreateId(d);for(d.$panel=this;d.lastChild;)d.removeChild(d.lastChild)}var f,c;if(b.width==null){c=pv.cssStyle(d);f=parseFloat(c("width")||0);b.width=f-b.left-b.right}if(b.height==null){c||pv.cssStyle(d);f=parseFloat(pv.cssStyle("height")||
0);b.height=f-b.top-b.bottom}}else{f=this.$canvas||(this.$canvas=[]);if(!(d=f[this.index])){d=f[this.index]=document.createElement(pv.renderer()=="svgweb"?"div":"span");if(this.$dom)this.$dom.parentNode.insertBefore(d,this.$dom);else{for(f=document.body;f.lastChild&&f.lastChild.tagName;)f=f.lastChild;if(f!=document.body)f=f.parentNode;f.appendChild(d)}}}b.canvas=d}if(!b.transform)b.transform=pv.Transform.identity;pv.Mark.prototype.buildImplied.call(this,b)};
pv.Panel.updateCreateId=function(b){b.$pvCreateId=(b.$pvCreateId||0)+1};pv.Image=function(){pv.Bar.call(this)};pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number);a=pv.Image.prototype;a.type="image";a.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null);a.image=function(b){this.$image=function(){var d=b.apply(this,arguments);return d==null?pv.Color.transparent:typeof d=="string"?pv.color(d):d};return this};
a.bind=function(){pv.Bar.prototype.bind.call(this);var b=this.binds,d=this;do b.image=d.$image;while(!b.image&&(d=d.proto))};
a.buildImplied=function(b){pv.Bar.prototype.buildImplied.call(this,b);if(b.visible){if(b.imageWidth==null)b.imageWidth=b.width;if(b.imageHeight==null)b.imageHeight=b.height;if(b.url==null&&this.binds.image){var d=this.$canvas||(this.$canvas=document.createElement("canvas")),f=d.getContext("2d"),c=b.imageWidth,e=b.imageHeight,g=pv.Mark.stack;d.width=c;d.height=e;b=(b.image=f.createImageData(c,e)).data;g.unshift(null,null);for(f=d=0;d<e;d++){g[1]=d;for(var h=0;h<c;h++){g[0]=h;var i=this.binds.image.apply(this,
g);b[f++]=i.r;b[f++]=i.g;b[f++]=i.b;b[f++]=255*i.a}}g.splice(0,2)}}};pv.Wedge=function(){pv.Mark.call(this)};
pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);a=pv.Wedge.prototype;a.type="wedge";
a.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var b=this.sibling();return b?b.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");a.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2};a.midAngle=function(){return(this.startAngle()+this.endAngle())/2};
a.anchor=function(b){function d(e){return e.innerRadius||e.angle<2*Math.PI}function f(e){return(e.innerRadius+e.outerRadius)/2}function c(e){return(e.startAngle+e.endAngle)/2}return pv.Mark.prototype.anchor.call(this,b).left(function(){var e=this.scene.target[this.index];if(d(e))switch(this.name()){case "outer":return e.left+e.outerRadius*Math.cos(c(e));case "inner":return e.left+e.innerRadius*Math.cos(c(e));case "start":return e.left+f(e)*Math.cos(e.startAngle);case "center":return e.left+f(e)*Math.cos(c(e));
case "end":return e.left+f(e)*Math.cos(e.endAngle)}return e.left}).top(function(){var e=this.scene.target[this.index];if(d(e))switch(this.name()){case "outer":return e.top+e.outerRadius*Math.sin(c(e));case "inner":return e.top+e.innerRadius*Math.sin(c(e));case "start":return e.top+f(e)*Math.sin(e.startAngle);case "center":return e.top+f(e)*Math.sin(c(e));case "end":return e.top+f(e)*Math.sin(e.endAngle)}return e.top}).textAlign(function(){var e=this.scene.target[this.index];if(d(e))switch(this.name()){case "outer":return pv.Wedge.upright(c(e))?
"right":"left";case "inner":return pv.Wedge.upright(c(e))?"left":"right"}return"center"}).textBaseline(function(){var e=this.scene.target[this.index];if(d(e))switch(this.name()){case "start":return pv.Wedge.upright(e.startAngle)?"top":"bottom";case "end":return pv.Wedge.upright(e.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var e=this.scene.target[this.index],g=0;if(d(e))switch(this.name()){case "center":case "inner":case "outer":g=c(e);break;case "start":g=e.startAngle;break;case "end":g=
e.endAngle;break}return pv.Wedge.upright(g)?g:g+Math.PI})};pv.Wedge.upright=function(b){b%=2*Math.PI;b=b<0?2*Math.PI+b:b;return b<Math.PI/2||b>=3*Math.PI/2};pv.Wedge.prototype.buildImplied=function(b){if(b.angle==null)b.angle=b.endAngle-b.startAngle;else if(b.endAngle==null)b.endAngle=b.startAngle+b.angle;pv.Mark.prototype.buildImplied.call(this,b)};pv.Wedge.prototype.getShapeCore=function(b,d){b=b[d];return new pv.Shape.Wedge(b.left,b.top,b.innerRadius,b.outerRadius,b.startAngle,b.angle)};
pv.Ease=function(){function b(o){return function(q){return 1-o(1-q)}}function d(o){return function(q){return 0.5*(q<0.5?o(2*q):2-o(2-2*q))}}function f(o){return function(q){return q<0?0:q>1?1:Math.pow(q,o)}}function c(o){return 1-Math.cos(o*Math.PI/2)}function e(o){return o?Math.pow(2,10*(o-1))-0.001:0}function g(o){return-(Math.sqrt(1-o*o)-1)}function h(o,q){var s;q||(q=0.45);if(!o||o<1){o=1;s=q/4}else s=q/(2*Math.PI)*Math.asin(1/o);return function(t){return t<=0||t>=1?t:-(o*Math.pow(2,10*--t)*Math.sin((t-
s)*2*Math.PI/q))}}function i(o){o||(o=1.70158);return function(q){return q*q*((o+1)*q-o)}}function j(o){return o<1/2.75?7.5625*o*o:o<2/2.75?7.5625*(o-=1.5/2.75)*o+0.75:o<2.5/2.75?7.5625*(o-=2.25/2.75)*o+0.9375:7.5625*(o-=2.625/2.75)*o+0.984375}var k=f(2),l=f(3),n=h(),p=i(),m={linear:pv.identity,"quad-in":k,"quad-out":b(k),"quad-in-out":d(k),"quad-out-in":d(b(k)),"cubic-in":l,"cubic-out":b(l),"cubic-in-out":d(l),"cubic-out-in":d(b(l)),"sin-in":c,"sin-out":b(c),"sin-in-out":d(c),"sin-out-in":d(b(c)),
"exp-in":e,"exp-out":b(e),"exp-in-out":d(e),"exp-out-in":d(b(e)),"circle-in":g,"circle-out":b(g),"circle-in-out":d(g),"circle-out-in":d(b(g)),"elastic-in":n,"elastic-out":b(n),"elastic-in-out":d(n),"elastic-out-in":d(b(n)),"back-in":p,"back-out":b(p),"back-in-out":d(p),"back-out-in":d(b(p)),"bounce-in":j,"bounce-out":b(j),"bounce-in-out":d(j),"bounce-out-in":d(b(j))};pv.ease=function(o){return m[o]};return{reverse:b,reflect:d,linear:function(){return pv.identity},sin:function(){return c},exp:function(){return e},
circle:function(){return g},elastic:h,back:i,bounce:j,poly:f}}();
pv.Transition=function(b){function d(q){for(var s={},t=0;t<q.length;t++){var u=q[t];if(u.id)s[u.id]=u}return s}function f(q,s,t,u){var r;if(s in m){var w=pv.Scale.interpolator(t[s],u[s]);r=function(v){t[s]=w(v)}}else r=function(v){if(v>0.5)t[s]=u[s]};r.next=q.head;q.head=r}function c(q,s,t){for(var u in s)u!="children"&&s[u]!=t[u]&&f(q,u,s,t);if(s.children)for(u=0;u<s.children.length;u++)e(q,s.children[u],t.children[u])}function e(q,s,t){for(var u=s.mark,r=d(s),w=d(t),v=0;v<s.length;v++){var z=s[v],
y=z.id?w[z.id]:t[v];z.index=v;if(z.visible){if(!(y&&y.visible)){var A=g(s,v,u.$exit,t);z.transition=y?2:(t.push(A),1);y=A}c(q,z,y)}}for(v=0;v<t.length;v++){y=t[v];z=y.id?r[y.id]:s[v];if(!(z&&z.visible)&&y.visible){A=g(t,v,u.$enter,s);if(z)s[z.index]=A;else s.push(A);c(q,A,y)}}}function g(q,s,t,u){var r=pv.extend(q[s]),w=q.mark,v=w.root.scene,z=(t||o).$properties,y;if(u.target&&(y=u.target[u.length])){q=pv.extend(q);q.target=pv.extend(u.target);q.target[s]=y}var A={};for(t=0;t<z.length;t++)A[z[t].name]=
1;z=w.binds.optional.filter(function(x){return!(x.name in A)}).concat(z);w.context(q,s,function(){this.buildProperties(r,z);this.buildImplied(r)});w.root.scene=v;return r}function h(q){for(var s=0,t=0;s<q.length;s++){var u=q[s];if(u.transition!=1){q[t++]=u;if(u.transition==2)u.visible=false;u.children&&u.children.forEach(h)}}q.length=t}function i(){b.root.animatingCount--;if(p){var q=p;p=null;q()}}var j=this,k=pv.ease("cubic-in-out"),l=250,n,p,m={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,
outerRadius:1,radius:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},o=new pv.Transient;j.ease=function(q){return arguments.length?(k=typeof q=="function"?q:pv.ease(q),j):k};j.duration=function(q){return arguments.length?(l=Number(q),j):l};j.start=function(q){p=q;b.root.animatingCount++;if(b.parent){i();throw new Error("Animated partial rendering is not supported.");}try{b.$transition&&b.$transition.stop();b.$transition=
j;var s=pv.Mark.prototype.index,t=b.scene,u;b.scene=null;b.bind();b.build();u=b.scene;b.scene=t;pv.Mark.prototype.index=s;var r=Date.now(),w={};e(w,t,u)}catch(v){i();throw v;}if(w.head)n=setInterval(function(){var z=Math.max(0,Math.min(1,(Date.now()-r)/l)),y=k(z),A=w.head;do A(y);while(A=A.next);if(z===1){h(b.scene);pv.Scene.updateAll(t);j.stop()}else pv.Scene.updateAll(t)},24);else i()};j.stop=function(){clearInterval(n);i()}};
pv.Transient=function(b){pv.Mark.call(this);this.fillStyle(null).strokeStyle(null).textStyle(null);this.on=function(d){return b.on(d)}};pv.Transient.prototype=pv.extend(pv.Mark);pv.simulation=function(b){return new pv.Simulation(b)};pv.Simulation=function(b){for(var d=0;d<b.length;d++)this.particle(b[d])};a=pv.Simulation.prototype;a.particle=function(b){b.next=this.particles;if(isNaN(b.px))b.px=b.x;if(isNaN(b.py))b.py=b.y;if(isNaN(b.fx))b.fx=0;if(isNaN(b.fy))b.fy=0;this.particles=b;return this};
a.force=function(b){b.next=this.forces;this.forces=b;return this};a.constraint=function(b){b.next=this.constraints;this.constraints=b;return this};a.stabilize=function(b){var d;arguments.length||(b=3);for(var f=0;f<b;f++){var c=new pv.Quadtree(this.particles);for(d=this.constraints;d;d=d.next)d.apply(this.particles,c)}for(d=this.particles;d;d=d.next){d.px=d.x;d.py=d.y}return this};
a.step=function(){var b;for(b=this.particles;b;b=b.next){var d=b.px,f=b.py;b.px=b.x;b.py=b.y;b.x+=b.vx=b.x-d+b.fx;b.y+=b.vy=b.y-f+b.fy}d=new pv.Quadtree(this.particles);for(b=this.constraints;b;b=b.next)b.apply(this.particles,d);for(b=this.particles;b;b=b.next)b.fx=b.fy=0;for(b=this.forces;b;b=b.next)b.apply(this.particles,d)};
pv.Quadtree=function(b){function d(k,l,n,p,m,o){if(!(isNaN(l.x)||isNaN(l.y)))if(k.leaf)if(k.p){if(!(Math.abs(k.p.x-l.x)+Math.abs(k.p.y-l.y)<0.01)){var q=k.p;k.p=null;f(k,q,n,p,m,o)}f(k,l,n,p,m,o)}else k.p=l;else f(k,l,n,p,m,o)}function f(k,l,n,p,m,o){var q=(n+m)*0.5,s=(p+o)*0.5,t=l.x>=q,u=l.y>=s;k.leaf=false;switch((u<<1)+t){case 0:k=k.c1||(k.c1=new pv.Quadtree.Node);break;case 1:k=k.c2||(k.c2=new pv.Quadtree.Node);break;case 2:k=k.c3||(k.c3=new pv.Quadtree.Node);break;case 3:k=k.c4||(k.c4=new pv.Quadtree.Node);
break}if(t)n=q;else m=q;if(u)p=s;else o=s;d(k,l,n,p,m,o)}var c,e=Number.POSITIVE_INFINITY,g=e,h=Number.NEGATIVE_INFINITY,i=h;for(c=b;c;c=c.next){if(c.x<e)e=c.x;if(c.y<g)g=c.y;if(c.x>h)h=c.x;if(c.y>i)i=c.y}c=h-e;var j=i-g;if(c>j)i=g+c;else h=e+j;this.xMin=e;this.yMin=g;this.xMax=h;this.yMax=i;this.root=new pv.Quadtree.Node;for(c=b;c;c=c.next)d(this.root,c,e,g,h,i)};pv.Quadtree.Node=function(){this.leaf=true;this.p=this.c4=this.c3=this.c2=this.c1=null};pv.Force={};
pv.Force.charge=function(b){function d(k){function l(m){d(m);k.cn+=m.cn;n+=m.cn*m.cx;p+=m.cn*m.cy}var n=0,p=0;k.cn=0;if(!k.leaf){k.c1&&l(k.c1);k.c2&&l(k.c2);k.c3&&l(k.c3);k.c4&&l(k.c4)}if(k.p){k.cn+=b;n+=b*k.p.x;p+=b*k.p.y}k.cx=n/k.cn;k.cy=p/k.cn}function f(k,l,n,p,m,o){var q=k.cx-l.x,s=k.cy-l.y,t=1/Math.sqrt(q*q+s*s);if(k.leaf&&k.p!=l||(m-n)*t<i){if(!(t<h)){if(t>e)t=e;k=k.cn*t*t*t;q=q*k;s=s*k;l.fx+=q;l.fy+=s}}else if(!k.leaf){var u=(n+m)*0.5,r=(p+o)*0.5;k.c1&&f(k.c1,l,n,p,u,r);k.c2&&f(k.c2,l,u,p,
m,r);k.c3&&f(k.c3,l,n,r,u,o);k.c4&&f(k.c4,l,u,r,m,o);if(!(t<h)){if(t>e)t=e;if(k.p&&k.p!=l){k=b*t*t*t;q=q*k;s=s*k;l.fx+=q;l.fy+=s}}}}var c=2,e=1/c,g=500,h=1/g,i=0.9,j={};arguments.length||(b=-40);j.constant=function(k){if(arguments.length){b=Number(k);return j}return b};j.domain=function(k,l){if(arguments.length){c=Number(k);e=1/c;g=Number(l);h=1/g;return j}return[c,g]};j.theta=function(k){if(arguments.length){i=Number(k);return j}return i};j.apply=function(k,l){d(l.root);for(k=k;k;k=k.next)f(l.root,
k,l.xMin,l.yMin,l.xMax,l.yMax)};return j};pv.Force.drag=function(b){var d={};arguments.length||(b=0.1);d.constant=function(f){if(arguments.length){b=f;return d}return b};d.apply=function(f){if(b)for(f=f;f;f=f.next){f.fx-=b*f.vx;f.fy-=b*f.vy}};return d};
pv.Force.spring=function(b){var d=0.1,f=20,c,e,g={};arguments.length||(b=0.1);g.links=function(h){if(arguments.length){c=h;e=h.map(function(i){return 1/Math.sqrt(Math.max(i.sourceNode.linkDegree,i.targetNode.linkDegree))});return g}return c};g.constant=function(h){if(arguments.length){b=Number(h);return g}return b};g.damping=function(h){if(arguments.length){d=Number(h);return g}return d};g.length=function(h){if(arguments.length){f=Number(h);return g}return f};g.apply=function(){for(var h=0;h<c.length;h++){var i=
c[h].sourceNode,j=c[h].targetNode,k=i.x-j.x,l=i.y-j.y,n=Math.sqrt(k*k+l*l),p=n?1/n:1;p=(b*e[h]*(n-f)+d*e[h]*(k*(i.vx-j.vx)+l*(i.vy-j.vy))*p)*p;k=-p*(n?k:0.01*(0.5-Math.random()));l=-p*(n?l:0.01*(0.5-Math.random()));i.fx+=k;i.fy+=l;j.fx-=k;j.fy-=l}};return g};pv.Constraint={};
pv.Constraint.collision=function(b){function d(k,l,n,p,m,o){if(!k.leaf){var q=(n+m)*0.5,s=(p+o)*0.5,t=s<i,u=q>e,r=q<h;if(s>g){k.c1&&u&&d(k.c1,l,n,p,q,s);k.c2&&r&&d(k.c2,l,q,p,m,s)}if(t){k.c3&&u&&d(k.c3,l,n,s,q,o);k.c4&&r&&d(k.c4,l,q,s,m,o)}}if(k.p&&k.p!=l){n=l.x-k.p.x;p=l.y-k.p.y;m=Math.sqrt(n*n+p*p);o=c+b(k.p);if(m<o){m=(m-o)/m*0.5;n*=m;p*=m;l.x-=n;l.y-=p;k.p.x+=n;k.p.y+=p}}}var f=1,c,e,g,h,i,j={};arguments.length||(c=10);j.repeat=function(k){if(arguments.length){f=Number(k);return j}return f};j.apply=
function(k,l){var n,p,m=-Infinity;for(n=k;n;n=n.next){p=b(n);if(p>m)m=p}for(var o=0;o<f;o++)for(n=k;n;n=n.next){p=(c=b(n))+m;e=n.x-p;h=n.x+p;g=n.y-p;i=n.y+p;d(l.root,n,l.xMin,l.yMin,l.xMax,l.yMax)}};return j};pv.Constraint.position=function(b){var d=1,f={};arguments.length||(b=function(c){return c.fix});f.alpha=function(c){if(arguments.length){d=Number(c);return f}return d};f.apply=function(c){for(c=c;c;c=c.next){var e=b(c);if(e){c.x+=(e.x-c.x)*d;c.y+=(e.y-c.y)*d;c.fx=c.fy=c.vx=c.vy=0}}};return f};
pv.Constraint.bound=function(){var b={},d,f;b.x=function(c,e){if(arguments.length){d={min:Math.min(c,e),max:Math.max(c,e)};return this}return d};b.y=function(c,e){if(arguments.length){f={min:Math.min(c,e),max:Math.max(c,e)};return this}return f};b.apply=function(c){if(d)for(var e=c;e;e=e.next)e.x=e.x<d.min?d.min:e.x>d.max?d.max:e.x;if(f)for(e=c;e;e=e.next)e.y=e.y<f.min?f.min:e.y>f.max?f.max:e.y};return b};pv.Layout=function(){pv.Panel.call(this)};pv.Layout.prototype=pv.extend(pv.Panel);
pv.Layout.prototype.property=pv.Mark.prototype.localProperty;
pv.Layout.Network=function(){pv.Layout.call(this);var b=this;this.$id=pv.id();(this.node=(new pv.Mark).data(function(){return b.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(d){return d.x}).top(function(d){return d.y})).parent=this;this.link=(new pv.Mark).extend(this.node).data(function(d){return[d.sourceNode,d.targetNode]}).fillStyle(null).lineWidth(function(d,f){return f.linkValue*1.5}).strokeStyle("rgba(0,0,0,.2)");this.link.add=function(d){return b.add(pv.Panel).data(function(){return b.links()}).add(d).extend(this)};
(this.label=(new pv.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(d){return d.nodeName||d.nodeValue}).textAngle(function(d){d=d.midAngle;return pv.Wedge.upright(d)?d:d+Math.PI}).textAlign(function(d){return pv.Wedge.upright(d.midAngle)?"left":"right"})).parent=this};
pv.Layout.Network.prototype=pv.extend(pv.Layout).property("nodes",function(b){return b.map(function(d,f){if(typeof d!="object")d={nodeValue:d};d.index=f;return d})}).property("links",function(b){return b.map(function(d){if(isNaN(d.linkValue))d.linkValue=isNaN(d.value)?1:d.value;return d})});pv.Layout.Network.prototype.reset=function(){this.$id=pv.id();return this};pv.Layout.Network.prototype.buildProperties=function(b,d){if((b.$id||0)<this.$id)pv.Layout.prototype.buildProperties.call(this,b,d)};
pv.Layout.Network.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);if(b.$id>=this.$id)return true;b.$id=this.$id;b.nodes.forEach(function(d){d.linkDegree=0});b.links.forEach(function(d){var f=d.linkValue;(d.sourceNode||(d.sourceNode=b.nodes[d.source])).linkDegree+=f;(d.targetNode||(d.targetNode=b.nodes[d.target])).linkDegree+=f})};pv.Layout.Hierarchy=function(){pv.Layout.Network.call(this);this.link.strokeStyle("#ccc")};pv.Layout.Hierarchy.prototype=pv.extend(pv.Layout.Network);
pv.Layout.Hierarchy.prototype.buildImplied=function(b){if(!b.links)b.links=pv.Layout.Hierarchy.links.call(this);pv.Layout.Network.prototype.buildImplied.call(this,b)};pv.Layout.Hierarchy.links=function(){return this.nodes().filter(function(b){return b.parentNode}).map(function(b){return{sourceNode:b,targetNode:b.parentNode,linkValue:1}})};
pv.Layout.Hierarchy.NodeLink={buildImplied:function(b){function d(m){return m.parentNode?m.depth*(n-l)+l:0}function f(m){return m.parentNode?(m.breadth-0.25)*2*Math.PI:0}function c(m){switch(h){case "left":return m.depth*j;case "right":return j-m.depth*j;case "top":return m.breadth*j;case "bottom":return j-m.breadth*j;case "radial":return j/2+d(m)*Math.cos(m.midAngle)}}function e(m){switch(h){case "left":return m.breadth*k;case "right":return k-m.breadth*k;case "top":return m.depth*k;case "bottom":return k-
m.depth*k;case "radial":return k/2+d(m)*Math.sin(m.midAngle)}}var g=b.nodes,h=b.orient,i=/^(top|bottom)$/.test(h),j=b.width,k=b.height;if(h=="radial"){var l=b.innerRadius,n=b.outerRadius;if(l==null)l=0;if(n==null)n=Math.min(j,k)/2}for(b=0;b<g.length;b++){var p=g[b];p.midAngle=h=="radial"?f(p):i?Math.PI/2:0;p.x=c(p);p.y=e(p);if(p.firstChild)p.midAngle+=Math.PI}}};
pv.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(b){return b.dx}).height(function(b){return b.dy}).innerRadius(function(b){return b.innerRadius}).outerRadius(function(b){return b.outerRadius}).startAngle(function(b){return b.startAngle}).angle(function(b){return b.angle});this.label.textAlign("center").left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2});delete this.link},buildImplied:function(b){function d(r,w){return(r+
w)/(1+w)}function f(r){switch(n){case "left":return d(r.minDepth,q)*m;case "right":return(1-d(r.maxDepth,q))*m;case "top":return r.minBreadth*m;case "bottom":return(1-r.maxBreadth)*m;case "radial":return m/2}}function c(r){switch(n){case "left":return r.minBreadth*o;case "right":return(1-r.maxBreadth)*o;case "top":return d(r.minDepth,q)*o;case "bottom":return(1-d(r.maxDepth,q))*o;case "radial":return o/2}}function e(r){switch(n){case "left":case "right":return(r.maxDepth-r.minDepth)/(1+q)*m;case "top":case "bottom":return(r.maxBreadth-
r.minBreadth)*m;case "radial":return r.parentNode?(r.innerRadius+r.outerRadius)*Math.cos(r.midAngle):0}}function g(r){switch(n){case "left":case "right":return(r.maxBreadth-r.minBreadth)*o;case "top":case "bottom":return(r.maxDepth-r.minDepth)/(1+q)*o;case "radial":return r.parentNode?(r.innerRadius+r.outerRadius)*Math.sin(r.midAngle):0}}function h(r){return Math.max(0,d(r.minDepth,q/2))*(t-s)+s}function i(r){return d(r.maxDepth,q/2)*(t-s)+s}function j(r){return(r.parentNode?r.minBreadth-0.25:0)*
2*Math.PI}function k(r){return(r.parentNode?r.maxBreadth-r.minBreadth:1)*2*Math.PI}var l=b.nodes,n=b.orient,p=/^(top|bottom)$/.test(n),m=b.width,o=b.height,q=-l[0].minDepth;if(n=="radial"){var s=b.innerRadius,t=b.outerRadius;if(s==null)s=0;if(s)q*=2;if(t==null)t=Math.min(m,o)/2}for(b=0;b<l.length;b++){var u=l[b];u.x=f(u);u.y=c(u);if(n=="radial"){u.innerRadius=h(u);u.outerRadius=i(u);u.startAngle=j(u);u.angle=k(u);u.midAngle=u.startAngle+u.angle/2}else u.midAngle=p?-Math.PI/2:0;u.dx=e(u);u.dy=g(u)}}};
pv.Layout.Grid=function(){pv.Layout.call(this);var b=this;(this.cell=(new pv.Mark).data(function(){return b.scene[b.index].$grid}).width(function(){return b.width()/b.cols()}).height(function(){return b.height()/b.rows()}).left(function(){return this.width()*(this.index%b.cols())}).top(function(){return this.height()*Math.floor(this.index/b.cols())})).parent=this};pv.Layout.Grid.prototype=pv.extend(pv.Layout).property("rows").property("cols");pv.Layout.Grid.prototype.defaults=(new pv.Layout.Grid).extend(pv.Layout.prototype.defaults).rows(1).cols(1);
pv.Layout.Grid.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var d=b.rows,f=b.cols;if(typeof f=="object")d=pv.transpose(f);if(typeof d=="object"){b.$grid=pv.blend(d);b.rows=d.length;b.cols=d[0]?d[0].length:0}else b.$grid=pv.repeat([b.data],d*f)};
pv.Layout.Stack=function(){function b(h){return function(){return c[h](this.parent.index,this.index)}}pv.Layout.call(this);var d=this,f=function(){return null},c={t:f,l:f,r:f,b:f,w:f,h:f},e,g=d.buildImplied;this.buildImplied=function(h){g.call(this,h);var i=h.layers,j=i.length,k,l=h.orient,n=/^(top|bottom)\b/.test(l),p=this.parent[n?"height":"width"](),m=[],o=[],q=[],s=pv.Mark.stack,t={parent:{parent:this}};s.unshift(null);e=[];for(var u=0;u<j;u++){q[u]=[];o[u]=[];t.parent.index=u;s[0]=i[u];e[u]=
this.$values.apply(t.parent,s);if(!u)k=e[u].length;s.unshift(null);for(var r=0;r<k;r++){s[0]=e[u][r];t.index=r;u||(m[r]=this.$x.apply(t,s));q[u][r]=this.$y.apply(t,s)}s.shift()}s.shift();switch(h.order){case "inside-out":var w=q.map(function(x){return pv.max.index(x)});t=pv.range(j).sort(function(x,C){return w[x]-w[C]});i=q.map(function(x){return pv.sum(x)});var v=s=0,z=[],y=[];for(u=0;u<j;u++){r=t[u];if(s<v){s+=i[r];z.push(r)}else{v+=i[r];y.push(r)}}i=y.reverse().concat(z);break;case "reverse":i=
pv.range(j-1,-1,-1);break;default:i=pv.range(j);break}switch(h.offset){case "silohouette":for(r=0;r<k;r++){for(u=t=0;u<j;u++)t+=q[u][r];o[i[0]][r]=(p-t)/2}break;case "wiggle":for(u=t=0;u<j;u++)t+=q[u][0];o[i[0]][0]=t=(p-t)/2;for(r=1;r<k;r++){s=p=0;v=m[r]-m[r-1];for(u=0;u<j;u++)p+=q[u][r];for(u=0;u<j;u++){z=(q[i[u]][r]-q[i[u]][r-1])/(2*v);for(h=0;h<u;h++)z+=(q[i[h]][r]-q[i[h]][r-1])/v;s+=z*q[i[u]][r]}o[i[0]][r]=t-=p?s/p*v:0}break;case "expand":for(r=0;r<k;r++){for(u=h=o[i[0]][r]=0;u<j;u++)h+=q[u][r];
if(h){h=p/h;for(u=0;u<j;u++)q[u][r]*=h}else{h=p/j;for(u=0;u<j;u++)q[u][r]=h}}break;default:for(r=0;r<k;r++)o[i[0]][r]=0;break}for(r=0;r<k;r++){t=o[i[0]][r];for(u=1;u<j;u++){t+=q[i[u-1]][r];o[i[u]][r]=t}}u=l.indexOf("-");j=n?"h":"w";n=u<0?n?"l":"b":l.charAt(u+1);l=l.charAt(0);for(var A in c)c[A]=f;c[n]=function(x,C){return m[C]};c[l]=function(x,C){return o[x][C]};c[j]=function(x,C){return q[x][C]}};this.layer=(new pv.Mark).data(function(){return e[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));
this.layer.add=function(h){return d.add(pv.Panel).data(function(){return d.layers()}).add(h).extend(this)}};pv.Layout.Stack.prototype=pv.extend(pv.Layout).property("orient",String).property("offset",String).property("order",String).property("layers");a=pv.Layout.Stack.prototype;a.defaults=(new pv.Layout.Stack).extend(pv.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]);a.$x=pv.Layout.Stack.prototype.$y=function(){return 0};a.x=function(b){this.$x=pv.functor(b);return this};
a.y=function(b){this.$y=pv.functor(b);return this};a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.Band=function(){function b(j){return function(){return c[j](this.index,this.parent.index)}}pv.Layout.call(this);var d=this,f=d.buildImplied,c,e,g=(new pv.Mark).data(function(){return e[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));this.buildImplied=function(j){f.call(this,j);c=Object.create(pv.Layout.Band.$baseItemProps);e=[];var k=j.layers,l=k.length;if(l>0){var n=j.orient,p=/^(top|bottom)\b/.test(n),m=this.parent[p?"height":"width"]();
k=this._readData(k,e,j);var o=k.length;j.bandOrder==="reverse"&&k.reverse();if(j.order==="reverse"){e.reverse();for(var q=0;q<o;q++)k[q].items.reverse()}switch(j.layout){case "grouped":this._calcGrouped(k,l,j);break;case "stacked":this._calcStacked(k,l,m,j);break}this._bindItemProps(k,c,n,p)}};var h=this.item={end:this,add:function(j){return d.add(pv.Panel).data(function(){return d.layers()}).add(j).extend(g)},order:function(j){d.order(j);return this},w:function(j){d.$iw=pv.functor(j);return this},
h:function(j){d.$ih=pv.functor(j);return this},horizontalRatio:function(j){d.$ihorizRatio=pv.functor(j);return this},verticalMargin:function(j){d.$ivertiMargin=pv.functor(j);return this}},i=this.band={end:this,w:function(j){d.$bw=pv.functor(j);return this},x:function(j){d.$bx=pv.functor(j);return this},order:function(j){d.bandOrder(j);return this},differentialControl:function(j){d.$bDiffControl=pv.functor(j);return this}};this.band.item=h;this.item.band=i};
pv.Layout.Band.$baseItemProps=function(){var b=function(){return null};return{t:b,l:b,r:b,b:b,w:b,h:b}}();pv.Layout.Band.prototype=pv.extend(pv.Layout).property("orient",String).property("layout",String).property("layers").property("yZero",Number).property("verticalMode",String).property("horizontalMode",String).property("order",String).property("bandOrder",String);a=pv.Layout.Band.prototype;a.defaults=(new pv.Layout.Band).extend(pv.Layout.prototype.defaults).orient("bottom-left").layout("grouped").yZero(0).layers([[]]);
a.$bx=pv.Layout.Band.prototype.$bw=pv.Layout.Band.prototype.$bDiffControl=pv.Layout.Band.prototype.$iw=pv.Layout.Band.prototype.$ih=pv.Layout.Band.prototype.$ivertiMargin=pv.functor(0);a.$ihorizRatio=pv.functor(0.9);a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.prototype._readData=function(b,d,f){var c=b.length,e=[],g,h=pv.Mark.stack,i={parent:{parent:this}};h.unshift(null);for(var j=0;j<c;j++){i.parent.index=j;h[0]=b[j];var k=d[j]=this.$values.apply(i.parent,h);if(!j)g=k.length;h.unshift(null);for(var l=0;l<g;l++){h[0]=k[l];i.index=l;var n=e[l];n||(n=e[l]={horizRatio:this.$ihorizRatio.apply(i,h),vertiMargin:this.$ivertiMargin.apply(i,h),w:this.$bw.apply(i,h),x:this.$bx.apply(i,h),diffControl:this.$bDiffControl?this.$bDiffControl.apply(i,h):0,
items:[]});var p=this.$ih.apply(i,h);n.items[j]={y:f.yZero||0,x:0,w:this.$iw.apply(i,h),h:p!=null?Math.abs(p):p,dir:p<0?-1:1}}h.shift()}h.shift();return e};
pv.Layout.Band.prototype._calcGrouped=function(b,d,f){for(var c=0,e=b.length;c<e;c++){for(var g=b[c],h=g.items,i=g.w,j=g.horizRatio,k=0,l=0;l<d;l++)k+=h[l].w;if(d===1)j=1;else j>0&&j<=1||(j=1);if(i==null)g.w=k/j;else if(f.horizontalMode==="expand"){i=j*i;if(k){k=i/k;for(l=0;l<d;l++)h[l].w*=k}else{k=i/d;for(l=0;l<d;l++)h[l].w=k}k=i}l=k/j;g=g.x-l/2;j=d>1?(l-k)/(d-1):0;for(l=0;l<d;l++){k=h[l];k.x=g;g+=k.w+j;if(k.dir<0)k.y-=k.h}}};
pv.Layout.Band.prototype._calcStacked=function(b,d,f,c){var e=b.length,g;if(c.verticalMode==="expand")for(var h=0;h<e;h++){g=b[h].items;for(var i=null,j=0,k=0;k<d;k++){var l=g[k];l.dir=1;l=l.h;if(l!=null){j++;i+=l}}if(j)if(i){i=f/i;for(k=0;k<d;k++){l=g[k].h;if(l!=null)g[k].h=l*i}}else{i=f/j;for(k=0;k<d;k++){l=g[k].h;if(l!=null)g[k].h=i}}}f=d=c.yZero;for(h=0;h<e;h++){g=b[h];c=g.x;k=g.diffControl;l=k<0;i=Math.max(0,g.vertiMargin);g=g.items;j=this._layoutItemsOfDir(+1,l,g,i,c,f);var n=null;if(j.existsOtherDir)n=
this._layoutItemsOfDir(-1,l,g,i,c,f);if(k){if(Math.abs(k)===1){g=f;f=j.yOffset;if(n)f-=g-n.yOffset}}else f=d}};pv.Layout.Band.prototype._layoutItemsOfDir=function(b,d,f,c,e,g){for(var h=false,i=c/2,j=d?-b:b,k=0,l=f.length;k<l;k+=1){var n=f[d?l-k-1:k];if(n.dir===b){var p=n.h||0;if(j>0){n.y=g+i;g+=p}else{n.y=g-(p-i);g-=p}p=p-c;n.h=p>0?p:0;n.x=e-n.w/2}else h=true}return{existsOtherDir:h,yOffset:g}};
pv.Layout.Band.prototype._bindItemProps=function(b,d,f,c){var e=f.indexOf("-"),g=c?"h":"w",h=c?"w":"h";c=e<0?c?"l":"b":f.charAt(e+1);f=f.charAt(0);d[c]=function(i,j){return b[i].items[j].x};d[f]=function(i,j){return b[i].items[j].y};d[h]=function(i,j){return b[i].items[j].w};d[g]=function(i,j){return b[i].items[j].h||0}};
pv.Layout.Treemap=function(){pv.Layout.Hierarchy.call(this);this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(b){return b.dx}).height(function(b){return b.dy});this.label.visible(function(b){return!b.firstChild}).left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2}).textAlign("center").textAngle(function(b){return b.dx>b.dy?0:-Math.PI/2});(this.leaf=(new pv.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(b){return!b.firstChild})).parent=
this;delete this.link};pv.Layout.Treemap.prototype=pv.extend(pv.Layout.Hierarchy).property("round",Boolean).property("mode",String).property("order",String);a=pv.Layout.Treemap.prototype;a.defaults=(new pv.Layout.Treemap).extend(pv.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending");a.$size=function(b){return Number(b.nodeValue)};a.$padLeft=pv.Layout.Treemap.prototype.$padRight=pv.Layout.Treemap.prototype.$padBottom=pv.Layout.Treemap.prototype.$padTop=function(){return 0};
a.size=function(b){this.$size=pv.functor(b);return this};a.padding=function(b){return this.paddingLeft(b).paddingRight(b).paddingTop(b).paddingBottom(b)};a.paddingLeft=function(b){if(arguments.length)this.$padLeft=b;return this.$padLeft};a.paddingRight=function(b){if(arguments.length)this.$padRight=b;return this.$padRight};a.paddingBottom=function(b){if(arguments.length)this.$padBottom=b;return this.$padBottom};a.paddingTop=function(b){if(arguments.length)this.$padTop=b;return this.$padTop};
a.buildImplied=function(b){function d(l,n,p,m,o,q,s){for(var t=0,u=0;t<l.length;t++){var r=l[t];if(p){r.x=m+u;r.y=o;u+=r.dx=j(q*r.size/n);r.dy=s}else{r.x=m;r.y=o+u;r.dx=q;u+=r.dy=j(s*r.size/n)}}if(r)if(p)r.dx+=q-u;else r.dy+=s-u}function f(l,n){for(var p=-Infinity,m=Infinity,o=0,q=0;q<l.length;q++){var s=l[q].size;if(s<m)m=s;if(s>p)p=s;o+=s}o*=o;n*=n;return Math.max(n*p/o,o/(n*m))}function c(l,n){function p(v){var z=s==u,y=pv.sum(v,i),A=u?j(y/u):0;d(v,y,z,o,q,z?s:A,z?A:t);if(z){q+=A;t-=A}else{o+=
A;s-=A}u=Math.min(s,t);return z}var m=l.parentNode,o=l.x,q=l.y,s=l.dx,t=l.dy;if(m){o+=m.paddingLeft;q+=m.paddingTop;s+=-m.paddingLeft-m.paddingRight;t+=-m.paddingTop-m.paddingBottom}if(k!="squarify")d(l.childNodes,l.size,k=="slice"?true:k=="dice"?false:n&1,o,q,s,t);else{m=[];n=Infinity;var u=Math.min(s,t),r=s*t/l.size;if(!(l.size<=0)){l.visitBefore(function(v){v.size*=r});for(l=l.childNodes.slice();l.length;){var w=l[l.length-1];if(w.size){m.push(w);r=f(m,u);if(r<=n){l.pop();n=r}else{m.pop();p(m);
m.length=0;n=Infinity}}else l.pop()}if(p(m))for(n=0;n<m.length;n++)m[n].dy+=t;else for(n=0;n<m.length;n++)m[n].dx+=s}}}pv.Layout.Hierarchy.prototype.buildImplied.call(this,b);var e=this,g=b.nodes[0],h=pv.Mark.stack,i=function(l){return l.size},j=b.round?Math.round:Number,k=b.mode;h.unshift(null);try{g.visitAfter(function(l,n){l.depth=n;l.x=l.y=l.dx=l.dy=0;h[0]=l;if(l.firstChild){l.size=pv.sum(l.childNodes,i);l.paddingRight=+e.$padRight.apply(e,h)||0;l.paddingLeft=+e.$padLeft.apply(e,h)||0;l.paddingBottom=
+e.$padBottom.apply(e,h)||0;l.paddingTop=+e.$padTop.apply(e,h)||0}else l.size=e.$size.apply(e,h)})}finally{h.shift()}switch(b.order){case "ascending":g.sort(function(l,n){return l.size-n.size});break;case "descending":g.sort(function(l,n){return n.size-l.size});break;case "reverse":g.reverse();break}g.x=0;g.y=0;g.dx=b.width;g.dy=b.height;g.visitBefore(c)};pv.Layout.Tree=function(){pv.Layout.Hierarchy.call(this)};
pv.Layout.Tree.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String);pv.Layout.Tree.prototype.defaults=(new pv.Layout.Tree).extend(pv.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top");
pv.Layout.Tree.prototype.buildImplied=function(b){function d(r){var w,v,z;if(r.firstChild){w=r.firstChild;v=r.lastChild;for(var y=z=w;y;y=y.nextSibling){d(y);z=c(y,z)}i(r);v=0.5*(w.prelim+v.prelim);if(w=r.previousSibling){r.prelim=w.prelim+k(r.depth,true);r.mod=r.prelim-v}else r.prelim=v}else if(w=r.previousSibling)r.prelim=w.prelim+k(r.depth,true)}function f(r,w,v){r.breadth=r.prelim+w;w+=r.mod;for(r=r.firstChild;r;r=r.nextSibling)f(r,w,v)}function c(r,w){var v=r.previousSibling;if(v){var z=r,y=
r,A=v;v=r.parentNode.firstChild;var x=z.mod,C=y.mod,E=A.mod,B=v.mod;A=g(A);for(z=e(z);A&&z;){A=A;z=z;v=e(v);y=g(y);y.ancestor=r;var D=A.prelim+E-(z.prelim+x)+k(A.depth,false);if(D>0){h(j(A,r,w),r,D);x+=D;C+=D}E+=A.mod;x+=z.mod;B+=v.mod;C+=y.mod;A=g(A);z=e(z)}if(A&&!g(y)){y.thread=A;y.mod+=E-C}if(z&&!e(v)){v.thread=z;v.mod+=x-B;w=r}}return w}function e(r){return r.firstChild||r.thread}function g(r){return r.lastChild||r.thread}function h(r,w,v){var z=w.number-r.number;w.change-=v/z;w.shift+=v;r.change+=
v/z;w.prelim+=v;w.mod+=v}function i(r){var w=0,v=0;for(r=r.lastChild;r;r=r.previousSibling){r.prelim+=w;r.mod+=w;v+=r.change;w+=r.shift+v}}function j(r,w,v){return r.ancestor.parentNode==w.parentNode?r.ancestor:v}function k(r,w){return(w?1:s+1)/(m=="radial"?r:1)}function l(r){return m=="radial"?r.breadth/o:0}function n(r){switch(m){case "left":return r.depth;case "right":return t-r.depth;case "top":case "bottom":return r.breadth+t/2;case "radial":return t/2+r.depth*Math.cos(l(r))}}function p(r){switch(m){case "left":case "right":return r.breadth+
u/2;case "top":return r.depth;case "bottom":return u-r.depth;case "radial":return u/2+r.depth*Math.sin(l(r))}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var m=b.orient,o=b.depth,q=b.breadth,s=b.group,t=b.width,u=b.height;b=b.nodes[0];b.visitAfter(function(r,w){r.ancestor=r;r.prelim=0;r.mod=0;r.change=0;r.shift=0;r.number=r.previousSibling?r.previousSibling.number+1:0;r.depth=w});d(b);f(b,-b.prelim,0);b.visitAfter(function(r){r.breadth*=q;r.depth*=o;r.midAngle=l(r);r.x=n(r);r.y=p(r);
if(r.firstChild)r.midAngle+=Math.PI;delete r.breadth;delete r.depth;delete r.ancestor;delete r.prelim;delete r.mod;delete r.change;delete r.shift;delete r.number;delete r.thread})}};pv.Layout.Indent=function(){pv.Layout.Hierarchy.call(this);this.link.interpolate("step-after")};pv.Layout.Indent.prototype=pv.extend(pv.Layout.Hierarchy).property("depth",Number).property("breadth",Number);pv.Layout.Indent.prototype.defaults=(new pv.Layout.Indent).extend(pv.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15);
pv.Layout.Indent.prototype.buildImplied=function(b){function d(h,i,j){h.x=e+j++*c;h.y=g+i++*f;h.midAngle=0;for(h=h.firstChild;h;h=h.nextSibling)i=d(h,i,j);return i}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var f=b.breadth,c=b.depth,e=0,g=0;d(b.nodes[0],1,1)}};pv.Layout.Pack=function(){pv.Layout.Hierarchy.call(this);this.node.shapeRadius(function(b){return b.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)");this.label.textAlign("center");delete this.link};
pv.Layout.Pack.prototype=pv.extend(pv.Layout.Hierarchy).property("spacing",Number).property("order",String);pv.Layout.Pack.prototype.defaults=(new pv.Layout.Pack).extend(pv.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending");pv.Layout.Pack.prototype.$radius=function(){return 1};pv.Layout.Pack.prototype.size=function(b){this.$radius=typeof b=="function"?function(){return Math.sqrt(b.apply(this,arguments))}:(b=Math.sqrt(b),function(){return b});return this};
pv.Layout.Pack.prototype.buildImplied=function(b){function d(n){var p=pv.Mark.stack;p.unshift(null);for(var m=0,o=n.length;m<o;m++){var q=n[m];if(!q.firstChild)q.radius=h.$radius.apply(h,(p[0]=q,p))}p.shift()}function f(n){var p=[];for(n=n.firstChild;n;n=n.nextSibling){if(n.firstChild)n.radius=f(n);n.n=n.p=n;p.push(n)}switch(b.order){case "ascending":p.sort(function(m,o){return m.radius-o.radius});break;case "descending":p.sort(function(m,o){return o.radius-m.radius});break;case "reverse":p.reverse();
break}return c(p)}function c(n){function p(D){s=Math.min(D.x-D.radius,s);t=Math.max(D.x+D.radius,t);u=Math.min(D.y-D.radius,u);r=Math.max(D.y+D.radius,r)}function m(D,F){var G=D.n;D.n=F;F.p=D;F.n=G;G.p=F}function o(D,F){D.n=F;F.p=D}function q(D,F){var G=F.x-D.x,H=F.y-D.y;D=D.radius+F.radius;return D*D-G*G-H*H>0.001}var s=Infinity,t=-Infinity,u=Infinity,r=-Infinity,w,v,z,y,A;w=n[0];w.x=-w.radius;w.y=0;p(w);if(n.length>1){v=n[1];v.x=v.radius;v.y=0;p(v);if(n.length>2){z=n[2];e(w,v,z);p(z);m(w,z);w.p=
z;m(z,v);v=w.n;for(var x=3;x<n.length;x++){e(w,v,z=n[x]);var C=0,E=1,B=1;for(y=v.n;y!=v;y=y.n,E++)if(q(y,z)){C=1;break}if(C==1)for(A=w.p;A!=y.p;A=A.p,B++)if(q(A,z)){if(B<E){C=-1;y=A}break}if(C==0){m(w,z);v=z;p(z)}else if(C>0){o(w,y);v=y;x--}else if(C<0){o(y,v);w=y;x--}}}}w=(s+t)/2;v=(u+r)/2;for(x=z=0;x<n.length;x++){y=n[x];y.x-=w;y.y-=v;z=Math.max(z,y.radius+Math.sqrt(y.x*y.x+y.y*y.y))}return z+b.spacing}function e(n,p,m){var o=p.radius+m.radius,q=n.radius+m.radius,s=p.x-n.x;p=p.y-n.y;var t=Math.sqrt(s*
s+p*p),u=(q*q+t*t-o*o)/(2*q*t);o=Math.acos(u);u=u*q;q=Math.sin(o)*q;s/=t;p/=t;m.x=n.x+u*s+q*p;m.y=n.y+u*p-q*s}function g(n,p,m,o){for(var q=n.firstChild;q;q=q.nextSibling){q.x+=n.x;q.y+=n.y;g(q,p,m,o)}n.x=p+o*n.x;n.y=m+o*n.y;n.radius*=o}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var h=this,i=b.nodes,j=i[0];d(i);j.x=0;j.y=0;j.radius=f(j);i=this.width();var k=this.height(),l=1/Math.max(2*j.radius/i,2*j.radius/k);g(j,i/2,k/2,l)}};
pv.Layout.Force=function(){pv.Layout.Network.call(this);this.link.lineWidth(function(b,d){return Math.sqrt(d.linkValue)*1.5});this.label.textAlign("center")};
pv.Layout.Force.prototype=pv.extend(pv.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number);pv.Layout.Force.prototype.defaults=(new pv.Layout.Force).extend(pv.Layout.Network.prototype.defaults).dragConstant(0.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(0.9).springConstant(0.1).springDamping(0.3).springLength(20);
pv.Layout.Force.prototype.buildImplied=function(b){function d(l){return l.fix?1:l.vx*l.vx+l.vy*l.vy}if(pv.Layout.Network.prototype.buildImplied.call(this,b)){if(b=b.$force){b.next=this.binds.$force;this.binds.$force=b}}else{for(var f=this,c=b.nodes,e=b.links,g=b.iterations,h=b.width,i=b.height,j=0,k;j<c.length;j++){k=c[j];if(isNaN(k.x))k.x=h/2+40*Math.random()-20;if(isNaN(k.y))k.y=i/2+40*Math.random()-20}k=pv.simulation(c);k.force(pv.Force.drag(b.dragConstant));k.force(pv.Force.charge(b.chargeConstant).domain(b.chargeMinDistance,
b.chargeMaxDistance).theta(b.chargeTheta));k.force(pv.Force.spring(b.springConstant).damping(b.springDamping).length(b.springLength).links(e));k.constraint(pv.Constraint.position());b.bound&&k.constraint(pv.Constraint.bound().x(6,h-6).y(6,i-6));if(g==null){k.step();k.step();b.$force=this.binds.$force={next:this.binds.$force,nodes:c,min:1.0E-4*(e.length+1),sim:k};if(!this.$timer)this.$timer=setInterval(function(){for(var l=false,n=f.binds.$force;n;n=n.next)if(pv.max(n.nodes,d)>n.min){n.sim.step();
l=true}l&&f.render()},42)}else for(j=0;j<g;j++)k.step()}};pv.Layout.Cluster=function(){pv.Layout.Hierarchy.call(this);var b,d=this.buildImplied;this.buildImplied=function(f){d.call(this,f);b=/^(top|bottom)$/.test(f.orient)?"step-before":/^(left|right)$/.test(f.orient)?"step-after":"linear"};this.link.interpolate(function(){return b})};
pv.Layout.Cluster.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);pv.Layout.Cluster.prototype.defaults=(new pv.Layout.Cluster).extend(pv.Layout.Hierarchy.prototype.defaults).group(0).orient("top");
pv.Layout.Cluster.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var d=b.nodes[0],f=b.group,c,e,g=0,h=0.5-f/2,i=undefined;d.visitAfter(function(j){if(j.firstChild)j.depth=1+pv.max(j.childNodes,function(k){return k.depth});else{if(f&&i!=j.parentNode){i=j.parentNode;g+=f}g++;j.depth=0}});c=1/g;e=1/d.depth;i=undefined;d.visitAfter(function(j){if(j.firstChild)j.breadth=pv.mean(j.childNodes,function(k){return k.breadth});else{if(f&&i!=j.parentNode){i=j.parentNode;
h+=f}j.breadth=c*h++}j.depth=1-j.depth*e});d.visitAfter(function(j){j.minBreadth=j.firstChild?j.firstChild.minBreadth:j.breadth-c/2;j.maxBreadth=j.firstChild?j.lastChild.maxBreadth:j.breadth+c/2});d.visitBefore(function(j){j.minDepth=j.parentNode?j.parentNode.maxDepth:0;j.maxDepth=j.parentNode?j.depth+d.depth:j.minDepth+2*d.depth});d.minDepth=-e;pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Cluster.Fill=function(){pv.Layout.Cluster.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};
pv.Layout.Cluster.Fill.prototype=pv.extend(pv.Layout.Cluster);pv.Layout.Cluster.Fill.prototype.buildImplied=function(b){pv.Layout.Cluster.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Partition=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Partition.prototype=pv.extend(pv.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);
pv.Layout.Partition.prototype.defaults=(new pv.Layout.Partition).extend(pv.Layout.Hierarchy.prototype.defaults).orient("top");pv.Layout.Partition.prototype.$size=function(){return 1};pv.Layout.Partition.prototype.size=function(b){this.$size=b;return this};
pv.Layout.Partition.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var d=this,f=b.nodes[0],c=pv.Mark.stack,e=0;c.unshift(null);f.visitAfter(function(g,h){if(h>e)e=h;g.size=g.firstChild?pv.sum(g.childNodes,function(i){return i.size}):d.$size.apply(d,(c[0]=g,c))});c.shift();switch(b.order){case "ascending":f.sort(function(g,h){return g.size-h.size});break;case "descending":f.sort(function(g,h){return h.size-g.size});break}f.minBreadth=0;f.breadth=0.5;
f.maxBreadth=1;f.visitBefore(function(g){for(var h=g.minBreadth,i=g.maxBreadth-h,j=g.firstChild;j;j=j.nextSibling){j.minBreadth=h;h+=j.size/g.size*i;j.maxBreadth=h;j.breadth=(h+j.minBreadth)/2}});f.visitAfter(function(g,h){g.minDepth=(h-1)/e;g.maxDepth=g.depth=h/e});pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Partition.Fill=function(){pv.Layout.Partition.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};pv.Layout.Partition.Fill.prototype=pv.extend(pv.Layout.Partition);
pv.Layout.Partition.Fill.prototype.buildImplied=function(b){pv.Layout.Partition.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Arc=function(){pv.Layout.Network.call(this);var b,d,f,c=this.buildImplied;this.buildImplied=function(e){c.call(this,e);d=e.directed;b=e.orient=="radial"?"linear":"polar";f=e.orient=="right"||e.orient=="top"};this.link.data(function(e){var g=e.sourceNode;e=e.targetNode;return f!=(d||g.breadth<e.breadth)?[g,e]:[e,g]}).interpolate(function(){return b})};
pv.Layout.Arc.prototype=pv.extend(pv.Layout.Network).property("orient",String).property("directed",Boolean);pv.Layout.Arc.prototype.defaults=(new pv.Layout.Arc).extend(pv.Layout.Network.prototype.defaults).orient("bottom");pv.Layout.Arc.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Arc.prototype.buildImplied=function(b){function d(m){switch(g){case "top":return-Math.PI/2;case "bottom":return Math.PI/2;case "left":return Math.PI;case "right":return 0;case "radial":return(m-0.25)*2*Math.PI}}function f(m){switch(g){case "top":case "bottom":return m*j;case "left":return 0;case "right":return j;case "radial":return j/2+l*Math.cos(d(m))}}function c(m){switch(g){case "top":return 0;case "bottom":return k;case "left":case "right":return m*k;case "radial":return k/2+l*Math.sin(d(m))}}
if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var e=b.nodes,g=b.orient,h=this.$sort,i=pv.range(e.length),j=b.width,k=b.height,l=Math.min(j,k)/2;h&&i.sort(function(m,o){return h(e[m],e[o])});for(b=0;b<e.length;b++){var n=e[i[b]],p=n.breadth=(b+0.5)/e.length;n.x=f(p);n.y=c(p);n.midAngle=d(p)}}};
pv.Layout.Horizon=function(){pv.Layout.call(this);var b=this,d,f,c,e,g,h,i=this.buildImplied;this.buildImplied=function(j){i.call(this,j);d=j.bands;f=j.mode;c=Math.round((f=="color"?0.5:1)*j.height);e=j.backgroundStyle;g=pv.ramp(e,j.negativeStyle).domain(0,d);h=pv.ramp(e,j.positiveStyle).domain(0,d)};d=(new pv.Panel).data(function(){return pv.range(d*2)}).overflow("hidden").height(function(){return c}).top(function(j){return f=="color"?(j&1)*c:0}).fillStyle(function(j){return j?null:e});this.band=
(new pv.Mark).top(function(j,k){return f=="mirror"&&k&1?(k+1>>1)*c:null}).bottom(function(j,k){return f=="mirror"?k&1?null:(k+1>>1)*-c:(k&1||-1)*(k+1>>1)*c}).fillStyle(function(j,k){return(k&1?g:h)((k>>1)+1)});this.band.add=function(j){return b.add(pv.Panel).extend(d).add(j).extend(this)}};pv.Layout.Horizon.prototype=pv.extend(pv.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",pv.fillStyle).property("positiveStyle",pv.fillStyle).property("negativeStyle",pv.fillStyle);
pv.Layout.Horizon.prototype.defaults=(new pv.Layout.Horizon).extend(pv.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728");
pv.Layout.Rollup=function(){pv.Layout.Network.call(this);var b=this,d,f,c=b.buildImplied;this.buildImplied=function(e){c.call(this,e);d=e.$rollup.nodes;f=e.$rollup.links};this.node.data(function(){return d}).shapeSize(function(e){return e.nodes.length*20});this.link.interpolate("polar").eccentricity(0.8);this.link.add=function(e){return b.add(pv.Panel).data(function(){return f}).add(e).extend(this)}};pv.Layout.Rollup.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);
pv.Layout.Rollup.prototype.x=function(b){this.$x=pv.functor(b);return this};pv.Layout.Rollup.prototype.y=function(b){this.$y=pv.functor(b);return this};
pv.Layout.Rollup.prototype.buildImplied=function(b){function d(o){return h[o]+","+i[o]}if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var f=b.nodes,c=b.links,e=b.directed,g=f.length,h=[],i=[],j=0,k={},l={},n=pv.Mark.stack,p={parent:this};n.unshift(null);for(var m=0;m<g;m++){p.index=m;n[0]=f[m];h[m]=this.$x.apply(p,n);i[m]=this.$y.apply(p,n)}n.shift();for(m=0;m<f.length;m++){g=d(m);n=k[g];if(!n){n=k[g]=pv.extend(f[m]);n.index=j++;n.x=h[m];n.y=i[m];n.nodes=[]}n.nodes.push(f[m])}for(m=0;m<
c.length;m++){j=c[m].targetNode;f=k[d(c[m].sourceNode.index)];j=k[d(j.index)];g=!e&&f.index>j.index?j.index+","+f.index:f.index+","+j.index;(n=l[g])||(n=l[g]={sourceNode:f,targetNode:j,linkValue:0,links:[]});n.links.push(c[m]);n.linkValue+=c[m].linkValue}b.$rollup={nodes:pv.values(k),links:pv.values(l)}}};
pv.Layout.Matrix=function(){pv.Layout.Network.call(this);var b,d,f,c,e,g=this.buildImplied;this.buildImplied=function(h){g.call(this,h);b=h.nodes.length;d=h.width/b;f=h.height/b;c=h.$matrix.labels;e=h.$matrix.pairs};this.link.data(function(){return e}).left(function(){return d*(this.index%b)}).top(function(){return f*Math.floor(this.index/b)}).width(function(){return d}).height(function(){return f}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(h){return h.linkValue?"#555":"#eee"}).parent=
this;delete this.link.add;this.label.data(function(){return c}).left(function(){return this.index&1?d*((this.index>>1)+0.5):0}).top(function(){return this.index&1?0:f*((this.index>>1)+0.5)}).textMargin(4).textAlign(function(){return this.index&1?"left":"right"}).textAngle(function(){return this.index&1?-Math.PI/2:0});delete this.node};pv.Layout.Matrix.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);pv.Layout.Matrix.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Matrix.prototype.buildImplied=function(b){if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var d=b.nodes,f=b.links,c=this.$sort,e=d.length,g=pv.range(e),h=[],i=[],j={};b.$matrix={labels:h,pairs:i};c&&g.sort(function(m,o){return c(d[m],d[o])});for(var k=0;k<e;k++)for(var l=0;l<e;l++){var n=g[k],p=g[l];i.push(j[n+"."+p]={row:k,col:l,sourceNode:d[n],targetNode:d[p],linkValue:0})}for(k=0;k<e;k++){n=g[k];h.push(d[n],d[n])}for(k=0;k<f.length;k++){h=f[k];e=h.sourceNode.index;g=h.targetNode.index;
h=h.linkValue;j[e+"."+g].linkValue+=h;b.directed||(j[g+"."+e].linkValue+=h)}}};
pv.Layout.Bullet=function(){pv.Layout.call(this);var b=this,d=b.buildImplied,f=b.x=pv.Scale.linear(),c,e,g,h,i;this.buildImplied=function(j){d.call(this,i=j);c=j.orient;e=/^left|right$/.test(c);g=pv.ramp("#bbb","#eee").domain(0,Math.max(1,i.ranges.length-1));h=pv.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,i.measures.length-1))};(this.range=new pv.Mark).data(function(){return i.ranges}).reverse(true).left(function(){return c=="left"?0:null}).top(function(){return c=="top"?0:null}).right(function(){return c==
"right"?0:null}).bottom(function(){return c=="bottom"?0:null}).width(function(j){return e?f(j):null}).height(function(j){return e?null:f(j)}).fillStyle(function(){return g(this.index)}).antialias(false).parent=b;(this.measure=new pv.Mark).extend(this.range).data(function(){return i.measures}).left(function(){return c=="left"?0:e?null:this.parent.width()/3.25}).top(function(){return c=="top"?0:e?this.parent.height()/3.25:null}).right(function(){return c=="right"?0:e?null:this.parent.width()/3.25}).bottom(function(){return c==
"bottom"?0:e?this.parent.height()/3.25:null}).fillStyle(function(){return h(this.index)}).parent=b;(this.marker=new pv.Mark).data(function(){return i.markers}).left(function(j){return c=="left"?f(j):e?null:this.parent.width()/2}).top(function(j){return c=="top"?f(j):e?this.parent.height()/2:null}).right(function(j){return c=="right"?f(j):null}).bottom(function(j){return c=="bottom"?f(j):null}).strokeStyle("black").shape("bar").shapeAngle(function(){return e?0:Math.PI/2}).parent=b;(this.tick=new pv.Mark).data(function(){return f.ticks(7)}).left(function(j){return c==
"left"?f(j):null}).top(function(j){return c=="top"?f(j):null}).right(function(j){return c=="right"?f(j):e?null:-6}).bottom(function(j){return c=="bottom"?f(j):e?-8:null}).height(function(){return e?6:null}).width(function(){return e?null:6}).parent=b};pv.Layout.Bullet.prototype=pv.extend(pv.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("minimum").property("maximum");pv.Layout.Bullet.prototype.defaults=(new pv.Layout.Bullet).extend(pv.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]);
pv.Layout.Bullet.prototype._originIsZero=true;pv.Layout.Bullet.prototype.originIsZero=function(b){if(arguments.length)return this._originIsZero=!!b;return this._originIsZero};
pv.Layout.Bullet.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var d=this.parent[/^left|right$/.test(b.orient)?"width":"height"](),f,c=b.maximum,e=b.minimum;if(c==null){f=[].concat(b.ranges,b.markers,b.measures);c=pv.max(f)}else c=+c;if(e==null){f||(f=[].concat(b.ranges,b.markers,b.measures));e=pv.min(f);e=0.95*e}else e=+e;if(e>c||c-e<1.0E-10)e=Math.abs(c)<1.0E-10?-0.1:0.99*c;if(this._originIsZero&&e*c>0)if(e>0)e=0;else c=0;b.minimum=e;b.maximum=c;this.x.domain(e,
c).range(0,d)};pv.Behavior={};
pv.Behavior.dragBase=function(b){function d(p){if(!l){l=true;this.addEventInterceptor("click",h,true)}if(!i){var m=this.root.scene.$g;i=[[m,"mousemove",pv.listen(m,"mousemove",f)],[m,"mouseup",pv.listen(m,"mouseup",c)],[document,"mousemove",pv.listen(document,"mousemove",f)],[document,"mouseup",pv.listen(document,"mouseup",c)]]}var o=arguments[arguments.length-1];j=o.target;k=false;o.stopPropagation();m=this.mouse();var q=this.scene,s=this.index;n=q[s].drag={phase:"start",m:m,m1:m,m2:null,d:p,scene:q,
index:s};o=e(o,n);b.dragstart.call(this,o);o=n.m;if(o!==m){m.x=o.x;m.y=o.y}}function f(p){if(n){n.phase="move";p.stopPropagation();p=e(p,n);var m=n.scene;m.mark.context(m,n.index,function(){var o=n.m2||n.m1,q=this.mouse();if(!(o&&q.distance2(o).dist2<=2)){n.m=n.m2=q;b.drag.call(this,p);o=n.m;if(o!==q){q.x=o.x;q.y=o.y}}})}}function c(p){if(n){n.phase="end";var m=n.m2;m=m&&n.m1.distance2(m).dist2>0.1;n.canceled=!m;(k=m&&j===p.target)||(j=null);p.stopPropagation();p=e(p,n);if(i){i.forEach(function(q){pv.unlisten.apply(pv,
q)});i=null}m=n.scene;var o=n.index;try{m.mark.context(m,o,function(){b.dragend.call(this,p)})}finally{n=null;delete m[o].drag}}}function e(p,m){try{p.drag=m;return p}catch(o){}m={};for(var q in p){var s=p[q];m[q]=typeof s!=="function"?s:g(s,p)}m._sourceEvent=p;return m}function g(p,m){return function(){return p.apply(m,arguments)}}function h(p,m){if(k&&j===m.target){k=false;j=null;return false}}var i,j,k,l,n;b.autoRender=true;b.positionConstraint=null;b.bound=function(p,m){return Math.max(n.min[m],
Math.min(n.max[m],p))};d.autoRender=function(p){if(arguments.length){b.autoRender=!!p;return d}return b.autoRender};d.positionConstraint=function(p){if(arguments.length){b.positionConstraint=p;return d}return b.positionConstraint};return d};
pv.Behavior.drag=function(){var b=null,d=1,f=1,c,e={dragstart:function(h){var i=h.drag;i.type="drag";var j=i.d,k=pv.vector(j.x,j.y);j.fix=k;j.drag=i;c=k.minus(i.m1);k=this.parent;i.max={x:k.width()-(j.dx||0),y:k.height()-(j.dy||0)};i.min={x:0,y:0};e.autoRender&&this.render();pv.Mark.dispatch("dragstart",i.scene,i.index,h)},drag:function(h){var i=h.drag,j=i.d;i.m=c.plus(i.m2);var k=e.positionConstraint;k&&k(i);k=i.m;if(d)j.x=j.fix.x=e.bound(k.x,"x");if(f)j.y=j.fix.y=e.bound(k.y,"y");e.autoRender&&
this.render();pv.Mark.dispatch("drag",i.scene,i.index,h)},dragend:function(h){var i=h.drag,j=i.d;c=j.fix=null;e.autoRender&&this.render();try{pv.Mark.dispatch("dragend",i.scene,i.index,h)}finally{delete j.drag}}},g=pv.Behavior.dragBase(e);g.collapse=function(h){if(arguments.length){b=String(h);switch(b){case "y":d=1;f=0;break;case "x":d=0;f=1;break;default:f=d=1;break}return g}return b};return g};
pv.Behavior.point=function(b){function d(l,n){l=l[n];n={cost:Infinity};for(var p=(l.visible?l.children.length:0)-1;p>=0;p--){var m=l.children[p],o=m.mark,q;if(o.type=="panel"){o.scene=m;for(var s=m.length-1;s>=0;s--){o.index=s;q=d(m,s);if(q.cost<n.cost)n=q}delete o.scene;delete o.index}else if(o.$handlers.point){o=o.mouse();for(s=m.length-1;s>=0;s--){var t=m[s];q=o.x-t.left-(t.width||0)/2;t=o.y-t.top-(t.height||0)/2;var u=h*q*q+i*t*t;if(u<n.cost){n.distance=q*q+t*t;n.cost=u;n.scene=m;n.index=s}}}}return n}
function f(l){var n=d(this.scene,this.index);if(n.cost==Infinity||n.distance>k)n=null;if(e){if(n&&e.scene==n.scene&&e.index==n.index)return;pv.Mark.dispatch("unpoint",e.scene,e.index,l)}if(e=n){pv.Mark.dispatch("point",n.scene,n.index,l);if(!j&&this.type==="panel"){j=this;j.event("mouseout",function(){c.call(j.scene.$g,arguments[arguments.length-1])})}else pv.listen(this.root.canvas(),"mouseout",c)}}function c(l){if(e&&!pv.ancestor(this,l.relatedTarget)){pv.Mark.dispatch("unpoint",e.scene,e.index,
l);e=null}}var e,g=null,h=1,i=1,j=null,k=arguments.length?b*b:900;f.collapse=function(l){if(arguments.length){g=String(l);switch(g){case "y":h=1;i=0;break;case "x":h=0;i=1;break;default:i=h=1;break}return f}return g};return f};
pv.Behavior.select=function(){var b=null,d=1,f=1,c=false,e={dragstart:function(h){var i=h.drag;i.type="select";var j=i.d;j.drag=i;i.max={x:this.width(),y:this.height()};i.min={x:0,y:0};var k=e.positionConstraint;if(k){i.m=i.m.clone();k(i)}k=i.m;if(d){j.x=e.bound(k.x,"x");if(!c)j.dx=0}if(f){j.y=e.bound(k.y,"y");if(!c)j.dy=0}pv.Mark.dispatch("selectstart",i.scene,i.index,h)},drag:function(h){var i=h.drag,j=i.m1,k=i.d;i.max.x=this.width();i.max.y=this.height();var l=e.positionConstraint;if(l){i.m=i.m.clone();
l(i)}l=i.m;if(d){var n=Math.min(j.x,l.x);n=e.bound(n,"x");k.x=n;if(!c){var p=Math.max(l.x,j.x);p=e.bound(p,"x");k.dx=p-n}}if(f){n=Math.min(j.y,l.y);n=e.bound(n,"y");k.y=n;if(!c){j=Math.max(l.y,j.y);j=e.bound(j,"y");k.dy=j-n}}e.autoRender&&this.render();pv.Mark.dispatch("select",i.scene,i.index,h)},dragend:function(h){var i=h.drag;try{pv.Mark.dispatch("selectend",i.scene,i.index,h)}finally{delete i.d.drag}}},g=pv.Behavior.dragBase(e);g.collapse=function(h){if(arguments.length){b=String(h);switch(b){case "y":d=
1;f=0;break;case "x":d=0;f=1;break;default:f=d=1;break}return g}return b};g.preserveLength=function(h){if(arguments.length){c=!!h;return g}return c};return g};
pv.Behavior.resize=function(b){var d=false,f=b==="left"||b==="right",c={dragstart:function(g){var h=g.drag;h.type="resize";var i=h.m1,j=h.d;j.drag=h;switch(b){case "left":i.x=j.x+j.dx;break;case "right":i.x=j.x;break;case "top":i.y=j.y+j.dy;break;case "bottom":i.y=j.y;break}i=this.parent;h.max={x:i.width(),y:i.height()};h.min={x:0,y:0};pv.Mark.dispatch("resizestart",h.scene,h.index,g)},drag:function(g){var h=g.drag,i=h.m1,j=c.positionConstraint;if(j){h.m=h.m.clone();j(h)}var k=h.m;j=h.d;if(!d||f){var l=
Math.min(i.x,k.x),n=Math.max(k.x,i.x);l=c.bound(l,"x");n=c.bound(n,"x");j.x=l;j.dx=n-l}if(!d||!f){l=Math.min(i.y,k.y);i=Math.max(k.y,i.y);c.bound(l,"y");c.bound(i,"y");j.y=l;j.dy=i-l}c.autoRender&&this.render();pv.Mark.dispatch("resize",h.scene,h.index,g)},dragend:function(g){var h=g.drag;max=null;try{pv.Mark.dispatch("resizeend",h.scene,h.index,g)}finally{delete h.d.drag}}},e=pv.Behavior.dragBase(c);e.preserveOrtho=function(g){if(arguments.length){d=!!g;return e}return d};return e};
pv.Behavior.pan=function(){function b(){e=this.index;c=this.scene;h=pv.vector(pv.event.pageX,pv.event.pageY);g=this.transform();i=1/(g.k*this.scale);if(j)j={x:(1-g.k)*this.width(),y:(1-g.k)*this.height()}}function d(k){if(c){c.mark.context(c,e,function(){var l=g.translate((pv.event.pageX-h.x)*i,(pv.event.pageY-h.y)*i);if(j){l.x=Math.max(j.x,Math.min(0,l.x));l.y=Math.max(j.y,Math.min(0,l.y))}this.transform(l).render()});pv.Mark.dispatch("pan",c,e,k)}}function f(){c=null}var c,e,g,h,i,j;b.bound=function(k){if(arguments.length){j=
Boolean(k);return this}return Boolean(j)};pv.listen(window,"mousemove",d);pv.listen(window,"mouseup",f);return b};
pv.Behavior.zoom=function(b){function d(c){var e=this.mouse(),g=pv.event.wheel*b;e=this.transform().translate(e.x,e.y).scale(g<0?1E3/(1E3-g):(1E3+g)/1E3).translate(-e.x,-e.y);if(f){e.k=Math.max(1,e.k);e.x=Math.max((1-e.k)*this.width(),Math.min(0,e.x));e.y=Math.max((1-e.k)*this.height(),Math.min(0,e.y))}this.transform(e).render();pv.Mark.dispatch("zoom",this.scene,this.index,c)}var f;arguments.length||(b=1/48);d.bound=function(c){if(arguments.length){f=Boolean(c);return this}return Boolean(f)};return d};
pv.Geo=function(){};
pv.Geo.projections={mercator:{project:function(b){return{x:b.lng/180,y:b.lat>85?1:b.lat<-85?-1:Math.log(Math.tan(Math.PI/4+pv.radians(b.lat)/2))/Math.PI}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(2*Math.atan(Math.exp(b.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(b){return{x:b.lng/180,y:Math.sin(pv.radians(b.lat))}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(Math.asin(b.y))}}},sinusoidal:{project:function(b){return{x:pv.radians(b.lng)*Math.cos(pv.radians(b.lat))/Math.PI,
y:b.lat/90}},invert:function(b){return{lng:pv.degrees(b.x*Math.PI/Math.cos(b.y*Math.PI/2)),lat:b.y*90}}},aitoff:{project:function(b){var d=pv.radians(b.lng);b=pv.radians(b.lat);var f=Math.acos(Math.cos(b)*Math.cos(d/2));return{x:2*(f?Math.cos(b)*Math.sin(d/2)*f/Math.sin(f):0)/Math.PI,y:2*(f?Math.sin(b)*f/Math.sin(f):0)/Math.PI}},invert:function(b){var d=b.y*Math.PI/2;return{lng:pv.degrees(b.x*Math.PI/2/Math.cos(d)),lat:pv.degrees(d)}}},hammer:{project:function(b){var d=pv.radians(b.lng);b=pv.radians(b.lat);
var f=Math.sqrt(1+Math.cos(b)*Math.cos(d/2));return{x:2*Math.SQRT2*Math.cos(b)*Math.sin(d/2)/f/3,y:Math.SQRT2*Math.sin(b)/f/1.5}},invert:function(b){var d=b.x*3;b=b.y*1.5;var f=Math.sqrt(1-d*d/16-b*b/4);return{lng:pv.degrees(2*Math.atan2(f*d,2*(2*f*f-1))),lat:pv.degrees(Math.asin(f*b))}}},identity:{project:function(b){return{x:b.lng/180,y:b.lat/90}},invert:function(b){return{lng:b.x*180,lat:b.y*90}}}};
pv.Geo.scale=function(b){function d(m){if(!n||m.lng!=n.lng||m.lat!=n.lat){n=m;m=f(m);p={x:j(m.x),y:k(m.y)}}return p}function f(m){return i.project({lng:m.lng-l.lng,lat:m.lat})}function c(m){m=i.invert(m);m.lng+=l.lng;return m}var e={x:0,y:0},g={x:1,y:1},h=[],i=pv.Geo.projections.identity,j=pv.Scale.linear(-1,1).range(0,1),k=pv.Scale.linear(-1,1).range(1,0),l={lng:0,lat:0},n,p;d.x=function(m){return d(m).x};d.y=function(m){return d(m).y};d.ticks={lng:function(m){var o;if(h.length>1){var q=pv.Scale.linear();
if(m==undefined)m=10;o=q.domain(h,function(s){return s.lat}).ticks(m);m=q.domain(h,function(s){return s.lng}).ticks(m)}else{o=pv.range(-80,81,10);m=pv.range(-180,181,10)}return m.map(function(s){return o.map(function(t){return{lat:t,lng:s}})})},lat:function(m){return pv.transpose(d.ticks.lng(m))}};d.invert=function(m){return c({x:j.invert(m.x),y:k.invert(m.y)})};d.domain=function(m,o){if(arguments.length){h=m instanceof Array?arguments.length>1?pv.map(m,o):m:Array.prototype.slice.call(arguments);
if(h.length>1){var q=h.map(function(t){return t.lng}),s=h.map(function(t){return t.lat});l={lng:(pv.max(q)+pv.min(q))/2,lat:(pv.max(s)+pv.min(s))/2};q=h.map(f);j.domain(q,function(t){return t.x});k.domain(q,function(t){return t.y})}else{l={lng:0,lat:0};j.domain(-1,1);k.domain(-1,1)}n=null;return this}return h};d.range=function(m,o){if(arguments.length){if(typeof m=="object"){e={x:Number(m.x),y:Number(m.y)};g={x:Number(o.x),y:Number(o.y)}}else{e={x:0,y:0};g={x:Number(m),y:Number(o)}}j.range(e.x,g.x);
k.range(g.y,e.y);n=null;return this}return[e,g]};d.projection=function(m){if(arguments.length){i=typeof m=="string"?pv.Geo.projections[m]||pv.Geo.projections.identity:m;return this.domain(h)}return m};pv.copyOwn(d,pv.Scale.common);arguments.length&&d.projection(b);return d};

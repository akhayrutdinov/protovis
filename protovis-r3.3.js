// 
var a;if(!Array.prototype.map)Array.prototype.map=function(b,c){for(var e=this.length,d=new Array(e),f=0;f<e;f++)if(f in this)d[f]=b.call(c,this[f],f,this);return d};if(!Array.prototype.filter)Array.prototype.filter=function(b,c){for(var e=this.length,d=[],f=0;f<e;f++)if(f in this){var g=this[f];b.call(c,g,f,this)&&d.push(g)}return d};if(!Array.prototype.forEach)Array.prototype.forEach=function(b,c){for(var e=this.length>>>0,d=0;d<e;d++)d in this&&b.call(c,this[d],d,this)};
if(!Array.prototype.reduce)Array.prototype.reduce=function(b,c){var e=this.length;if(!e&&arguments.length==1)throw new Error("reduce: empty array, no initial value");var d=0;if(arguments.length<2)for(;;){if(d in this){c=this[d++];break}if(++d>=e)throw new Error("reduce: no values, no initial value");}for(;d<e;d++)if(d in this)c=b(c,this[d],d,this);return c};var pv={};pv.version={major:3,minor:3};pv.identity=function(b){return b};pv.index=function(){return this.index};pv.child=function(){return this.childIndex};
pv.parent=function(){return this.parent.index};pv.extend=function(b){function c(){}c.prototype=b.prototype||b;return new c};
pv.parse=function(b){for(var c=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),e,d,f=0,g="";e=c.exec(b);){e=e.index+e[0].length;if(b.charAt(e)!="{"){g+=b.substring(f,e)+"{return ";f=e;for(var h=0;h>=0&&e<b.length;e++){var i=b.charAt(e);switch(i){case '"':case "'":for(;++e<b.length&&(d=b.charAt(e))!=i;)d=="\\"&&e++;break;case "[":case "(":h++;break;case "]":case ")":h--;break;case ";":case ",":h==0&&h--;break}}g+=pv.parse(b.substring(f,--e))+";}";f=e}c.lastIndex=e}g+=b.substring(f);return g};
pv.css=function(b,c){return window.getComputedStyle?window.getComputedStyle(b,null).getPropertyValue(c):b.currentStyle[c]};pv.error=function(b){typeof console==="undefined"||!console.error?alert(b):console.error(b)};pv.listen=function(b,c,e){if(c=="load"||c=="onload")return pv.listenForPageLoad(pv.listener(e));e=pv.listener(e);b.addEventListener?b.addEventListener(c,e,false):b.attachEvent("on"+c,e);return e};
pv.unlisten=function(b,c,e){if(e.$listener)e=e.$listener;b.removeEventListener?b.removeEventListener(c,e,false):b.detachEvent("on"+c,e)};pv.listener=function(b){return b.$listener||(b.$listener=function(c){try{pv.event=c;return b.call(this,c)}catch(e){pv.error(e)}finally{delete pv.event}})};pv.ancestor=function(b,c){for(;c;){if(c==b)return true;c=c.parentNode}return false};pv.scrollOffset=function(b){for(var c=0,e=0;b;){c+=b.scrollLeft||0;e+=b.scrollTop||0;b=b.parentNode}return[c,e]};
pv.listenForPageLoad=function(b){document.readyState==="complete"&&b();if(pv.renderer()=="svgweb")window.addEventListener("SVGLoad",b,false);else if(document.addEventListener)window.addEventListener("load",b,false);else document.attachEvent&&window.attachEvent("onload",b)};pv.renderer=function(){var b=typeof document.svgImplementation!=="undefined"?document.svgImplementation:typeof window.svgweb==="undefined"?"nativesvg":"svgweb";pv.renderer=function(){return b};return b};
pv.id=function(){var b=1;return function(){return b++}}();pv.functor=function(b){return typeof b=="function"?b:function(){return b}};pv.get=function(b,c,e){var d;return b&&(d=b[c])!=null?d:e};pv.renderer()!=="batik"&&pv.listen(window,"load",function(){pv.$={i:0,x:document.getElementsByTagName("script")};for(pv.$.xlen=pv.$.x.length;pv.$.i<pv.$.xlen;pv.$.i++){pv.$.s=pv.$.x[pv.$.i];if(pv.$.s.type=="text/javascript+protovis")try{window.eval(pv.parse(pv.$.s.text))}catch(b){pv.error(b)}}delete pv.$});
pv.Format={};pv.Format.re=function(b){return b.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")};pv.Format.pad=function(b,c,e){c=c-String(e).length;return c<1?e:(new Array(c+1)).join(b)+e};
pv.Format.date=function(b){function c(d){return b.replace(/%[a-zA-Z0-9]/g,function(f){switch(f){case "%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d.getDay()];case "%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][d.getDay()];case "%h":case "%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][d.getMonth()];case "%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()];
case "%c":return d.toLocaleString();case "%C":return e("0",2,Math.floor(d.getFullYear()/100)%100);case "%d":return e("0",2,d.getDate());case "%x":case "%D":return e("0",2,d.getMonth()+1)+"/"+e("0",2,d.getDate())+"/"+e("0",2,d.getFullYear()%100);case "%e":return e(" ",2,d.getDate());case "%H":return e("0",2,d.getHours());case "%I":return(f=d.getHours()%12)?e("0",2,f):12;case "%m":return e("0",2,d.getMonth()+1);case "%M":return e("0",2,d.getMinutes());case "%n":return"\n";case "%p":return d.getHours()<
12?"AM":"PM";case "%T":case "%X":case "%r":f=d.getHours()%12;return(f?e("0",2,f):12)+":"+e("0",2,d.getMinutes())+":"+e("0",2,d.getSeconds())+" "+(d.getHours()<12?"AM":"PM");case "%R":return e("0",2,d.getHours())+":"+e("0",2,d.getMinutes());case "%S":return e("0",2,d.getSeconds());case "%Q":return e("0",3,d.getMilliseconds());case "%t":return"\t";case "%u":return(f=d.getDay())?f:1;case "%w":return d.getDay();case "%y":return e("0",2,d.getFullYear()%100);case "%Y":return d.getFullYear();case "%%":return"%"}return f})}
var e=pv.Format.pad;c.format=c;c.parse=function(d){var f=1970,g=0,h=1,i=0,j=0,k=0,m=[function(){}],l=pv.Format.re(b).replace(/%[a-zA-Z0-9]/g,function(p){switch(p){case "%b":m.push(function(n){g={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[n]});return"([A-Za-z]+)";case "%h":case "%B":m.push(function(n){g={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[n]});return"([A-Za-z]+)";case "%e":case "%d":m.push(function(n){h=
n});return"([0-9]+)";case "%I":case "%H":m.push(function(n){i=n});return"([0-9]+)";case "%m":m.push(function(n){g=n-1});return"([0-9]+)";case "%M":m.push(function(n){j=n});return"([0-9]+)";case "%p":m.push(function(n){if(i==12){if(n=="am")i=0}else if(n=="pm")i=Number(i)+12});return"(am|pm)";case "%S":m.push(function(n){k=n});return"([0-9]+)";case "%y":m.push(function(n){n=Number(n);f=n+(0<=n&&n<69?2E3:n>=69&&n<100?1900:0)});return"([0-9]+)";case "%Y":m.push(function(n){f=n});return"([0-9]+)";case "%%":m.push(function(){});
return"%"}return p});(d=d.match(l))&&d.forEach(function(p,n){m[n](p)});return new Date(f,g,h,i,j,k)};return c};
pv.Format.time=function(b){function c(d){d=Number(d);switch(b){case "short":if(d>=31536E6)return(d/31536E6).toFixed(1)+" years";else if(d>=6048E5)return(d/6048E5).toFixed(1)+" weeks";else if(d>=864E5)return(d/864E5).toFixed(1)+" days";else if(d>=36E5)return(d/36E5).toFixed(1)+" hours";else if(d>=6E4)return(d/6E4).toFixed(1)+" minutes";return(d/1E3).toFixed(1)+" seconds";case "long":var f=[],g=d%36E5/6E4>>0;f.push(e("0",2,d%6E4/1E3>>0));if(d>=36E5){var h=d%864E5/36E5>>0;f.push(e("0",2,g));if(d>=864E5){f.push(e("0",
2,h));f.push(Math.floor(d/864E5).toFixed())}else f.push(h.toFixed())}else f.push(g.toFixed());return f.reverse().join(":")}}var e=pv.Format.pad;c.format=c;c.parse=function(d){switch(b){case "short":for(var f=/([0-9,.]+)\s*([a-z]+)/g,g,h=0;g=f.exec(d);){var i=parseFloat(g[0].replace(",","")),j=0;switch(g[2].toLowerCase()){case "year":case "years":j=31536E6;break;case "week":case "weeks":j=6048E5;break;case "day":case "days":j=864E5;break;case "hour":case "hours":j=36E5;break;case "minute":case "minutes":j=
6E4;break;case "second":case "seconds":j=1E3;break}h+=i*j}return h;case "long":g=d.replace(",","").split(":").reverse();h=0;if(g.length)h+=parseFloat(g[0])*1E3;if(g.length>1)h+=parseFloat(g[1])*6E4;if(g.length>2)h+=parseFloat(g[2])*36E5;if(g.length>3)h+=parseFloat(g[3])*864E5;return h}};return c};
pv.Format.number=function(){function b(o){if(Infinity>g)o=Math.round(o*h)/h;var r=String(Math.abs(o)).split("."),u=r[0];if(u.length>e)u=u.substring(u.length-e);if(k&&u.length<c)u=(new Array(c-u.length+1)).join(i)+u;if(u.length>3)u=u.replace(/\B(?=(?:\d{3})+(?!\d))/g,l);if(!k&&u.length<d)u=(new Array(d-u.length+1)).join(i)+u;r[0]=o<0?p+u+n:u;o=r[1]||"";if(o.length>g)o=r[1]=o.substr(0,g);if(o.length<f)r[1]=o+(new Array(f-o.length+1)).join(j);return r.join(m)}var c=0,e=Infinity,d=0,f=0,g=0,h=1,i="0",
j="0",k=true,m=".",l=",",p="\u2212",n="";b.format=b;b.parse=function(o){var r=pv.Format.re;o=String(o).split(m);if(o.length==1)o[1]="";o[0].replace(new RegExp("^("+r(i)+")*"),"");o[1].replace(new RegExp("("+r(j)+")*$"),"");r=o[0].replace(new RegExp(r(l),"g"),"");if(r.length>e)r=r.substring(r.length-e);o=o[1]?Number("0."+o[1]):0;if(Infinity>g)o=Math.round(o*h)/h;return Math.round(r)+o};b.integerDigits=function(o,r){if(arguments.length){c=Number(o);e=arguments.length>1?Number(r):c;d=c+Math.floor(c/
3)*l.length;return this}return[c,e]};b.fractionDigits=function(o,r){if(arguments.length){f=Number(o);g=arguments.length>1?Number(r):f;h=Math.pow(10,g);return this}return[f,g]};b.integerPad=function(o){if(arguments.length){i=String(o);k=/\d/.test(i);return this}return i};b.fractionPad=function(o){if(arguments.length){j=String(o);return this}return j};b.decimal=function(o){if(arguments.length){m=String(o);return this}return m};b.group=function(o){if(arguments.length){l=o?String(o):"";d=c+Math.floor(c/
3)*l.length;return this}return l};b.negativeAffix=function(o,r){if(arguments.length){p=String(o||"");n=String(r||"");return this}return[p,n]};return b};pv.map=function(b,c){var e={};return c?b.map(function(d,f){e.index=f;return c.call(e,d)}):b.slice()};pv.repeat=function(b,c){if(arguments.length==1)c=2;return pv.blend(pv.range(c).map(function(){return b}))};pv.array=function(b,c){var e=b>=0?new Array(b):[];if(c!==undefined)for(var d=0;d<b;d++)e[d]=c;return e};
pv.cross=function(b,c){for(var e=[],d=0,f=b.length,g=c.length;d<f;d++)for(var h=0,i=b[d];h<g;h++)e.push([i,c[h]]);return e};pv.blend=function(b){return Array.prototype.concat.apply([],b)};
pv.transpose=function(b){var c=b.length,e=pv.max(b,function(h){return h.length});if(e>c){b.length=e;for(var d=c;d<e;d++)b[d]=new Array(c);for(d=0;d<c;d++)for(var f=d+1;f<e;f++){var g=b[d][f];b[d][f]=b[f][d];b[f][d]=g}}else{for(d=0;d<e;d++)b[d].length=c;for(d=0;d<c;d++)for(f=0;f<d;f++){g=b[d][f];b[d][f]=b[f][d];b[f][d]=g}}b.length=e;for(d=0;d<e;d++)b[d].length=c;return b};pv.normalize=function(b,c){b=pv.map(b,c);c=pv.sum(b);for(var e=0;e<b.length;e++)b[e]/=c;return b};
pv.permute=function(b,c,e){if(!e)e=pv.identity;var d=new Array(c.length),f={};c.forEach(function(g,h){f.index=g;d[h]=e.call(f,b[g])});return d};pv.numerate=function(b,c){if(!c)c=pv.identity;var e={},d={};b.forEach(function(f,g){d.index=g;e[c.call(d,f)]=g});return e};pv.uniq=function(b,c){if(!c)c=pv.identity;var e={},d=[],f={},g;b.forEach(function(h,i){f.index=i;g=c.call(f,h);g in e||(e[g]=d.push(g))});return d};pv.naturalOrder=function(b,c){return b<c?-1:b>c?1:0};
pv.reverseOrder=function(b,c){return c<b?-1:c>b?1:0};pv.search=function(b,c,e){if(!e)e=pv.identity;for(var d=0,f=b.length-1;d<=f;){var g=d+f>>1,h=e(b[g]);if(h<c)d=g+1;else if(h>c)f=g-1;else return g}return-d-1};pv.search.index=function(b,c,e){b=pv.search(b,c,e);return b<0?-b-1:b};
pv.range=function(b,c,e){if(arguments.length==1){c=b;b=0}if(e==undefined)e=1;if((c-b)/e==Infinity)throw new Error("range must be finite");var d=[],f=0,g;c-=(c-b)*1.0E-10;if(e<0)for(;(g=b+e*f++)>c;)d.push(g);else for(;(g=b+e*f++)<c;)d.push(g);return d};pv.random=function(b,c,e){if(arguments.length==1){c=b;b=0}if(e==undefined)e=1;return e?Math.floor(Math.random()*(c-b)/e)*e+b:Math.random()*(c-b)+b};
pv.sum=function(b,c){var e={};return b.reduce(c?function(d,f,g){e.index=g;return d+c.call(e,f)}:function(d,f){return d+f},0)};pv.max=function(b,c){if(c==pv.index)return b.length-1;return Math.max.apply(null,c?pv.map(b,c):b)};pv.max.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return b.length-1;if(!c)c=pv.identity;for(var e=0,d=-Infinity,f={},g=0;g<b.length;g++){f.index=g;var h=c.call(f,b[g]);if(h>d){d=h;e=g}}return e};
pv.min=function(b,c){if(c==pv.index)return 0;return Math.min.apply(null,c?pv.map(b,c):b)};pv.min.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return 0;if(!c)c=pv.identity;for(var e=0,d=Infinity,f={},g=0;g<b.length;g++){f.index=g;var h=c.call(f,b[g]);if(h<d){d=h;e=g}}return e};pv.mean=function(b,c){return pv.sum(b,c)/b.length};
pv.median=function(b,c){if(c==pv.index)return(b.length-1)/2;b=pv.map(b,c).sort(pv.naturalOrder);if(b.length%2)return b[Math.floor(b.length/2)];c=b.length/2;return(b[c-1]+b[c])/2};pv.variance=function(b,c){if(b.length<1)return NaN;if(b.length==1)return 0;var e=pv.mean(b,c),d=0,f={};if(!c)c=pv.identity;for(var g=0;g<b.length;g++){f.index=g;var h=c.call(f,b[g])-e;d+=h*h}return d};pv.deviation=function(b,c){return Math.sqrt(pv.variance(b,c)/(b.length-1))};pv.log=function(b,c){return Math.log(b)/Math.log(c)};
pv.logSymmetric=function(b,c){return b==0?0:b<0?-pv.log(-b,c):pv.log(b,c)};pv.logAdjusted=function(b,c){if(!isFinite(b))return b;var e=b<0;if(b<c)b+=(c-b)/c;return e?-pv.log(b,c):pv.log(b,c)};pv.logFloor=function(b,c){return b>0?Math.pow(c,Math.floor(pv.log(b,c))):-Math.pow(c,-Math.floor(-pv.log(-b,c)))};pv.logCeil=function(b,c){return b>0?Math.pow(c,Math.ceil(pv.log(b,c))):-Math.pow(c,-Math.ceil(-pv.log(-b,c)))};
(function(){var b=Math.PI/180,c=180/Math.PI;pv.radians=function(e){return b*e};pv.degrees=function(e){return c*e}})();pv.keys=function(b){var c=[];for(var e in b)c.push(e);return c};pv.entries=function(b){var c=[];for(var e in b)c.push({key:e,value:b[e]});return c};pv.values=function(b){var c=[];for(var e in b)c.push(b[e]);return c};pv.dict=function(b,c){for(var e={},d={},f=0;f<b.length;f++)if(f in b){var g=b[f];d.index=f;e[g]=c.call(d,g)}return e};pv.hasOwnProp=Object.prototype.hasOwnProperty;
pv.copyOwn=function(b,c){if(c){var e=pv.hasOwnProp;for(var d in c)if(e.call(c,d))b[d]=c[d]}return b};pv.dom=function(b){return new pv.Dom(b)};pv.Dom=function(b){this.$map=b};pv.Dom.prototype.$leaf=function(b){return typeof b!="object"};pv.Dom.prototype.leaf=function(b){if(arguments.length){this.$leaf=b;return this}return this.$leaf};
pv.Dom.prototype.root=function(b){function c(f){var g=new pv.Dom.Node;for(var h in f){var i=f[h];g.appendChild(e(i)?new pv.Dom.Node(i):c(i)).nodeName=h}return g}var e=this.$leaf,d=c(this.$map);d.nodeName=b;return d};pv.Dom.prototype.nodes=function(){return this.root().nodes()};pv.Dom.Node=function(b){if(b!==undefined)this.nodeValue=b;this.childNodes=[]};a=pv.Dom.Node.prototype;a.nodeValue=undefined;a.parentNode=null;a.firstChild=null;a.lastChild=null;a.previousSibling=null;a.nextSibling=null;
a._firstDirtyChildIndex=Infinity;a.removeChild=function(b){b=this.childNodes.indexOf(b);if(b===-1)throw new Error("child not found");return this.removeAt(b)};a.appendChild=function(b){var c=b.parentNode;c&&c.removeChild(b);c=this.lastChild;b.parentNode=this;if(b.previousSibling=c){c.nextSibling=b;b._childIndex=c._childIndex+1}else{this.firstChild=b;b._childIndex=0}this.lastChild=b;this.childNodes.push(b);return b};
a.insertBefore=function(b,c){if(!c)return this.appendChild(b);c=this.childNodes.indexOf(c);if(c===-1)throw new Error("child not found");return this.insertAt(b,c)};
a.insertAt=function(b,c){if(c==null)return this.appendChild(b);var e=this.childNodes,d=e.length;if(c===d)return this.appendChild(b);if(c>d)throw new Error("Index out of range.");d=c+1;if(d<this._firstDirtyChildIndex)this._firstDirtyChildIndex=d;(d=b.parentNode)&&d.removeChild(b);e=e[c];b.parentNode=this;b.nextSibling=e;b._childIndex=c;if(d=b.previousSibling=e.previousSibling)d.nextSibling=b;else{if(e===this.lastChild)this.lastChild=b;this.firstChild=b}this.childNodes.splice(c,0,b);return b};
a.removeAt=function(b){var c=this.childNodes,e=c[b];if(e){c.splice(b,1);if(b<c.length)if(b<this._firstDirtyChildIndex)this._firstDirtyChildIndex=b;if(b=e.previousSibling)b.nextSibling=e.nextSibling;else this.firstChild=e.nextSibling;if(b=e.nextSibling)b.previousSibling=e.previousSibling;else this.lastChild=e.previousSibling;delete e.nextSibling;delete e.previousSibling;delete e.parentNode}return e};
a.replaceChild=function(b,c){var e=this.childNodes,d=e.indexOf(c);if(d===-1)throw new Error("child not found");var f=b.parentNode;f&&f.removeChild(b);b.parentNode=this;b.nextSibling=c.nextSibling;b._childIndex=c._childIndex;if(f=b.previousSibling=c.previousSibling)f.nextSibling=b;else this.firstChild=b;if(f=c.nextSibling)f.previousSibling=b;else this.lastChild=b;e[d]=b;return c};
a.childIndex=function(){var b=this.parentNode;if(b){var c=b._firstDirtyChildIndex;if(c<Infinity){var e=b.childNodes;if(c<e.length)for(e=e[c];e;e=e.nextSibling)e._childIndex=c++;delete b._firstDirtyChildIndex}return this._childIndex}return-1};a.visitBefore=function(b){function c(e,d){b(e,d);for(e=e.firstChild;e;e=e.nextSibling)c(e,d+1)}c(this,0)};a.visitAfter=function(b){function c(e,d){for(var f=e.firstChild;f;f=f.nextSibling)c(f,d+1);b(e,d)}c(this,0)};
a.sort=function(b){if(this.firstChild){delete c._firstDirtyChildIndex;this.childNodes.sort(b);var c=this.firstChild=this.childNodes[0],e;delete c.previousSibling;c._childIndex=0;for(var d=1;d<this.childNodes.length;d++){c.sort(b);e=this.childNodes[d];e._childIndex=d;e.previousSibling=c;c=c.nextSibling=e}this.lastChild=c;delete c.nextSibling;c.sort(b)}return this};
a.reverse=function(){var b=[];this.visitAfter(function(c){for(;c.lastChild;)b.push(c.removeChild(c.lastChild));for(var e;e=b.pop();)c.insertBefore(e,c.firstChild)});return this};a.nodes=function(){function b(e){c.push(e);e.childNodes.forEach(b)}var c=[];b(this,c);return c};
a.toggle=function(b){if(b)return this.toggled?this.visitBefore(function(e){e.toggled&&e.toggle()}):this.visitAfter(function(e){e.toggled||e.toggle()});b=this;if(b.toggled){for(var c;c=b.toggled.pop();)b.appendChild(c);delete b.toggled}else if(b.lastChild)for(b.toggled=[];b.lastChild;)b.toggled.push(b.removeChild(b.lastChild))};pv.nodes=function(b){for(var c=new pv.Dom.Node,e=0;e<b.length;e++)c.appendChild(new pv.Dom.Node(b[e]));return c.nodes()};pv.tree=function(b){return new pv.Tree(b)};
pv.Tree=function(b){this.array=b};pv.Tree.prototype.keys=function(b){this.k=b;return this};pv.Tree.prototype.value=function(b){this.v=b;return this};pv.Tree.prototype.map=function(){for(var b={},c={},e=0;e<this.array.length;e++){c.index=e;for(var d=this.array[e],f=this.k.call(c,d),g=b,h=0;h<f.length-1;h++)g=g[f[h]]||(g[f[h]]={});g[f[h]]=this.v?this.v.call(c,d):d}return b};pv.nest=function(b){return new pv.Nest(b)};pv.Nest=function(b){this.array=b;this.keys=[]};a=pv.Nest.prototype;
a.key=function(b){this.keys.push(b);return this};a.sortKeys=function(b){this.keys[this.keys.length-1].order=b||pv.naturalOrder;return this};a.sortValues=function(b){this.order=b||pv.naturalOrder;return this};a.map=function(){for(var b={},c=[],e,d=0;d<this.array.length;d++){var f=this.array[d],g=b;for(e=0;e<this.keys.length-1;e++){var h=this.keys[e](f);g[h]||(g[h]={});g=g[h]}h=this.keys[e](f);if(!g[h]){e=[];c.push(e);g[h]=e}g[h].push(f)}if(this.order)for(e=0;e<c.length;e++)c[e].sort(this.order);return b};
a.entries=function(){function b(e){var d=[];for(var f in e){var g=e[f];d.push({key:f,values:g instanceof Array?g:b(g)})}return d}function c(e,d){var f=this.keys[d].order;f&&e.sort(function(h,i){return f(h.key,i.key)});if(++d<this.keys.length)for(var g=0;g<e.length;g++)c.call(this,e[g].values,d);return e}return c.call(this,b(this.map()),0)};a.rollup=function(b){function c(e){for(var d in e){var f=e[d];if(f instanceof Array)e[d]=b(f);else c(f)}return e}return c(this.map())};pv.flatten=function(b){return new pv.Flatten(b)};
pv.Flatten=function(b){this.map=b;this.keys=[]};pv.Flatten.prototype.key=function(b,c){this.keys.push({name:b,value:c});delete this.$leaf;return this};pv.Flatten.prototype.leaf=function(b){this.keys.length=0;this.$leaf=b;return this};
pv.Flatten.prototype.array=function(){function b(h,i){if(i<d.length-1)for(var j in h){e.push(j);b(h[j],i+1);e.pop()}else c.push(e.concat(h))}var c=[],e=[],d=this.keys,f=this.$leaf;if(f){function g(h,i){if(f(h))c.push({keys:e.slice(),value:h});else for(var j in h){e.push(j);g(h[j],i+1);e.pop()}}g(this.map,0);return c}b(this.map,0);return c.map(function(h){for(var i={},j=0;j<d.length;j++){var k=d[j],m=h[j];i[k.name]=k.value?k.value.call(null,m):m}return i})};
pv.vector=function(b,c){return new pv.Vector(b,c)};pv.Vector=function(b,c){this.x=b;this.y=c};a=pv.Vector.prototype;a.perp=function(){return new pv.Vector(-this.y,this.x)};a.rotate=function(b){var c=Math.cos(b);b=Math.sin(b);return new pv.Vector(c*this.x-b*this.y,b*this.x+c*this.y)};a.norm=function(){var b=this.length();return this.times(b?1/b:1)};a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.times=function(b){return new pv.Vector(this.x*b,this.y*b)};
a.plus=function(b,c){return arguments.length==1?new pv.Vector(this.x+b.x,this.y+b.y):new pv.Vector(this.x+b,this.y+c)};a.minus=function(b,c){return arguments.length==1?new pv.Vector(this.x-b.x,this.y-b.y):new pv.Vector(this.x-b,this.y-c)};a.dot=function(b,c){return arguments.length==1?this.x*b.x+this.y*b.y:this.x*b+this.y*c};pv.Transform=function(){};pv.Transform.prototype={k:1,x:0,y:0};pv.Transform.identity=new pv.Transform;
pv.Transform.prototype.translate=function(b,c){var e=new pv.Transform;e.k=this.k;e.x=this.k*b+this.x;e.y=this.k*c+this.y;return e};pv.Transform.prototype.scale=function(b){var c=new pv.Transform;c.k=this.k*b;c.x=this.x;c.y=this.y;return c};pv.Transform.prototype.invert=function(){var b=new pv.Transform,c=1/this.k;b.k=c;b.x=-this.x*c;b.y=-this.y*c;return b};pv.Transform.prototype.times=function(b){var c=new pv.Transform;c.k=this.k*b.k;c.x=this.k*b.x+this.x;c.y=this.k*b.y+this.y;return c};
pv.Scale=function(){};pv.Scale.interpolator=function(b,c){if(typeof b=="number")return function(e){return e*(c-b)+b};b=pv.color(b).rgb();c=pv.color(c).rgb();return function(e){var d=b.a*(1-e)+c.a*e;if(d<1.0E-5)d=0;return b.a==0?pv.rgb(c.r,c.g,c.b,d):c.a==0?pv.rgb(b.r,b.g,b.b,d):pv.rgb(Math.round(b.r*(1-e)+c.r*e),Math.round(b.g*(1-e)+c.g*e),Math.round(b.b*(1-e)+c.b*e),d)}};
pv.Scale.common={by:function(b){function c(){return e(b.apply(this,arguments))}var e=this;for(var d in e)c[d]=e[d];return c},by1:function(b){function c(f){return e(b.call(this,f))}var e=this;for(var d in e)c[d]=e[d];return c},transform:function(b){function c(){return b.call(this,e.apply(e,arguments))}var e=this;for(var d in e)c[d]=e[d];return c}};
pv.Scale.quantitative=function(){function b(u){return new Date(u)}function c(u){var t=pv.search(e,u);if(t<0)t=-t-2;t=Math.max(0,Math.min(g.length-1,t));return g[t]((j(u)-d[t])/(d[t+1]-d[t]))}var e=[0,1],d=[0,1],f=[0,1],g=[pv.identity],h=Number,i=false,j=pv.identity,k=pv.identity,m=String,l=null,p,n,o,r;c.transform=function(u,t){j=function(s){return i?-u(-s):u(s)};k=function(s){return i?-t(-s):t(s)};d=e.map(j);return this};c.domain=function(u,t,s){if(arguments.length){var q;if(u instanceof Array){if(arguments.length<
2)t=pv.identity;if(arguments.length<3)s=t;q=u.length&&t(u[0]);e=u.length?[pv.min(u,t),pv.max(u,s)]:[]}else{q=u;e=Array.prototype.slice.call(arguments).map(Number)}if(e.length){if(e.length==1)e=[e[0],e[0]]}else e=[-Infinity,Infinity];i=(e[0]||e[e.length-1])<0;d=e.map(j);h=q instanceof Date?b:Number;return this}return e.map(h)};c.range=function(){if(arguments.length){f=Array.prototype.slice.call(arguments);if(f.length){if(f.length==1)f=[f[0],f[0]]}else f=[-Infinity,Infinity];g=[];for(var u=0;u<f.length-
1;u++)g.push(pv.Scale.interpolator(f[u],f[u+1]));return this}return f};c.invert=function(u){var t=pv.search(f,u);if(t<0)t=-t-2;t=Math.max(0,Math.min(g.length-1,t));return h(k(d[t]+(u-f[t])/(f[t+1]-f[t])*(d[t+1]-d[t])))};c.ticks=function(u,t){var s=e[0],q=e[e.length-1],x=q<s,v=x?q:s;q=x?s:q;s=q-v;if(!s||!isFinite(s)){if(h==b)m=pv.Format.date("%x");return[h(v)]}if(h==b){function z(B,D){switch(D){case 31536E6:B.setMonth(0);case 2592E6:B.setDate(1);case 6048E5:D==6048E5&&B.setDate(B.getDate()-B.getDay());
case 864E5:B.setHours(0);case 36E5:B.setMinutes(0);case 6E4:B.setSeconds(0);case 1E3:B.setMilliseconds(0)}}var w,A,y=1;if(s>=15768E7){w=31536E6;t="%Y";A=function(B){B.setFullYear(B.getFullYear()+y)}}else if(s>=1296E7){w=2592E6;t="%m/%Y";A=function(B){B.setMonth(B.getMonth()+y)}}else if(s>=3024E6){w=6048E5;t="%m/%d";A=function(B){B.setDate(B.getDate()+7*y)}}else if(s>=432E6){w=864E5;t="%m/%d";A=function(B){B.setDate(B.getDate()+y)}}else if(s>=18E6){w=36E5;t="%I:%M %p";A=function(B){B.setHours(B.getHours()+
y)}}else if(s>=3E5){w=6E4;t="%I:%M %p";A=function(B){B.setMinutes(B.getMinutes()+y)}}else if(s>=5E3){w=1E3;t="%I:%M:%S";A=function(B){B.setSeconds(B.getSeconds()+y)}}else{w=1;t="%S.%Qs";A=function(B){B.setTime(B.getTime()+y)}}w=n?n:w;t=p?p:t;o=w;m=pv.Format.date(t);v=new Date(v);t=[];z(v,w);s=s/w;if(s>10)switch(w){case 36E5:y=s>20?6:3;v.setHours(Math.floor(v.getHours()/y)*y);break;case 2592E6:y=s>24?3:s>12?2:1;v.setMonth(Math.floor(v.getMonth()/y)*y);break;case 6048E5:y=s>15?3:s>10?2:1;v.setDate(Math.floor(v.getDate()/
(7*y))*7*y);break;case 864E5:y=s>=30?5:s>=15?3:2;v.setDate(Math.floor(v.getDate()/y)*y);break;case 6E4:y=s>30?15:s>15?10:5;v.setMinutes(Math.floor(v.getMinutes()/y)*y);break;case 1E3:y=s>90?15:s>60?10:5;v.setSeconds(Math.floor(v.getSeconds()/y)*y);break;case 1:y=s>1E3?250:s>200?100:s>100?50:s>50?25:5;v.setMilliseconds(Math.floor(v.getMilliseconds()/y)*y);break;default:y=pv.logCeil(s/15,10);if(s/y<2)y/=5;else if(s/y<5)y/=2;v.setFullYear(Math.floor(v.getFullYear()/y)*y);break}if(n){y=1;A=function(B){B.setSeconds(B.getSeconds()+
y*n/1E3)}}for(;;){A(v);if(v>q)break;t.push(new Date(v))}return x?t.reverse():t}if(u==null)u=10;w=pv.get(t,"roundInside",true);A=pv.get(t,"numberExponentMin",-Infinity);t=pv.get(t,"numberExponentMax",+Infinity);var C=Math.floor(pv.log(s/u,10)),E=false;if(C>t){C=t;E=true}else if(C<A){C=A;E=true}y=Math.pow(10,C);s=u/(s/y);if(s<=0.15&&C<t-1)y*=10;else if(s<=0.35)y*=5;else if(s<=0.75)y*=2;C=Math.floor(pv.log(y,10)+1.0E-10);s=y*Math[w?"ceil":"floor"](v/y);q=y*Math[w?"floor":"ceil"](q/y);r=Math.max(0,-C);
m=pv.Format.number().fractionDigits(r);q=pv.range(s,q+y,y);x&&q.reverse();q.roundInside=w;q.step=y;q.exponent=C;q.exponentOverflow=E;q.exponentMin=A;q.exponentMax=t;return q};c.dateTickFormat=function(){if(arguments.length){p=arguments[0];return this}return p};c.dateTickPrecision=function(){if(arguments.length){n=arguments[0];return this}return n};c.tickFormatter=function(u){if(arguments.length){l=u;return this}return l};c.tickFormat=function(u){if(l)return l(u,h!==Number?o:r);return(l||m)(u)};c.nice=
function(){if(e.length!=2)return this;var u=e[0],t=e[e.length-1],s=t<u,q=s?t:u;u=s?u:t;t=u-q;if(!t||!isFinite(t))return this;t=Math.pow(10,Math.round(Math.log(t)/Math.log(10))-1);e=[Math.floor(q/t)*t,Math.ceil(u/t)*t];s&&e.reverse();d=e.map(j);return this};pv.copyOwn(c,pv.Scale.common);c.domain.apply(c,arguments);return c};pv.Scale.linear=function(){var b=pv.Scale.quantitative();b.domain.apply(b,arguments);return b};
pv.Scale.log=function(){var b=pv.Scale.quantitative(1,10),c,e,d=function(g){return Math.log(g)/e},f=function(g){return Math.pow(c,g)};b.ticks=function(){var g=b.domain(),h=g[0]<0,i=Math.floor(h?-d(-g[0]):d(g[0])),j=Math.ceil(h?-d(-g[1]):d(g[1])),k=[];if(h)for(k.push(-f(-i));i++<j;)for(h=c-1;h>0;h--)k.push(-f(-i)*h);else{for(;i<j;i++)for(h=1;h<c;h++)k.push(f(i)*h);k.push(f(i))}for(i=0;k[i]<g[0];i++);for(j=k.length;k[j-1]>g[1];j--);return k.slice(i,j)};b.tickFormat=function(g){return g.toPrecision(1)};
b.nice=function(){var g=b.domain();return b.domain(pv.logFloor(g[0],c),pv.logCeil(g[1],c))};b.base=function(g){if(arguments.length){c=Number(g);e=Math.log(c);b.transform(d,f);return this}return c};b.domain.apply(b,arguments);return b.base(10)};pv.Scale.root=function(){var b=pv.Scale.quantitative();b.power=function(c){if(arguments.length){var e=Number(c),d=1/e;b.transform(function(f){return Math.pow(f,d)},function(f){return Math.pow(f,e)});return this}return e};b.domain.apply(b,arguments);return b.power(2)};
pv.Scale.ordinal=function(){function b(f){f in e||(e[f]=c.push(f)-1);return d[e[f]%d.length]}var c=[],e={},d=[];b.domain=function(f,g){if(arguments.length){f=f instanceof Array?arguments.length>1?pv.map(f,g):f:Array.prototype.slice.call(arguments);c=[];for(var h={},i=0;i<f.length;i++){var j=f[i];if(!(j in h)){h[j]=true;c.push(j)}}e=pv.numerate(c);return this}return c};b.range=function(f,g){if(arguments.length){d=f instanceof Array?arguments.length>1?pv.map(f,g):f:Array.prototype.slice.call(arguments);
if(typeof d[0]=="string")d=d.map(pv.color);return this}return d};b.split=function(f,g){var h=g-f,i=this.domain().length,j=0;if(h===0)d=pv.array(i,f);else if(i){j=(g-f)/i;d=pv.range(f+j/2,g,j)}d.step=j;return this};b.splitBandedCenter=function(f,g,h){b.split(f,g);if(h==null)h=1;d.band=d.step*h;d.margin=d.step-d.band;return this};b.splitBandedFlushCenter=function(f,g,h){if(h==null)h=1;var i=g-f,j=this.domain().length,k=0,m=0,l=0;if(i===0)d=pv.array(j,f);else if(j){m=i*h/j;l=j>1?(i-j*m)/(j-1):0;k=l+
m;d=pv.range(f+m/2,g,k)}d.step=k;d.band=m;d.margin=l;return this};b.splitFlush=function(f,g){var h=this.domain().length,i=(g-f)/(h-1);d=h==1?[(f+g)/2]:pv.range(f,g+i/2,i);return this};b.splitBanded=function(f,g,h){if(arguments.length<3)h=1;if(h<0){var i=this.domain().length;i=(g-f- -h*i)/(i+1);d=pv.range(f+i,g,i-h);d.band=-h}else{i=(g-f)/(this.domain().length+(1-h));d=pv.range(f+i*(1-h),g,i);d.band=i*h;d.step=i;d.margin=i-d.band}return this};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);
return b};
pv.Scale.quantile=function(){function b(h){return g(Math.max(0,Math.min(e,pv.search.index(d,h)-1))/e)}var c=-1,e=-1,d=[],f=[],g=pv.Scale.linear();b.quantiles=function(h){if(arguments.length){c=Number(h);if(c<0){d=[f[0]].concat(f);e=f.length-1}else{d=[];d[0]=f[0];for(var i=1;i<=c;i++)d[i]=f[~~(i*(f.length-1)/c)];e=c-1}return this}return d};b.domain=function(h,i){if(arguments.length){f=h instanceof Array?pv.map(h,i):Array.prototype.slice.call(arguments);f.sort(pv.naturalOrder);b.quantiles(c);return this}return f};
b.range=function(){if(arguments.length){g.range.apply(g,arguments);return this}return g.range()};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);return b};
pv.histogram=function(b,c){var e=true;return{bins:function(d){var f=pv.map(b,c),g=[];arguments.length||(d=pv.Scale.linear(f).ticks());for(var h=0;h<d.length-1;h++){var i=g[h]=[];i.x=d[h];i.dx=d[h+1]-d[h];i.y=0}for(h=0;h<f.length;h++){i=pv.search.index(d,f[h])-1;i=g[Math.max(0,Math.min(g.length-1,i))];i.y++;i.push(b[h])}if(!e)for(h=0;h<g.length;h++)g[h].y/=f.length;return g},frequency:function(d){if(arguments.length){e=Boolean(d);return this}return e}}};
pv.color=function(b){if(b.rgb)return b.rgb();var c=/([a-z]+)\((.*)\)/i.exec(b);if(c){var e=c[2].split(","),d=1;switch(c[1]){case "hsla":case "rgba":d=parseFloat(e[3]);if(!d)return pv.Color.transparent;break}switch(c[1]){case "hsla":case "hsl":b=parseFloat(e[0]);var f=parseFloat(e[1])/100;e=parseFloat(e[2])/100;return(new pv.Color.Hsl(b,f,e,d)).rgb();case "rgba":case "rgb":function g(j){var k=parseFloat(j);return j[j.length-1]=="%"?Math.round(k*2.55):k}f=g(e[0]);var h=g(e[1]),i=g(e[2]);return pv.rgb(f,
h,i,d)}}if(d=pv.Color.names[b])return d;if(b.charAt(0)=="#"){if(b.length==4){f=b.charAt(1);f+=f;h=b.charAt(2);h+=h;i=b.charAt(3);i+=i}else if(b.length==7){f=b.substring(1,3);h=b.substring(3,5);i=b.substring(5,7)}return pv.rgb(parseInt(f,16),parseInt(h,16),parseInt(i,16),1)}return new pv.Color(b,1)};pv.Color=function(b,c){this.color=b;this.opacity=c;this.key="solid "+b+" alpha("+c+")"};pv.Color.prototype.hsl=function(){return this.rgb().hsl()};pv.Color.prototype.brighter=function(b){return this.rgb().brighter(b)};
pv.Color.prototype.darker=function(b){return this.rgb().darker(b)};pv.rgb=function(b,c,e,d){return new pv.Color.Rgb(b,c,e,arguments.length==4?d:1)};pv.Color.Rgb=function(b,c,e,d){pv.Color.call(this,d?"rgb("+b+","+c+","+e+")":"none",d);this.r=b;this.g=c;this.b=e;this.a=d};pv.Color.Rgb.prototype=pv.extend(pv.Color);a=pv.Color.Rgb.prototype;a.red=function(b){return pv.rgb(b,this.g,this.b,this.a)};a.green=function(b){return pv.rgb(this.r,b,this.b,this.a)};
a.blue=function(b){return pv.rgb(this.r,this.g,b,this.a)};a.alpha=function(b){return pv.rgb(this.r,this.g,this.b,b)};a.rgb=function(){return this};a.brighter=function(b){b=Math.pow(0.7,arguments.length?b:1);var c=this.r,e=this.g,d=this.b;if(!c&&!e&&!d)return pv.rgb(30,30,30,this.a);if(c&&c<30)c=30;if(e&&e<30)e=30;if(d&&d<30)d=30;return pv.rgb(Math.min(255,Math.floor(c/b)),Math.min(255,Math.floor(e/b)),Math.min(255,Math.floor(d/b)),this.a)};
a.darker=function(b){b=Math.pow(0.7,arguments.length?b:1);return pv.rgb(Math.max(0,Math.floor(b*this.r)),Math.max(0,Math.floor(b*this.g)),Math.max(0,Math.floor(b*this.b)),this.a)};a.hsl=function(){var b=this.r/255,c=this.g/255,e=this.b/255,d=Math.max(b,c,e),f=Math.min(b,c,e),g=(d+f)/2,h;if(d===f)h=f=0;else{var i=d-f;f=g>0.5?i/(2-d-f):i/(d+f);switch(d){case b:h=(c-e)/i+(c<e?6:0);break;case c:h=(e-b)/i+2;break;case e:h=(b-c)/i+4;break}h/=6}return pv.hsl(h*360,f,g,this.a)};
pv.hsl=function(b,c,e,d){return new pv.Color.Hsl(b,c,e,arguments.length==4?d:1)};pv.Color.Hsl=function(b,c,e,d){pv.Color.call(this,"hsl("+b+","+c*100+"%,"+e*100+"%)",d);this.h=b;this.s=c;this.l=e;this.a=d};pv.Color.Hsl.prototype=pv.extend(pv.Color);a=pv.Color.Hsl.prototype;a.hsl=function(){return this};a.hue=function(b){return pv.hsl(b,this.s,this.l,this.a)};a.saturation=function(b){return pv.hsl(this.h,b,this.l,this.a)};a.lightness=function(b){return pv.hsl(this.h,this.s,b,this.a)};
a.alpha=function(b){return pv.hsl(this.h,this.s,this.l,b)};a.rgb=function(){function b(i){if(i>360)i-=360;else if(i<0)i+=360;if(i<60)return h+(g-h)*i/60;if(i<180)return g;if(i<240)return h+(g-h)*(240-i)/60;return h}function c(i){return Math.round(b(i)*255)}var e=this.h,d=this.s,f=this.l;e%=360;if(e<0)e+=360;d=Math.max(0,Math.min(d,1));f=Math.max(0,Math.min(f,1));var g=f<=0.5?f*(1+d):f+d-f*d,h=2*f-g;return pv.rgb(c(e+120),c(e),c(e-120),this.a)};
pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)};
(function(){var b=pv.Color.names;b.none=b.transparent;for(var c in b)b[c]=pv.color(b[c])})();pv.colors=function(){var b=pv.Scale.ordinal();b.range.apply(b,arguments);return b};pv.Colors={};pv.Colors.category10=function(){var b=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");b.domain.apply(b,arguments);return b};
pv.Colors.category20=function(){var b=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");b.domain.apply(b,arguments);return b};
pv.Colors.category19=function(){var b=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");b.domain.apply(b,arguments);return b};
(function(){function b(l){var p=e(l);if(!p.length)return null;var n=Math.PI,o,r=p[0];if(r.indexOf("to ")===0){if(o=/^to\s+(?:((top|bottom)(?:\s+(left|right))?)|((left|right)(?:\\s+(top|bottom))?))$/.exec(r)){if(o[1]){n=o[2];if(o[3])n+=" "+o[3]}else{n=o[5];if(o[6])n=o[6]+" "+n}n=pv.radians(f[n]);p.shift()}}else{o=parseFloat(r);if(!isNaN(o)){n=o;if(/^.*?deg$/.test(r))n=pv.radians(n);p.shift()}}p=d(p);switch(p.length){case 0:return null;case 1:return new pv.FillStyle.Solid(p[0].color,1)}return new pv.FillStyle.LinearGradient(n,
p,l)}function c(l){var p=e(l);if(!p.length)return null;p=d(p);switch(p.length){case 0:return null;case 1:return new pv.FillStyle.Solid(p[0].color,1)}return new pv.FillStyle.RadialGradient(50,50,p,l)}function e(l){var p={},n=0;l=l.replace(/\b\w+?\(.*?\)/g,function(r){var u="__color"+n++;p[u]=r;return u});var o=l.split(/\s*,\s*/);if(!o.length)return null;n&&o.forEach(function(r,u){if(p.hasOwnProperty(r))o[u]=p[r]});return o}function d(l){function p(w){var A=u.length;if(A){var y=r;w=(w-y)/(A+1);for(var C=
0;C<A;C++){y+=w;u[C].offset=y}u.length=0}}for(var n=[],o=+Infinity,r=-Infinity,u=[],t=0,s=l.length;t<s;){var q=/^(.+?)\s*([+\-]?[e\.\d]+%)?$/i.exec(l[t++]);if(q){var x={color:pv.color(q[1])};q=parseFloat(q[2]);if(isNaN(q))if(n.length){if(t===s)q=Math.max(r,100)}else q=0;n.push(x);if(isNaN(q))u.push(x);else{x.offset=q;p(q);if(q>r)r=q;else if(q<r)q=r;if(q<o)o=q}}}if(n.length>=2&&(o<0||r>100)){var v=[],z=[];n.forEach(function(w){v.push(w.offset);z.push(w.color)});l=pv.scale.linear().domain(v).range(z);
if(o<0){for(;n.length&&n[0].offset<=0;)n.shift();n.unshift({offset:0,color:l(0)})}if(r>100){for(;n.length&&n[n.length-1].offset>=100;)n.pop();n.push({offset:100,color:l(100)})}}return n}pv.fillStyle=function(l){if(l.type)return l;if(l.rgb)return new pv.FillStyle.Solid(l.color,l.opacity);var p=/^\s*([a-z\-]+)\(\s*(.*?)\s*\)\s*$/.exec(l);if(p)switch(p[1]){case "linear-gradient":return b(p[2]);case "radial-gradient":return c(p[2])}return new pv.FillStyle.Solid(pv.color(l))};var f={top:0,"top right":45,
right:90,"bottom right":135,bottom:180,"bottom left":225,left:270,"top left":315},g=pv.FillStyle=function(l){this.key=this.type=l};g.prototype=new pv.Color("none",1);g.prototype.rgb=function(){var l=pv.color(this.color);if(this.opacity!==l.opacity)l=l.alpha(this.opacity);return l};var h=pv.FillStyle.Solid=function(l,p){g.call(this,"solid");if(l.rgb){this.color=l.color;this.opacity=l.opacity}else{this.color=l;this.opacity=p}this.key+=" "+this.color+" alpha("+this.opacity+")"};h.prototype=pv.extend(pv.FillStyle);
h.prototype.alpha=function(l){return new h(this.color,l)};h.prototype.brighter=function(l){return new h(this.rgb().brighter(l))};h.prototype.darker=function(l){return new h(this.rgb().darker(l))};pv.FillStyle.transparent=new h(pv.Color.transparent);var i=0,j=pv.FillStyle.Gradient=function(l,p){g.call(this,l);this.id=++i;this.stops=p;if(p.length)this.color=p[0].color.color;this.key+=" stops("+p.map(function(n){var o=n.color;return o.color+" alpha("+o.opacity+") at("+n.offset+")"}).join(", ")+")"};
j.prototype=pv.extend(pv.FillStyle);j.prototype.rgb=function(){return this.stops.length?this.stops[0].color:undefined};j.prototype.alpha=function(l){return this._clone(this.stops.map(function(p){return{offset:p.offset,color:p.color.alpha(l)}}))};j.prototype.darker=function(l){return this._clone(this.stops.map(function(p){return{offset:p.offset,color:p.color.darker(l)}}))};j.prototype.brighter=function(l){return this._clone(this.stops.map(function(p){return{offset:p.offset,color:p.color.brighter(l)}}))};
var k=pv.FillStyle.LinearGradient=function(l,p){j.call(this,"lineargradient",p);this.angle=l;this.key+=" angle("+l+")"};k.prototype=pv.extend(j);k.prototype._clone=function(l){return new k(this.angle,l)};var m=pv.FillStyle.RadialGradient=function(l,p,n){j.call(this,"radialgradient",n);this.cx=l;this.cy=p;this.key+=" center("+l+","+p+")"};m.prototype=pv.extend(j);m.prototype._clone=function(){return new m(this.cx,this.cy)}})();pv.ramp=function(){var b=pv.Scale.linear();b.range.apply(b,arguments);return b};
pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter",
"stroke-linecap":"butt","stroke-miterlimit":8,"stroke-dasharray":"none"},css:{font:"10px sans-serif"}}};pv.SvgScene.updateAll=function(b){if(b.length&&b[0].reverse&&b.type!="line"&&b.type!="area"){for(var c=pv.extend(b),e=0,d=b.length-1;d>=0;e++,d--)c[e]=b[d];b=c}this.removeSiblings(this[b.type](b))};pv.SvgScene.create=function(b){return document.createElementNS(this.svg,b)};
pv.SvgScene.expect=function(b,c,e,d,f,g){if(b){e=b.tagName;if(e==="defs")b=b.nextSibling;if(e==="a")b=b.firstChild;if(e!==c){c=this.create(c);b.parentNode.replaceChild(c,b);b=c}}else b=this.create(c);f&&this.setAttributes(b,f);g&&this.setStyle(b,g);return b};pv.SvgScene.setAttributes=function(b,c){var e=this.implicit.svg;for(var d in c){var f=c[d];f==null||f==e[d]?b.removeAttribute(d):b.setAttribute(d,f)}};
pv.SvgScene.setStyle=function(b,c){var e=this.implicit.css;switch(pv.renderer()){case "batik":for(var d in c){var f=c[d];f==null||f==e[d]?b.removeAttribute(d):b.style.setProperty(d,f)}break;case "svgweb":for(d in c){f=c[d];f==null||f==e[d]||(b.style[d]=f)}break;default:for(d in c){f=c[d];if(f==null||f==e[d])b.style.removeProperty(d);else b.style[d]=f}}};pv.SvgScene.append=function(b,c,e){b.$scene={scenes:c,index:e};b=this.title(b,c[e]);b.parentNode||c.$g.appendChild(b);return b.nextSibling};
pv.SvgScene.title=function(b,c){var e=b.parentNode;if(e&&e.tagName!="a")e=null;if(c.title){if(!e){e=this.create("a");e.setAttributeNS(this.xlink,"xlink:href","");b.parentNode&&b.parentNode.replaceChild(e,b);e.appendChild(b)}e.setAttributeNS(this.xlink,"xlink:title",c.title);for(var d=null,f=b.firstChild;f!=null;f=f.nextSibling)if(f.nodeName=="title"){d=f;break}if(d)d.removeChild(d.firstChild);else{d=this.create("title");b.appendChild(d)}pv.renderer()=="svgweb"?d.appendChild(document.createTextNode(c.title,
true)):d.appendChild(document.createTextNode(c.title));return e}e&&e.parentNode.replaceChild(b,e);return b};pv.SvgScene.dispatch=pv.listener(function(b){var c=b.target.$scene;if(c){var e=b.type;switch(e){case "DOMMouseScroll":e="mousewheel";b.wheel=-480*b.detail;break;case "mousewheel":b.wheel=(window.opera?12:1)*b.wheelDelta;break}pv.Mark.dispatch(e,c.scenes,c.index,b)&&b.preventDefault()}});
pv.SvgScene.removeSiblings=function(b){for(;b;){var c=b.nextSibling;b.nodeName!=="defs"&&b.parentNode.removeChild(b);b=c}};pv.SvgScene.undefined=function(){};pv.SvgScene.removeFillStyleDefinitions=function(b){b=b.$g.getElementsByTagName("defs");if(b.length===1){b=b[0];for(var c=b.firstChild;c;){var e=c.nextSibling;if(c.nodeName=="linearGradient"||c.nodeName=="radialGradient")b.removeChild(c);c=e}}};
(function(){var b={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},c={shortdash:[3,1],shortdot:[1,1],shortdashdot:[3,1,1,1],shortdashdotdot:[3,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};pv.SvgScene.isStandardDashStyle=function(e){return c.hasOwnProperty(e)};pv.SvgScene.translateDashStyleAlias=function(e){return b.hasOwnProperty(e)?
b[e]:e};pv.SvgScene.parseDasharray=function(e){var d=e.strokeDasharray;if(d&&d!=="none"){d=this.translateDashStyleAlias(d);var f=c[d];d=f?f:d.split(/[\s,]+/);var g=e.lineWidth,h=(e.lineCap||"butt")==="butt";d=d.map(function(i,j){i=+i;if(!h)if(j%2)i++;else i-=1;if(i<=0)i=0.001;return i*g/this.scale},this).join(" ")}else d=null;return d}})();
(function(){function b(e){return Math.abs(e)<=1.0E-12?0:e}var c=0;pv.SvgScene.addFillStyleDefinition=function(e,d){if(!(!d.type||d.type==="solid")){var f=d.type==="lineargradient";if(f||d.type==="radialgradient"){var g=e.$g;e=g.getElementsByTagName("defs");g=e.length?e[0]:g.appendChild(this.create("defs"));var h="__pv_gradient"+d.id;e=undefined;if(!e){e="__pv_gradient"+d.id+"_inst_"+ ++c;g=g.appendChild(this.create(f?"linearGradient":"radialGradient"));g.setAttribute("id",e);g.setAttribute("class",
h);if(f){h=d.angle-Math.PI/2;f=Math.abs(h%(Math.PI/2))-Math.PI/4;var i=Math.abs(Math.SQRT2/2*Math.cos(f));f=i*Math.cos(h);var j=i*Math.sin(h);h=b(0.5-f);i=b(0.5-j);f=b(0.5+f);j=b(0.5+j);g.setAttribute("x1",h);g.setAttribute("y1",i);g.setAttribute("x2",f);g.setAttribute("y2",j)}f=d.stops;h=0;for(i=f.length;h<i;h++){j=f[h];var k=g.appendChild(this.create("stop")),m=j.color;k.setAttribute("offset",j.offset+"%");k.setAttribute("stop-color",m.color);k.setAttribute("stop-opacity",m.opacity+"")}d.color=
"url(#"+e+")"}}}}})();
pv.SvgScene.pathBasis=function(){function b(d,f,g,h,i){return{x:d[0]*f.left+d[1]*g.left+d[2]*h.left+d[3]*i.left,y:d[0]*f.top+d[1]*g.top+d[2]*h.top+d[3]*i.top}}var c=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],e=function(d,f,g,h){var i=b(c[1],d,f,g,h),j=b(c[2],d,f,g,h);d=b(c[3],d,f,g,h);return"C"+i.x+","+i.y+","+j.x+","+j.y+","+d.x+","+d.y};e.segment=function(d,f,g,h){var i=b(c[0],d,f,g,h),j=b(c[1],d,f,g,h),k=b(c[2],d,f,g,h);d=b(c[3],d,f,g,h);return["M"+i.x+","+i.y,"C"+j.x+","+j.y+
","+k.x+","+k.y+","+d.x+","+d.y]};return e}();pv.SvgScene.curveBasis=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";d="";var f=b[c],g=f,h=f,i=b[c+1];d+=this.pathBasis(f,g,h,i);for(c=c+2;c<=e;c++){f=g;g=h;h=i;i=b[c];d+=this.pathBasis(f,g,h,i)}d+=this.pathBasis(g,h,i,i);d+=this.pathBasis(h,i,i,i);return d};
pv.SvgScene.curveBasisSegments=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";d=[];var f=b[c],g=f,h=f,i=b[c+1],j=this.pathBasis.segment(f,g,h,i);f=g;g=h;h=i;i=b[c+2];j[1]+=this.pathBasis(f,g,h,i);d.push(j);for(c=c+3;c<=e;c++){f=g;g=h;h=i;i=b[c];d.push(this.pathBasis.segment(f,g,h,i))}b=this.pathBasis.segment(g,h,i,i);b[1]+=this.pathBasis(h,i,i,i);d.push(b);return d};
pv.SvgScene.curveHermite=function(b,c,e,d){var f;if(e==null){f=b.length;e=0}else f=d-e+1;d=c.length;if(d<1||f!==d&&f!==d+2)return"";var g=f!==d;f="";var h=b[e],i=b[e+1],j=c[0],k=j,m=e+1;if(g){f+="Q"+(i.left-j.x*2/3)+","+(i.top-j.y*2/3)+","+i.left+","+i.top;h=b[e+1];m=e+2}if(d>1){k=c[1];i=b[m];m++;f+="C"+(h.left+j.x)+","+(h.top+j.y)+","+(i.left-k.x)+","+(i.top-k.y)+","+i.left+","+i.top;for(e=2;e<d;e++,m++){i=b[m];k=c[e];f+="S"+(i.left-k.x)+","+(i.top-k.y)+","+i.left+","+i.top}}if(g){b=b[m];f+="Q"+
(i.left+k.x*2/3)+","+(i.top+k.y*2/3)+","+b.left+","+b.top}return f};
pv.SvgScene.curveHermiteSegments=function(b,c,e,d){var f;if(e==null){f=b.length;e=0}else f=d-e+1;d=c.length;if(d<1||f!==d&&f!==d+2)return[];var g=f!==d;f=[];var h=b[e],i=h,j=c[0],k=j,m=e+1;if(g){i=b[e+1];f.push(["M"+h.left+","+h.top,"Q"+(i.left-k.x*2/3)+","+(i.top-k.y*2/3)+","+i.left+","+i.top]);m=e+2}for(e=1;e<d;e++,m++){h=i;j=k;i=b[m];k=c[e];f.push(["M"+h.left+","+h.top,"C"+(h.left+j.x)+","+(h.top+j.y)+","+(i.left-k.x)+","+(i.top-k.y)+","+i.left+","+i.top])}if(g){b=b[m];f.push(["M"+i.left+","+i.top,
"Q"+(i.left+k.x*2/3)+","+(i.top+k.y*2/3)+","+b.left+","+b.top])}return f};pv.SvgScene.cardinalTangents=function(b,c,e,d){if(e==null){d=b.length;e=0;d=d-1}var f=[];c=(1-c)/2;var g=b[e],h=b[e+1],i=b[e+2];for(e=e+3;e<=d;e++){f.push({x:c*(i.left-g.left),y:c*(i.top-g.top)});g=h;h=i;i=b[e]}f.push({x:c*(i.left-g.left),y:c*(i.top-g.top)});return f};
pv.SvgScene.curveCardinal=function(b,c,e,d){var f;if(e==null){f=b.length;e=0;d=f-1}else f=d-e+1;if(f<=2)return"";return this.curveHermite(b,this.cardinalTangents(b,c,e,d),e,d)};pv.SvgScene.curveCardinalSegments=function(b,c,e,d){var f;if(e==null){f=b.length;e=0;d=f-1}else f=d-e+1;if(f<=2)return"";return this.curveHermiteSegments(b,this.cardinalTangents(b,c,e,d),e,d)};
pv.SvgScene.monotoneTangents=function(b,c,e){if(c==null){e=b.length;c=0}else e=e-c+1;var d=[],f=[],g=[],h=[],i=0,j;for(i=0;i<e-1;i++){j=c+i;f[i]=(b[j+1].top-b[j].top)/(b[j+1].left-b[j].left)}g[0]=f[0];h[0]=b[c+1].left-b[c].left;i=1;for(j=c+i;i<e-1;i++,j++){g[i]=(f[i-1]+f[i])/2;h[i]=(b[j+1].left-b[j-1].left)/2}g[i]=f[i-1];h[i]=b[j].left-b[j-1].left;for(i=0;i<e-1;i++)if(f[i]==0){g[i]=0;g[i+1]=0}for(i=0;i<e-1;i++)if(!(Math.abs(g[i])<1.0E-5||Math.abs(g[i+1])<1.0E-5)){b=g[i]/f[i];c=g[i+1]/f[i];j=b*b+c*
c;if(j>9){j=3/Math.sqrt(j);g[i]=j*b*f[i];g[i+1]=j*c*f[i]}}for(i=0;i<e;i++){f=1+g[i]*g[i];d.push({x:h[i]/3/f,y:g[i]*h[i]/3/f})}return d};pv.SvgScene.curveMonotone=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";return this.curveHermite(b,this.monotoneTangents(b,c,e),c,e)};pv.SvgScene.curveMonotoneSegments=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";return this.curveHermiteSegments(b,this.monotoneTangents(b,c,e),c,e)};
pv.SvgScene.area=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);var e=b.length;if(!e)return c;var d=b[0];if(d.segmented==="smart")return this.areaSegmentedSmart(c,b);if(d.segmented)return this.areaSegmentedFull(c,b);return this.areaFixed(c,b,0,e-1,true)};
pv.SvgScene.areaFixed=function(b,c,e,d,f){if(d-e+1===1)return this.lineAreaDot(b,c,e);var g=c[e];if(!g.visible)return b;var h=g.fillStyle,i=g.strokeStyle;if(!h.opacity&&!i.opacity)return b;this.addFillStyleDefinition(c,h);this.addFillStyleDefinition(c,i);var j=false,k=false,m=false,l=false,p=false;switch(g.interpolate){case "basis":j=true;break;case "cardinal":k=true;break;case "monotone":m=true;break;case "step-after":l=true;break;case "step-before":p=true;break}k=j||k||m;j=[];var n;for(m=e;m<=d;m++){n=
c[m];if(n.width||n.height){for(var o=m+1;o<=d;o++){n=c[o];if(!n.width&&!n.height)break}m>e&&!l&&m--;o<=d&&!p&&o++;j.push((k&&o-m>2?this.areaPathCurve:this.areaPathStraight).call(this,c,m,o-1,g));m=o-1}}if(!j.length)return b;d=i.opacity;b=this.expect(b,"path",c,e,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":f?g.events:"none",cursor:g.cursor,d:"M"+j.join("ZM")+"Z",fill:h.color,"fill-opacity":h.opacity||null,stroke:i.color,"stroke-opacity":d||null,"stroke-width":d?g.lineWidth/this.scale:
null,"stroke-linecap":g.lineCap,"stroke-linejoin":g.lineJoin,"stroke-miterlimit":g.strokeMiterLimit,"stroke-dasharray":d?this.parseDasharray(g):null});g.svg&&this.setAttributes(b,g.svg);g.css&&this.setStyle(b,g.css);return this.append(b,c,e)};
pv.SvgScene.areaSegmentedSmart=function(b,c){var e=c.mark.$hasHandlers?[]:null;b=this.eachLineAreaSegment(b,c,function(d,f,g,h){var i=this.areaSegmentPaths(f,g,h),j=i.top,k=i.bottom;e&&e.push(i);return this.eachLineAreaSegment(d,f,{breakOnKeyChange:true,from:g,to:h},function(m,l,p,n){var o=l[p],r=o.fillStyle,u=o.strokeStyle;this.addFillStyleDefinition(l,r);this.addFillStyleDefinition(l,u);if(p===n)return this.lineAreaDotAlone(m,l,p);n=this.areaJoinPaths(j,k,p-p,n-p-1);var t=u.opacity;r={"shape-rendering":o.antialias?
null:"crispEdges","pointer-events":"none",cursor:o.cursor,d:n,fill:r.color,"fill-opacity":r.opacity||null,stroke:u.color,"stroke-opacity":t||null,"stroke-width":t?o.lineWidth/this.scale:null,"stroke-linecap":o.lineCap,"stroke-linejoin":o.lineJoin,"stroke-miterlimit":o.strokeMiterLimit,"stroke-dasharray":t?this.parseDasharray(o):null};m=this.expect(m,"path",l,p,r,o.css);return this.append(m,l,p)})});e&&e.forEach(function(d){var f=d.from,g=d.top,h=d.bottom,i=g.length,j={"shape-rendering":"crispEdges",
fill:"rgb(127,127,127)","fill-opacity":0.005,stroke:null};g.forEach(function(k,m){var l=f+m,p=c[l],n=p.events;if(n&&n!=="none"){m=h[i-m-1];var o=Object.create(j);o["pointer-events"]=n;o.cursor=p.cursor;o.d=k+"L"+m[0].substr(1)+m[1]+"Z";b=this.expect(b,"path",c,l,o);b=this.append(b,c,l)}},this)},this);return b};pv.SvgScene.areaSegmentPaths=function(b,c,e){return this.areaSegmentCurvePaths(b,c,e)||this.areaSegmentStraightPaths(b,c,e)};
pv.SvgScene.areaSegmentCurvePaths=function(b,c,e){var d=e-c+1,f=b[c],g=f.interpolate==="basis",h=!g&&f.interpolate==="cardinal";if(g||h||f.interpolate=="monotone"){for(var i=[],j=[],k=0;k<d;k++){var m=b[e-k];i.push(b[c+k]);j.push({left:m.left+m.width,top:m.top+m.height})}if(g){b=this.curveBasisSegments(i);f=this.curveBasisSegments(j)}else if(h){b=this.curveCardinalSegments(i,f.tension);f=this.curveCardinalSegments(j,f.tension)}else{b=this.curveMonotoneSegments(i);f=this.curveMonotoneSegments(j)}if(b||
b.length)return{from:c,top:b,bottom:f}}};pv.SvgScene.areaSegmentStraightPaths=function(b,c,e){for(var d=[],f=[],g=e,h=c;c<g;c++,e--){var i=b[c],j=b[e],k=["M"+i.left+","+i.top];j=["M"+(j.left+j.width)+","+(j.top+j.height)];var m=b[c+1],l=b[e-1];switch(i.interpolate){case "step-before":k.push("V"+m.top+"H"+m.left);break;case "step-after":k.push("H"+m.left+"V"+m.top);break;default:k.push("L"+m.left+","+m.top)}j.push("L"+(l.left+l.width)+","+(l.top+l.height));d.push(k);f.push(j)}return{from:h,top:d,bottom:f}};
pv.SvgScene.areaJoinPaths=function(b,c,e,d){for(var f="",g="",h=e,i=b.length-1-d;h<=d;h++,i++){var j=b[h],k=c[i];if(h===e){j=j.join("");k="L"+k[0].substr(1)+k[1]}else{j=j[1];k=k[1]}f+=j;g+=k}return f+g+"Z"};
pv.SvgScene.areaSegmentedFull=function(b,c){var e=c.length,d,f,g=this.areaSegmentCurvePaths(c,0,e-1);if(g){d=g.top;f=g.bottom}for(g=0;g<e-1;g++){var h=c[g],i=c[g+1];if(h.visible&&i.visible){var j=h.fillStyle,k=h.strokeStyle;if(j.opacity||k.opacity){if(d){i=d[g].join("");var m="L"+f[e-g-2].join("").substr(1);i=i+m+"Z"}else{m=h;var l=i;switch(h.interpolate){case "step-before":m=i;break;case "step-after":l=h;break}i="M"+h.left+","+m.top+"L"+i.left+","+l.top+"L"+(i.left+i.width)+","+(l.top+l.height)+
"L"+(h.left+h.width)+","+(m.top+m.height)+"Z"}b=this.expect(b,"path",c,g,{"shape-rendering":h.antialias?null:"crispEdges","pointer-events":h.events,cursor:h.cursor,d:i,fill:j.color,"fill-opacity":j.opacity||null,stroke:k.color,"stroke-opacity":k.opacity||null,"stroke-width":k.opacity?h.lineWidth/this.scale:null});h.svg&&this.setAttributes(b,h.svg);h.css&&this.setStyle(b,h.css);b=this.append(b,c,g)}}}return b};
pv.SvgScene.areaPathStraight=function(b,c,e,d){for(var f=[],g=[],h=e;c<=h;c++,e--){var i=b[c],j=b[e];i=i.left+","+i.top;j=j.left+j.width+","+(j.top+j.height);if(c<h){var k=b[c+1],m=b[e-1];switch(d.interpolate){case "step-before":i+="V"+k.top;j+="H"+(m.left+m.width);break;case "step-after":i+="H"+k.left;j+="V"+(m.top+m.height);break}}f.push(i);g.push(j)}return f.concat(g).join("L")};
pv.SvgScene.areaPathCurve=function(b,c,e,d){for(var f=[],g=[],h=e;c<=h;c++,e--){var i=b[e];f.push(b[c]);g.push({left:i.left+i.width,top:i.top+i.height})}switch(d.interpolate){case "basis":b=this.curveBasis(f);d=this.curveBasis(g);break;case "cardinal":b=this.curveCardinal(f,d.tension);d=this.curveCardinal(g,d.tension);break;default:b=this.curveMonotone(f);d=this.curveMonotone(g)}return f[0].left+","+f[0].top+b+"L"+g[0].left+","+g[0].top+d};pv.SvgScene.minBarWidth=1;pv.SvgScene.minBarHeight=1;
pv.SvgScene.minBarLineWidth=0.2;
pv.SvgScene.bar=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var e=0;e<b.length;e++){var d=b[e];if(!(!d.visible||Math.abs(d.width)<=1.0E-10||Math.abs(d.height)<=1.0E-10)){if(d.width<this.minBarWidth)d.width=this.minBarWidth;if(d.height<this.minBarHeight)d.height=this.minBarHeight;var f=d.fillStyle,g=d.strokeStyle;if(f.opacity||g.opacity){f.type&&f.type!=="solid"&&this.addFillStyleDefinition(b,f);g.type&&g.type!="solid"&&this.addFillStyleDefinition(b,g);var h;if(g.opacity){h=
d.lineWidth;h=h<1.0E-10?0:Math.max(this.minBarLineWidth,h/this.scale)}else h=null;c=this.expect(c,"rect",b,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1.0E-10,d.width),height:Math.max(1.0E-10,d.height),fill:f.color,"fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":h,"stroke-linecap":d.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(d):null});d.svg&&this.setAttributes(c,
d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,e)}}}return c};
pv.SvgScene.dot=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var e=0;e<b.length;e++){var d=b[e];if(d.visible){var f=d.fillStyle,g=d.strokeStyle;if(f.opacity||g.opacity){f.type&&f.type!=="solid"&&this.addFillStyleDefinition(b,f);g.type&&g.type!="solid"&&this.addFillStyleDefinition(b,g);var h=d.shapeRadius,i=null;switch(d.shape){case "cross":i="M"+-h+","+-h+"L"+h+","+h+"M"+h+","+-h+"L"+-h+","+h;break;case "triangle":i=h;var j=h*1.1547;i="M0,"+i+"L"+j+","+-i+" "+-j+","+-i+
"Z";break;case "diamond":h*=Math.SQRT2;i="M0,"+-h+"L"+h+",0 0,"+h+" "+-h+",0Z";break;case "square":i="M"+-h+","+-h+"L"+h+","+-h+" "+h+","+h+" "+-h+","+h+"Z";break;case "tick":i="M0,0L0,"+-d.shapeSize;break;case "bar":i="M0,"+d.shapeSize/2+"L0,"+-(d.shapeSize/2);break}f={"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,fill:f.color,"fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":g.opacity?d.lineWidth/this.scale:
null,"stroke-linecap":d.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(d):null};if(i){f.transform="translate("+d.left+","+d.top+")";if(d.shapeAngle)f.transform+=" rotate("+180*d.shapeAngle/Math.PI+")";f.d=i;c=this.expect(c,"path",b,e,f)}else{f.cx=d.left;f.cy=d.top;f.r=h;c=this.expect(c,"circle",b,e,f)}d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,e)}}}return c};
pv.SvgScene.image=function(b){for(var c=b.$g.firstChild,e=0;e<b.length;e++){var d=b[e];if(d.visible){c=this.fill(c,b,e);if(d.image){c=this.expect(c,"foreignObject",b,e,{cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);var f=c.firstChild||c.appendChild(document.createElementNS(this.xhtml,"canvas"));f.$scene={scenes:b,index:e};f.style.width=d.width;f.style.height=d.height;f.width=d.imageWidth;f.height=d.imageHeight;f.getContext("2d").putImageData(d.image,
0,0)}else{c=this.expect(c,"image",b,e,{preserveAspectRatio:"none",cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c.setAttributeNS(this.xlink,"xlink:href",d.url)}c=this.append(c,b,e);c=this.stroke(c,b,e)}}return c};
pv.SvgScene.label=function(b){for(var c=b.$g.firstChild,e=0;e<b.length;e++){var d=b[e];if(d.visible){var f=d.textStyle;if(f.opacity&&d.text){var g=0,h=0,i=0,j="start";switch(d.textBaseline){case "middle":if(pv.renderer()=="svgweb")h=3;else i=".35em";break;case "top":if(pv.renderer()=="svgweb")h=9+d.textMargin;else{i=".71em";h=d.textMargin}break;case "bottom":h="-"+d.textMargin;break}switch(d.textAlign){case "right":j="end";g="-"+d.textMargin;break;case "center":j="middle";break;case "left":g=d.textMargin;
break}c=this.expect(c,"text",b,e,{"pointer-events":d.events,cursor:d.cursor,x:g,y:h,dy:i,transform:"translate("+d.left+","+d.top+")"+(d.textAngle?" rotate("+180*d.textAngle/Math.PI+")":"")+(this.scale!=1?" scale("+1/this.scale+")":""),fill:f.color,"fill-opacity":f.opacity||null,"text-anchor":j},{font:d.font,"text-shadow":d.textShadow,"text-decoration":d.textDecoration});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);if(c.firstChild)c.firstChild.nodeValue=d.text;else pv.renderer()==
"svgweb"?c.appendChild(document.createTextNode(d.text,true)):c.appendChild(document.createTextNode(d.text));c=this.append(c,b,e)}}}return c};pv.SvgScene.line=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);var e=b.length;if(!e)return c;var d=b[0];if(d.segmented==="smart")return this.lineSegmentedSmart(c,b);if(e<2)return c;if(d.segmented)return this.lineSegmentedFull(c,b);return this.lineFixed(c,b)};
pv.SvgScene.lineFixed=function(b,c){var e=c.length;if(e===1)return this.lineAreaDotAlone(b,c,0);var d=c[0];if(!d.visible)return b;var f=d.fillStyle,g=d.strokeStyle;if(!f.opacity&&!g.opacity)return b;this.addFillStyleDefinition(c,f);this.addFillStyleDefinition(c,g);var h="M"+d.left+","+d.top,i=e>2;if(i)switch(d.interpolate){case "basis":h+=this.curveBasis(c);break;case "cardinal":h+=this.curveCardinal(c,d.tension);break;case "monotone":h+=this.curveMonotone(c);break;default:i=false}if(!i)for(i=1;i<
e;i++)h+=this.lineSegmentPath(c[i-1],c[i]);e=g.opacity;f={"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,d:h,fill:f.color,"fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":e||null,"stroke-width":e?d.lineWidth/this.scale:null,"stroke-linecap":d.lineCap,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,"stroke-dasharray":e?this.parseDasharray(d):null};b=this.expect(b,"path",c,0,f,d.css);d.svg&&this.setAttributes(b,d.svg);return this.append(b,
c,0)};
pv.SvgScene.lineSegmentedSmart=function(b,c){var e=c.mark.$hasHandlers?[]:null;b=this.eachLineAreaSegment(b,c,function(d,f,g,h){var i=this.lineSegmentPaths(f,g,h);e&&e.push({from:g,paths:i});return this.eachLineAreaSegment(d,f,{breakOnKeyChange:true,from:g,to:h},function(j,k,m,l){var p=k[m],n=p.fillStyle;this.addFillStyleDefinition(k,n);var o=p.strokeStyle;this.addFillStyleDefinition(k,o);if(m===l)return this.lineAreaDotAlone(j,k,m);l=this.lineJoinPaths(i,m-m,l-m-1);var r=o.opacity;n={"shape-rendering":p.antialias?null:
"crispEdges","pointer-events":"none",cursor:p.cursor,d:l,fill:n.color,"fill-opacity":n.opacity||null,stroke:o.color,"stroke-opacity":r||null,"stroke-width":r?p.lineWidth/this.scale:null,"stroke-linecap":p.lineCap,"stroke-linejoin":p.lineJoin,"stroke-miterlimit":p.strokeMiterLimit,"stroke-dasharray":r?this.parseDasharray(p):null};j=this.expect(j,"path",k,m,n,p.css);return this.append(j,k,m)})});e&&e.forEach(function(d){var f=d.from,g={"shape-rendering":"crispEdges",fill:"rgb(127,127,127)","fill-opacity":0.005,
stroke:"rgb(127,127,127)","stroke-opacity":0.005,"stroke-width":5};d.paths.forEach(function(h,i){i=f+i;var j=c[i],k=j.events;if(k&&k!=="none"){var m=Object.create(g);m["pointer-events"]=k;m.cursor=j.cursor;m.d=h;b=this.expect(b,"path",c,i,m);b=this.append(b,c,i)}},this)},this);return b};
pv.SvgScene.lineSegmentedFull=function(b,c){var e=c[0],d;switch(e.interpolate){case "basis":d=this.curveBasisSegments(c);break;case "cardinal":d=this.curveCardinalSegments(c,e.tension);break;case "monotone":d=this.curveMonotoneSegments(c);break}e=0;for(var f=c.length-1;e<f;e++){var g=c[e],h=c[e+1];if(g.visible&&h.visible){var i=g.strokeStyle,j=pv.FillStyle.transparent;if(i.opacity){if(g.interpolate=="linear"&&g.lineJoin=="miter"){j=i;i=pv.FillStyle.transparent;h=this.pathJoin(c[e-1],g,h,c[e+2])}else h=
d?d[e].join(""):"M"+g.left+","+g.top+this.lineSegmentPath(g,h);b=this.expect(b,"path",c,e,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":g.events,cursor:g.cursor,d:h,fill:j.color,"fill-opacity":j.opacity||null,stroke:i.color,"stroke-opacity":i.opacity||null,"stroke-width":i.opacity?g.lineWidth/this.scale:null,"stroke-linejoin":g.lineJoin});g.svg&&this.setAttributes(b,g.svg);g.css&&this.setStyle(b,g.css);b=this.append(b,c,e)}}}return b};
pv.SvgScene.lineSegmentPath=function(b,c){var e=1;switch(b.interpolate){case "polar-reverse":e=0;case "polar":var d=c.left-b.left,f=c.top-b.top;b=1-b.eccentricity;d=Math.sqrt(d*d+f*f)/(2*b);if(b<=0||b>1)break;return"A"+d+","+d+" 0 0,"+e+" "+c.left+","+c.top;case "step-before":return"V"+c.top+"H"+c.left;case "step-after":return"H"+c.left+"V"+c.top}return"L"+c.left+","+c.top};
pv.SvgScene.lineSegmentPaths=function(b,c,e){var d=b[c],f;switch(d.interpolate){case "basis":f=this.curveBasisSegments(b,c,e);break;case "cardinal":f=this.curveCardinalSegments(b,d.tension,c,e);break;case "monotone":f=this.curveMonotoneSegments(b,c,e);break}if(!f||!f.length){f=[];for(c=c+1;c<=e;c++){d=b[c-1];f.push(["M"+d.left+","+d.top,this.lineSegmentPath(d,b[c])])}}return f};pv.strokeMiterLimit=4;
pv.SvgScene.pathJoin=function(b,c,e,d){var f=[],g,h=c.lineWidth/this.scale,i=pv.vector(c.left,c.top),j=pv.vector(e.left,e.top),k=j.minus(i),m=k.perp().norm(),l=m.times(h/2),p=i.plus(l),n=i.minus(l),o=j.plus(l);l=j.minus(l);if(!b||!b.visible)f.push(n,p);else{var r=pv.vector(b.left,b.top),u=i.minus(r),t=u.perp().norm().plus(m).norm();r=this.lineIntersect(i,t,p,k);t=this.lineIntersect(i,t,n,k);g=r.minus(t).length();b=(h+b.lineWidth/this.scale)/2;g=g/b;c=c.strokeMiterLimit||pv.strokeMiterLimit;if(g<=
c)f.push(t,r);else{c=k.times(-1);c=u.norm().plus(c.norm()).norm();i=i.plus(c.times(b/2));c.dot(m)>=0?f.push(t,i,p):f.push(n,i,r)}}if(!d||!d.visible)f.push(o,l);else{i=pv.vector(d.left,d.top).minus(j);n=i.perp().norm().plus(m).norm();p=this.lineIntersect(j,n,o,k);n=this.lineIntersect(j,n,l,k);g=p.minus(n).length();d=(d.lineWidth/this.scale+h)/2;g=g/d;c=e.strokeMiterLimit||pv.strokeMiterLimit;if(g<=c)f.push(p,n);else{e=i.times(-1);k=k.norm().plus(e.norm()).norm();j=j.plus(k.times(d/2));k.dot(m)>=0?
f.push(o,j,n):f.push(p,j,l)}}m=f.shift();return"M"+m.x+","+m.y+"L"+f.map(function(s){return s.x+","+s.y}).join(" ")};pv.SvgScene.lineIntersect=function(b,c,e,d){return b.plus(c.times(e.minus(b).dot(d.perp())/c.dot(d.perp())))};pv.SvgScene.lineJoinPaths=function(b,c,e){var d=b[c].join("");for(c=c+1;c<=e;c++)d+=b[c][1];return d};
pv.SvgScene.lineAreaDotAlone=function(b,c,e){var d=c[e],f;if(e>0){f=c[e-1];if(this.isSceneVisible(f))return b}if(e<c.length-1){f=c[e+1];if(this.isSceneVisible(f))return b}f=d.strokeStyle;if(!f||!f.opacity)f=d.fillStyle;b=this.expect(b,"circle",c,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,fill:f.color,"fill-opacity":f.opacity||null,stroke:"none",cx:d.left,cy:d.top,r:d.lineWidth/this.scale/2},d.css);d.svg&&this.setAttributes(b,d.svg);return this.append(b,
c,e)};pv.SvgScene.eachLineAreaSegment=function(b,c,e,d){if(typeof e==="function"){d=e;e=null}var f=pv.get(e,"breakOnKeyChange",false),g=pv.get(e,"from")||0,h=pv.get(e,"to",c.length-1),i,j;if(f){i=[];j=[]}for(g=g;g<=h;){var k=c[g];if(this.isSceneVisible(k)){f&&this.lineAreaSceneKey(k,i);var m;for(k=g;;){var l=k+1;if(l>h){m=l;break}var p=c[l];if(!this.isSceneVisible(p)){m=l+1;break}k=l;if(f){this.lineAreaSceneKey(p,j);if(!this.equalSceneKeys(i,j)){m=k;break}}}b=d.call(this,b,c,g,k,e);g=m}else g++}return b};
pv.SvgScene.lineAreaSceneKey=function(b,c){c[0]=b.fillStyle.key;c[1]=b.strokeStyle.key;c[2]=b.lineWidth;c[3]=b.strokeDasharray||"none";c[4]=b.interpolate;return c};pv.SvgScene.isSceneVisible=function(b){return b.visible&&(b.fillStyle.opacity>0||b.strokeStyle.opacity>0)};pv.SvgScene.equalSceneKeys=function(b,c){for(var e=0,d=b.length;e<d;e++)if(b[e]!==c[e])return false;return true};
pv.SvgScene.panel=function(b){for(var c=b.$g,e=c&&c.firstChild,d=false,f=0;f<b.length;f++){var g=b[f];if(g.visible){if(!b.parent){if(pv.renderer()!=="batik")g.canvas.style.display="inline-block";if(c&&c.parentNode!=g.canvas)e=(c=g.canvas.firstChild)&&c.firstChild;if(!c){c=this.create(pv.renderer()!=="batik"?"svg":"g");c.setAttribute("font-size","10px");c.setAttribute("font-family","sans-serif");c.setAttribute("fill","none");c.setAttribute("stroke","none");c.setAttribute("stroke-width",1.5);c.setAttribute("style",
"-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");if(typeof c.onselectstart!=="undefined"){c.setAttribute("unselectable","on");c.onselectstart=function(){return false}}if(pv.renderer()==="svgweb"){c.setAttribute("width",g.width+g.left+g.right);c.setAttribute("height",g.height+g.top+g.bottom);var h=document.createDocumentFragment(true);c.addEventListener("SVGLoad",function(){var p=this;(function(){if(d){d=
false;p.appendChild(h);for(var n=0;n<pv.Scene.events.length;n++)p.addEventListener(pv.Scene.events[n],pv.SvgScene.dispatch,false);b.$g=p;b.$g.__ready=true}else setTimeout(arguments.callee,10)})()},false);svgweb.appendChild(c,g.canvas);c=h}else{for(var i=0;i<this.events.length;i++)c.addEventListener(this.events[i],this.dispatch,false);c=g.canvas.appendChild(c);c.__ready=true}e=c.firstChild}b.$g=c;if(c.__ready){c.setAttribute("width",g.width+g.left+g.right);c.setAttribute("height",g.height+g.top+g.bottom)}}if(g.overflow==
"hidden"){i=pv.id().toString(36);var j=this.expect(e,"g",b,f,{"clip-path":"url(#"+i+")"});j.parentNode||c.appendChild(j);b.$g=c=j;e=j.firstChild;e=this.expect(e,"clipPath",b,f,{id:i});i=e.firstChild||e.appendChild(this.create("rect"));i.setAttribute("x",g.left);i.setAttribute("y",g.top);i.setAttribute("width",g.width);i.setAttribute("height",g.height);e.parentNode||c.appendChild(e);e=e.nextSibling}e=this.fill(e,b,f);i=this.scale;var k=g.transform,m=g.left+k.x,l=g.top+k.y;this.scale*=k.k;this.eachChild(b,
f,function(p){p.$g=e=this.expect(e,"g",b,f,{transform:"translate("+m+","+l+")"+(k.k!=1?" scale("+k.k+")":"")});this.updateAll(p);e.parentNode||c.appendChild(e);e=e.nextSibling});this.scale=i;e=this.stroke(e,b,f);if(g.overflow=="hidden"){b.$g=c=j.parentNode;e=j.nextSibling}}}d=true;return e};
pv.SvgScene.eachChild=function(b,c,e,d){if(b.mark.zOrderChildCount){b=b[c].children.slice(0);b.sort(function(f,g){var h=f.mark._zOrder-g.mark._zOrder;if(h===0)h=f.childIndex-g.childIndex;return h});b.forEach(e,d||this)}else b[c].children.forEach(e,d||this)};
pv.SvgScene.fill=function(b,c,e){this.removeFillStyleDefinitions(c);var d=c[e],f=d.fillStyle;if(f.opacity||d.events=="all"){f.type&&f.type!=="solid"&&this.addFillStyleDefinition(c,f);b=this.expect(b,"rect",c,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height,fill:f.color,"fill-opacity":f.opacity,stroke:null});b=this.append(b,c,e)}return b};
pv.SvgScene.stroke=function(b,c,e){var d=c[e],f=d.strokeStyle;if(f.opacity||d.events=="all"){b=this.expect(b,"rect",c,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events=="all"?"stroke":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1.0E-10,d.width),height:Math.max(1.0E-10,d.height),fill:null,stroke:f.color,"stroke-opacity":f.opacity,"stroke-width":d.lineWidth/this.scale,"stroke-linecap":d.lineCap,"stroke-dasharray":f.opacity?this.parseDasharray(d):null});b=this.append(b,
c,e)}return b};pv.SvgScene.minRuleLineWidth=1;
pv.SvgScene.rule=function(b){for(var c=b.$g.firstChild,e=0;e<b.length;e++){var d=b[e];if(d.visible){var f=d.strokeStyle;if(f.opacity){var g=d.lineWidth;g=g<1.0E-10?0:Math.max(this.minRuleLineWidth,g/this.scale);c=this.expect(c,"line",b,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x1:d.left,y1:d.top,x2:d.left+d.width,y2:d.top+d.height,stroke:f.color,"stroke-opacity":f.opacity,"stroke-width":g,"stroke-linecap":d.lineCap,"stroke-dasharray":f.opacity?this.parseDasharray(d):
null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,e)}}}return c};
pv.SvgScene.wedge=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var e=0;e<b.length;e++){var d=b[e];if(d.visible){var f=d.fillStyle,g=d.strokeStyle;if(f.opacity||g.opacity){var h=d.innerRadius,i=d.outerRadius,j=Math.abs(d.angle);if(j>=2*Math.PI)h=h?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z";else{var k=Math.min(d.startAngle,d.endAngle),
m=Math.max(d.startAngle,d.endAngle),l=Math.cos(k),p=Math.cos(m);k=Math.sin(k);m=Math.sin(m);h=h?"M"+i*l+","+i*k+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*p+","+i*m+"L"+h*p+","+h*m+"A"+h+","+h+" 0 "+(j<Math.PI?"0":"1")+",0 "+h*l+","+h*k+"Z":"M"+i*l+","+i*k+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*p+","+i*m+"L0,0Z"}f.type&&f.type!=="solid"&&this.addFillStyleDefinition(b,f);g.type&&g.type!="solid"&&this.addFillStyleDefinition(b,g);c=this.expect(c,"path",b,e,{"shape-rendering":d.antialias?null:
"crispEdges","pointer-events":d.events,cursor:d.cursor,transform:"translate("+d.left+","+d.top+")",d:h,fill:f.color,"fill-rule":"evenodd","fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":g.opacity?d.lineWidth/this.scale:null,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,"stroke-linecap":d.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(d):null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,
b,e)}}}return c};pv.Mark=function(){this.$properties=[];this.$propertiesMap={};this.$handlers={}};pv.Mark.prototype.properties={};pv.Mark.cast={};pv.Mark.prototype.property=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;pv.Mark.prototype.propertyMethod(b,false,pv.Mark.cast[b]=c);return this};
pv.Mark.prototype.localProperty=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;var e=pv.Mark.cast[b];if(c)pv.Mark.cast[b]=e=c;this.propertyMethod(b,false,e);return this};
pv.Mark.prototype.propertyMethod=function(b,c,e){e||(e=pv.Mark.cast[b]);this[b]=function(d,f){if(c&&this.scene){var g=this.scene.defs;if(arguments.length){g[b]={id:d==null?0:pv.id(),value:d!=null&&e?e(d):d};return this}return g[b]?g[b].value:null}if(arguments.length){this.setPropertyValue(b,d,c,e,false,f);return this}if(g=pv.propertyEval){var h=this.binds,i=h.properties[b];if(i){h=h.net;var j=h[b];if(j==null)j=h[b]=0;(i.dependents||(i.dependents={}))[g.name]=true;(pv.propertyEvalDependencies||(pv.propertyEvalDependencies=
{}))[b]=true;if(j>=pv.propertyEvalNetIndex)pv.propertyEvalNetIndex=j+1}}return this.instance()[b]}};pv.Mark.funPropertyCaller=function(b,c){var e=pv.Mark.stack;return function(){var d=b.apply(this,e);return d!=null?c(d):d}};
pv.Mark.prototype.setPropertyValue=function(b,c,e,d,f,g){e=!e<<1|typeof c==="function";if(e&1&&d)c=pv.Mark.funPropertyCaller(c,d);else if(c!=null&&d)c=d(c);var h=this.$propertiesMap;d=this.$properties;c={name:b,id:pv.id(),value:c,type:e,tag:g};g=h[b];h[b]=c;if(g)for(b=0;b<d.length;b++)if(d[b]===g){d.splice(b,1);break}d.push(c);if(f&&g&&e===3){c.proto=g;c.root=g.root||g}return c};
pv.Mark.prototype.intercept=function(b,c,e){this.setPropertyValue(b,c,false,pv.get(e,"noCast")?null:pv.Mark.cast[b],true,pv.get(e,"tag"));return this};pv.Mark.prototype.propertyValue=function(b,c){var e=this.$propertiesMap[b];if(e)return e.value;if(c){if(this.proto){c=this.proto.propertyValueRecursive(b);if(c!==undefined)return c}return this.defaults.propertyValueRecursive(b)}};pv.Mark.prototype.propertyValueRecursive=function(b){var c=this.$propertiesMap[b];if(c)return c.value;if(this.proto)return this.proto.propertyValueRecursive(b)};
pv.Mark.stack=[];pv.Mark.prototype.property("data").property("visible",Boolean).property("datum",Object).property("css",Object).property("svg",Object).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String);a=pv.Mark.prototype;a.childIndex=-1;a.index=-1;a.scale=1;a._zOrder=0;
a.defaults=(new pv.Mark).data(function(b){return[b]}).datum(function(){var b=this.parent;return b?b.scene[b.index].datum:null}).visible(true).antialias(true).events("painted");a.extend=function(b){this.proto=b;this.target=b.target;return this};a.add=function(b){return this.parent.add(b).extend(this)};a.def=function(b,c){this.propertyMethod(b,true);return this[b](arguments.length>1?c:null)};
a.zOrder=function(b){if(!arguments.length)return this._zOrder;b=+b||0;if(this._zOrder!==b){this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount--;this._zOrder=b;this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount++}return this};
a.anchor=function(b){b||(b="center");return(new pv.Anchor(this)).name(b).data(function(){return this.scene.target.map(function(c){return c.data})}).datum(function(){return this.scene.target[this.index].datum}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var c=this.scene.target[this.index],e=c.width||0;switch(this.name()){case "bottom":case "top":case "center":return c.left+e/2;case "left":return null}return c.left+
e}).top(function(){var c=this.scene.target[this.index],e=c.height||0;switch(this.name()){case "left":case "right":case "center":return c.top+e/2;case "top":return null}return c.top+e}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+(c.width||0):null}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+(c.height||0):null}).textAlign(function(){switch(this.name()){case "bottom":case "top":case "center":return"center";case "right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";
case "top":return"top"}return"bottom"})};a.anchorTarget=function(){return this.target};a.margin=function(b){return this.left(b).right(b).top(b).bottom(b)};a.instance=function(b){var c=this.scene||this.parent.instance(-1).children[this.childIndex],e=!arguments.length||this.hasOwnProperty("index")?this.index:b;return c[e<0?c.length-1:e]};
a.instances=function(b){for(var c=this,e=[],d;!(d=c.scene);){b=b.parent;e.push({index:b.index,childIndex:c.childIndex});c=c.parent}for(;e.length;){b=e.pop();d=d[b.index].children[b.childIndex]}if(this.hasOwnProperty("index")){e=pv.extend(d[this.index]);e.right=e.top=e.left=e.bottom=0;return[e]}return d};a.first=function(){return this.scene[0]};a.last=function(){return this.scene[this.scene.length-1]};a.sibling=function(){return this.index==0?null:this.scene[this.index-1]};
a.cousin=function(){var b=this.parent;return(b=b&&b.sibling())&&b.children?b.children[this.childIndex][this.index]:null};a.render=function(){this.parent&&!this.root.scene?this.root.render():this.renderCore()};
a.renderCore=function(){function b(h,i,j){h.scale=j;if(i<f.length){d.unshift(null);try{if(h.hasOwnProperty("index"))c(h,i,j);else{for(var k=0,m=h.scene.length;k<m;k++){h.index=k;c(h,i,j)}delete h.index}}finally{d.shift()}}else{h.build();pv.Scene.scale=j;i=null;if(h.scene&&h.scene.$g&&h.scene.$g.suspendRedraw)i=h.scene.$g.suspendRedraw(1E3);pv.Scene.updateAll(h.scene);i&&h.scene.$g.unsuspendRedraw(i)}delete h.scale}function c(h,i,j){var k=h.scene[h.index],m;if(k.visible){var l=f[i],p=h.children[l];
for(m=0;m<l;m++)h.children[m].scene=k.children[m];d[0]=k.data;if(p.scene)b(p,i+1,j*k.transform.k);else{p.scene=k.children[l];b(p,i+1,j*k.transform.k);delete p.scene}for(m=0;m<l;m++)delete h.children[m].scene}}for(var e=this.parent,d=pv.Mark.stack,f=[],g=this;g.parent;g=g.parent)f.unshift(g.childIndex);for(this.bind();e&&!e.hasOwnProperty("index");)e=e.parent;this.context(e?e.scene:undefined,e?e.index:-1,function(){b(this.root,0,1)})};pv.Mark._requiredPropsPosition={id:0,datum:1,visible:3};a=pv.Mark.prototype;
a.bind=function(){function b(j){do for(var k=j.$properties,m=k.length-1;m>=0;m--){var l=k[m],p=c[l.name];if(p){if(p.type===3){var n=p.root;if(n){if(!n.proto){n.proto=l;p.root=l}}else p.proto=p.root=l}}else{c[l.name]=l;switch(l.name){case "data":e=l;break;case "datum":case "visible":case "id":d.push(l);break;default:f[l.type].push(l);break}}}while(j=j.proto)}var c={},e,d=[],f=[[],[],[],[]],g=pv.Mark._requiredPropsPosition;b(this);b(this.defaults);d.sort(function(j,k){return g[j.name]-g[k.name]});f[1].reverse();
f[3].reverse();var h=this;do for(var i in h.properties)i in c||f[2].push(c[i]={name:i,type:2,value:null});while(h=h.proto);h=f[0].concat(f[1]);for(i=0;i<h.length;i++)this.propertyMethod(h[i].name,true);this.binds={properties:c,net:{},data:e,defs:h,required:d,optional:pv.blend(f)}};a.updateNet=function(b,c){function e(h,i){if(i>(g[h.name]||0)){g[h.name]=i;if(h=h.dependents){i++;for(var j in h)if(h.hasOwnProperty(j)){var k=f[j];k&&e(k,i)}}}}var d=this.binds,f=d.properties,g=d.net;e(b,c)};
a.build=function(){var b=this.scene,c=pv.Mark.stack;if(!b){b=this.scene=[];b.mark=this;b.type=this.type;b.childIndex=this.childIndex;if(this.parent){b.parent=this.parent.scene;b.parentIndex=this.parent.index}}if(this.target)b.target=this.target.instances(b);if(this.binds.defs.length){var e=b.defs;if(!e)b.defs=e={};for(var d=0;d<this.binds.defs.length;d++){var f=this.binds.defs[d],g=e[f.name];if(!g||f.id>g.id)e[f.name]={id:0,value:f.type&1?f.value.apply(this,c):f.value}}}e=this.binds.data;e=e.type&
1?e.value.apply(this,c):e.value;f=pv.Mark.prototype;c.unshift(null);try{var h=b.length=e.length;for(d=0;d<h;d++){f.index=this.index=d;var i=b[d]||(b[d]={});i.data=c[0]=e[d];this.buildInstance(i)}}finally{f.index=-1;delete this.index;c.shift()}return this};
a.buildProperties=function(b,c){for(var e=pv.Mark.stack,d=0,f=c.length;d<f;d++){var g=c[d],h;switch(g.type){case 3:var i=pv.propertyProto;try{pv.propertyProto=g.proto;h=g.value.apply(this,e)}finally{pv.propertyProto=i}break;case 2:h=g.value;break;case 0:case 1:h=this.scene.defs[g.name].value;break}b[g.name]=h}};a.delegate=function(b,c){var e=pv.propertyProto;if(e&&(!c||e.tag===c)){c=this.evalProperty(e);if(c!==undefined)return c}return b};
a.hasDelegate=function(b){var c=pv.propertyProto;return!!c&&(!b||c.tag===b)};a.evalProperty=function(b){switch(b.type){case 3:var c=pv.propertyProto;try{pv.propertyProto=b.proto;return b.value.apply(this,pv.Mark.stack)}finally{pv.propertyProto=c}case 2:return b.value;case 0:case 1:return this.scene.defs[b.name].value}};
a.buildPropertiesWithDepTracking=function(b,c){var e=this.binds.net,d,f,g,h,i,j,k=pv.Mark.stack,m=c.length;try{for(;;){g=null;j={};for(var l=0;l<m;l++){var p=c[l],n=p.name;j[n]=true;if(!h||h[n]){var o;switch(p.type){case 3:pv.propertyEval=p;pv.propertyEvalNetIndex=d=e[n]||0;pv.propertyEvalDependencies=null;var r=pv.propertyProto;try{pv.propertyProto=p.proto;o=p.value.apply(this,k)}finally{pv.propertyProto=r}f=pv.propertyEvalNetIndex;if(f>d){var u=pv.propertyEvalDependencies;for(var t in u)if(u.hasOwnProperty(t)&&
!j.hasOwnProperty(n)){g||(g={});g[t]=true}this.updateNet(p,f)}break;case 2:o=p.value;break;case 0:case 1:o=this.scene.defs[n].value;break}b[n]=o}}if(!g)break;h=g;i=pv.numerate(c,function(s){return s.name});c.sort(function(s,q){var x=pv.naturalOrder(e[s.name]||0,e[q.name]||0);x||(x=pv.naturalOrder(i[s.name],i[q.name]));return x});i=null}}finally{pv.propertyEval=null;pv.propertyEvalNetIndex=null;pv.propertyEvalDependencies=null}};
a.buildInstance=function(b){this.buildProperties(b,this.binds.required);if(b.visible){this.index===0?this.buildPropertiesWithDepTracking(b,this.binds.optional):this.buildProperties(b,this.binds.optional);this.buildImplied(b)}};
a.buildImplied=function(b){var c=b.left,e=b.right,d=b.top,f=b.bottom,g=this.properties,h=g.width?b.width:0,i=g.height?b.height:0,j,k;if(h==null||e==null||c==null){j=this.parent?this.parent.instance():null;k=true;var m=j?j.width:h+c+e;if(h==null)h=m-(e=e||0)-(c=c||0);else if(e==null)if(c==null)c=e=(m-h)/2;else e=m-h-c;else c=m-h-e}if(i==null||f==null||d==null){k||(j=this.parent?this.parent.instance():null);j=j?j.height:i+d+f;if(i==null)i=j-(d=d||0)-(f=f||0);else if(f==null)f=d==null?(d=(j-i)/2):j-
i-d;else d=j-i-f}b.left=c;b.right=e;b.top=d;b.bottom=f;if(g.width)b.width=h;if(g.height)b.height=i;if(g.textStyle&&!b.textStyle)b.textStyle=pv.FillStyle.transparent;if(g.fillStyle&&!b.fillStyle)b.fillStyle=pv.FillStyle.transparent;if(g.strokeStyle&&!b.strokeStyle)b.strokeStyle=pv.FillStyle.transparent};
a.mouse=function(){var b=this.root.canvas(),c=pv.scrollOffset(b),e=pv.event,d=c[0]+e.clientX*1;c=c[1]+e.clientY*1;if(pv.renderer()!=="svgweb"){do{d-=b.offsetLeft;c-=b.offsetTop}while(b=b.offsetParent)}b=pv.Transform.identity;var f=this.properties.transform?this:this.parent;e=[];do e.push(f);while(f=f.parent);for(;f=e.pop();){f=f.instance();b=b.translate(f.left,f.top).times(f.transform)}b=b.invert();return pv.vector(d*b.k+b.x,c*b.k+b.y)};
a.event=function(b,c){c=pv.functor(c);var e=this.$handlers[b];if(e)if(e instanceof Array)e.push(c);else e=[e,c];else e=c;this.$hasHandlers=true;this.$handlers[b]=e;return this};
a.context=function(b,c,e){function d(l,p){pv.Mark.scene=l;g.index=p;if(l){var n=l.mark,o=n,r=[];do{r.push(o);h.push(l[p].data);o.index=p;o.scene=l;p=l.parentIndex;l=l.parent}while(o=o.parent);l=r.length-1;for(p=1;l>0;l--){o=r[l];o.scale=p;p*=o.scene[o.index].transform.k}if(r=n.children){n=n.scene[n.index];l=0;for(var u=r.length;l<u;l++){o=r[l];o.scene=n.children[l];o.scale=p}}}}function f(l){if(l){l=l.mark;var p,n=l.children;if(n)for(var o=0,r=n.length;o<r;o++){p=n[o];delete p.scene;delete p.scale}p=
l;do{h.pop();if(p.parent){delete p.scene;delete p.scale}delete p.index}while(p=p.parent)}}var g=pv.Mark.prototype,h=pv.Mark.stack,i=pv.Mark.scene,j=g.index;if(b&&b===i&&c===j)try{e.apply(this,h)}catch(k){pv.error(k);throw k;}finally{pv.Mark.scene=i;g.index=j}else{f(i,j);d(b,c);try{e.apply(this,h)}catch(m){pv.error(m);throw m;}finally{f(b,c);d(i,j)}}};
pv.Mark.dispatch=function(b,c,e,d){var f=c.mark,g=c.parent,h=f.$handlers[b];if(f.root.animatingCount)return true;if(!h)return g&&pv.Mark.dispatch(b,g,c.parentIndex,d);f.context(c,e,function(){var i=pv.Mark.stack.concat(d);if(h instanceof Array){var j;h.forEach(function(k){if((k=k.apply(f,i))&&k.render)(j||(j=[])).push(k)});j&&j.forEach(function(k){k.render()})}else(f=h.apply(f,i))&&f.render&&f.render()});return true};
pv.Mark.prototype.eachInstance=function(b,c){function e(i,j,k){var m;j===h||(m=f[j]);var l=i.length;if(l>0){for(var p=0;p<l;p++){var n=i[p];if(j===h)b.call(c,i[p],k);else if(n.visible){var o=n.children[m];if(o){n=k.times(n.transform).translate(n.left,n.top);e(o,j+1,n)}}}b.call(c,g,null)}}for(var d=this,f=[],g={isBreak:true,visible:false,datum:{}};d.parent;){f.unshift(d.childIndex);d=d.parent}if(d=d.scene){var h=f.length;e(d,0,pv.Transform.identity)}};
pv.Mark.prototype.toScreenTransform=function(){var b=pv.Transform.identity;if(this instanceof pv.Panel)b=b.translate(this.left(),this.top()).times(this.transform());var c=this.parent;if(c){do b=b.translate(c.left(),c.top()).times(c.transform());while(c=c.parent)}return b};pv.Mark.prototype.transition=function(){return new pv.Transition(this)};pv.Mark.prototype.on=function(b){return this["$"+b]=new pv.Transient(this)};pv.Anchor=function(b){pv.Mark.call(this);this.target=b;this.parent=b.parent};
pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String);pv.Anchor.prototype.extend=function(b){this.proto=b;return this};pv.Area=function(){pv.Mark.call(this)};pv.Area.castSegmented=function(b){if(!b)return"";switch(b){case "smart":case "full":break;default:b="full"}return b};
pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("tension",Number);pv.Area.prototype.type="area";pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
pv.Area.prototype.buildImplied=function(b){if(b.height==null)b.height=0;if(b.width==null)b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Area.fixed={lineWidth:1,lineJoin:1,strokeMiterLimit:1,lineCap:1,strokeStyle:1,strokeDasharray:1,fillStyle:1,segmented:1,interpolate:1,tension:1};
pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);var b=this.binds,c=b.required;b=b.optional;for(var e=0,d=b.length;e<d;e++){var f=b[e];f.fixed=f.name in pv.Area.fixed;if(f.name=="segmented"){c.push(f);b.splice(e,1);e--;d--}}this.binds.$required=c;this.binds.$optional=b};
pv.Area.prototype.buildInstance=function(b){var c=this.binds;if(this.index){var e=c.fixed;if(!e){e=c.fixed=[];function d(i){return!i.fixed||(e.push(i),false)}c.required=c.required.filter(d);if(!this.scene[0].segmented)c.optional=c.optional.filter(d)}if(c=e.length)for(var f=this.scene[0],g=0;g<c;g++){var h=e[g].name;b[h]=f[h]}}else{c.required=c.$required;c.optional=c.$optional;c.fixed=null}pv.Mark.prototype.buildInstance.call(this,b)};
pv.Area.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})};pv.Bar=function(){pv.Mark.call(this)};
pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Bar.prototype.type="bar";pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).lineCap("butt").strokeDasharray("none");pv.Dot=function(){pv.Mark.call(this)};
pv.Dot.prototype=pv.extend(pv.Mark).property("shape",String).property("shapeAngle",Number).property("shapeRadius",Number).property("shapeSize",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);pv.Dot.prototype.type="dot";pv.Dot.prototype.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).shape("circle").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).lineCap("butt").strokeDasharray("none");
pv.Dot.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).left(function(){var c=this.scene.target[this.index];switch(this.name()){case "bottom":case "top":case "center":return c.left;case "left":return null}return c.left+c.shapeRadius}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+c.shapeRadius:null}).top(function(){var c=this.scene.target[this.index];switch(this.name()){case "left":case "right":case "center":return c.top;case "top":return null}return c.top+
c.shapeRadius}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+c.shapeRadius:null}).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "bottom":return"top"}return"bottom"})};
pv.Dot.prototype.buildImplied=function(b){var c=b.shapeRadius,e=b.shapeSize;if(c==null)if(e==null){b.shapeSize=20.25;b.shapeRadius=4.5}else b.shapeRadius=Math.sqrt(e);else if(e==null)b.shapeSize=c*c;pv.Mark.prototype.buildImplied.call(this,b)};pv.Label=function(){pv.Mark.call(this)};
pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String);pv.Label.prototype.type="label";pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3);
pv.Line=function(){pv.Mark.call(this)};pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeStyle",pv.fillStyle).property("strokeDasharray",String).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("eccentricity",Number).property("tension",Number);a=pv.Line.prototype;a.type="line";a.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
a.bind=pv.Area.prototype.bind;a.buildInstance=pv.Area.prototype.buildInstance;a.anchor=function(b){return pv.Area.prototype.anchor.call(this,b).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center";case "right":return"left"}}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "top":return"bottom";case "bottom":return"top"}})};pv.Rule=function(){pv.Mark.call(this)};
pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Rule.prototype.type="rule";pv.Rule.prototype.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(false).lineCap("butt").strokeDasharray("none");pv.Rule.prototype.anchor=pv.Line.prototype.anchor;
pv.Rule.prototype.buildImplied=function(b){var c=b.left,e=b.right;if(b.width!=null||c==null&&e==null||e!=null&&c!=null)b.height=0;else b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Panel=function(){pv.Bar.call(this);this.children=[];this.root=this;this.$dom=pv.$&&pv.$.s};pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(b){return typeof b=="string"?document.getElementById(b):b});a=pv.Panel.prototype;a.type="panel";
a.animatingCount=0;a.zOrderChildCount=0;a.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible");a.anchor=function(b){b=pv.Bar.prototype.anchor.call(this,b);b.parent=this;return b};a.add=function(b){b=new b;b.parent=this;b.root=this.root;b.childIndex=this.children.length;this.children.push(b);return b};a.bind=function(){pv.Mark.prototype.bind.call(this);for(var b=this.children,c=0,e=b.length;c<e;c++)b[c].bind()};
a.buildInstance=function(b){pv.Bar.prototype.buildInstance.call(this,b);if(b.visible){var c=this.scale*b.transform.k;pv.Mark.prototype.index=-1;for(var e=this.children,d=b.children||(b.children=[]),f=0,g=e.length;f<g;f++){b=e[f];b.scene=d[f];b.scale=c;b.build()}for(f=0;f<g;f++){b=e[f];d[f]=b.scene;delete b.scene;delete b.scale}d.length=g}};
a.buildImplied=function(b){if(!this.parent){var c=b.canvas;if(pv.renderer()==="batik")if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}}else c=document.lastChild;else if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}var e;if(b.width==null){e=parseFloat(pv.css(c,"width"));b.width=e-b.left-b.right}if(b.height==null){e=parseFloat(pv.css(c,"height"));b.height=e-b.top-b.bottom}}else{e=
this.$canvas||(this.$canvas=[]);if(!(c=e[this.index])){c=e[this.index]=document.createElement(pv.renderer()=="svgweb"?"div":"span");if(this.$dom)this.$dom.parentNode.insertBefore(c,this.$dom);else{for(e=document.body;e.lastChild&&e.lastChild.tagName;)e=e.lastChild;if(e!=document.body)e=e.parentNode;e.appendChild(c)}}}b.canvas=c}if(!b.transform)b.transform=pv.Transform.identity;pv.Mark.prototype.buildImplied.call(this,b)};pv.Panel.updateCreateId=function(b){b.$pvCreateId=(b.$pvCreateId||0)+1};
pv.Image=function(){pv.Bar.call(this)};pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number);a=pv.Image.prototype;a.type="image";a.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null);a.image=function(b){this.$image=function(){var c=b.apply(this,arguments);return c==null?pv.Color.transparent:typeof c=="string"?pv.color(c):c};return this};
a.bind=function(){pv.Bar.prototype.bind.call(this);var b=this.binds,c=this;do b.image=c.$image;while(!b.image&&(c=c.proto))};
a.buildImplied=function(b){pv.Bar.prototype.buildImplied.call(this,b);if(b.visible){if(b.imageWidth==null)b.imageWidth=b.width;if(b.imageHeight==null)b.imageHeight=b.height;if(b.url==null&&this.binds.image){var c=this.$canvas||(this.$canvas=document.createElement("canvas")),e=c.getContext("2d"),d=b.imageWidth,f=b.imageHeight,g=pv.Mark.stack;c.width=d;c.height=f;b=(b.image=e.createImageData(d,f)).data;g.unshift(null,null);for(e=c=0;c<f;c++){g[1]=c;for(var h=0;h<d;h++){g[0]=h;var i=this.binds.image.apply(this,
g);b[e++]=i.r;b[e++]=i.g;b[e++]=i.b;b[e++]=255*i.a}}g.splice(0,2)}}};pv.Wedge=function(){pv.Mark.call(this)};
pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);a=pv.Wedge.prototype;a.type="wedge";
a.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var b=this.sibling();return b?b.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");a.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2};a.midAngle=function(){return(this.startAngle()+this.endAngle())/2};
a.anchor=function(b){function c(f){return f.innerRadius||f.angle<2*Math.PI}function e(f){return(f.innerRadius+f.outerRadius)/2}function d(f){return(f.startAngle+f.endAngle)/2}return pv.Mark.prototype.anchor.call(this,b).left(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "outer":return f.left+f.outerRadius*Math.cos(d(f));case "inner":return f.left+f.innerRadius*Math.cos(d(f));case "start":return f.left+e(f)*Math.cos(f.startAngle);case "center":return f.left+e(f)*Math.cos(d(f));
case "end":return f.left+e(f)*Math.cos(f.endAngle)}return f.left}).top(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "outer":return f.top+f.outerRadius*Math.sin(d(f));case "inner":return f.top+f.innerRadius*Math.sin(d(f));case "start":return f.top+e(f)*Math.sin(f.startAngle);case "center":return f.top+e(f)*Math.sin(d(f));case "end":return f.top+e(f)*Math.sin(f.endAngle)}return f.top}).textAlign(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "outer":return pv.Wedge.upright(d(f))?
"right":"left";case "inner":return pv.Wedge.upright(d(f))?"left":"right"}return"center"}).textBaseline(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "start":return pv.Wedge.upright(f.startAngle)?"top":"bottom";case "end":return pv.Wedge.upright(f.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var f=this.scene.target[this.index],g=0;if(c(f))switch(this.name()){case "center":case "inner":case "outer":g=d(f);break;case "start":g=f.startAngle;break;case "end":g=
f.endAngle;break}return pv.Wedge.upright(g)?g:g+Math.PI})};pv.Wedge.upright=function(b){b%=2*Math.PI;b=b<0?2*Math.PI+b:b;return b<Math.PI/2||b>=3*Math.PI/2};pv.Wedge.prototype.buildImplied=function(b){if(b.angle==null)b.angle=b.endAngle-b.startAngle;else if(b.endAngle==null)b.endAngle=b.startAngle+b.angle;pv.Mark.prototype.buildImplied.call(this,b)};
pv.Ease=function(){function b(o){return function(r){return 1-o(1-r)}}function c(o){return function(r){return 0.5*(r<0.5?o(2*r):2-o(2-2*r))}}function e(o){return function(r){return r<0?0:r>1?1:Math.pow(r,o)}}function d(o){return 1-Math.cos(o*Math.PI/2)}function f(o){return o?Math.pow(2,10*(o-1))-0.001:0}function g(o){return-(Math.sqrt(1-o*o)-1)}function h(o,r){var u;r||(r=0.45);if(!o||o<1){o=1;u=r/4}else u=r/(2*Math.PI)*Math.asin(1/o);return function(t){return t<=0||t>=1?t:-(o*Math.pow(2,10*--t)*Math.sin((t-
u)*2*Math.PI/r))}}function i(o){o||(o=1.70158);return function(r){return r*r*((o+1)*r-o)}}function j(o){return o<1/2.75?7.5625*o*o:o<2/2.75?7.5625*(o-=1.5/2.75)*o+0.75:o<2.5/2.75?7.5625*(o-=2.25/2.75)*o+0.9375:7.5625*(o-=2.625/2.75)*o+0.984375}var k=e(2),m=e(3),l=h(),p=i(),n={linear:pv.identity,"quad-in":k,"quad-out":b(k),"quad-in-out":c(k),"quad-out-in":c(b(k)),"cubic-in":m,"cubic-out":b(m),"cubic-in-out":c(m),"cubic-out-in":c(b(m)),"sin-in":d,"sin-out":b(d),"sin-in-out":c(d),"sin-out-in":c(b(d)),
"exp-in":f,"exp-out":b(f),"exp-in-out":c(f),"exp-out-in":c(b(f)),"circle-in":g,"circle-out":b(g),"circle-in-out":c(g),"circle-out-in":c(b(g)),"elastic-in":l,"elastic-out":b(l),"elastic-in-out":c(l),"elastic-out-in":c(b(l)),"back-in":p,"back-out":b(p),"back-in-out":c(p),"back-out-in":c(b(p)),"bounce-in":j,"bounce-out":b(j),"bounce-in-out":c(j),"bounce-out-in":c(b(j))};pv.ease=function(o){return n[o]};return{reverse:b,reflect:c,linear:function(){return pv.identity},sin:function(){return d},exp:function(){return f},
circle:function(){return g},elastic:h,back:i,bounce:j,poly:e}}();
pv.Transition=function(b){function c(r){for(var u={},t=0;t<r.length;t++){var s=r[t];if(s.id)u[s.id]=s}return u}function e(r,u,t,s){var q;if(u in n){var x=pv.Scale.interpolator(t[u],s[u]);q=function(v){t[u]=x(v)}}else q=function(v){if(v>0.5)t[u]=s[u]};q.next=r.head;r.head=q}function d(r,u,t){for(var s in u)s!="children"&&u[s]!=t[s]&&e(r,s,u,t);if(u.children)for(s=0;s<u.children.length;s++)f(r,u.children[s],t.children[s])}function f(r,u,t){for(var s=u.mark,q=c(u),x=c(t),v=0;v<u.length;v++){var z=u[v],
w=z.id?x[z.id]:t[v];z.index=v;if(z.visible){if(!(w&&w.visible)){var A=g(u,v,s.$exit,t);z.transition=w?2:(t.push(A),1);w=A}d(r,z,w)}}for(v=0;v<t.length;v++){w=t[v];z=w.id?q[w.id]:u[v];if(!(z&&z.visible)&&w.visible){A=g(t,v,s.$enter,u);if(z)u[z.index]=A;else u.push(A);d(r,A,w)}}}function g(r,u,t,s){var q=pv.extend(r[u]),x=r.mark,v=x.root.scene,z=(t||o).$properties,w;if(s.target&&(w=s.target[s.length])){r=pv.extend(r);r.target=pv.extend(s.target);r.target[u]=w}var A={};for(t=0;t<z.length;t++)A[z[t].name]=
1;z=x.binds.optional.filter(function(y){return!(y.name in A)}).concat(z);x.context(r,u,function(){this.buildProperties(q,z);this.buildImplied(q)});x.root.scene=v;return q}function h(r){for(var u=0,t=0;u<r.length;u++){var s=r[u];if(s.transition!=1){r[t++]=s;if(s.transition==2)s.visible=false;s.children&&s.children.forEach(h)}}r.length=t}function i(){b.root.animatingCount--;if(p){var r=p;p=null;r()}}var j=this,k=pv.ease("cubic-in-out"),m=250,l,p,n={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,
outerRadius:1,radius:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},o=new pv.Transient;j.ease=function(r){return arguments.length?(k=typeof r=="function"?r:pv.ease(r),j):k};j.duration=function(r){return arguments.length?(m=Number(r),j):m};j.start=function(r){p=r;b.root.animatingCount++;if(b.parent){i();throw new Error("Animated partial rendering is not supported.");}try{b.$transition&&b.$transition.stop();b.$transition=
j;var u=pv.Mark.prototype.index,t=b.scene,s;b.scene=null;b.bind();b.build();s=b.scene;b.scene=t;pv.Mark.prototype.index=u;var q=Date.now(),x={};f(x,t,s)}catch(v){i();throw v;}l=setInterval(function(){for(var z=Math.max(0,Math.min(1,(Date.now()-q)/m)),w=k(z),A=x.head;A;A=A.next)A(w);if(z==1){h(b.scene);j.stop()}pv.Scene.updateAll(t)},24)};j.stop=function(){clearInterval(l);i()}};pv.Transient=function(b){pv.Mark.call(this);this.fillStyle(null).strokeStyle(null).textStyle(null);this.on=function(c){return b.on(c)}};
pv.Transient.prototype=pv.extend(pv.Mark);pv.simulation=function(b){return new pv.Simulation(b)};pv.Simulation=function(b){for(var c=0;c<b.length;c++)this.particle(b[c])};a=pv.Simulation.prototype;a.particle=function(b){b.next=this.particles;if(isNaN(b.px))b.px=b.x;if(isNaN(b.py))b.py=b.y;if(isNaN(b.fx))b.fx=0;if(isNaN(b.fy))b.fy=0;this.particles=b;return this};a.force=function(b){b.next=this.forces;this.forces=b;return this};a.constraint=function(b){b.next=this.constraints;this.constraints=b;return this};
a.stabilize=function(b){var c;arguments.length||(b=3);for(var e=0;e<b;e++){var d=new pv.Quadtree(this.particles);for(c=this.constraints;c;c=c.next)c.apply(this.particles,d)}for(c=this.particles;c;c=c.next){c.px=c.x;c.py=c.y}return this};
a.step=function(){var b;for(b=this.particles;b;b=b.next){var c=b.px,e=b.py;b.px=b.x;b.py=b.y;b.x+=b.vx=b.x-c+b.fx;b.y+=b.vy=b.y-e+b.fy}c=new pv.Quadtree(this.particles);for(b=this.constraints;b;b=b.next)b.apply(this.particles,c);for(b=this.particles;b;b=b.next)b.fx=b.fy=0;for(b=this.forces;b;b=b.next)b.apply(this.particles,c)};
pv.Quadtree=function(b){function c(k,m,l,p,n,o){if(!(isNaN(m.x)||isNaN(m.y)))if(k.leaf)if(k.p){if(!(Math.abs(k.p.x-m.x)+Math.abs(k.p.y-m.y)<0.01)){var r=k.p;k.p=null;e(k,r,l,p,n,o)}e(k,m,l,p,n,o)}else k.p=m;else e(k,m,l,p,n,o)}function e(k,m,l,p,n,o){var r=(l+n)*0.5,u=(p+o)*0.5,t=m.x>=r,s=m.y>=u;k.leaf=false;switch((s<<1)+t){case 0:k=k.c1||(k.c1=new pv.Quadtree.Node);break;case 1:k=k.c2||(k.c2=new pv.Quadtree.Node);break;case 2:k=k.c3||(k.c3=new pv.Quadtree.Node);break;case 3:k=k.c4||(k.c4=new pv.Quadtree.Node);
break}if(t)l=r;else n=r;if(s)p=u;else o=u;c(k,m,l,p,n,o)}var d,f=Number.POSITIVE_INFINITY,g=f,h=Number.NEGATIVE_INFINITY,i=h;for(d=b;d;d=d.next){if(d.x<f)f=d.x;if(d.y<g)g=d.y;if(d.x>h)h=d.x;if(d.y>i)i=d.y}d=h-f;var j=i-g;if(d>j)i=g+d;else h=f+j;this.xMin=f;this.yMin=g;this.xMax=h;this.yMax=i;this.root=new pv.Quadtree.Node;for(d=b;d;d=d.next)c(this.root,d,f,g,h,i)};pv.Quadtree.Node=function(){this.leaf=true;this.p=this.c4=this.c3=this.c2=this.c1=null};pv.Force={};
pv.Force.charge=function(b){function c(k){function m(n){c(n);k.cn+=n.cn;l+=n.cn*n.cx;p+=n.cn*n.cy}var l=0,p=0;k.cn=0;if(!k.leaf){k.c1&&m(k.c1);k.c2&&m(k.c2);k.c3&&m(k.c3);k.c4&&m(k.c4)}if(k.p){k.cn+=b;l+=b*k.p.x;p+=b*k.p.y}k.cx=l/k.cn;k.cy=p/k.cn}function e(k,m,l,p,n,o){var r=k.cx-m.x,u=k.cy-m.y,t=1/Math.sqrt(r*r+u*u);if(k.leaf&&k.p!=m||(n-l)*t<i){if(!(t<h)){if(t>f)t=f;k=k.cn*t*t*t;r=r*k;u=u*k;m.fx+=r;m.fy+=u}}else if(!k.leaf){var s=(l+n)*0.5,q=(p+o)*0.5;k.c1&&e(k.c1,m,l,p,s,q);k.c2&&e(k.c2,m,s,p,
n,q);k.c3&&e(k.c3,m,l,q,s,o);k.c4&&e(k.c4,m,s,q,n,o);if(!(t<h)){if(t>f)t=f;if(k.p&&k.p!=m){k=b*t*t*t;r=r*k;u=u*k;m.fx+=r;m.fy+=u}}}}var d=2,f=1/d,g=500,h=1/g,i=0.9,j={};arguments.length||(b=-40);j.constant=function(k){if(arguments.length){b=Number(k);return j}return b};j.domain=function(k,m){if(arguments.length){d=Number(k);f=1/d;g=Number(m);h=1/g;return j}return[d,g]};j.theta=function(k){if(arguments.length){i=Number(k);return j}return i};j.apply=function(k,m){c(m.root);for(k=k;k;k=k.next)e(m.root,
k,m.xMin,m.yMin,m.xMax,m.yMax)};return j};pv.Force.drag=function(b){var c={};arguments.length||(b=0.1);c.constant=function(e){if(arguments.length){b=e;return c}return b};c.apply=function(e){if(b)for(e=e;e;e=e.next){e.fx-=b*e.vx;e.fy-=b*e.vy}};return c};
pv.Force.spring=function(b){var c=0.1,e=20,d,f,g={};arguments.length||(b=0.1);g.links=function(h){if(arguments.length){d=h;f=h.map(function(i){return 1/Math.sqrt(Math.max(i.sourceNode.linkDegree,i.targetNode.linkDegree))});return g}return d};g.constant=function(h){if(arguments.length){b=Number(h);return g}return b};g.damping=function(h){if(arguments.length){c=Number(h);return g}return c};g.length=function(h){if(arguments.length){e=Number(h);return g}return e};g.apply=function(){for(var h=0;h<d.length;h++){var i=
d[h].sourceNode,j=d[h].targetNode,k=i.x-j.x,m=i.y-j.y,l=Math.sqrt(k*k+m*m),p=l?1/l:1;p=(b*f[h]*(l-e)+c*f[h]*(k*(i.vx-j.vx)+m*(i.vy-j.vy))*p)*p;k=-p*(l?k:0.01*(0.5-Math.random()));m=-p*(l?m:0.01*(0.5-Math.random()));i.fx+=k;i.fy+=m;j.fx-=k;j.fy-=m}};return g};pv.Constraint={};
pv.Constraint.collision=function(b){function c(k,m,l,p,n,o){if(!k.leaf){var r=(l+n)*0.5,u=(p+o)*0.5,t=u<i,s=r>f,q=r<h;if(u>g){k.c1&&s&&c(k.c1,m,l,p,r,u);k.c2&&q&&c(k.c2,m,r,p,n,u)}if(t){k.c3&&s&&c(k.c3,m,l,u,r,o);k.c4&&q&&c(k.c4,m,r,u,n,o)}}if(k.p&&k.p!=m){l=m.x-k.p.x;p=m.y-k.p.y;n=Math.sqrt(l*l+p*p);o=d+b(k.p);if(n<o){n=(n-o)/n*0.5;l*=n;p*=n;m.x-=l;m.y-=p;k.p.x+=l;k.p.y+=p}}}var e=1,d,f,g,h,i,j={};arguments.length||(d=10);j.repeat=function(k){if(arguments.length){e=Number(k);return j}return e};j.apply=
function(k,m){var l,p,n=-Infinity;for(l=k;l;l=l.next){p=b(l);if(p>n)n=p}for(var o=0;o<e;o++)for(l=k;l;l=l.next){p=(d=b(l))+n;f=l.x-p;h=l.x+p;g=l.y-p;i=l.y+p;c(m.root,l,m.xMin,m.yMin,m.xMax,m.yMax)}};return j};pv.Constraint.position=function(b){var c=1,e={};arguments.length||(b=function(d){return d.fix});e.alpha=function(d){if(arguments.length){c=Number(d);return e}return c};e.apply=function(d){for(d=d;d;d=d.next){var f=b(d);if(f){d.x+=(f.x-d.x)*c;d.y+=(f.y-d.y)*c;d.fx=d.fy=d.vx=d.vy=0}}};return e};
pv.Constraint.bound=function(){var b={},c,e;b.x=function(d,f){if(arguments.length){c={min:Math.min(d,f),max:Math.max(d,f)};return this}return c};b.y=function(d,f){if(arguments.length){e={min:Math.min(d,f),max:Math.max(d,f)};return this}return e};b.apply=function(d){if(c)for(var f=d;f;f=f.next)f.x=f.x<c.min?c.min:f.x>c.max?c.max:f.x;if(e)for(f=d;f;f=f.next)f.y=f.y<e.min?e.min:f.y>e.max?e.max:f.y};return b};pv.Layout=function(){pv.Panel.call(this)};pv.Layout.prototype=pv.extend(pv.Panel);
pv.Layout.prototype.property=pv.Mark.prototype.localProperty;
pv.Layout.Network=function(){pv.Layout.call(this);var b=this;this.$id=pv.id();(this.node=(new pv.Mark).data(function(){return b.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(c){return c.x}).top(function(c){return c.y})).parent=this;this.link=(new pv.Mark).extend(this.node).data(function(c){return[c.sourceNode,c.targetNode]}).fillStyle(null).lineWidth(function(c,e){return e.linkValue*1.5}).strokeStyle("rgba(0,0,0,.2)");this.link.add=function(c){return b.add(pv.Panel).data(function(){return b.links()}).add(c).extend(this)};
(this.label=(new pv.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(c){return c.nodeName||c.nodeValue}).textAngle(function(c){c=c.midAngle;return pv.Wedge.upright(c)?c:c+Math.PI}).textAlign(function(c){return pv.Wedge.upright(c.midAngle)?"left":"right"})).parent=this};
pv.Layout.Network.prototype=pv.extend(pv.Layout).property("nodes",function(b){return b.map(function(c,e){if(typeof c!="object")c={nodeValue:c};c.index=e;return c})}).property("links",function(b){return b.map(function(c){if(isNaN(c.linkValue))c.linkValue=isNaN(c.value)?1:c.value;return c})});pv.Layout.Network.prototype.reset=function(){this.$id=pv.id();return this};pv.Layout.Network.prototype.buildProperties=function(b,c){if((b.$id||0)<this.$id)pv.Layout.prototype.buildProperties.call(this,b,c)};
pv.Layout.Network.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);if(b.$id>=this.$id)return true;b.$id=this.$id;b.nodes.forEach(function(c){c.linkDegree=0});b.links.forEach(function(c){var e=c.linkValue;(c.sourceNode||(c.sourceNode=b.nodes[c.source])).linkDegree+=e;(c.targetNode||(c.targetNode=b.nodes[c.target])).linkDegree+=e})};pv.Layout.Hierarchy=function(){pv.Layout.Network.call(this);this.link.strokeStyle("#ccc")};pv.Layout.Hierarchy.prototype=pv.extend(pv.Layout.Network);
pv.Layout.Hierarchy.prototype.buildImplied=function(b){if(!b.links)b.links=pv.Layout.Hierarchy.links.call(this);pv.Layout.Network.prototype.buildImplied.call(this,b)};pv.Layout.Hierarchy.links=function(){return this.nodes().filter(function(b){return b.parentNode}).map(function(b){return{sourceNode:b,targetNode:b.parentNode,linkValue:1}})};
pv.Layout.Hierarchy.NodeLink={buildImplied:function(b){function c(n){return n.parentNode?n.depth*(l-m)+m:0}function e(n){return n.parentNode?(n.breadth-0.25)*2*Math.PI:0}function d(n){switch(h){case "left":return n.depth*j;case "right":return j-n.depth*j;case "top":return n.breadth*j;case "bottom":return j-n.breadth*j;case "radial":return j/2+c(n)*Math.cos(n.midAngle)}}function f(n){switch(h){case "left":return n.breadth*k;case "right":return k-n.breadth*k;case "top":return n.depth*k;case "bottom":return k-
n.depth*k;case "radial":return k/2+c(n)*Math.sin(n.midAngle)}}var g=b.nodes,h=b.orient,i=/^(top|bottom)$/.test(h),j=b.width,k=b.height;if(h=="radial"){var m=b.innerRadius,l=b.outerRadius;if(m==null)m=0;if(l==null)l=Math.min(j,k)/2}for(b=0;b<g.length;b++){var p=g[b];p.midAngle=h=="radial"?e(p):i?Math.PI/2:0;p.x=d(p);p.y=f(p);if(p.firstChild)p.midAngle+=Math.PI}}};
pv.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(b){return b.dx}).height(function(b){return b.dy}).innerRadius(function(b){return b.innerRadius}).outerRadius(function(b){return b.outerRadius}).startAngle(function(b){return b.startAngle}).angle(function(b){return b.angle});this.label.textAlign("center").left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2});delete this.link},buildImplied:function(b){function c(q,x){return(q+
x)/(1+x)}function e(q){switch(l){case "left":return c(q.minDepth,r)*n;case "right":return(1-c(q.maxDepth,r))*n;case "top":return q.minBreadth*n;case "bottom":return(1-q.maxBreadth)*n;case "radial":return n/2}}function d(q){switch(l){case "left":return q.minBreadth*o;case "right":return(1-q.maxBreadth)*o;case "top":return c(q.minDepth,r)*o;case "bottom":return(1-c(q.maxDepth,r))*o;case "radial":return o/2}}function f(q){switch(l){case "left":case "right":return(q.maxDepth-q.minDepth)/(1+r)*n;case "top":case "bottom":return(q.maxBreadth-
q.minBreadth)*n;case "radial":return q.parentNode?(q.innerRadius+q.outerRadius)*Math.cos(q.midAngle):0}}function g(q){switch(l){case "left":case "right":return(q.maxBreadth-q.minBreadth)*o;case "top":case "bottom":return(q.maxDepth-q.minDepth)/(1+r)*o;case "radial":return q.parentNode?(q.innerRadius+q.outerRadius)*Math.sin(q.midAngle):0}}function h(q){return Math.max(0,c(q.minDepth,r/2))*(t-u)+u}function i(q){return c(q.maxDepth,r/2)*(t-u)+u}function j(q){return(q.parentNode?q.minBreadth-0.25:0)*
2*Math.PI}function k(q){return(q.parentNode?q.maxBreadth-q.minBreadth:1)*2*Math.PI}var m=b.nodes,l=b.orient,p=/^(top|bottom)$/.test(l),n=b.width,o=b.height,r=-m[0].minDepth;if(l=="radial"){var u=b.innerRadius,t=b.outerRadius;if(u==null)u=0;if(u)r*=2;if(t==null)t=Math.min(n,o)/2}for(b=0;b<m.length;b++){var s=m[b];s.x=e(s);s.y=d(s);if(l=="radial"){s.innerRadius=h(s);s.outerRadius=i(s);s.startAngle=j(s);s.angle=k(s);s.midAngle=s.startAngle+s.angle/2}else s.midAngle=p?-Math.PI/2:0;s.dx=f(s);s.dy=g(s)}}};
pv.Layout.Grid=function(){pv.Layout.call(this);var b=this;(this.cell=(new pv.Mark).data(function(){return b.scene[b.index].$grid}).width(function(){return b.width()/b.cols()}).height(function(){return b.height()/b.rows()}).left(function(){return this.width()*(this.index%b.cols())}).top(function(){return this.height()*Math.floor(this.index/b.cols())})).parent=this};pv.Layout.Grid.prototype=pv.extend(pv.Layout).property("rows").property("cols");pv.Layout.Grid.prototype.defaults=(new pv.Layout.Grid).extend(pv.Layout.prototype.defaults).rows(1).cols(1);
pv.Layout.Grid.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=b.rows,e=b.cols;if(typeof e=="object")c=pv.transpose(e);if(typeof c=="object"){b.$grid=pv.blend(c);b.rows=c.length;b.cols=c[0]?c[0].length:0}else b.$grid=pv.repeat([b.data],c*e)};
pv.Layout.Stack=function(){function b(h){return function(){return d[h](this.parent.index,this.index)}}pv.Layout.call(this);var c=this,e=function(){return null},d={t:e,l:e,r:e,b:e,w:e,h:e},f,g=c.buildImplied;this.buildImplied=function(h){g.call(this,h);var i=h.layers,j=i.length,k,m=h.orient,l=/^(top|bottom)\b/.test(m),p=this.parent[l?"height":"width"](),n=[],o=[],r=[],u=pv.Mark.stack,t={parent:{parent:this}};u.unshift(null);f=[];for(var s=0;s<j;s++){r[s]=[];o[s]=[];t.parent.index=s;u[0]=i[s];f[s]=
this.$values.apply(t.parent,u);if(!s)k=f[s].length;u.unshift(null);for(var q=0;q<k;q++){u[0]=f[s][q];t.index=q;s||(n[q]=this.$x.apply(t,u));r[s][q]=this.$y.apply(t,u)}u.shift()}u.shift();switch(h.order){case "inside-out":var x=r.map(function(y){return pv.max.index(y)});t=pv.range(j).sort(function(y,C){return x[y]-x[C]});i=r.map(function(y){return pv.sum(y)});var v=u=0,z=[],w=[];for(s=0;s<j;s++){q=t[s];if(u<v){u+=i[q];z.push(q)}else{v+=i[q];w.push(q)}}i=w.reverse().concat(z);break;case "reverse":i=
pv.range(j-1,-1,-1);break;default:i=pv.range(j);break}switch(h.offset){case "silohouette":for(q=0;q<k;q++){for(s=t=0;s<j;s++)t+=r[s][q];o[i[0]][q]=(p-t)/2}break;case "wiggle":for(s=t=0;s<j;s++)t+=r[s][0];o[i[0]][0]=t=(p-t)/2;for(q=1;q<k;q++){u=p=0;v=n[q]-n[q-1];for(s=0;s<j;s++)p+=r[s][q];for(s=0;s<j;s++){z=(r[i[s]][q]-r[i[s]][q-1])/(2*v);for(h=0;h<s;h++)z+=(r[i[h]][q]-r[i[h]][q-1])/v;u+=z*r[i[s]][q]}o[i[0]][q]=t-=p?u/p*v:0}break;case "expand":for(q=0;q<k;q++){for(s=h=o[i[0]][q]=0;s<j;s++)h+=r[s][q];
if(h){h=p/h;for(s=0;s<j;s++)r[s][q]*=h}else{h=p/j;for(s=0;s<j;s++)r[s][q]=h}}break;default:for(q=0;q<k;q++)o[i[0]][q]=0;break}for(q=0;q<k;q++){t=o[i[0]][q];for(s=1;s<j;s++){t+=r[i[s-1]][q];o[i[s]][q]=t}}s=m.indexOf("-");j=l?"h":"w";l=s<0?l?"l":"b":m.charAt(s+1);m=m.charAt(0);for(var A in d)d[A]=e;d[l]=function(y,C){return n[C]};d[m]=function(y,C){return o[y][C]};d[j]=function(y,C){return r[y][C]}};this.layer=(new pv.Mark).data(function(){return f[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));
this.layer.add=function(h){return c.add(pv.Panel).data(function(){return c.layers()}).add(h).extend(this)}};pv.Layout.Stack.prototype=pv.extend(pv.Layout).property("orient",String).property("offset",String).property("order",String).property("layers");a=pv.Layout.Stack.prototype;a.defaults=(new pv.Layout.Stack).extend(pv.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]);a.$x=pv.Layout.Stack.prototype.$y=function(){return 0};a.x=function(b){this.$x=pv.functor(b);return this};
a.y=function(b){this.$y=pv.functor(b);return this};a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.Band=function(){function b(j){return function(){return d[j](this.index,this.parent.index)}}pv.Layout.call(this);var c=this,e=c.buildImplied,d,f,g=(new pv.Mark).data(function(){return f[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));this.buildImplied=function(j){e.call(this,j);d=Object.create(pv.Layout.Band.$baseItemProps);f=[];var k=j.layers,m=k.length;if(m>0){var l=j.orient,p=/^(top|bottom)\b/.test(l),n=this.parent[p?"height":"width"]();
k=this._readData(k,f,j);var o=k.length;j.bandOrder==="reverse"&&k.reverse();if(j.order==="reverse"){f.reverse();for(var r=0;r<o;r++)k[r].items.reverse()}switch(j.layout){case "grouped":this._calcGrouped(k,m,j);break;case "stacked":this._calcStacked(k,m,n,j);break}this._bindItemProps(k,d,l,p)}};var h=this.item={end:this,add:function(j){return c.add(pv.Panel).data(function(){return c.layers()}).add(j).extend(g)},order:function(j){c.order(j);return this},w:function(j){c.$iw=pv.functor(j);return this},
h:function(j){c.$ih=pv.functor(j);return this},horizontalRatio:function(j){c.$ihorizRatio=pv.functor(j);return this},verticalMargin:function(j){c.$ivertiMargin=pv.functor(j);return this}},i=this.band={end:this,w:function(j){c.$bw=pv.functor(j);return this},x:function(j){c.$bx=pv.functor(j);return this},order:function(j){c.bandOrder(j);return this},differentialControl:function(j){c.$bDiffControl=pv.functor(j);return this}};this.band.item=h;this.item.band=i};
pv.Layout.Band.$baseItemProps=function(){var b=function(){return null};return{t:b,l:b,r:b,b:b,w:b,h:b}}();pv.Layout.Band.prototype=pv.extend(pv.Layout).property("orient",String).property("layout",String).property("layers").property("yZero",Number).property("verticalMode",String).property("horizontalMode",String).property("order",String).property("bandOrder",String);a=pv.Layout.Band.prototype;a.defaults=(new pv.Layout.Band).extend(pv.Layout.prototype.defaults).orient("bottom-left").layout("grouped").yZero(0).layers([[]]);
a.$bx=pv.Layout.Band.prototype.$bw=pv.Layout.Band.prototype.$bDiffControl=pv.Layout.Band.prototype.$iw=pv.Layout.Band.prototype.$ih=pv.Layout.Band.prototype.$ivertiMargin=pv.functor(0);a.$ihorizRatio=pv.functor(0.9);a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.prototype._readData=function(b,c,e){var d=b.length,f=[],g,h=pv.Mark.stack,i={parent:{parent:this}};h.unshift(null);for(var j=0;j<d;j++){i.parent.index=j;h[0]=b[j];var k=c[j]=this.$values.apply(i.parent,h);if(!j)g=k.length;h.unshift(null);for(var m=0;m<g;m++){h[0]=k[m];i.index=m;var l=f[m];l||(l=f[m]={horizRatio:this.$ihorizRatio.apply(i,h),vertiMargin:this.$ivertiMargin.apply(i,h),w:this.$bw.apply(i,h),x:this.$bx.apply(i,h),diffControl:this.$bDiffControl?this.$bDiffControl.apply(i,h):0,
items:[]});var p=this.$ih.apply(i,h);l.items[j]={y:e.yZero||0,x:0,w:this.$iw.apply(i,h),h:p!=null?Math.abs(p):p,dir:p<0?-1:1}}h.shift()}h.shift();return f};
pv.Layout.Band.prototype._calcGrouped=function(b,c,e){for(var d=0,f=b.length;d<f;d++){for(var g=b[d],h=g.items,i=g.w,j=g.horizRatio,k=0,m=0;m<c;m++)k+=h[m].w;if(c===1)j=1;else j>0&&j<=1||(j=1);if(i==null)g.w=k/j;else if(e.horizontalMode==="expand"){i=j*i;if(k){k=i/k;for(m=0;m<c;m++)h[m].w*=k}else{k=i/c;for(m=0;m<c;m++)h[m].w=k}k=i}m=k/j;g=g.x-m/2;j=c>1?(m-k)/(c-1):0;for(m=0;m<c;m++){k=h[m];k.x=g;g+=k.w+j;if(k.dir<0)k.y-=k.h}}};
pv.Layout.Band.prototype._calcStacked=function(b,c,e,d){var f=b.length,g;if(d.verticalMode==="expand")for(var h=0;h<f;h++){g=b[h].items;for(var i=null,j=0,k=0;k<c;k++){var m=g[k];m.dir=1;m=m.h;if(m!=null){j++;i+=m}}if(j)if(i){i=e/i;for(k=0;k<c;k++){m=g[k].h;if(m!=null)g[k].h=m*i}}else{i=e/j;for(k=0;k<c;k++){m=g[k].h;if(m!=null)g[k].h=i}}}e=c=d.yZero;for(h=0;h<f;h++){g=b[h];d=g.x;k=g.diffControl;m=k<0;i=g.vertiMargin>0?g.vertiMargin:0;g=g.items;j=this._layoutItemsOfDir(+1,m,g,i,d,e);var l;if(j.existsOtherDir)l=
this._layoutItemsOfDir(-1,m,g,i,d,e);if(k){if(Math.abs(k)===1){g=e;e=j.yOffset;if(l)e-=g-l.yOffset}}else e=c}};pv.Layout.Band.prototype._layoutItemsOfDir=function(b,c,e,d,f,g){for(var h=false,i=d/2,j=c?-b:b,k=0,m=e.length;k<m;k+=1){var l=e[c?m-k-1:k];if(l.dir===b){var p=l.h||0;if(j>0){l.y=g+i;g+=p}else{l.y=g-(p-i);g-=p}p=l.h-d;l.h=p>0?p:0;l.x=f-l.w/2}else h=true}return{existsOtherDir:h,yOffset:g}};
pv.Layout.Band.prototype._bindItemProps=function(b,c,e,d){var f=e.indexOf("-"),g=d?"h":"w",h=d?"w":"h";d=f<0?d?"l":"b":e.charAt(f+1);e=e.charAt(0);c[d]=function(i,j){return b[i].items[j].x};c[e]=function(i,j){return b[i].items[j].y};c[h]=function(i,j){return b[i].items[j].w};c[g]=function(i,j){return b[i].items[j].h||0}};
pv.Layout.Treemap=function(){pv.Layout.Hierarchy.call(this);this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(b){return b.dx}).height(function(b){return b.dy});this.label.visible(function(b){return!b.firstChild}).left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2}).textAlign("center").textAngle(function(b){return b.dx>b.dy?0:-Math.PI/2});(this.leaf=(new pv.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(b){return!b.firstChild})).parent=
this;delete this.link};pv.Layout.Treemap.prototype=pv.extend(pv.Layout.Hierarchy).property("round",Boolean).property("paddingLeft",Number).property("paddingRight",Number).property("paddingTop",Number).property("paddingBottom",Number).property("mode",String).property("order",String);a=pv.Layout.Treemap.prototype;a.defaults=(new pv.Layout.Treemap).extend(pv.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending");a.padding=function(b){return this.paddingLeft(b).paddingRight(b).paddingTop(b).paddingBottom(b)};
a.$size=function(b){return Number(b.nodeValue)};a.size=function(b){this.$size=pv.functor(b);return this};
a.buildImplied=function(b){function c(o,r,u,t,s,q,x){for(var v=0,z=0;v<o.length;v++){var w=o[v];if(u){w.x=t+z;w.y=s;z+=w.dx=p(q*w.size/r);w.dy=x}else{w.x=t;w.y=s+z;w.dx=q;z+=w.dy=p(x*w.size/r)}}if(w)if(u)w.dx+=q-z;else w.dy+=x-z}function e(o,r){for(var u=-Infinity,t=Infinity,s=0,q=0;q<o.length;q++){var x=o[q].size;if(x<t)t=x;if(x>u)u=x;s+=x}s*=s;r*=r;return Math.max(r*u/s,s/(r*t))}function d(o,r){function u(y){var C=q==z,E=pv.sum(y,l),B=z?p(E/z):0;c(y,E,C,t,s,C?q:B,C?B:x);if(C){s+=B;x-=B}else{t+=
B;q-=B}z=Math.min(q,x);return C}var t=o.x+i,s=o.y+k,q=o.dx-i-j,x=o.dy-k-m;if(n!="squarify")c(o.childNodes,o.size,n=="slice"?true:n=="dice"?false:r&1,t,s,q,x);else{var v=[];r=Infinity;var z=Math.min(q,x),w=q*x/o.size;if(!(o.size<=0)){o.visitBefore(function(y){y.size*=w});for(o=o.childNodes.slice();o.length;){var A=o[o.length-1];if(A.size){v.push(A);w=e(v,z);if(w<=r){o.pop();r=w}else{v.pop();u(v);v.length=0;r=Infinity}}else o.pop()}if(u(v))for(r=0;r<v.length;r++)v[r].dy+=x;else for(r=0;r<v.length;r++)v[r].dx+=
q}}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var f=this,g=b.nodes[0],h=pv.Mark.stack,i=b.paddingLeft,j=b.paddingRight,k=b.paddingTop,m=b.paddingBottom,l=function(o){return o.size},p=b.round?Math.round:Number,n=b.mode;h.unshift(null);g.visitAfter(function(o,r){o.depth=r;o.x=o.y=o.dx=o.dy=0;o.size=o.firstChild?pv.sum(o.childNodes,function(u){return u.size}):f.$size.apply(f,(h[0]=o,h))});h.shift();switch(b.order){case "ascending":g.sort(function(o,r){return o.size-r.size});break;
case "descending":g.sort(function(o,r){return r.size-o.size});break;case "reverse":g.reverse();break}g.x=0;g.y=0;g.dx=b.width;g.dy=b.height;g.visitBefore(d)}};pv.Layout.Tree=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Tree.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String);pv.Layout.Tree.prototype.defaults=(new pv.Layout.Tree).extend(pv.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top");
pv.Layout.Tree.prototype.buildImplied=function(b){function c(q){var x,v,z;if(q.firstChild){x=q.firstChild;v=q.lastChild;for(var w=z=x;w;w=w.nextSibling){c(w);z=d(w,z)}i(q);v=0.5*(x.prelim+v.prelim);if(x=q.previousSibling){q.prelim=x.prelim+k(q.depth,true);q.mod=q.prelim-v}else q.prelim=v}else if(x=q.previousSibling)q.prelim=x.prelim+k(q.depth,true)}function e(q,x,v){q.breadth=q.prelim+x;x+=q.mod;for(q=q.firstChild;q;q=q.nextSibling)e(q,x,v)}function d(q,x){var v=q.previousSibling;if(v){var z=q,w=
q,A=v;v=q.parentNode.firstChild;var y=z.mod,C=w.mod,E=A.mod,B=v.mod;A=g(A);for(z=f(z);A&&z;){A=A;z=z;v=f(v);w=g(w);w.ancestor=q;var D=A.prelim+E-(z.prelim+y)+k(A.depth,false);if(D>0){h(j(A,q,x),q,D);y+=D;C+=D}E+=A.mod;y+=z.mod;B+=v.mod;C+=w.mod;A=g(A);z=f(z)}if(A&&!g(w)){w.thread=A;w.mod+=E-C}if(z&&!f(v)){v.thread=z;v.mod+=y-B;x=q}}return x}function f(q){return q.firstChild||q.thread}function g(q){return q.lastChild||q.thread}function h(q,x,v){var z=x.number-q.number;x.change-=v/z;x.shift+=v;q.change+=
v/z;x.prelim+=v;x.mod+=v}function i(q){var x=0,v=0;for(q=q.lastChild;q;q=q.previousSibling){q.prelim+=x;q.mod+=x;v+=q.change;x+=q.shift+v}}function j(q,x,v){return q.ancestor.parentNode==x.parentNode?q.ancestor:v}function k(q,x){return(x?1:u+1)/(n=="radial"?q:1)}function m(q){return n=="radial"?q.breadth/o:0}function l(q){switch(n){case "left":return q.depth;case "right":return t-q.depth;case "top":case "bottom":return q.breadth+t/2;case "radial":return t/2+q.depth*Math.cos(m(q))}}function p(q){switch(n){case "left":case "right":return q.breadth+
s/2;case "top":return q.depth;case "bottom":return s-q.depth;case "radial":return s/2+q.depth*Math.sin(m(q))}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var n=b.orient,o=b.depth,r=b.breadth,u=b.group,t=b.width,s=b.height;b=b.nodes[0];b.visitAfter(function(q,x){q.ancestor=q;q.prelim=0;q.mod=0;q.change=0;q.shift=0;q.number=q.previousSibling?q.previousSibling.number+1:0;q.depth=x});c(b);e(b,-b.prelim,0);b.visitAfter(function(q){q.breadth*=r;q.depth*=o;q.midAngle=m(q);q.x=l(q);q.y=p(q);
if(q.firstChild)q.midAngle+=Math.PI;delete q.breadth;delete q.depth;delete q.ancestor;delete q.prelim;delete q.mod;delete q.change;delete q.shift;delete q.number;delete q.thread})}};pv.Layout.Indent=function(){pv.Layout.Hierarchy.call(this);this.link.interpolate("step-after")};pv.Layout.Indent.prototype=pv.extend(pv.Layout.Hierarchy).property("depth",Number).property("breadth",Number);pv.Layout.Indent.prototype.defaults=(new pv.Layout.Indent).extend(pv.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15);
pv.Layout.Indent.prototype.buildImplied=function(b){function c(h,i,j){h.x=f+j++*d;h.y=g+i++*e;h.midAngle=0;for(h=h.firstChild;h;h=h.nextSibling)i=c(h,i,j);return i}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var e=b.breadth,d=b.depth,f=0,g=0;c(b.nodes[0],1,1)}};pv.Layout.Pack=function(){pv.Layout.Hierarchy.call(this);this.node.shapeRadius(function(b){return b.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)");this.label.textAlign("center");delete this.link};
pv.Layout.Pack.prototype=pv.extend(pv.Layout.Hierarchy).property("spacing",Number).property("order",String);pv.Layout.Pack.prototype.defaults=(new pv.Layout.Pack).extend(pv.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending");pv.Layout.Pack.prototype.$radius=function(){return 1};pv.Layout.Pack.prototype.size=function(b){this.$radius=typeof b=="function"?function(){return Math.sqrt(b.apply(this,arguments))}:(b=Math.sqrt(b),function(){return b});return this};
pv.Layout.Pack.prototype.buildImplied=function(b){function c(l){var p=pv.Mark.stack;p.unshift(null);for(var n=0,o=l.length;n<o;n++){var r=l[n];if(!r.firstChild)r.radius=h.$radius.apply(h,(p[0]=r,p))}p.shift()}function e(l){var p=[];for(l=l.firstChild;l;l=l.nextSibling){if(l.firstChild)l.radius=e(l);l.n=l.p=l;p.push(l)}switch(b.order){case "ascending":p.sort(function(n,o){return n.radius-o.radius});break;case "descending":p.sort(function(n,o){return o.radius-n.radius});break;case "reverse":p.reverse();
break}return d(p)}function d(l){function p(D){u=Math.min(D.x-D.radius,u);t=Math.max(D.x+D.radius,t);s=Math.min(D.y-D.radius,s);q=Math.max(D.y+D.radius,q)}function n(D,F){var G=D.n;D.n=F;F.p=D;F.n=G;G.p=F}function o(D,F){D.n=F;F.p=D}function r(D,F){var G=F.x-D.x,H=F.y-D.y;D=D.radius+F.radius;return D*D-G*G-H*H>0.001}var u=Infinity,t=-Infinity,s=Infinity,q=-Infinity,x,v,z,w,A;x=l[0];x.x=-x.radius;x.y=0;p(x);if(l.length>1){v=l[1];v.x=v.radius;v.y=0;p(v);if(l.length>2){z=l[2];f(x,v,z);p(z);n(x,z);x.p=
z;n(z,v);v=x.n;for(var y=3;y<l.length;y++){f(x,v,z=l[y]);var C=0,E=1,B=1;for(w=v.n;w!=v;w=w.n,E++)if(r(w,z)){C=1;break}if(C==1)for(A=x.p;A!=w.p;A=A.p,B++)if(r(A,z)){if(B<E){C=-1;w=A}break}if(C==0){n(x,z);v=z;p(z)}else if(C>0){o(x,w);v=w;y--}else if(C<0){o(w,v);x=w;y--}}}}x=(u+t)/2;v=(s+q)/2;for(y=z=0;y<l.length;y++){w=l[y];w.x-=x;w.y-=v;z=Math.max(z,w.radius+Math.sqrt(w.x*w.x+w.y*w.y))}return z+b.spacing}function f(l,p,n){var o=p.radius+n.radius,r=l.radius+n.radius,u=p.x-l.x;p=p.y-l.y;var t=Math.sqrt(u*
u+p*p),s=(r*r+t*t-o*o)/(2*r*t);o=Math.acos(s);s=s*r;r=Math.sin(o)*r;u/=t;p/=t;n.x=l.x+s*u+r*p;n.y=l.y+s*p-r*u}function g(l,p,n,o){for(var r=l.firstChild;r;r=r.nextSibling){r.x+=l.x;r.y+=l.y;g(r,p,n,o)}l.x=p+o*l.x;l.y=n+o*l.y;l.radius*=o}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var h=this,i=b.nodes,j=i[0];c(i);j.x=0;j.y=0;j.radius=e(j);i=this.width();var k=this.height(),m=1/Math.max(2*j.radius/i,2*j.radius/k);g(j,i/2,k/2,m)}};
pv.Layout.Force=function(){pv.Layout.Network.call(this);this.link.lineWidth(function(b,c){return Math.sqrt(c.linkValue)*1.5});this.label.textAlign("center")};
pv.Layout.Force.prototype=pv.extend(pv.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number);pv.Layout.Force.prototype.defaults=(new pv.Layout.Force).extend(pv.Layout.Network.prototype.defaults).dragConstant(0.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(0.9).springConstant(0.1).springDamping(0.3).springLength(20);
pv.Layout.Force.prototype.buildImplied=function(b){function c(m){return m.fix?1:m.vx*m.vx+m.vy*m.vy}if(pv.Layout.Network.prototype.buildImplied.call(this,b)){if(b=b.$force){b.next=this.binds.$force;this.binds.$force=b}}else{for(var e=this,d=b.nodes,f=b.links,g=b.iterations,h=b.width,i=b.height,j=0,k;j<d.length;j++){k=d[j];if(isNaN(k.x))k.x=h/2+40*Math.random()-20;if(isNaN(k.y))k.y=i/2+40*Math.random()-20}k=pv.simulation(d);k.force(pv.Force.drag(b.dragConstant));k.force(pv.Force.charge(b.chargeConstant).domain(b.chargeMinDistance,
b.chargeMaxDistance).theta(b.chargeTheta));k.force(pv.Force.spring(b.springConstant).damping(b.springDamping).length(b.springLength).links(f));k.constraint(pv.Constraint.position());b.bound&&k.constraint(pv.Constraint.bound().x(6,h-6).y(6,i-6));if(g==null){k.step();k.step();b.$force=this.binds.$force={next:this.binds.$force,nodes:d,min:1.0E-4*(f.length+1),sim:k};if(!this.$timer)this.$timer=setInterval(function(){for(var m=false,l=e.binds.$force;l;l=l.next)if(pv.max(l.nodes,c)>l.min){l.sim.step();
m=true}m&&e.render()},42)}else for(j=0;j<g;j++)k.step()}};pv.Layout.Cluster=function(){pv.Layout.Hierarchy.call(this);var b,c=this.buildImplied;this.buildImplied=function(e){c.call(this,e);b=/^(top|bottom)$/.test(e.orient)?"step-before":/^(left|right)$/.test(e.orient)?"step-after":"linear"};this.link.interpolate(function(){return b})};
pv.Layout.Cluster.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);pv.Layout.Cluster.prototype.defaults=(new pv.Layout.Cluster).extend(pv.Layout.Hierarchy.prototype.defaults).group(0).orient("top");
pv.Layout.Cluster.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=b.nodes[0],e=b.group,d,f,g=0,h=0.5-e/2,i=undefined;c.visitAfter(function(j){if(j.firstChild)j.depth=1+pv.max(j.childNodes,function(k){return k.depth});else{if(e&&i!=j.parentNode){i=j.parentNode;g+=e}g++;j.depth=0}});d=1/g;f=1/c.depth;i=undefined;c.visitAfter(function(j){if(j.firstChild)j.breadth=pv.mean(j.childNodes,function(k){return k.breadth});else{if(e&&i!=j.parentNode){i=j.parentNode;
h+=e}j.breadth=d*h++}j.depth=1-j.depth*f});c.visitAfter(function(j){j.minBreadth=j.firstChild?j.firstChild.minBreadth:j.breadth-d/2;j.maxBreadth=j.firstChild?j.lastChild.maxBreadth:j.breadth+d/2});c.visitBefore(function(j){j.minDepth=j.parentNode?j.parentNode.maxDepth:0;j.maxDepth=j.parentNode?j.depth+c.depth:j.minDepth+2*c.depth});c.minDepth=-f;pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Cluster.Fill=function(){pv.Layout.Cluster.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};
pv.Layout.Cluster.Fill.prototype=pv.extend(pv.Layout.Cluster);pv.Layout.Cluster.Fill.prototype.buildImplied=function(b){pv.Layout.Cluster.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Partition=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Partition.prototype=pv.extend(pv.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);
pv.Layout.Partition.prototype.defaults=(new pv.Layout.Partition).extend(pv.Layout.Hierarchy.prototype.defaults).orient("top");pv.Layout.Partition.prototype.$size=function(){return 1};pv.Layout.Partition.prototype.size=function(b){this.$size=b;return this};
pv.Layout.Partition.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=this,e=b.nodes[0],d=pv.Mark.stack,f=0;d.unshift(null);e.visitAfter(function(h,i){if(i>f)f=i;h.size=h.firstChild?pv.sum(h.childNodes,function(j){return j.size}):c.$size.apply(c,(d[0]=h,d))});d.shift();switch(b.order){case "ascending":e.sort(function(h,i){return h.size-i.size});break;case "descending":e.sort(function(h,i){return i.size-h.size});break}var g=1/f;e.minBreadth=0;e.breadth=
0.5;e.maxBreadth=1;e.visitBefore(function(h){for(var i=h.minBreadth,j=h.maxBreadth-i,k=h.firstChild;k;k=k.nextSibling){k.minBreadth=i;k.maxBreadth=i+=k.size/h.size*j;k.breadth=(i+k.minBreadth)/2}});e.visitAfter(function(h,i){h.minDepth=(i-1)*g;h.maxDepth=h.depth=i*g});pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Partition.Fill=function(){pv.Layout.Partition.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};pv.Layout.Partition.Fill.prototype=pv.extend(pv.Layout.Partition);
pv.Layout.Partition.Fill.prototype.buildImplied=function(b){pv.Layout.Partition.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Arc=function(){pv.Layout.Network.call(this);var b,c,e,d=this.buildImplied;this.buildImplied=function(f){d.call(this,f);c=f.directed;b=f.orient=="radial"?"linear":"polar";e=f.orient=="right"||f.orient=="top"};this.link.data(function(f){var g=f.sourceNode;f=f.targetNode;return e!=(c||g.breadth<f.breadth)?[g,f]:[f,g]}).interpolate(function(){return b})};
pv.Layout.Arc.prototype=pv.extend(pv.Layout.Network).property("orient",String).property("directed",Boolean);pv.Layout.Arc.prototype.defaults=(new pv.Layout.Arc).extend(pv.Layout.Network.prototype.defaults).orient("bottom");pv.Layout.Arc.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Arc.prototype.buildImplied=function(b){function c(n){switch(g){case "top":return-Math.PI/2;case "bottom":return Math.PI/2;case "left":return Math.PI;case "right":return 0;case "radial":return(n-0.25)*2*Math.PI}}function e(n){switch(g){case "top":case "bottom":return n*j;case "left":return 0;case "right":return j;case "radial":return j/2+m*Math.cos(c(n))}}function d(n){switch(g){case "top":return 0;case "bottom":return k;case "left":case "right":return n*k;case "radial":return k/2+m*Math.sin(c(n))}}
if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var f=b.nodes,g=b.orient,h=this.$sort,i=pv.range(f.length),j=b.width,k=b.height,m=Math.min(j,k)/2;h&&i.sort(function(n,o){return h(f[n],f[o])});for(b=0;b<f.length;b++){var l=f[i[b]],p=l.breadth=(b+0.5)/f.length;l.x=e(p);l.y=d(p);l.midAngle=c(p)}}};
pv.Layout.Horizon=function(){pv.Layout.call(this);var b=this,c,e,d,f,g,h,i=this.buildImplied;this.buildImplied=function(j){i.call(this,j);c=j.bands;e=j.mode;d=Math.round((e=="color"?0.5:1)*j.height);f=j.backgroundStyle;g=pv.ramp(f,j.negativeStyle).domain(0,c);h=pv.ramp(f,j.positiveStyle).domain(0,c)};c=(new pv.Panel).data(function(){return pv.range(c*2)}).overflow("hidden").height(function(){return d}).top(function(j){return e=="color"?(j&1)*d:0}).fillStyle(function(j){return j?null:f});this.band=
(new pv.Mark).top(function(j,k){return e=="mirror"&&k&1?(k+1>>1)*d:null}).bottom(function(j,k){return e=="mirror"?k&1?null:(k+1>>1)*-d:(k&1||-1)*(k+1>>1)*d}).fillStyle(function(j,k){return(k&1?g:h)((k>>1)+1)});this.band.add=function(j){return b.add(pv.Panel).extend(c).add(j).extend(this)}};pv.Layout.Horizon.prototype=pv.extend(pv.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",pv.color).property("positiveStyle",pv.color).property("negativeStyle",pv.color);
pv.Layout.Horizon.prototype.defaults=(new pv.Layout.Horizon).extend(pv.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728");
pv.Layout.Rollup=function(){pv.Layout.Network.call(this);var b=this,c,e,d=b.buildImplied;this.buildImplied=function(f){d.call(this,f);c=f.$rollup.nodes;e=f.$rollup.links};this.node.data(function(){return c}).shapeSize(function(f){return f.nodes.length*20});this.link.interpolate("polar").eccentricity(0.8);this.link.add=function(f){return b.add(pv.Panel).data(function(){return e}).add(f).extend(this)}};pv.Layout.Rollup.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);
pv.Layout.Rollup.prototype.x=function(b){this.$x=pv.functor(b);return this};pv.Layout.Rollup.prototype.y=function(b){this.$y=pv.functor(b);return this};
pv.Layout.Rollup.prototype.buildImplied=function(b){function c(o){return h[o]+","+i[o]}if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var e=b.nodes,d=b.links,f=b.directed,g=e.length,h=[],i=[],j=0,k={},m={},l=pv.Mark.stack,p={parent:this};l.unshift(null);for(var n=0;n<g;n++){p.index=n;l[0]=e[n];h[n]=this.$x.apply(p,l);i[n]=this.$y.apply(p,l)}l.shift();for(n=0;n<e.length;n++){g=c(n);l=k[g];if(!l){l=k[g]=pv.extend(e[n]);l.index=j++;l.x=h[n];l.y=i[n];l.nodes=[]}l.nodes.push(e[n])}for(n=0;n<
d.length;n++){j=d[n].targetNode;e=k[c(d[n].sourceNode.index)];j=k[c(j.index)];g=!f&&e.index>j.index?j.index+","+e.index:e.index+","+j.index;(l=m[g])||(l=m[g]={sourceNode:e,targetNode:j,linkValue:0,links:[]});l.links.push(d[n]);l.linkValue+=d[n].linkValue}b.$rollup={nodes:pv.values(k),links:pv.values(m)}}};
pv.Layout.Matrix=function(){pv.Layout.Network.call(this);var b,c,e,d,f,g=this.buildImplied;this.buildImplied=function(h){g.call(this,h);b=h.nodes.length;c=h.width/b;e=h.height/b;d=h.$matrix.labels;f=h.$matrix.pairs};this.link.data(function(){return f}).left(function(){return c*(this.index%b)}).top(function(){return e*Math.floor(this.index/b)}).width(function(){return c}).height(function(){return e}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(h){return h.linkValue?"#555":"#eee"}).parent=
this;delete this.link.add;this.label.data(function(){return d}).left(function(){return this.index&1?c*((this.index>>1)+0.5):0}).top(function(){return this.index&1?0:e*((this.index>>1)+0.5)}).textMargin(4).textAlign(function(){return this.index&1?"left":"right"}).textAngle(function(){return this.index&1?-Math.PI/2:0});delete this.node};pv.Layout.Matrix.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);pv.Layout.Matrix.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Matrix.prototype.buildImplied=function(b){if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var c=b.nodes,e=b.links,d=this.$sort,f=c.length,g=pv.range(f),h=[],i=[],j={};b.$matrix={labels:h,pairs:i};d&&g.sort(function(n,o){return d(c[n],c[o])});for(var k=0;k<f;k++)for(var m=0;m<f;m++){var l=g[k],p=g[m];i.push(j[l+"."+p]={row:k,col:m,sourceNode:c[l],targetNode:c[p],linkValue:0})}for(k=0;k<f;k++){l=g[k];h.push(c[l],c[l])}for(k=0;k<e.length;k++){h=e[k];f=h.sourceNode.index;g=h.targetNode.index;
h=h.linkValue;j[f+"."+g].linkValue+=h;b.directed||(j[g+"."+f].linkValue+=h)}}};
pv.Layout.Bullet=function(){pv.Layout.call(this);var b=this,c=b.buildImplied,e=b.x=pv.Scale.linear(),d,f,g,h,i;this.buildImplied=function(j){c.call(this,i=j);d=j.orient;f=/^left|right$/.test(d);g=pv.ramp("#bbb","#eee").domain(0,Math.max(1,i.ranges.length-1));h=pv.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,i.measures.length-1))};(this.range=new pv.Mark).data(function(){return i.ranges}).reverse(true).left(function(){return d=="left"?0:null}).top(function(){return d=="top"?0:null}).right(function(){return d==
"right"?0:null}).bottom(function(){return d=="bottom"?0:null}).width(function(j){return f?e(j):null}).height(function(j){return f?null:e(j)}).fillStyle(function(){return g(this.index)}).antialias(false).parent=b;(this.measure=new pv.Mark).extend(this.range).data(function(){return i.measures}).left(function(){return d=="left"?0:f?null:this.parent.width()/3.25}).top(function(){return d=="top"?0:f?this.parent.height()/3.25:null}).right(function(){return d=="right"?0:f?null:this.parent.width()/3.25}).bottom(function(){return d==
"bottom"?0:f?this.parent.height()/3.25:null}).fillStyle(function(){return h(this.index)}).parent=b;(this.marker=new pv.Mark).data(function(){return i.markers}).left(function(j){return d=="left"?e(j):f?null:this.parent.width()/2}).top(function(j){return d=="top"?e(j):f?this.parent.height()/2:null}).right(function(j){return d=="right"?e(j):null}).bottom(function(j){return d=="bottom"?e(j):null}).strokeStyle("black").shape("bar").shapeAngle(function(){return f?0:Math.PI/2}).parent=b;(this.tick=new pv.Mark).data(function(){return e.ticks(7)}).left(function(j){return d==
"left"?e(j):null}).top(function(j){return d=="top"?e(j):null}).right(function(j){return d=="right"?e(j):f?null:-6}).bottom(function(j){return d=="bottom"?e(j):f?-8:null}).height(function(){return f?6:null}).width(function(){return f?null:6}).parent=b};pv.Layout.Bullet.prototype=pv.extend(pv.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("maximum",Number);pv.Layout.Bullet.prototype.defaults=(new pv.Layout.Bullet).extend(pv.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]);
pv.Layout.Bullet.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=this.parent[/^left|right$/.test(b.orient)?"width":"height"]();b.maximum=b.maximum||pv.max([].concat(b.ranges,b.markers,b.measures));this.x.domain(0,b.maximum).range(0,c)};pv.Behavior={};
pv.Behavior.drag=function(){function b(j,k){f=this.index;d=this.scene;var m=this.mouse();h=((g=j).fix=pv.vector(j.x,j.y)).minus(m);i={x:this.parent.width()-(j.dx||0),y:this.parent.height()-(j.dy||0)};d.mark.context(d,f,function(){this.render()});pv.Mark.dispatch("dragstart",d,f,k)}function c(j){if(d){d.mark.context(d,f,function(){var k=this.mouse();g.x=g.fix.x=Math.max(0,Math.min(h.x+k.x,i.x));g.y=g.fix.y=Math.max(0,Math.min(h.y+k.y,i.y));this.render()});pv.Mark.dispatch("drag",d,f,j)}}function e(j){if(d){g.fix=
null;d.mark.context(d,f,function(){this.render()});pv.Mark.dispatch("dragend",d,f,j);d=null}}var d,f,g,h,i;pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",e);return b};
pv.Behavior.point=function(b){function c(m,l){m=m[l];l={cost:Infinity};for(var p=(m.visible?m.children.length:0)-1;p>=0;p--){var n=m.children[p],o=n.mark,r;if(o.type=="panel"){o.scene=n;for(var u=n.length-1;u>=0;u--){o.index=u;r=c(n,u);if(r.cost<l.cost)l=r}delete o.scene;delete o.index}else if(o.$handlers.point){o=o.mouse();for(u=n.length-1;u>=0;u--){var t=n[u];r=o.x-t.left-(t.width||0)/2;t=o.y-t.top-(t.height||0)/2;var s=h*r*r+i*t*t;if(s<l.cost){l.distance=r*r+t*t;l.cost=s;l.scene=n;l.index=u}}}}return l}
function e(m){var l=c(this.scene,this.index);if(l.cost==Infinity||l.distance>k)l=null;if(f){if(l&&f.scene==l.scene&&f.index==l.index)return;pv.Mark.dispatch("unpoint",f.scene,f.index,m)}if(f=l){pv.Mark.dispatch("point",l.scene,l.index,m);if(!j&&this.type==="panel"){j=this;j.event("mouseout",function(){d.call(j.scene.$g,arguments[arguments.length-1])})}else pv.listen(this.root.canvas(),"mouseout",d)}}function d(m){if(f&&!pv.ancestor(this,m.relatedTarget)){pv.Mark.dispatch("unpoint",f.scene,f.index,
m);f=null}}var f,g=null,h=1,i=1,j=null,k=arguments.length?b*b:900;e.collapse=function(m){if(arguments.length){g=String(m);switch(g){case "y":h=1;i=0;break;case "x":h=0;i=1;break;default:i=h=1;break}return e}return g};return e};
pv.Behavior.select=function(){function b(i,j){f=this.index;d=this.scene;h=this.mouse();g=i;g.x=h.x;g.y=h.y;g.dx=g.dy=0;pv.Mark.dispatch("selectstart",d,f,j)}function c(i){if(d){d.mark.context(d,f,function(){var j=this.mouse();g.x=Math.max(0,Math.min(h.x,j.x));g.y=Math.max(0,Math.min(h.y,j.y));g.dx=Math.min(this.width(),Math.max(j.x,h.x))-g.x;g.dy=Math.min(this.height(),Math.max(j.y,h.y))-g.y;this.render()});pv.Mark.dispatch("select",d,f,i)}}function e(i){if(d){pv.Mark.dispatch("selectend",d,f,i);
d=null}}var d,f,g,h;pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",e);return b};
pv.Behavior.resize=function(b){function c(j,k){g=this.index;f=this.scene;i=this.mouse();h=j;switch(b){case "left":i.x=h.x+h.dx;break;case "right":i.x=h.x;break;case "top":i.y=h.y+h.dy;break;case "bottom":i.y=h.y;break}pv.Mark.dispatch("resizestart",f,g,k)}function e(j){if(f){f.mark.context(f,g,function(){var k=this.mouse();h.x=Math.max(0,Math.min(i.x,k.x));h.y=Math.max(0,Math.min(i.y,k.y));h.dx=Math.min(this.parent.width(),Math.max(k.x,i.x))-h.x;h.dy=Math.min(this.parent.height(),Math.max(k.y,i.y))-
h.y;this.render()});pv.Mark.dispatch("resize",f,g,j)}}function d(j){if(f){pv.Mark.dispatch("resizeend",f,g,j);f=null}}var f,g,h,i;pv.listen(window,"mousemove",e);pv.listen(window,"mouseup",d);return c};
pv.Behavior.pan=function(){function b(){f=this.index;d=this.scene;h=pv.vector(pv.event.pageX,pv.event.pageY);g=this.transform();i=1/(g.k*this.scale);if(j)j={x:(1-g.k)*this.width(),y:(1-g.k)*this.height()}}function c(k){if(d){d.mark.context(d,f,function(){var m=g.translate((pv.event.pageX-h.x)*i,(pv.event.pageY-h.y)*i);if(j){m.x=Math.max(j.x,Math.min(0,m.x));m.y=Math.max(j.y,Math.min(0,m.y))}this.transform(m).render()});pv.Mark.dispatch("pan",d,f,k)}}function e(){d=null}var d,f,g,h,i,j;b.bound=function(k){if(arguments.length){j=
Boolean(k);return this}return Boolean(j)};pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",e);return b};
pv.Behavior.zoom=function(b){function c(d){var f=this.mouse(),g=pv.event.wheel*b;f=this.transform().translate(f.x,f.y).scale(g<0?1E3/(1E3-g):(1E3+g)/1E3).translate(-f.x,-f.y);if(e){f.k=Math.max(1,f.k);f.x=Math.max((1-f.k)*this.width(),Math.min(0,f.x));f.y=Math.max((1-f.k)*this.height(),Math.min(0,f.y))}this.transform(f).render();pv.Mark.dispatch("zoom",this.scene,this.index,d)}var e;arguments.length||(b=1/48);c.bound=function(d){if(arguments.length){e=Boolean(d);return this}return Boolean(e)};return c};
pv.Geo=function(){};
pv.Geo.projections={mercator:{project:function(b){return{x:b.lng/180,y:b.lat>85?1:b.lat<-85?-1:Math.log(Math.tan(Math.PI/4+pv.radians(b.lat)/2))/Math.PI}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(2*Math.atan(Math.exp(b.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(b){return{x:b.lng/180,y:Math.sin(pv.radians(b.lat))}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(Math.asin(b.y))}}},sinusoidal:{project:function(b){return{x:pv.radians(b.lng)*Math.cos(pv.radians(b.lat))/Math.PI,
y:b.lat/90}},invert:function(b){return{lng:pv.degrees(b.x*Math.PI/Math.cos(b.y*Math.PI/2)),lat:b.y*90}}},aitoff:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);var e=Math.acos(Math.cos(b)*Math.cos(c/2));return{x:2*(e?Math.cos(b)*Math.sin(c/2)*e/Math.sin(e):0)/Math.PI,y:2*(e?Math.sin(b)*e/Math.sin(e):0)/Math.PI}},invert:function(b){var c=b.y*Math.PI/2;return{lng:pv.degrees(b.x*Math.PI/2/Math.cos(c)),lat:pv.degrees(c)}}},hammer:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);
var e=Math.sqrt(1+Math.cos(b)*Math.cos(c/2));return{x:2*Math.SQRT2*Math.cos(b)*Math.sin(c/2)/e/3,y:Math.SQRT2*Math.sin(b)/e/1.5}},invert:function(b){var c=b.x*3;b=b.y*1.5;var e=Math.sqrt(1-c*c/16-b*b/4);return{lng:pv.degrees(2*Math.atan2(e*c,2*(2*e*e-1))),lat:pv.degrees(Math.asin(e*b))}}},identity:{project:function(b){return{x:b.lng/180,y:b.lat/90}},invert:function(b){return{lng:b.x*180,lat:b.y*90}}}};
pv.Geo.scale=function(b){function c(n){if(!l||n.lng!=l.lng||n.lat!=l.lat){l=n;n=e(n);p={x:j(n.x),y:k(n.y)}}return p}function e(n){return i.project({lng:n.lng-m.lng,lat:n.lat})}function d(n){n=i.invert(n);n.lng+=m.lng;return n}var f={x:0,y:0},g={x:1,y:1},h=[],i=pv.Geo.projections.identity,j=pv.Scale.linear(-1,1).range(0,1),k=pv.Scale.linear(-1,1).range(1,0),m={lng:0,lat:0},l,p;c.x=function(n){return c(n).x};c.y=function(n){return c(n).y};c.ticks={lng:function(n){var o;if(h.length>1){var r=pv.Scale.linear();
if(n==undefined)n=10;o=r.domain(h,function(u){return u.lat}).ticks(n);n=r.domain(h,function(u){return u.lng}).ticks(n)}else{o=pv.range(-80,81,10);n=pv.range(-180,181,10)}return n.map(function(u){return o.map(function(t){return{lat:t,lng:u}})})},lat:function(n){return pv.transpose(c.ticks.lng(n))}};c.invert=function(n){return d({x:j.invert(n.x),y:k.invert(n.y)})};c.domain=function(n,o){if(arguments.length){h=n instanceof Array?arguments.length>1?pv.map(n,o):n:Array.prototype.slice.call(arguments);
if(h.length>1){var r=h.map(function(t){return t.lng}),u=h.map(function(t){return t.lat});m={lng:(pv.max(r)+pv.min(r))/2,lat:(pv.max(u)+pv.min(u))/2};r=h.map(e);j.domain(r,function(t){return t.x});k.domain(r,function(t){return t.y})}else{m={lng:0,lat:0};j.domain(-1,1);k.domain(-1,1)}l=null;return this}return h};c.range=function(n,o){if(arguments.length){if(typeof n=="object"){f={x:Number(n.x),y:Number(n.y)};g={x:Number(o.x),y:Number(o.y)}}else{f={x:0,y:0};g={x:Number(n),y:Number(o)}}j.range(f.x,g.x);
k.range(g.y,f.y);l=null;return this}return[f,g]};c.projection=function(n){if(arguments.length){i=typeof n=="string"?pv.Geo.projections[n]||pv.Geo.projections.identity:n;return this.domain(h)}return n};pv.copyOwn(c,pv.Scale.common);arguments.length&&c.projection(b);return c};

// 
var a;if(!Array.prototype.map)Array.prototype.map=function(b,c){for(var d=this.length,e=new Array(d),f=0;f<d;f++)if(f in this)e[f]=b.call(c,this[f],f,this);return e};if(!Array.prototype.filter)Array.prototype.filter=function(b,c){for(var d=this.length,e=[],f=0;f<d;f++)if(f in this){var g=this[f];b.call(c,g,f,this)&&e.push(g)}return e};if(!Array.prototype.forEach)Array.prototype.forEach=function(b,c){for(var d=this.length>>>0,e=0;e<d;e++)e in this&&b.call(c,this[e],e,this)};
if(!Array.prototype.reduce)Array.prototype.reduce=function(b,c){var d=this.length;if(!d&&arguments.length==1)throw new Error("reduce: empty array, no initial value");var e=0;if(arguments.length<2)for(;;){if(e in this){c=this[e++];break}if(++e>=d)throw new Error("reduce: no values, no initial value");}for(;e<d;e++)if(e in this)c=b(c,this[e],e,this);return c};var pv={};pv.version={major:3,minor:3};pv.identity=function(b){return b};pv.index=function(){return this.index};pv.child=function(){return this.childIndex};
pv.parent=function(){return this.parent.index};pv.extend=function(b){function c(){}c.prototype=b.prototype||b;return new c};
pv.parse=function(b){for(var c=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),d,e,f=0,g="";d=c.exec(b);){d=d.index+d[0].length;if(b.charAt(d)!="{"){g+=b.substring(f,d)+"{return ";f=d;for(var h=0;h>=0&&d<b.length;d++){var i=b.charAt(d);switch(i){case '"':case "'":for(;++d<b.length&&(e=b.charAt(d))!=i;)e=="\\"&&d++;break;case "[":case "(":h++;break;case "]":case ")":h--;break;case ";":case ",":h==0&&h--;break}}g+=pv.parse(b.substring(f,--d))+";}";f=d}c.lastIndex=d}g+=b.substring(f);return g};
pv.css=function(b,c){return window.getComputedStyle?window.getComputedStyle(b,null).getPropertyValue(c):b.currentStyle[c]};pv.error=function(b){typeof console=="undefined"?alert(b):console.error(b)};pv.listen=function(b,c,d){if(c=="load"||c=="onload")return pv.listenForPageLoad(pv.listener(d));d=pv.listener(d);b.addEventListener?b.addEventListener(c,d,false):b.attachEvent("on"+c,d);return d};
pv.unlisten=function(b,c,d){if(d.$listener)d=d.$listener;b.removeEventListener?b.removeEventListener(c,d,false):b.detachEvent("on"+c,d)};pv.listener=function(b){return b.$listener||(b.$listener=function(c){try{pv.event=c;return b.call(this,c)}catch(d){pv.error(d)}finally{delete pv.event}})};pv.ancestor=function(b,c){for(;c;){if(c==b)return true;c=c.parentNode}return false};pv.scrollOffset=function(b){for(var c=0,d=0;b;){c+=b.scrollLeft||0;d+=b.scrollTop||0;b=b.parentNode}return[c,d]};
pv.listenForPageLoad=function(b){document.readyState==="complete"&&b();if(pv.renderer()=="svgweb")window.addEventListener("SVGLoad",b,false);else if(document.addEventListener)window.addEventListener("load",b,false);else document.attachEvent&&window.attachEvent("onload",b)};pv.renderer=function(){var b=typeof document.svgImplementation!=="undefined"?document.svgImplementation:typeof window.svgweb==="undefined"?"nativesvg":"svgweb";pv.renderer=function(){return b};return b};
pv.id=function(){var b=1;return function(){return b++}}();pv.functor=function(b){return typeof b=="function"?b:function(){return b}};pv.get=function(b,c,d){var e;return b&&(e=b[c])!=null?e:d};pv.renderer()!=="batik"&&pv.listen(window,"load",function(){pv.$={i:0,x:document.getElementsByTagName("script")};for(pv.$.xlen=pv.$.x.length;pv.$.i<pv.$.xlen;pv.$.i++){pv.$.s=pv.$.x[pv.$.i];if(pv.$.s.type=="text/javascript+protovis")try{window.eval(pv.parse(pv.$.s.text))}catch(b){pv.error(b)}}delete pv.$});
pv.Format={};pv.Format.re=function(b){return b.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")};pv.Format.pad=function(b,c,d){c=c-String(d).length;return c<1?d:(new Array(c+1)).join(b)+d};
pv.Format.date=function(b){function c(e){return b.replace(/%[a-zA-Z0-9]/g,function(f){switch(f){case "%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()];case "%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()];case "%h":case "%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()];case "%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()];
case "%c":return e.toLocaleString();case "%C":return d("0",2,Math.floor(e.getFullYear()/100)%100);case "%d":return d("0",2,e.getDate());case "%x":case "%D":return d("0",2,e.getMonth()+1)+"/"+d("0",2,e.getDate())+"/"+d("0",2,e.getFullYear()%100);case "%e":return d(" ",2,e.getDate());case "%H":return d("0",2,e.getHours());case "%I":return(f=e.getHours()%12)?d("0",2,f):12;case "%m":return d("0",2,e.getMonth()+1);case "%M":return d("0",2,e.getMinutes());case "%n":return"\n";case "%p":return e.getHours()<
12?"AM":"PM";case "%T":case "%X":case "%r":f=e.getHours()%12;return(f?d("0",2,f):12)+":"+d("0",2,e.getMinutes())+":"+d("0",2,e.getSeconds())+" "+(e.getHours()<12?"AM":"PM");case "%R":return d("0",2,e.getHours())+":"+d("0",2,e.getMinutes());case "%S":return d("0",2,e.getSeconds());case "%Q":return d("0",3,e.getMilliseconds());case "%t":return"\t";case "%u":return(f=e.getDay())?f:1;case "%w":return e.getDay();case "%y":return d("0",2,e.getFullYear()%100);case "%Y":return e.getFullYear();case "%%":return"%"}return f})}
var d=pv.Format.pad;c.format=c;c.parse=function(e){var f=1970,g=0,h=1,i=0,j=0,k=0,p=[function(){}],l=pv.Format.re(b).replace(/%[a-zA-Z0-9]/g,function(r){switch(r){case "%b":p.push(function(m){g={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[m]});return"([A-Za-z]+)";case "%h":case "%B":p.push(function(m){g={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[m]});return"([A-Za-z]+)";case "%e":case "%d":p.push(function(m){h=
m});return"([0-9]+)";case "%I":case "%H":p.push(function(m){i=m});return"([0-9]+)";case "%m":p.push(function(m){g=m-1});return"([0-9]+)";case "%M":p.push(function(m){j=m});return"([0-9]+)";case "%p":p.push(function(m){if(i==12){if(m=="am")i=0}else if(m=="pm")i=Number(i)+12});return"(am|pm)";case "%S":p.push(function(m){k=m});return"([0-9]+)";case "%y":p.push(function(m){m=Number(m);f=m+(0<=m&&m<69?2E3:m>=69&&m<100?1900:0)});return"([0-9]+)";case "%Y":p.push(function(m){f=m});return"([0-9]+)";case "%%":p.push(function(){});
return"%"}return r});(e=e.match(l))&&e.forEach(function(r,m){p[m](r)});return new Date(f,g,h,i,j,k)};return c};
pv.Format.time=function(b){function c(e){e=Number(e);switch(b){case "short":if(e>=31536E6)return(e/31536E6).toFixed(1)+" years";else if(e>=6048E5)return(e/6048E5).toFixed(1)+" weeks";else if(e>=864E5)return(e/864E5).toFixed(1)+" days";else if(e>=36E5)return(e/36E5).toFixed(1)+" hours";else if(e>=6E4)return(e/6E4).toFixed(1)+" minutes";return(e/1E3).toFixed(1)+" seconds";case "long":var f=[],g=e%36E5/6E4>>0;f.push(d("0",2,e%6E4/1E3>>0));if(e>=36E5){var h=e%864E5/36E5>>0;f.push(d("0",2,g));if(e>=864E5){f.push(d("0",
2,h));f.push(Math.floor(e/864E5).toFixed())}else f.push(h.toFixed())}else f.push(g.toFixed());return f.reverse().join(":")}}var d=pv.Format.pad;c.format=c;c.parse=function(e){switch(b){case "short":for(var f=/([0-9,.]+)\s*([a-z]+)/g,g,h=0;g=f.exec(e);){var i=parseFloat(g[0].replace(",","")),j=0;switch(g[2].toLowerCase()){case "year":case "years":j=31536E6;break;case "week":case "weeks":j=6048E5;break;case "day":case "days":j=864E5;break;case "hour":case "hours":j=36E5;break;case "minute":case "minutes":j=
6E4;break;case "second":case "seconds":j=1E3;break}h+=i*j}return h;case "long":g=e.replace(",","").split(":").reverse();h=0;if(g.length)h+=parseFloat(g[0])*1E3;if(g.length>1)h+=parseFloat(g[1])*6E4;if(g.length>2)h+=parseFloat(g[2])*36E5;if(g.length>3)h+=parseFloat(g[3])*864E5;return h}};return c};
pv.Format.number=function(){function b(n){if(Infinity>g)n=Math.round(n*h)/h;var o=String(Math.abs(n)).split("."),s=o[0];if(s.length>d)s=s.substring(s.length-d);if(k&&s.length<c)s=(new Array(c-s.length+1)).join(i)+s;if(s.length>3)s=s.replace(/\B(?=(?:\d{3})+(?!\d))/g,l);if(!k&&s.length<e)s=(new Array(e-s.length+1)).join(i)+s;o[0]=n<0?r+s+m:s;n=o[1]||"";if(n.length>g)n=o[1]=n.substr(0,g);if(n.length<f)o[1]=n+(new Array(f-n.length+1)).join(j);return o.join(p)}var c=0,d=Infinity,e=0,f=0,g=0,h=1,i="0",
j="0",k=true,p=".",l=",",r="\u2212",m="";b.format=b;b.parse=function(n){var o=pv.Format.re;n=String(n).split(p);if(n.length==1)n[1]="";n[0].replace(new RegExp("^("+o(i)+")*"),"");n[1].replace(new RegExp("("+o(j)+")*$"),"");o=n[0].replace(new RegExp(o(l),"g"),"");if(o.length>d)o=o.substring(o.length-d);n=n[1]?Number("0."+n[1]):0;if(Infinity>g)n=Math.round(n*h)/h;return Math.round(o)+n};b.integerDigits=function(n,o){if(arguments.length){c=Number(n);d=arguments.length>1?Number(o):c;e=c+Math.floor(c/
3)*l.length;return this}return[c,d]};b.fractionDigits=function(n,o){if(arguments.length){f=Number(n);g=arguments.length>1?Number(o):f;h=Math.pow(10,g);return this}return[f,g]};b.integerPad=function(n){if(arguments.length){i=String(n);k=/\d/.test(i);return this}return i};b.fractionPad=function(n){if(arguments.length){j=String(n);return this}return j};b.decimal=function(n){if(arguments.length){p=String(n);return this}return p};b.group=function(n){if(arguments.length){l=n?String(n):"";e=c+Math.floor(c/
3)*l.length;return this}return l};b.negativeAffix=function(n,o){if(arguments.length){r=String(n||"");m=String(o||"");return this}return[r,m]};return b};pv.map=function(b,c){var d={};return c?b.map(function(e,f){d.index=f;return c.call(d,e)}):b.slice()};pv.repeat=function(b,c){if(arguments.length==1)c=2;return pv.blend(pv.range(c).map(function(){return b}))};pv.array=function(b,c){var d=b>=0?new Array(b):[];if(c!==undefined)for(var e=0;e<b;e++)d[e]=c;return d};
pv.cross=function(b,c){for(var d=[],e=0,f=b.length,g=c.length;e<f;e++)for(var h=0,i=b[e];h<g;h++)d.push([i,c[h]]);return d};pv.blend=function(b){return Array.prototype.concat.apply([],b)};
pv.transpose=function(b){var c=b.length,d=pv.max(b,function(h){return h.length});if(d>c){b.length=d;for(var e=c;e<d;e++)b[e]=new Array(c);for(e=0;e<c;e++)for(var f=e+1;f<d;f++){var g=b[e][f];b[e][f]=b[f][e];b[f][e]=g}}else{for(e=0;e<d;e++)b[e].length=c;for(e=0;e<c;e++)for(f=0;f<e;f++){g=b[e][f];b[e][f]=b[f][e];b[f][e]=g}}b.length=d;for(e=0;e<d;e++)b[e].length=c;return b};pv.normalize=function(b,c){b=pv.map(b,c);c=pv.sum(b);for(var d=0;d<b.length;d++)b[d]/=c;return b};
pv.permute=function(b,c,d){if(!d)d=pv.identity;var e=new Array(c.length),f={};c.forEach(function(g,h){f.index=g;e[h]=d.call(f,b[g])});return e};pv.numerate=function(b,c){if(!c)c=pv.identity;var d={},e={};b.forEach(function(f,g){e.index=g;d[c.call(e,f)]=g});return d};pv.uniq=function(b,c){if(!c)c=pv.identity;var d={},e=[],f={},g;b.forEach(function(h,i){f.index=i;g=c.call(f,h);g in d||(d[g]=e.push(g))});return e};pv.naturalOrder=function(b,c){return b<c?-1:b>c?1:0};
pv.reverseOrder=function(b,c){return c<b?-1:c>b?1:0};pv.search=function(b,c,d){if(!d)d=pv.identity;for(var e=0,f=b.length-1;e<=f;){var g=e+f>>1,h=d(b[g]);if(h<c)e=g+1;else if(h>c)f=g-1;else return g}return-e-1};pv.search.index=function(b,c,d){b=pv.search(b,c,d);return b<0?-b-1:b};
pv.range=function(b,c,d){if(arguments.length==1){c=b;b=0}if(d==undefined)d=1;if((c-b)/d==Infinity)throw new Error("range must be finite");var e=[],f=0,g;c-=(c-b)*1.0E-10;if(d<0)for(;(g=b+d*f++)>c;)e.push(g);else for(;(g=b+d*f++)<c;)e.push(g);return e};pv.random=function(b,c,d){if(arguments.length==1){c=b;b=0}if(d==undefined)d=1;return d?Math.floor(Math.random()*(c-b)/d)*d+b:Math.random()*(c-b)+b};
pv.sum=function(b,c){var d={};return b.reduce(c?function(e,f,g){d.index=g;return e+c.call(d,f)}:function(e,f){return e+f},0)};pv.max=function(b,c){if(c==pv.index)return b.length-1;return Math.max.apply(null,c?pv.map(b,c):b)};pv.max.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return b.length-1;if(!c)c=pv.identity;for(var d=0,e=-Infinity,f={},g=0;g<b.length;g++){f.index=g;var h=c.call(f,b[g]);if(h>e){e=h;d=g}}return d};
pv.min=function(b,c){if(c==pv.index)return 0;return Math.min.apply(null,c?pv.map(b,c):b)};pv.min.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return 0;if(!c)c=pv.identity;for(var d=0,e=Infinity,f={},g=0;g<b.length;g++){f.index=g;var h=c.call(f,b[g]);if(h<e){e=h;d=g}}return d};pv.mean=function(b,c){return pv.sum(b,c)/b.length};
pv.median=function(b,c){if(c==pv.index)return(b.length-1)/2;b=pv.map(b,c).sort(pv.naturalOrder);if(b.length%2)return b[Math.floor(b.length/2)];c=b.length/2;return(b[c-1]+b[c])/2};pv.variance=function(b,c){if(b.length<1)return NaN;if(b.length==1)return 0;var d=pv.mean(b,c),e=0,f={};if(!c)c=pv.identity;for(var g=0;g<b.length;g++){f.index=g;var h=c.call(f,b[g])-d;e+=h*h}return e};pv.deviation=function(b,c){return Math.sqrt(pv.variance(b,c)/(b.length-1))};pv.log=function(b,c){return Math.log(b)/Math.log(c)};
pv.logSymmetric=function(b,c){return b==0?0:b<0?-pv.log(-b,c):pv.log(b,c)};pv.logAdjusted=function(b,c){if(!isFinite(b))return b;var d=b<0;if(b<c)b+=(c-b)/c;return d?-pv.log(b,c):pv.log(b,c)};pv.logFloor=function(b,c){return b>0?Math.pow(c,Math.floor(pv.log(b,c))):-Math.pow(c,-Math.floor(-pv.log(-b,c)))};pv.logCeil=function(b,c){return b>0?Math.pow(c,Math.ceil(pv.log(b,c))):-Math.pow(c,-Math.ceil(-pv.log(-b,c)))};
(function(){var b=Math.PI/180,c=180/Math.PI;pv.radians=function(d){return b*d};pv.degrees=function(d){return c*d}})();pv.keys=function(b){var c=[];for(var d in b)c.push(d);return c};pv.entries=function(b){var c=[];for(var d in b)c.push({key:d,value:b[d]});return c};pv.values=function(b){var c=[];for(var d in b)c.push(b[d]);return c};pv.dict=function(b,c){for(var d={},e={},f=0;f<b.length;f++)if(f in b){var g=b[f];e.index=f;d[g]=c.call(e,g)}return d};pv.hasOwnProp=Object.prototype.hasOwnProperty;
pv.copyOwn=function(b,c){if(c){var d=pv.hasOwnProp;for(var e in c)if(d.call(c,e))b[e]=c[e]}return b};pv.dom=function(b){return new pv.Dom(b)};pv.Dom=function(b){this.$map=b};pv.Dom.prototype.$leaf=function(b){return typeof b!="object"};pv.Dom.prototype.leaf=function(b){if(arguments.length){this.$leaf=b;return this}return this.$leaf};
pv.Dom.prototype.root=function(b){function c(f){var g=new pv.Dom.Node;for(var h in f){var i=f[h];g.appendChild(d(i)?new pv.Dom.Node(i):c(i)).nodeName=h}return g}var d=this.$leaf,e=c(this.$map);e.nodeName=b;return e};pv.Dom.prototype.nodes=function(){return this.root().nodes()};pv.Dom.Node=function(b){if(b!==undefined)this.nodeValue=b;this.childNodes=[]};a=pv.Dom.Node.prototype;a.nodeValue=undefined;a.parentNode=null;a.firstChild=null;a.lastChild=null;a.previousSibling=null;a.nextSibling=null;
a._firstDirtyChildIndex=Infinity;a.removeChild=function(b){b=this.childNodes.indexOf(b);if(b===-1)throw new Error("child not found");return this.removeAt(b)};a.appendChild=function(b){var c=b.parentNode;c&&c.removeChild(b);c=this.lastChild;b.parentNode=this;if(b.previousSibling=c){c.nextSibling=b;b._childIndex=c._childIndex+1}else{this.firstChild=b;b._childIndex=0}this.lastChild=b;this.childNodes.push(b);return b};
a.insertBefore=function(b,c){if(!c)return this.appendChild(b);c=this.childNodes.indexOf(c);if(c===-1)throw new Error("child not found");return this.insertAt(b,c)};
a.insertAt=function(b,c){if(c==null)return this.appendChild(b);var d=this.childNodes,e=d.length;if(c===e)return this.appendChild(b);if(c>e)throw new Error("Index out of range.");e=c+1;if(e<this._firstDirtyChildIndex)this._firstDirtyChildIndex=e;(e=b.parentNode)&&e.removeChild(b);d=d[c];b.parentNode=this;b.nextSibling=d;b._childIndex=c;if(e=b.previousSibling=d.previousSibling)e.nextSibling=b;else{if(d===this.lastChild)this.lastChild=b;this.firstChild=b}this.childNodes.splice(c,0,b);return b};
a.removeAt=function(b){var c=this.childNodes,d=c[b];if(d){c.splice(b,1);if(b<c.length)if(b<this._firstDirtyChildIndex)this._firstDirtyChildIndex=b;if(b=d.previousSibling)b.nextSibling=d.nextSibling;else this.firstChild=d.nextSibling;if(b=d.nextSibling)b.previousSibling=d.previousSibling;else this.lastChild=d.previousSibling;delete d.nextSibling;delete d.previousSibling;delete d.parentNode}return d};
a.replaceChild=function(b,c){var d=this.childNodes,e=d.indexOf(c);if(e===-1)throw new Error("child not found");var f=b.parentNode;f&&f.removeChild(b);b.parentNode=this;b.nextSibling=c.nextSibling;b._childIndex=c._childIndex;if(f=b.previousSibling=c.previousSibling)f.nextSibling=b;else this.firstChild=b;if(f=c.nextSibling)f.previousSibling=b;else this.lastChild=b;d[e]=b;return c};
a.childIndex=function(){var b=this.parentNode;if(b){var c=b._firstDirtyChildIndex;if(c<Infinity){var d=b.childNodes;if(c<d.length)for(d=d[c];d;d=d.nextSibling)d._childIndex=c++;delete b._firstDirtyChildIndex}return this._childIndex}return-1};a.visitBefore=function(b){function c(d,e){b(d,e);for(d=d.firstChild;d;d=d.nextSibling)c(d,e+1)}c(this,0)};a.visitAfter=function(b){function c(d,e){for(var f=d.firstChild;f;f=f.nextSibling)c(f,e+1);b(d,e)}c(this,0)};
a.sort=function(b){if(this.firstChild){delete c._firstDirtyChildIndex;this.childNodes.sort(b);var c=this.firstChild=this.childNodes[0],d;delete c.previousSibling;c._childIndex=0;for(var e=1;e<this.childNodes.length;e++){c.sort(b);d=this.childNodes[e];d._childIndex=e;d.previousSibling=c;c=c.nextSibling=d}this.lastChild=c;delete c.nextSibling;c.sort(b)}return this};
a.reverse=function(){var b=[];this.visitAfter(function(c){for(;c.lastChild;)b.push(c.removeChild(c.lastChild));for(var d;d=b.pop();)c.insertBefore(d,c.firstChild)});return this};a.nodes=function(){function b(d){c.push(d);d.childNodes.forEach(b)}var c=[];b(this,c);return c};
a.toggle=function(b){if(b)return this.toggled?this.visitBefore(function(d){d.toggled&&d.toggle()}):this.visitAfter(function(d){d.toggled||d.toggle()});b=this;if(b.toggled){for(var c;c=b.toggled.pop();)b.appendChild(c);delete b.toggled}else if(b.lastChild)for(b.toggled=[];b.lastChild;)b.toggled.push(b.removeChild(b.lastChild))};pv.nodes=function(b){for(var c=new pv.Dom.Node,d=0;d<b.length;d++)c.appendChild(new pv.Dom.Node(b[d]));return c.nodes()};pv.tree=function(b){return new pv.Tree(b)};
pv.Tree=function(b){this.array=b};pv.Tree.prototype.keys=function(b){this.k=b;return this};pv.Tree.prototype.value=function(b){this.v=b;return this};pv.Tree.prototype.map=function(){for(var b={},c={},d=0;d<this.array.length;d++){c.index=d;for(var e=this.array[d],f=this.k.call(c,e),g=b,h=0;h<f.length-1;h++)g=g[f[h]]||(g[f[h]]={});g[f[h]]=this.v?this.v.call(c,e):e}return b};pv.nest=function(b){return new pv.Nest(b)};pv.Nest=function(b){this.array=b;this.keys=[]};a=pv.Nest.prototype;
a.key=function(b){this.keys.push(b);return this};a.sortKeys=function(b){this.keys[this.keys.length-1].order=b||pv.naturalOrder;return this};a.sortValues=function(b){this.order=b||pv.naturalOrder;return this};a.map=function(){for(var b={},c=[],d,e=0;e<this.array.length;e++){var f=this.array[e],g=b;for(d=0;d<this.keys.length-1;d++){var h=this.keys[d](f);g[h]||(g[h]={});g=g[h]}h=this.keys[d](f);if(!g[h]){d=[];c.push(d);g[h]=d}g[h].push(f)}if(this.order)for(d=0;d<c.length;d++)c[d].sort(this.order);return b};
a.entries=function(){function b(d){var e=[];for(var f in d){var g=d[f];e.push({key:f,values:g instanceof Array?g:b(g)})}return e}function c(d,e){var f=this.keys[e].order;f&&d.sort(function(h,i){return f(h.key,i.key)});if(++e<this.keys.length)for(var g=0;g<d.length;g++)c.call(this,d[g].values,e);return d}return c.call(this,b(this.map()),0)};a.rollup=function(b){function c(d){for(var e in d){var f=d[e];if(f instanceof Array)d[e]=b(f);else c(f)}return d}return c(this.map())};pv.flatten=function(b){return new pv.Flatten(b)};
pv.Flatten=function(b){this.map=b;this.keys=[]};pv.Flatten.prototype.key=function(b,c){this.keys.push({name:b,value:c});delete this.$leaf;return this};pv.Flatten.prototype.leaf=function(b){this.keys.length=0;this.$leaf=b;return this};
pv.Flatten.prototype.array=function(){function b(h,i){if(i<e.length-1)for(var j in h){d.push(j);b(h[j],i+1);d.pop()}else c.push(d.concat(h))}var c=[],d=[],e=this.keys,f=this.$leaf;if(f){function g(h,i){if(f(h))c.push({keys:d.slice(),value:h});else for(var j in h){d.push(j);g(h[j],i+1);d.pop()}}g(this.map,0);return c}b(this.map,0);return c.map(function(h){for(var i={},j=0;j<e.length;j++){var k=e[j],p=h[j];i[k.name]=k.value?k.value.call(null,p):p}return i})};
pv.vector=function(b,c){return new pv.Vector(b,c)};pv.Vector=function(b,c){this.x=b;this.y=c};a=pv.Vector.prototype;a.perp=function(){return new pv.Vector(-this.y,this.x)};a.rotate=function(b){var c=Math.cos(b);b=Math.sin(b);return new pv.Vector(c*this.x-b*this.y,b*this.x+c*this.y)};a.norm=function(){var b=this.length();return this.times(b?1/b:1)};a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.times=function(b){return new pv.Vector(this.x*b,this.y*b)};
a.plus=function(b,c){return arguments.length==1?new pv.Vector(this.x+b.x,this.y+b.y):new pv.Vector(this.x+b,this.y+c)};a.minus=function(b,c){return arguments.length==1?new pv.Vector(this.x-b.x,this.y-b.y):new pv.Vector(this.x-b,this.y-c)};a.dot=function(b,c){return arguments.length==1?this.x*b.x+this.y*b.y:this.x*b+this.y*c};pv.Transform=function(){};pv.Transform.prototype={k:1,x:0,y:0};pv.Transform.identity=new pv.Transform;
pv.Transform.prototype.translate=function(b,c){var d=new pv.Transform;d.k=this.k;d.x=this.k*b+this.x;d.y=this.k*c+this.y;return d};pv.Transform.prototype.scale=function(b){var c=new pv.Transform;c.k=this.k*b;c.x=this.x;c.y=this.y;return c};pv.Transform.prototype.invert=function(){var b=new pv.Transform,c=1/this.k;b.k=c;b.x=-this.x*c;b.y=-this.y*c;return b};pv.Transform.prototype.times=function(b){var c=new pv.Transform;c.k=this.k*b.k;c.x=this.k*b.x+this.x;c.y=this.k*b.y+this.y;return c};
pv.Scale=function(){};pv.Scale.interpolator=function(b,c){if(typeof b=="number")return function(d){return d*(c-b)+b};b=pv.color(b).rgb();c=pv.color(c).rgb();return function(d){var e=b.a*(1-d)+c.a*d;if(e<1.0E-5)e=0;return b.a==0?pv.rgb(c.r,c.g,c.b,e):c.a==0?pv.rgb(b.r,b.g,b.b,e):pv.rgb(Math.round(b.r*(1-d)+c.r*d),Math.round(b.g*(1-d)+c.g*d),Math.round(b.b*(1-d)+c.b*d),e)}};
pv.Scale.common={by:function(b){function c(){return d(b.apply(d,arguments))}var d=this;for(var e in d)c[e]=d[e];return c},by1:function(b){function c(f){return d(b.call(d,f))}var d=this;for(var e in d)c[e]=d[e];return c},transform:function(b){function c(){return b.call(d,d.apply(d,arguments))}var d=this;for(var e in d)c[e]=d[e];return c}};
pv.Scale.quantitative=function(){function b(n){return new Date(n)}function c(n){var o=pv.search(d,n);if(o<0)o=-o-2;o=Math.max(0,Math.min(g.length-1,o));return g[o]((j(n)-e[o])/(e[o+1]-e[o]))}var d=[0,1],e=[0,1],f=[0,1],g=[pv.identity],h=Number,i=false,j=pv.identity,k=pv.identity,p=String,l=null,r,m;c.transform=function(n,o){j=function(s){return i?-n(-s):n(s)};k=function(s){return i?-o(-s):o(s)};e=d.map(j);return this};c.domain=function(n,o,s){if(arguments.length){var t;if(n instanceof Array){if(arguments.length<
2)o=pv.identity;if(arguments.length<3)s=o;t=n.length&&o(n[0]);d=n.length?[pv.min(n,o),pv.max(n,s)]:[]}else{t=n;d=Array.prototype.slice.call(arguments).map(Number)}if(d.length){if(d.length==1)d=[d[0],d[0]]}else d=[-Infinity,Infinity];i=(d[0]||d[d.length-1])<0;e=d.map(j);h=t instanceof Date?b:Number;return this}return d.map(h)};c.range=function(){if(arguments.length){f=Array.prototype.slice.call(arguments);if(f.length){if(f.length==1)f=[f[0],f[0]]}else f=[-Infinity,Infinity];g=[];for(var n=0;n<f.length-
1;n++)g.push(pv.Scale.interpolator(f[n],f[n+1]));return this}return f};c.invert=function(n){var o=pv.search(f,n);if(o<0)o=-o-2;o=Math.max(0,Math.min(g.length-1,o));return h(k(e[o]+(n-f[o])/(f[o+1]-f[o])*(e[o+1]-e[o])))};c.ticks=function(n,o){var s=d[0],t=d[d.length-1],u=t<s,q=u?t:s;t=u?s:t;s=t-q;if(!s||!isFinite(s)){if(h==b)p=pv.Format.date("%x");return[h(q)]}if(h==b){function x(z,D){switch(D){case 31536E6:z.setMonth(0);case 2592E6:z.setDate(1);case 6048E5:D==6048E5&&z.setDate(z.getDate()-z.getDay());
case 864E5:z.setHours(0);case 36E5:z.setMinutes(0);case 6E4:z.setSeconds(0);case 1E3:z.setMilliseconds(0)}}var w,y,v=1;if(s>=15768E7){w=31536E6;o="%Y";y=function(z){z.setFullYear(z.getFullYear()+v)}}else if(s>=1296E7){w=2592E6;o="%m/%Y";y=function(z){z.setMonth(z.getMonth()+v)}}else if(s>=3024E6){w=6048E5;o="%m/%d";y=function(z){z.setDate(z.getDate()+7*v)}}else if(s>=432E6){w=864E5;o="%m/%d";y=function(z){z.setDate(z.getDate()+v)}}else if(s>=18E6){w=36E5;o="%I:%M %p";y=function(z){z.setHours(z.getHours()+
v)}}else if(s>=3E5){w=6E4;o="%I:%M %p";y=function(z){z.setMinutes(z.getMinutes()+v)}}else if(s>=5E3){w=1E3;o="%I:%M:%S";y=function(z){z.setSeconds(z.getSeconds()+v)}}else{w=1;o="%S.%Qs";y=function(z){z.setTime(z.getTime()+v)}}w=m?m:w;o=r?r:o;p=pv.Format.date(o);q=new Date(q);o=[];x(q,w);s=s/w;if(s>10)switch(w){case 36E5:v=s>20?6:3;q.setHours(Math.floor(q.getHours()/v)*v);break;case 2592E6:v=s>24?3:s>12?2:1;q.setMonth(Math.floor(q.getMonth()/v)*v);break;case 6048E5:v=s>15?3:s>10?2:1;q.setDate(Math.floor(q.getDate()/
(7*v))*7*v);break;case 864E5:v=s>=30?5:s>=15?3:2;q.setDate(Math.floor(q.getDate()/v)*v);break;case 6E4:v=s>30?15:s>15?10:5;q.setMinutes(Math.floor(q.getMinutes()/v)*v);break;case 1E3:v=s>90?15:s>60?10:5;q.setSeconds(Math.floor(q.getSeconds()/v)*v);break;case 1:v=s>1E3?250:s>200?100:s>100?50:s>50?25:5;q.setMilliseconds(Math.floor(q.getMilliseconds()/v)*v);break;default:v=pv.logCeil(s/15,10);if(s/v<2)v/=5;else if(s/v<5)v/=2;q.setFullYear(Math.floor(q.getFullYear()/v)*v);break}if(m){v=1;y=function(z){z.setSeconds(z.getSeconds()+
v*m/1E3)}}for(;;){y(q);if(q>t)break;o.push(new Date(q))}return u?o.reverse():o}if(n==null)n=10;w=pv.get(o,"roundInside",true);y=pv.get(o,"numberExponentMin",-Infinity);o=pv.get(o,"numberExponentMax",+Infinity);var A=Math.floor(pv.log(s/n,10)),B=false;if(A>o){A=o;B=true}else if(A<y){A=y;B=true}v=Math.pow(10,A);s=n/(s/v);if(s<=0.15&&A<o-1)v*=10;else if(s<=0.35)v*=5;else if(s<=0.75)v*=2;A=Math.floor(pv.log(v,10)+1.0E-10);s=v*Math[w?"ceil":"floor"](q/v);t=v*Math[w?"floor":"ceil"](t/v);p=pv.Format.number().fractionDigits(Math.max(0,
-A));t=pv.range(s,t+v,v);u&&t.reverse();t.roundInside=w;t.step=v;t.exponent=A;t.exponentOverflow=B;t.exponentMin=y;t.exponentMax=o;return t};c.dateTickFormat=function(){if(arguments.length){r=arguments[0];return this}return r};c.dateTickPrecision=function(){if(arguments.length){m=arguments[0];return this}return m};c.tickFormatter=function(n){if(arguments.length){l=n;return this}return l};c.tickFormat=function(n){return(l||p)(n)};c.nice=function(){if(d.length!=2)return this;var n=d[0],o=d[d.length-
1],s=o<n,t=s?o:n;n=s?n:o;o=n-t;if(!o||!isFinite(o))return this;o=Math.pow(10,Math.round(Math.log(o)/Math.log(10))-1);d=[Math.floor(t/o)*o,Math.ceil(n/o)*o];s&&d.reverse();e=d.map(j);return this};pv.copyOwn(c,pv.Scale.common);c.domain.apply(c,arguments);return c};pv.Scale.linear=function(){var b=pv.Scale.quantitative();b.domain.apply(b,arguments);return b};
pv.Scale.log=function(){var b=pv.Scale.quantitative(1,10),c,d,e=function(g){return Math.log(g)/d},f=function(g){return Math.pow(c,g)};b.ticks=function(){var g=b.domain(),h=g[0]<0,i=Math.floor(h?-e(-g[0]):e(g[0])),j=Math.ceil(h?-e(-g[1]):e(g[1])),k=[];if(h)for(k.push(-f(-i));i++<j;)for(h=c-1;h>0;h--)k.push(-f(-i)*h);else{for(;i<j;i++)for(h=1;h<c;h++)k.push(f(i)*h);k.push(f(i))}for(i=0;k[i]<g[0];i++);for(j=k.length;k[j-1]>g[1];j--);return k.slice(i,j)};b.tickFormat=function(g){return g.toPrecision(1)};
b.nice=function(){var g=b.domain();return b.domain(pv.logFloor(g[0],c),pv.logCeil(g[1],c))};b.base=function(g){if(arguments.length){c=Number(g);d=Math.log(c);b.transform(e,f);return this}return c};b.domain.apply(b,arguments);return b.base(10)};pv.Scale.root=function(){var b=pv.Scale.quantitative();b.power=function(c){if(arguments.length){var d=Number(c),e=1/d;b.transform(function(f){return Math.pow(f,e)},function(f){return Math.pow(f,d)});return this}return d};b.domain.apply(b,arguments);return b.power(2)};
pv.Scale.ordinal=function(){function b(f){f in d||(d[f]=c.push(f)-1);return e[d[f]%e.length]}var c=[],d={},e=[];b.domain=function(f,g){if(arguments.length){f=f instanceof Array?arguments.length>1?pv.map(f,g):f:Array.prototype.slice.call(arguments);c=[];for(var h={},i=0;i<f.length;i++){var j=f[i];if(!(j in h)){h[j]=true;c.push(j)}}d=pv.numerate(c);return this}return c};b.range=function(f,g){if(arguments.length){e=f instanceof Array?arguments.length>1?pv.map(f,g):f:Array.prototype.slice.call(arguments);
if(typeof e[0]=="string")e=e.map(pv.color);return this}return e};b.split=function(f,g){var h=g-f,i=this.domain().length,j=0;if(h===0)e=pv.array(i,f);else if(i){j=(g-f)/i;e=pv.range(f+j/2,g,j)}e.step=j;return this};b.splitBandedCenter=function(f,g,h){b.split(f,g);if(h==null)h=1;e.band=e.step*h;e.margin=e.step-e.band;return this};b.splitBandedFlushCenter=function(f,g,h){if(h==null)h=1;var i=g-f,j=this.domain().length,k=0,p=0,l=0;if(i===0)e=pv.array(j,f);else if(j){p=i*h/j;l=j>1?(i-j*p)/(j-1):0;k=l+
p;e=pv.range(f+p/2,g,k)}e.step=k;e.band=p;e.margin=l;return this};b.splitFlush=function(f,g){var h=this.domain().length,i=(g-f)/(h-1);e=h==1?[(f+g)/2]:pv.range(f,g+i/2,i);return this};b.splitBanded=function(f,g,h){if(arguments.length<3)h=1;if(h<0){var i=this.domain().length;i=(g-f- -h*i)/(i+1);e=pv.range(f+i,g,i-h);e.band=-h}else{i=(g-f)/(this.domain().length+(1-h));e=pv.range(f+i*(1-h),g,i);e.band=i*h;e.step=i;e.margin=i-e.band}return this};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);
return b};
pv.Scale.quantile=function(){function b(h){return g(Math.max(0,Math.min(d,pv.search.index(e,h)-1))/d)}var c=-1,d=-1,e=[],f=[],g=pv.Scale.linear();b.quantiles=function(h){if(arguments.length){c=Number(h);if(c<0){e=[f[0]].concat(f);d=f.length-1}else{e=[];e[0]=f[0];for(var i=1;i<=c;i++)e[i]=f[~~(i*(f.length-1)/c)];d=c-1}return this}return e};b.domain=function(h,i){if(arguments.length){f=h instanceof Array?pv.map(h,i):Array.prototype.slice.call(arguments);f.sort(pv.naturalOrder);b.quantiles(c);return this}return f};
b.range=function(){if(arguments.length){g.range.apply(g,arguments);return this}return g.range()};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);return b};
pv.histogram=function(b,c){var d=true;return{bins:function(e){var f=pv.map(b,c),g=[];arguments.length||(e=pv.Scale.linear(f).ticks());for(var h=0;h<e.length-1;h++){var i=g[h]=[];i.x=e[h];i.dx=e[h+1]-e[h];i.y=0}for(h=0;h<f.length;h++){i=pv.search.index(e,f[h])-1;i=g[Math.max(0,Math.min(g.length-1,i))];i.y++;i.push(b[h])}if(!d)for(h=0;h<g.length;h++)g[h].y/=f.length;return g},frequency:function(e){if(arguments.length){d=Boolean(e);return this}return d}}};
pv.color=function(b){if(b.rgb)return b.rgb();var c=/([a-z]+)\((.*)\)/i.exec(b);if(c){var d=c[2].split(","),e=1;switch(c[1]){case "hsla":case "rgba":e=parseFloat(d[3]);if(!e)return pv.Color.transparent;break}switch(c[1]){case "hsla":case "hsl":b=parseFloat(d[0]);var f=parseFloat(d[1])/100;d=parseFloat(d[2])/100;return(new pv.Color.Hsl(b,f,d,e)).rgb();case "rgba":case "rgb":function g(j){var k=parseFloat(j);return j[j.length-1]=="%"?Math.round(k*2.55):k}f=g(d[0]);var h=g(d[1]),i=g(d[2]);return pv.rgb(f,
h,i,e)}}if(e=pv.Color.names[b])return e;if(b.charAt(0)=="#"){if(b.length==4){f=b.charAt(1);f+=f;h=b.charAt(2);h+=h;i=b.charAt(3);i+=i}else if(b.length==7){f=b.substring(1,3);h=b.substring(3,5);i=b.substring(5,7)}return pv.rgb(parseInt(f,16),parseInt(h,16),parseInt(i,16),1)}return new pv.Color(b,1)};pv.Color=function(b,c){this.color=b;this.opacity=c};pv.Color.prototype.hsl=function(){return this.rgb().hsl()};pv.Color.prototype.brighter=function(b){return this.rgb().brighter(b)};
pv.Color.prototype.darker=function(b){return this.rgb().darker(b)};pv.rgb=function(b,c,d,e){return new pv.Color.Rgb(b,c,d,arguments.length==4?e:1)};pv.Color.Rgb=function(b,c,d,e){pv.Color.call(this,e?"rgb("+b+","+c+","+d+")":"none",e);this.r=b;this.g=c;this.b=d;this.a=e};pv.Color.Rgb.prototype=pv.extend(pv.Color);a=pv.Color.Rgb.prototype;a.red=function(b){return pv.rgb(b,this.g,this.b,this.a)};a.green=function(b){return pv.rgb(this.r,b,this.b,this.a)};
a.blue=function(b){return pv.rgb(this.r,this.g,b,this.a)};a.alpha=function(b){return pv.rgb(this.r,this.g,this.b,b)};a.rgb=function(){return this};a.brighter=function(b){b=Math.pow(0.7,arguments.length?b:1);var c=this.r,d=this.g,e=this.b;if(!c&&!d&&!e)return pv.rgb(30,30,30,this.a);if(c&&c<30)c=30;if(d&&d<30)d=30;if(e&&e<30)e=30;return pv.rgb(Math.min(255,Math.floor(c/b)),Math.min(255,Math.floor(d/b)),Math.min(255,Math.floor(e/b)),this.a)};
a.darker=function(b){b=Math.pow(0.7,arguments.length?b:1);return pv.rgb(Math.max(0,Math.floor(b*this.r)),Math.max(0,Math.floor(b*this.g)),Math.max(0,Math.floor(b*this.b)),this.a)};a.hsl=function(){var b=this.r/255,c=this.g/255,d=this.b/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=(e+f)/2,h;if(e===f)h=f=0;else{var i=e-f;f=g>0.5?i/(2-e-f):i/(e+f);switch(e){case b:h=(c-d)/i+(c<d?6:0);break;case c:h=(d-b)/i+2;break;case d:h=(b-c)/i+4;break}h/=6}return pv.hsl(h*360,f,g,this.a)};
pv.hsl=function(b,c,d,e){return new pv.Color.Hsl(b,c,d,arguments.length==4?e:1)};pv.Color.Hsl=function(b,c,d,e){pv.Color.call(this,"hsl("+b+","+c*100+"%,"+d*100+"%)",e);this.h=b;this.s=c;this.l=d;this.a=e};pv.Color.Hsl.prototype=pv.extend(pv.Color);a=pv.Color.Hsl.prototype;a.hsl=function(){return this};a.hue=function(b){return pv.hsl(b,this.s,this.l,this.a)};a.saturation=function(b){return pv.hsl(this.h,b,this.l,this.a)};a.lightness=function(b){return pv.hsl(this.h,this.s,b,this.a)};
a.alpha=function(b){return pv.hsl(this.h,this.s,this.l,b)};a.rgb=function(){function b(i){if(i>360)i-=360;else if(i<0)i+=360;if(i<60)return h+(g-h)*i/60;if(i<180)return g;if(i<240)return h+(g-h)*(240-i)/60;return h}function c(i){return Math.round(b(i)*255)}var d=this.h,e=this.s,f=this.l;d%=360;if(d<0)d+=360;e=Math.max(0,Math.min(e,1));f=Math.max(0,Math.min(f,1));var g=f<=0.5?f*(1+e):f+e-f*e,h=2*f-g;return pv.rgb(c(d+120),c(d),c(d-120),this.a)};
pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)};
(function(){var b=pv.Color.names;b.none=b.transparent;for(var c in b)b[c]=pv.color(b[c])})();pv.colors=function(){var b=pv.Scale.ordinal();b.range.apply(b,arguments);return b};pv.Colors={};pv.Colors.category10=function(){var b=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");b.domain.apply(b,arguments);return b};
pv.Colors.category20=function(){var b=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");b.domain.apply(b,arguments);return b};
pv.Colors.category19=function(){var b=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");b.domain.apply(b,arguments);return b};
(function(){function b(l){l=d(l);if(!l.length)return null;var r=Math.PI,m,n=l[0];if(n.indexOf("to ")===0){if(m=/^to\s+(?:((top|bottom)(?:\s+(left|right))?)|((left|right)(?:\\s+(top|bottom))?))$/.exec(n)){if(m[1]){r=m[2];if(m[3])r+=" "+m[3]}else{r=m[5];if(m[6])r=m[6]+" "+r}r=pv.radians(f[r]);l.shift()}}else{m=parseFloat(n);if(!isNaN(m)){r=m;if(/^.*?deg$/.test(n))r=pv.radians(r);l.shift()}}l=e(l);switch(l.length){case 0:return null;case 1:return new pv.FillStyle.Solid(l[0].color,1)}return new pv.FillStyle.LinearGradient(r,
l)}function c(l){l=d(l);if(!l.length)return null;l=e(l);switch(l.length){case 0:return null;case 1:return new pv.FillStyle.Solid(l[0].color,1)}return new pv.FillStyle.RadialGradient(50,50,l)}function d(l){var r={},m=0;l=l.replace(/\b\w+?\(.*?\)/g,function(o){var s="__color"+m++;r[s]=o;return s});var n=l.split(/\s*,\s*/);if(!n.length)return null;m&&n.forEach(function(o,s){if(r.hasOwnProperty(o))n[s]=r[o]});return n}function e(l){function r(v){var A=s.length;if(A){var B=o;v=(v-B)/(A+1);for(var z=0;z<
A;z++){B+=v;s[z].offset=B}s.length=0}}for(var m=[],n=+Infinity,o=-Infinity,s=[],t=0,u=l.length;t<u;){var q=/^(.+?)\s*([+\-]?[e\.\d]+%)?$/i.exec(l[t++]);if(q){var x={color:pv.color(q[1])};q=parseFloat(q[2]);if(isNaN(q))if(m.length){if(t===u)q=Math.max(o,100)}else q=0;m.push(x);if(isNaN(q))s.push(x);else{x.offset=q;r(q);if(q>o)o=q;else if(q<o)q=o;if(q<n)n=q}}}if(m.length>=2&&(n<0||o>100)){var w=[],y=[];m.forEach(function(v){w.push(v.offset);y.push(v.color)});l=pv.scale.linear().domain(w).range(y);if(n<
0){for(;m.length&&m[0].offset<=0;)m.shift();m.unshift({offset:0,color:l(0)})}if(o>100){for(;m.length&&m[m.length-1].offset>=100;)m.pop();m.push({offset:100,color:l(100)})}}return m}pv.fillStyle=function(l){if(l.type)return l;if(l.rgb)return new pv.FillStyle.Solid(l.color,l.opacity);var r=/^\s*([a-z\-]+)\(\s*(.*?)\s*\)\s*$/.exec(l);if(r)switch(r[1]){case "linear-gradient":return b(r[2]);case "radial-gradient":return c(r[2])}return new pv.FillStyle.Solid(pv.color(l))};var f={top:0,"top right":45,right:90,
"bottom right":135,bottom:180,"bottom left":225,left:270,"top left":315},g=pv.FillStyle=function(l){this.type=l};g.prototype=new pv.Color("none",1);g.prototype.rgb=function(){var l=pv.color(this.color);if(this.opacity!==l.opacity)l=l.alpha(this.opacity);return l};var h=pv.FillStyle.Solid=function(l,r){g.call(this,"solid");if(l.rgb){this.color=l.color;this.opacity=l.opacity}else{this.color=l;this.opacity=r}};h.prototype=pv.extend(pv.FillStyle);h.prototype.alpha=function(l){return new h(this.color,
l)};h.prototype.brighter=function(l){return new h(this.rgb().brighter(l))};h.prototype.darker=function(l){return new h(this.rgb().darker(l))};pv.FillStyle.transparent=new h(pv.Color.transparent);var i=0,j=pv.FillStyle.Gradient=function(l,r){g.call(this,l);this.id=++i;this.stops=r;if(r.length)this.color=r[0].color.color};j.prototype=pv.extend(pv.FillStyle);j.prototype.rgb=function(){return this.stops.length?this.stops[0].color:undefined};j.prototype.alpha=function(l){return this._clone(this.stops.map(function(r){return{offset:r.offset,
color:r.color.alpha(l)}}))};j.prototype.darker=function(l){return this._clone(this.stops.map(function(r){return{offset:r.offset,color:r.color.darker(l)}}))};j.prototype.brighter=function(l){return this._clone(this.stops.map(function(r){return{offset:r.offset,color:r.color.brighter(l)}}))};var k=pv.FillStyle.LinearGradient=function(l,r){j.call(this,"lineargradient",r);this.angle=l};k.prototype=pv.extend(j);k.prototype._clone=function(l){return new k(this.angle,l)};var p=pv.FillStyle.RadialGradient=
function(l,r,m){j.call(this,"radialgradient",m);this.cx=l;this.cy=r};p.prototype=pv.extend(j);p.prototype._clone=function(l){return new p(this.cx,this.cy,l)}})();pv.ramp=function(){var b=pv.Scale.linear();b.range.apply(b,arguments);return b};
pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter",
"stroke-linecap":"butt","stroke-miterlimit":8,"stroke-dasharray":"none"},css:{font:"10px sans-serif"}}};pv.SvgScene.updateAll=function(b){if(b.length&&b[0].reverse&&b.type!="line"&&b.type!="area"){for(var c=pv.extend(b),d=0,e=b.length-1;e>=0;d++,e--)c[d]=b[e];b=c}this.removeSiblings(this[b.type](b))};pv.SvgScene.create=function(b){return document.createElementNS(this.svg,b)};
pv.SvgScene.expect=function(b,c,d,e,f,g){if(b){d=b.tagName;if(d==="defs")b=b.nextSibling;if(d==="a")b=b.firstChild;if(d!==c){c=this.create(c);b.parentNode.replaceChild(c,b);b=c}}else b=this.create(c);f&&this.setAttributes(b,f);g&&this.setStyle(b,g);return b};pv.SvgScene.setAttributes=function(b,c){var d=this.implicit.svg;for(var e in c){var f=c[e];f==null||f==d[e]?b.removeAttribute(e):b.setAttribute(e,f)}};
pv.SvgScene.setStyle=function(b,c){var d=this.implicit.css;switch(pv.renderer()){case "batik":for(var e in c){var f=c[e];f==null||f==d[e]?b.removeAttribute(e):b.style.setProperty(e,f)}break;case "svgweb":for(e in c){f=c[e];f==null||f==d[e]||(b.style[e]=f)}break;default:for(e in c){f=c[e];if(f==null||f==d[e])b.style.removeProperty(e);else b.style[e]=f}}};pv.SvgScene.append=function(b,c,d){b.$scene={scenes:c,index:d};b=this.title(b,c[d]);b.parentNode||c.$g.appendChild(b);return b.nextSibling};
pv.SvgScene.title=function(b,c){var d=b.parentNode;if(d&&d.tagName!="a")d=null;if(c.title){if(!d){d=this.create("a");d.setAttributeNS(this.xlink,"xlink:href","");b.parentNode&&b.parentNode.replaceChild(d,b);d.appendChild(b)}d.setAttributeNS(this.xlink,"xlink:title",c.title);for(var e=null,f=b.firstChild;f!=null;f=f.nextSibling)if(f.nodeName=="title"){e=f;break}if(e)e.removeChild(e.firstChild);else{e=this.create("title");b.appendChild(e)}pv.renderer()=="svgweb"?e.appendChild(document.createTextNode(c.title,
true)):e.appendChild(document.createTextNode(c.title));return d}d&&d.parentNode.replaceChild(b,d);return b};pv.SvgScene.dispatch=pv.listener(function(b){var c=b.target.$scene;if(c){var d=b.type;switch(d){case "DOMMouseScroll":d="mousewheel";b.wheel=-480*b.detail;break;case "mousewheel":b.wheel=(window.opera?12:1)*b.wheelDelta;break}pv.Mark.dispatch(d,c.scenes,c.index,b)&&b.preventDefault()}});
pv.SvgScene.removeSiblings=function(b){for(;b;){var c=b.nextSibling;b.nodeName!="defs"&&b.parentNode.removeChild(b);b=c}};pv.SvgScene.undefined=function(){};pv.SvgScene.removeFillStyleDefinitions=function(b){b=b.$g.getElementsByTagName("defs");if(b.length===1){b=b[0];for(var c=b.firstChild;c;){var d=c.nextSibling;if(c.nodeName=="linearGradient"||c.nodeName=="radialGradient")b.removeChild(c);c=d}}};
(function(){var b={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},c={shortdash:[3,1],shortdot:[1,1],shortdashdot:[3,1,1,1],shortdashdotdot:[3,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};pv.SvgScene.isStandardDashStyle=function(d){return c.hasOwnProperty(d)};pv.SvgScene.translateDashStyleAlias=function(d){return b.hasOwnProperty(d)?
b[d]:d};pv.SvgScene.parseDasharray=function(d){var e=d.strokeDasharray;if(e&&e!=="none"){e=this.translateDashStyleAlias(e);var f=c[e];e=f?f:e.split(/[\s,]+/);var g=d.lineWidth,h=(d.lineCap||"butt")==="butt";e=e.map(function(i,j){i=+i;if(!h)if(j%2)i++;else i-=1;if(i<=0)i=0.001;return i*g/this.scale},this).join(" ")}else e=null;return e}})();
(function(){function b(d){return Math.abs(d)<=1.0E-12?0:d}var c=0;pv.SvgScene.addFillStyleDefinition=function(d,e){var f=e.type==="lineargradient";if(f||e.type==="radialgradient"){var g=d.$g;d=g.getElementsByTagName("defs");g=d.length?d[0]:g.appendChild(this.create("defs"));var h="__pv_gradient"+e.id;d=undefined;if(!d){d="__pv_gradient"+e.id+"_inst_"+ ++c;g=g.appendChild(this.create(f?"linearGradient":"radialGradient"));g.setAttribute("id",d);g.setAttribute("class",h);if(f){h=e.angle-Math.PI/2;f=
Math.abs(h%(Math.PI/2))-Math.PI/4;var i=Math.abs(Math.SQRT2/2*Math.cos(f));f=i*Math.cos(h);var j=i*Math.sin(h);h=b(0.5-f);i=b(0.5-j);f=b(0.5+f);j=b(0.5+j);g.setAttribute("x1",h);g.setAttribute("y1",i);g.setAttribute("x2",f);g.setAttribute("y2",j)}f=e.stops;h=0;for(i=f.length;h<i;h++){j=f[h];var k=g.appendChild(this.create("stop")),p=j.color;k.setAttribute("offset",j.offset+"%");k.setAttribute("stop-color",p.color);k.setAttribute("stop-opacity",p.opacity+"")}e.color="url(#"+d+")"}}}})();
pv.SvgScene.pathBasis=function(){function b(e,f,g,h,i){return{x:e[0]*f.left+e[1]*g.left+e[2]*h.left+e[3]*i.left,y:e[0]*f.top+e[1]*g.top+e[2]*h.top+e[3]*i.top}}var c=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],d=function(e,f,g,h){var i=b(c[1],e,f,g,h),j=b(c[2],e,f,g,h);e=b(c[3],e,f,g,h);return"C"+i.x+","+i.y+","+j.x+","+j.y+","+e.x+","+e.y};d.segment=function(e,f,g,h){var i=b(c[0],e,f,g,h),j=b(c[1],e,f,g,h),k=b(c[2],e,f,g,h);e=b(c[3],e,f,g,h);return"M"+i.x+","+i.y+"C"+j.x+","+j.y+
","+k.x+","+k.y+","+e.x+","+e.y};return d}();pv.SvgScene.curveBasis=function(b){if(b.length<=2)return"";var c="",d=b[0],e=d,f=d,g=b[1];c+=this.pathBasis(d,e,f,g);for(var h=2;h<b.length;h++){d=e;e=f;f=g;g=b[h];c+=this.pathBasis(d,e,f,g)}c+=this.pathBasis(e,f,g,g);c+=this.pathBasis(f,g,g,g);return c};
pv.SvgScene.curveBasisSegments=function(b){if(b.length<=2)return"";var c=[],d=b[0],e=d,f=d,g=b[1],h=this.pathBasis.segment(d,e,f,g);d=e;e=f;f=g;g=b[2];c.push(h+this.pathBasis(d,e,f,g));for(h=3;h<b.length;h++){d=e;e=f;f=g;g=b[h];c.push(this.pathBasis.segment(d,e,f,g))}c.push(this.pathBasis.segment(e,f,g,g)+this.pathBasis(f,g,g,g));return c};
pv.SvgScene.curveHermite=function(b,c){if(c.length<1||b.length!=c.length&&b.length!=c.length+2)return"";var d=b.length!=c.length,e="",f=b[0],g=b[1],h=c[0],i=h,j=1;if(d){e+="Q"+(g.left-h.x*2/3)+","+(g.top-h.y*2/3)+","+g.left+","+g.top;f=b[1];j=2}if(c.length>1){i=c[1];g=b[j];j++;e+="C"+(f.left+h.x)+","+(f.top+h.y)+","+(g.left-i.x)+","+(g.top-i.y)+","+g.left+","+g.top;for(f=2;f<c.length;f++,j++){g=b[j];i=c[f];e+="S"+(g.left-i.x)+","+(g.top-i.y)+","+g.left+","+g.top}}if(d){b=b[j];e+="Q"+(g.left+i.x*2/
3)+","+(g.top+i.y*2/3)+","+b.left+","+b.top}return e};
pv.SvgScene.curveHermiteSegments=function(b,c){if(c.length<1||b.length!=c.length&&b.length!=c.length+2)return[];var d=b.length!=c.length,e=[],f=b[0],g=f,h=c[0],i=h,j=1;if(d){g=b[1];e.push("M"+f.left+","+f.top+"Q"+(g.left-i.x*2/3)+","+(g.top-i.y*2/3)+","+g.left+","+g.top);j=2}for(var k=1;k<c.length;k++,j++){f=g;h=i;g=b[j];i=c[k];e.push("M"+f.left+","+f.top+"C"+(f.left+h.x)+","+(f.top+h.y)+","+(g.left-i.x)+","+(g.top-i.y)+","+g.left+","+g.top)}if(d){b=b[j];e.push("M"+g.left+","+g.top+"Q"+(g.left+i.x*
2/3)+","+(g.top+i.y*2/3)+","+b.left+","+b.top)}return e};pv.SvgScene.cardinalTangents=function(b,c){var d=[];c=(1-c)/2;for(var e=b[0],f=b[1],g=b[2],h=3;h<b.length;h++){d.push({x:c*(g.left-e.left),y:c*(g.top-e.top)});e=f;f=g;g=b[h]}d.push({x:c*(g.left-e.left),y:c*(g.top-e.top)});return d};pv.SvgScene.curveCardinal=function(b,c){if(b.length<=2)return"";return this.curveHermite(b,this.cardinalTangents(b,c))};
pv.SvgScene.curveCardinalSegments=function(b,c){if(b.length<=2)return"";return this.curveHermiteSegments(b,this.cardinalTangents(b,c))};
pv.SvgScene.monotoneTangents=function(b){var c=[],d=[],e=[],f=[],g=0;for(g=0;g<b.length-1;g++)d[g]=(b[g+1].top-b[g].top)/(b[g+1].left-b[g].left);e[0]=d[0];f[0]=b[1].left-b[0].left;for(g=1;g<b.length-1;g++){e[g]=(d[g-1]+d[g])/2;f[g]=(b[g+1].left-b[g-1].left)/2}e[g]=d[g-1];f[g]=b[g].left-b[g-1].left;for(g=0;g<b.length-1;g++)if(d[g]==0){e[g]=0;e[g+1]=0}for(g=0;g<b.length-1;g++)if(!(Math.abs(e[g])<1.0E-5||Math.abs(e[g+1])<1.0E-5)){var h=e[g]/d[g],i=e[g+1]/d[g],j=h*h+i*i;if(j>9){j=3/Math.sqrt(j);e[g]=
j*h*d[g];e[g+1]=j*i*d[g]}}for(g=0;g<b.length;g++){d=1+e[g]*e[g];c.push({x:f[g]/3/d,y:e[g]*f[g]/3/d})}return c};pv.SvgScene.curveMonotone=function(b){if(b.length<=2)return"";return this.curveHermite(b,this.monotoneTangents(b))};pv.SvgScene.curveMonotoneSegments=function(b){if(b.length<=2)return"";return this.curveHermiteSegments(b,this.monotoneTangents(b))};
pv.SvgScene.area=function(b){function c(l,r){for(var m=[],n=[],o=r;l<=o;l++,r--){var s=b[l],t=b[r];s=s.left+","+s.top;t=t.left+t.width+","+(t.top+t.height);if(l<o){var u=b[l+1],q=b[r-1];switch(f.interpolate){case "step-before":s+="V"+u.top;t+="H"+(q.left+q.width);break;case "step-after":s+="H"+u.left;t+="V"+(q.top+q.height);break}}m.push(s);n.push(t)}return m.concat(n).join("L")}function d(l,r){for(var m=[],n=[],o=r;l<=o;l++,r--){var s=b[r];m.push(b[l]);n.push({left:s.left+s.width,top:s.top+s.height})}if(f.interpolate==
"basis"){l=pv.SvgScene.curveBasis(m);r=pv.SvgScene.curveBasis(n)}else if(f.interpolate=="cardinal"){l=pv.SvgScene.curveCardinal(m,f.tension);r=pv.SvgScene.curveCardinal(n,f.tension)}else{l=pv.SvgScene.curveMonotone(m);r=pv.SvgScene.curveMonotone(n)}return m[0].left+","+m[0].top+l+"L"+n[0].left+","+n[0].top+r}var e=b.$g.firstChild;this.removeFillStyleDefinitions(b);if(!b.length)return e;var f=b[0];if(f.segmented)return this.areaSegment(b);if(!f.visible)return e;var g=f.fillStyle,h=f.strokeStyle;if(!g.opacity&&
!h.opacity)return e;g.type&&g.type!=="solid"&&this.addFillStyleDefinition(b,g);h.type&&h.type!="solid"&&this.addFillStyleDefinition(b,h);for(var i=[],j,k=0;k<b.length;k++){j=b[k];if(j.width||j.height){for(var p=k+1;p<b.length;p++){j=b[p];if(!j.width&&!j.height)break}k&&f.interpolate!="step-after"&&k--;p<b.length&&f.interpolate!="step-before"&&p++;i.push((p-k>2&&(f.interpolate=="basis"||f.interpolate=="cardinal"||f.interpolate=="monotone")?d:c)(k,p-1));k=p-1}}if(!i.length)return e;e=this.expect(e,
"path",b,0,{"shape-rendering":f.antialias?null:"crispEdges","pointer-events":f.events,cursor:f.cursor,d:"M"+i.join("ZM")+"Z",fill:g.color,"fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":h.opacity?f.lineWidth/this.scale:null,"stroke-linecap":f.lineCap,"stroke-linejoin":f.lineJoin,"stroke-miterlimit":f.strokeMiterLimit,"stroke-dasharray":h.opacity?this.parseDasharray(f):null});f.svg&&this.setAttributes(e,f.svg);f.css&&this.setStyle(e,f.css);return this.append(e,
b,0)};
pv.SvgScene.areaSegment=function(b){var c=b.$g.firstChild,d=b[0],e,f;if(d.interpolate=="basis"||d.interpolate=="cardinal"||d.interpolate=="monotone"){e=[];f=[];for(var g=0,h=b.length;g<h;g++){var i=b[h-g-1];e.push(b[g]);f.push({left:i.left+i.width,top:i.top+i.height})}if(d.interpolate=="basis"){e=this.curveBasisSegments(e);f=this.curveBasisSegments(f)}else if(d.interpolate=="cardinal"){e=this.curveCardinalSegments(e,d.tension);f=this.curveCardinalSegments(f,d.tension)}else{e=this.curveMonotoneSegments(e);f=
this.curveMonotoneSegments(f)}}g=0;for(h=b.length-1;g<h;g++){d=b[g];var j=b[g+1];if(d.visible&&j.visible){var k=d.fillStyle,p=d.strokeStyle;if(k.opacity||p.opacity){if(e){i=e[g];j="L"+f[h-g-1].substr(1);i=i+j+"Z"}else{var l=d;i=j;switch(d.interpolate){case "step-before":l=j;break;case "step-after":i=d;break}i="M"+d.left+","+l.top+"L"+j.left+","+i.top+"L"+(j.left+j.width)+","+(i.top+i.height)+"L"+(d.left+d.width)+","+(l.top+l.height)+"Z"}c=this.expect(c,"path",b,g,{"shape-rendering":d.antialias?null:
"crispEdges","pointer-events":d.events,cursor:d.cursor,d:i,fill:k.color,"fill-opacity":k.opacity||null,stroke:p.color,"stroke-opacity":p.opacity||null,"stroke-width":p.opacity?d.lineWidth/this.scale:null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,g)}}}return c};pv.SvgScene.minBarWidth=1;pv.SvgScene.minBarHeight=1;pv.SvgScene.minBarLineWidth=0.2;
pv.SvgScene.bar=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var d=0;d<b.length;d++){var e=b[d];if(!(!e.visible||Math.abs(e.width)<=1.0E-10||Math.abs(e.height)<=1.0E-10)){if(e.width<this.minBarWidth)e.width=this.minBarWidth;if(e.height<this.minBarHeight)e.height=this.minBarHeight;var f=e.fillStyle,g=e.strokeStyle;if(f.opacity||g.opacity){f.type&&f.type!=="solid"&&this.addFillStyleDefinition(b,f);g.type&&g.type!="solid"&&this.addFillStyleDefinition(b,g);var h;if(g.opacity){h=
e.lineWidth;h=h<1.0E-10?0:Math.max(this.minBarLineWidth,h/this.scale)}else h=null;c=this.expect(c,"rect",b,d,{"shape-rendering":e.antialias?null:"crispEdges","pointer-events":e.events,cursor:e.cursor,x:e.left,y:e.top,width:Math.max(1.0E-10,e.width),height:Math.max(1.0E-10,e.height),fill:f.color,"fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":h,"stroke-linecap":e.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(e):null});e.svg&&this.setAttributes(c,
e.svg);e.css&&this.setStyle(c,e.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.dot=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var d=0;d<b.length;d++){var e=b[d];if(e.visible){var f=e.fillStyle,g=e.strokeStyle;if(f.opacity||g.opacity){f.type&&f.type!=="solid"&&this.addFillStyleDefinition(b,f);g.type&&g.type!="solid"&&this.addFillStyleDefinition(b,g);var h=e.shapeRadius,i=null;switch(e.shape){case "cross":i="M"+-h+","+-h+"L"+h+","+h+"M"+h+","+-h+"L"+-h+","+h;break;case "triangle":i=h;var j=h*1.1547;i="M0,"+i+"L"+j+","+-i+" "+-j+","+-i+
"Z";break;case "diamond":h*=Math.SQRT2;i="M0,"+-h+"L"+h+",0 0,"+h+" "+-h+",0Z";break;case "square":i="M"+-h+","+-h+"L"+h+","+-h+" "+h+","+h+" "+-h+","+h+"Z";break;case "tick":i="M0,0L0,"+-e.shapeSize;break;case "bar":i="M0,"+e.shapeSize/2+"L0,"+-(e.shapeSize/2);break}f={"shape-rendering":e.antialias?null:"crispEdges","pointer-events":e.events,cursor:e.cursor,fill:f.color,"fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":g.opacity?e.lineWidth/this.scale:
null,"stroke-linecap":e.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(e):null};if(i){f.transform="translate("+e.left+","+e.top+")";if(e.shapeAngle)f.transform+=" rotate("+180*e.shapeAngle/Math.PI+")";f.d=i;c=this.expect(c,"path",b,d,f)}else{f.cx=e.left;f.cy=e.top;f.r=h;c=this.expect(c,"circle",b,d,f)}e.svg&&this.setAttributes(c,e.svg);e.css&&this.setStyle(c,e.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.image=function(b){for(var c=b.$g.firstChild,d=0;d<b.length;d++){var e=b[d];if(e.visible){c=this.fill(c,b,d);if(e.image){c=this.expect(c,"foreignObject",b,d,{cursor:e.cursor,x:e.left,y:e.top,width:e.width,height:e.height});e.svg&&this.setAttributes(c,e.svg);e.css&&this.setStyle(c,e.css);var f=c.firstChild||c.appendChild(document.createElementNS(this.xhtml,"canvas"));f.$scene={scenes:b,index:d};f.style.width=e.width;f.style.height=e.height;f.width=e.imageWidth;f.height=e.imageHeight;f.getContext("2d").putImageData(e.image,
0,0)}else{c=this.expect(c,"image",b,d,{preserveAspectRatio:"none",cursor:e.cursor,x:e.left,y:e.top,width:e.width,height:e.height});e.svg&&this.setAttributes(c,e.svg);e.css&&this.setStyle(c,e.css);c.setAttributeNS(this.xlink,"xlink:href",e.url)}c=this.append(c,b,d);c=this.stroke(c,b,d)}}return c};
pv.SvgScene.label=function(b){for(var c=b.$g.firstChild,d=0;d<b.length;d++){var e=b[d];if(e.visible){var f=e.textStyle;if(f.opacity&&e.text){var g=0,h=0,i=0,j="start";switch(e.textBaseline){case "middle":if(pv.renderer()=="svgweb")h=3;else i=".35em";break;case "top":if(pv.renderer()=="svgweb")h=9+e.textMargin;else{i=".71em";h=e.textMargin}break;case "bottom":h="-"+e.textMargin;break}switch(e.textAlign){case "right":j="end";g="-"+e.textMargin;break;case "center":j="middle";break;case "left":g=e.textMargin;
break}c=this.expect(c,"text",b,d,{"pointer-events":e.events,cursor:e.cursor,x:g,y:h,dy:i,transform:"translate("+e.left+","+e.top+")"+(e.textAngle?" rotate("+180*e.textAngle/Math.PI+")":"")+(this.scale!=1?" scale("+1/this.scale+")":""),fill:f.color,"fill-opacity":f.opacity||null,"text-anchor":j},{font:e.font,"text-shadow":e.textShadow,"text-decoration":e.textDecoration});e.svg&&this.setAttributes(c,e.svg);e.css&&this.setStyle(c,e.css);if(c.firstChild)c.firstChild.nodeValue=e.text;else pv.renderer()==
"svgweb"?c.appendChild(document.createTextNode(e.text,true)):c.appendChild(document.createTextNode(e.text));c=this.append(c,b,d)}}}return c};
pv.SvgScene.line=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);if(b.length<2)return c;var d=b[0];if(d.segmented)return this.lineSegment(b);if(!d.visible)return c;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)return c;f.type&&f.type!="solid"&&this.addFillStyleDefinition(b,f);var g="M"+d.left+","+d.top;if(b.length>2&&(d.interpolate=="basis"||d.interpolate=="cardinal"||d.interpolate=="monotone"))switch(d.interpolate){case "basis":g+=this.curveBasis(b);break;case "cardinal":g+=
this.curveCardinal(b,d.tension);break;case "monotone":g+=this.curveMonotone(b);break}else for(var h=1;h<b.length;h++)g+=this.pathSegment(b[h-1],b[h]);c=this.expect(c,"path",b,0,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,d:g,fill:e.color,"fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?d.lineWidth/this.scale:null,"stroke-linecap":d.lineCap,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,
"stroke-dasharray":f.opacity?this.parseDasharray(d):null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);return this.append(c,b,0)};
pv.SvgScene.lineSegment=function(b){var c=b.$g.firstChild,d=b[0],e;switch(d.interpolate){case "basis":e=this.curveBasisSegments(b);break;case "cardinal":e=this.curveCardinalSegments(b,d.tension);break;case "monotone":e=this.curveMonotoneSegments(b);break}d=0;for(var f=b.length-1;d<f;d++){var g=b[d],h=b[d+1];if(g.visible&&h.visible){var i=g.strokeStyle,j=pv.FillStyle.transparent;if(i.opacity){if(g.interpolate=="linear"&&g.lineJoin=="miter"){j=i;i=pv.FillStyle.transparent;h=this.pathJoin(b[d-1],g,h,
b[d+2])}else h=e?e[d]:"M"+g.left+","+g.top+this.pathSegment(g,h);c=this.expect(c,"path",b,d,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":g.events,cursor:g.cursor,d:h,fill:j.color,"fill-opacity":j.opacity||null,stroke:i.color,"stroke-opacity":i.opacity||null,"stroke-width":i.opacity?g.lineWidth/this.scale:null,"stroke-linejoin":g.lineJoin});g.svg&&this.setAttributes(c,g.svg);g.css&&this.setStyle(c,g.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.pathSegment=function(b,c){var d=1;switch(b.interpolate){case "polar-reverse":d=0;case "polar":var e=c.left-b.left,f=c.top-b.top;b=1-b.eccentricity;e=Math.sqrt(e*e+f*f)/(2*b);if(b<=0||b>1)break;return"A"+e+","+e+" 0 0,"+d+" "+c.left+","+c.top;case "step-before":return"V"+c.top+"H"+c.left;case "step-after":return"H"+c.left+"V"+c.top}return"L"+c.left+","+c.top};pv.SvgScene.lineIntersect=function(b,c,d,e){return b.plus(c.times(d.minus(b).dot(e.perp())/c.dot(e.perp())))};
pv.strokeMiterLimit=4;
pv.SvgScene.pathJoin=function(b,c,d,e){var f=[],g,h=c.lineWidth/this.scale,i=pv.vector(c.left,c.top),j=pv.vector(d.left,d.top),k=j.minus(i),p=k.perp().norm(),l=p.times(h/2),r=i.plus(l),m=i.minus(l),n=j.plus(l);l=j.minus(l);if(!b||!b.visible)f.push(m,r);else{var o=pv.vector(b.left,b.top),s=i.minus(o),t=s.perp().norm().plus(p).norm();o=this.lineIntersect(i,t,r,k);t=this.lineIntersect(i,t,m,k);g=o.minus(t).length();b=(h+b.lineWidth/this.scale)/2;g=g/b;c=c.strokeMiterLimit||pv.strokeMiterLimit;if(g<=
c)f.push(t,o);else{c=k.times(-1);c=s.norm().plus(c.norm()).norm();i=i.plus(c.times(b/2));c.dot(p)>=0?f.push(t,i,r):f.push(m,i,o)}}if(!e||!e.visible)f.push(n,l);else{i=pv.vector(e.left,e.top).minus(j);m=i.perp().norm().plus(p).norm();r=this.lineIntersect(j,m,n,k);m=this.lineIntersect(j,m,l,k);g=r.minus(m).length();e=(e.lineWidth/this.scale+h)/2;g=g/e;c=d.strokeMiterLimit||pv.strokeMiterLimit;if(g<=c)f.push(r,m);else{d=i.times(-1);k=k.norm().plus(d.norm()).norm();j=j.plus(k.times(e/2));k.dot(p)>=0?
f.push(n,j,m):f.push(r,j,l)}}p=f.shift();return"M"+p.x+","+p.y+"L"+f.map(function(u){return u.x+","+u.y}).join(" ")};
pv.SvgScene.panel=function(b){for(var c=b.$g,d=c&&c.firstChild,e=false,f=0;f<b.length;f++){var g=b[f];if(g.visible){if(!b.parent){if(pv.renderer()!=="batik")g.canvas.style.display="inline-block";if(c&&c.parentNode!=g.canvas)d=(c=g.canvas.firstChild)&&c.firstChild;if(!c){c=this.create(pv.renderer()!=="batik"?"svg":"g");c.setAttribute("font-size","10px");c.setAttribute("font-family","sans-serif");c.setAttribute("fill","none");c.setAttribute("stroke","none");c.setAttribute("stroke-width",1.5);c.setAttribute("style",
"-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");if(typeof c.onselectstart!=="undefined"){c.setAttribute("unselectable","on");c.onselectstart=function(){return false}}if(pv.renderer()==="svgweb"){c.setAttribute("width",g.width+g.left+g.right);c.setAttribute("height",g.height+g.top+g.bottom);var h=document.createDocumentFragment(true);c.addEventListener("SVGLoad",function(){var r=this;(function(){if(e){e=
false;r.appendChild(h);for(var m=0;m<pv.Scene.events.length;m++)r.addEventListener(pv.Scene.events[m],pv.SvgScene.dispatch,false);b.$g=r;b.$g.__ready=true}else setTimeout(arguments.callee,10)})()},false);svgweb.appendChild(c,g.canvas);c=h}else{for(var i=0;i<this.events.length;i++)c.addEventListener(this.events[i],this.dispatch,false);c=g.canvas.appendChild(c);c.__ready=true}d=c.firstChild}b.$g=c;if(c.__ready){c.setAttribute("width",g.width+g.left+g.right);c.setAttribute("height",g.height+g.top+g.bottom)}}if(g.overflow==
"hidden"){i=pv.id().toString(36);var j=this.expect(d,"g",b,f,{"clip-path":"url(#"+i+")"});j.parentNode||c.appendChild(j);b.$g=c=j;d=j.firstChild;d=this.expect(d,"clipPath",b,f,{id:i});i=d.firstChild||d.appendChild(this.create("rect"));i.setAttribute("x",g.left);i.setAttribute("y",g.top);i.setAttribute("width",g.width);i.setAttribute("height",g.height);d.parentNode||c.appendChild(d);d=d.nextSibling}d=this.fill(d,b,f);i=this.scale;var k=g.transform,p=g.left+k.x,l=g.top+k.y;this.scale*=k.k;this.eachChild(b,
f,function(r){r.$g=d=this.expect(d,"g",b,f,{transform:"translate("+p+","+l+")"+(k.k!=1?" scale("+k.k+")":"")});this.updateAll(r);d.parentNode||c.appendChild(d);d=d.nextSibling});this.scale=i;d=this.stroke(d,b,f);if(g.overflow=="hidden"){b.$g=c=j.parentNode;d=j.nextSibling}}}e=true;return d};
pv.SvgScene.eachChild=function(b,c,d,e){if(b.mark.zOrderChildCount){b=b[c].children.slice(0);b.sort(function(f,g){var h=f.mark._zOrder-g.mark._zOrder;if(h===0)h=f.childIndex-g.childIndex;return h});b.forEach(d,e||this)}else b[c].children.forEach(d,e||this)};
pv.SvgScene.fill=function(b,c,d){this.removeFillStyleDefinitions(c);var e=c[d],f=e.fillStyle;if(f.opacity||e.events=="all"){f.type&&f.type!=="solid"&&this.addFillStyleDefinition(c,f);b=this.expect(b,"rect",c,d,{"shape-rendering":e.antialias?null:"crispEdges","pointer-events":e.events,cursor:e.cursor,x:e.left,y:e.top,width:e.width,height:e.height,fill:f.color,"fill-opacity":f.opacity,stroke:null});b=this.append(b,c,d)}return b};
pv.SvgScene.stroke=function(b,c,d){var e=c[d],f=e.strokeStyle;if(f.opacity||e.events=="all"){b=this.expect(b,"rect",c,d,{"shape-rendering":e.antialias?null:"crispEdges","pointer-events":e.events=="all"?"stroke":e.events,cursor:e.cursor,x:e.left,y:e.top,width:Math.max(1.0E-10,e.width),height:Math.max(1.0E-10,e.height),fill:null,stroke:f.color,"stroke-opacity":f.opacity,"stroke-width":e.lineWidth/this.scale,"stroke-linecap":e.lineCap,"stroke-dasharray":f.opacity?this.parseDasharray(e):null});b=this.append(b,
c,d)}return b};pv.SvgScene.minRuleLineWidth=1;
pv.SvgScene.rule=function(b){for(var c=b.$g.firstChild,d=0;d<b.length;d++){var e=b[d];if(e.visible){var f=e.strokeStyle;if(f.opacity){var g=e.lineWidth;g=g<1.0E-10?0:Math.max(this.minRuleLineWidth,g/this.scale);c=this.expect(c,"line",b,d,{"shape-rendering":e.antialias?null:"crispEdges","pointer-events":e.events,cursor:e.cursor,x1:e.left,y1:e.top,x2:e.left+e.width,y2:e.top+e.height,stroke:f.color,"stroke-opacity":f.opacity,"stroke-width":g,"stroke-linecap":e.lineCap,"stroke-dasharray":f.opacity?this.parseDasharray(e):
null});e.svg&&this.setAttributes(c,e.svg);e.css&&this.setStyle(c,e.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.wedge=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var d=0;d<b.length;d++){var e=b[d];if(e.visible){var f=e.fillStyle,g=e.strokeStyle;if(f.opacity||g.opacity){var h=e.innerRadius,i=e.outerRadius,j=Math.abs(e.angle);if(j>=2*Math.PI)h=h?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z";else{var k=Math.min(e.startAngle,e.endAngle),
p=Math.max(e.startAngle,e.endAngle),l=Math.cos(k),r=Math.cos(p);k=Math.sin(k);p=Math.sin(p);h=h?"M"+i*l+","+i*k+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*r+","+i*p+"L"+h*r+","+h*p+"A"+h+","+h+" 0 "+(j<Math.PI?"0":"1")+",0 "+h*l+","+h*k+"Z":"M"+i*l+","+i*k+"A"+i+","+i+" 0 "+(j<Math.PI?"0":"1")+",1 "+i*r+","+i*p+"L0,0Z"}f.type&&f.type!=="solid"&&this.addFillStyleDefinition(b,f);g.type&&g.type!="solid"&&this.addFillStyleDefinition(b,g);c=this.expect(c,"path",b,d,{"shape-rendering":e.antialias?null:
"crispEdges","pointer-events":e.events,cursor:e.cursor,transform:"translate("+e.left+","+e.top+")",d:h,fill:f.color,"fill-rule":"evenodd","fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":g.opacity?e.lineWidth/this.scale:null,"stroke-linejoin":e.lineJoin,"stroke-miterlimit":e.strokeMiterLimit,"stroke-linecap":e.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(e):null});e.svg&&this.setAttributes(c,e.svg);e.css&&this.setStyle(c,e.css);c=this.append(c,
b,d)}}}return c};pv.Mark=function(){this.$properties=[];this.$propertiesMap={};this.$handlers={}};pv.Mark.prototype.properties={};pv.Mark.cast={};pv.Mark.prototype.property=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;pv.Mark.prototype.propertyMethod(b,false,pv.Mark.cast[b]=c);return this};
pv.Mark.prototype.localProperty=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;var d=pv.Mark.cast[b];if(c)pv.Mark.cast[b]=d=c;this.propertyMethod(b,false,d);return this};
pv.Mark.prototype.propertyMethod=function(b,c,d){d||(d=pv.Mark.cast[b]);this[b]=function(e,f){if(c&&this.scene){var g=this.scene.defs;if(arguments.length){g[b]={id:e==null?0:pv.id(),value:e!=null&&d?d(e):e};return this}return g[b]?g[b].value:null}if(arguments.length){this.setPropertyValue(b,e,c,d,false,f);return this}if(g=pv.propertyEval){var h=this.binds,i=h.properties[b];if(i){h=h.net;var j=h[b];if(j==null)j=h[b]=0;(i.dependents||(i.dependents={}))[g.name]=true;(pv.propertyEvalDependencies||(pv.propertyEvalDependencies=
{}))[b]=true;if(j>=pv.propertyEvalNetIndex)pv.propertyEvalNetIndex=j+1}}return this.instance()[b]}};pv.Mark.funPropertyCaller=function(b,c){var d=pv.Mark.stack;return function(){var e=b.apply(this,d);return e!=null?c(e):e}};
pv.Mark.prototype.setPropertyValue=function(b,c,d,e,f,g){d=!d<<1|typeof c==="function";if(d&1&&e)c=pv.Mark.funPropertyCaller(c,e);else if(c!=null&&e)c=e(c);var h=this.$propertiesMap;e=this.$properties;c={name:b,id:pv.id(),value:c,type:d,tag:g};g=h[b];h[b]=c;if(g)for(b=0;b<e.length;b++)if(e[b]===g){e.splice(b,1);break}e.push(c);if(f&&g&&d===3){c.proto=g;c.root=g.root||g}return c};
pv.Mark.prototype.intercept=function(b,c,d){this.setPropertyValue(b,c,false,pv.get(d,"noCast")?null:pv.Mark.cast[b],true,pv.get(d,"tag"));return this};pv.Mark.prototype.propertyValue=function(b,c){var d=this.$propertiesMap[b];if(d)return d.value;if(c){if(this.proto){c=this.proto.propertyValueRecursive(b);if(c!==undefined)return c}return this.defaults.propertyValueRecursive(b)}};pv.Mark.prototype.propertyValueRecursive=function(b){var c=this.$propertiesMap[b];if(c)return c.value;if(this.proto)return this.proto.propertyValueRecursive(b)};
pv.Mark.stack=[];pv.Mark.prototype.property("data").property("visible",Boolean).property("datum",Object).property("css",Object).property("svg",Object).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String);a=pv.Mark.prototype;a.childIndex=-1;a.index=-1;a.scale=1;a._zOrder=0;
a.defaults=(new pv.Mark).data(function(b){return[b]}).datum(function(){var b=this.parent;return b?b.scene[b.index].datum:null}).visible(true).antialias(true).events("painted");a.extend=function(b){this.proto=b;this.target=b.target;return this};a.add=function(b){return this.parent.add(b).extend(this)};a.def=function(b,c){this.propertyMethod(b,true);return this[b](arguments.length>1?c:null)};
a.zOrder=function(b){if(!arguments.length)return this._zOrder;b=+b||0;if(this._zOrder!==b){this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount--;this._zOrder=b;this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount++}return this};
a.anchor=function(b){b||(b="center");return(new pv.Anchor(this)).name(b).data(function(){return this.scene.target.map(function(c){return c.data})}).datum(function(){return this.scene.target[this.index].datum}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var c=this.scene.target[this.index],d=c.width||0;switch(this.name()){case "bottom":case "top":case "center":return c.left+d/2;case "left":return null}return c.left+
d}).top(function(){var c=this.scene.target[this.index],d=c.height||0;switch(this.name()){case "left":case "right":case "center":return c.top+d/2;case "top":return null}return c.top+d}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+(c.width||0):null}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+(c.height||0):null}).textAlign(function(){switch(this.name()){case "bottom":case "top":case "center":return"center";case "right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";
case "top":return"top"}return"bottom"})};a.anchorTarget=function(){return this.target};a.margin=function(b){return this.left(b).right(b).top(b).bottom(b)};a.instance=function(b){var c=this.scene||this.parent.instance(-1).children[this.childIndex],d=!arguments.length||this.hasOwnProperty("index")?this.index:b;return c[d<0?c.length-1:d]};
a.instances=function(b){for(var c=this,d=[],e;!(e=c.scene);){b=b.parent;d.push({index:b.index,childIndex:c.childIndex});c=c.parent}for(;d.length;){b=d.pop();e=e[b.index].children[b.childIndex]}if(this.hasOwnProperty("index")){d=pv.extend(e[this.index]);d.right=d.top=d.left=d.bottom=0;return[d]}return e};a.first=function(){return this.scene[0]};a.last=function(){return this.scene[this.scene.length-1]};a.sibling=function(){return this.index==0?null:this.scene[this.index-1]};
a.cousin=function(){var b=this.parent;return(b=b&&b.sibling())&&b.children?b.children[this.childIndex][this.index]:null};a.render=function(){this.parent&&!this.root.scene?this.root.render():this.renderCore()};
a.renderCore=function(){function b(h,i,j){h.scale=j;if(i<f.length){e.unshift(null);try{if(h.hasOwnProperty("index"))c(h,i,j);else{for(var k=0,p=h.scene.length;k<p;k++){h.index=k;c(h,i,j)}delete h.index}}finally{e.shift()}}else{h.build();pv.Scene.scale=j;i=null;if(h.scene&&h.scene.$g&&h.scene.$g.suspendRedraw)i=h.scene.$g.suspendRedraw(1E3);pv.Scene.updateAll(h.scene);i&&h.scene.$g.unsuspendRedraw(i)}delete h.scale}function c(h,i,j){var k=h.scene[h.index],p;if(k.visible){var l=f[i],r=h.children[l];
for(p=0;p<l;p++)h.children[p].scene=k.children[p];e[0]=k.data;if(r.scene)b(r,i+1,j*k.transform.k);else{r.scene=k.children[l];b(r,i+1,j*k.transform.k);delete r.scene}for(p=0;p<l;p++)delete h.children[p].scene}}for(var d=this.parent,e=pv.Mark.stack,f=[],g=this;g.parent;g=g.parent)f.unshift(g.childIndex);for(this.bind();d&&!d.hasOwnProperty("index");)d=d.parent;this.context(d?d.scene:undefined,d?d.index:-1,function(){b(this.root,0,1)})};pv.Mark._requiredPropsPosition={id:0,datum:1,visible:3};a=pv.Mark.prototype;
a.bind=function(){function b(j){do for(var k=j.$properties,p=k.length-1;p>=0;p--){var l=k[p],r=c[l.name];if(r){if(r.type===3){var m=r.root;if(m){if(!m.proto){m.proto=l;r.root=l}}else r.proto=r.root=l}}else{c[l.name]=l;switch(l.name){case "data":d=l;break;case "datum":case "visible":case "id":e.push(l);break;default:f[l.type].push(l);break}}}while(j=j.proto)}var c={},d,e=[],f=[[],[],[],[]],g=pv.Mark._requiredPropsPosition;b(this);b(this.defaults);e.sort(function(j,k){return g[j.name]-g[k.name]});f[1].reverse();
f[3].reverse();var h=this;do for(var i in h.properties)i in c||f[2].push(c[i]={name:i,type:2,value:null});while(h=h.proto);h=f[0].concat(f[1]);for(i=0;i<h.length;i++)this.propertyMethod(h[i].name,true);this.binds={properties:c,net:{},data:d,defs:h,required:e,optional:pv.blend(f)}};a.updateNet=function(b,c){function d(h,i){if(i>(g[h.name]||0)){g[h.name]=i;if(h=h.dependents){i++;for(var j in h)if(h.hasOwnProperty(j)){var k=f[j];k&&d(k,i)}}}}var e=this.binds,f=e.properties,g=e.net;d(b,c)};
a.build=function(){var b=this.scene,c=pv.Mark.stack;if(!b){b=this.scene=[];b.mark=this;b.type=this.type;b.childIndex=this.childIndex;if(this.parent){b.parent=this.parent.scene;b.parentIndex=this.parent.index}}if(this.target)b.target=this.target.instances(b);if(this.binds.defs.length){var d=b.defs;if(!d)b.defs=d={};for(var e=0;e<this.binds.defs.length;e++){var f=this.binds.defs[e],g=d[f.name];if(!g||f.id>g.id)d[f.name]={id:0,value:f.type&1?f.value.apply(this,c):f.value}}}d=this.binds.data;d=d.type&
1?d.value.apply(this,c):d.value;f=pv.Mark.prototype;c.unshift(null);try{var h=b.length=d.length;for(e=0;e<h;e++){f.index=this.index=e;var i=b[e]||(b[e]={});i.data=c[0]=d[e];this.buildInstance(i)}}finally{f.index=-1;delete this.index;c.shift()}return this};
a.buildProperties=function(b,c){for(var d=pv.Mark.stack,e=0,f=c.length;e<f;e++){var g=c[e],h;switch(g.type){case 3:var i=pv.propertyProto;try{pv.propertyProto=g.proto;h=g.value.apply(this,d)}finally{pv.propertyProto=i}break;case 2:h=g.value;break;case 0:case 1:h=this.scene.defs[g.name].value;break}b[g.name]=h}};a.delegate=function(b,c){var d=pv.propertyProto;if(d&&(!c||d.tag===c)){c=this.evalProperty(d);if(c!==undefined)return c}return b};
a.hasDelegate=function(b){var c=pv.propertyProto;return!!c&&(!b||c.tag===b)};a.evalProperty=function(b){switch(b.type){case 3:var c=pv.propertyProto;try{pv.propertyProto=b.proto;return b.value.apply(this,pv.Mark.stack)}finally{pv.propertyProto=c}case 2:return b.value;case 0:case 1:return this.scene.defs[b.name].value}};
a.buildPropertiesWithDepTracking=function(b,c){var d=this.binds.net,e,f,g,h,i,j,k=pv.Mark.stack,p=c.length;try{for(;;){g=null;j={};for(var l=0;l<p;l++){var r=c[l],m=r.name;j[m]=true;if(!h||h[m]){var n;switch(r.type){case 3:pv.propertyEval=r;pv.propertyEvalNetIndex=e=d[m]||0;pv.propertyEvalDependencies=null;var o=pv.propertyProto;try{pv.propertyProto=r.proto;n=r.value.apply(this,k)}finally{pv.propertyProto=o}f=pv.propertyEvalNetIndex;if(f>e){var s=pv.propertyEvalDependencies;for(var t in s)if(s.hasOwnProperty(t)&&
!j.hasOwnProperty(m)){g||(g={});g[t]=true}this.updateNet(r,f)}break;case 2:n=r.value;break;case 0:case 1:n=this.scene.defs[m].value;break}b[m]=n}}if(!g)break;h=g;i=pv.numerate(c,function(u){return u.name});c.sort(function(u,q){var x=pv.naturalOrder(d[u.name]||0,d[q.name]||0);x||(x=pv.naturalOrder(i[u.name],i[q.name]));return x});i=null}}finally{pv.propertyEval=null;pv.propertyEvalNetIndex=null;pv.propertyEvalDependencies=null}};
a.buildInstance=function(b){this.buildProperties(b,this.binds.required);if(b.visible){this.index===0?this.buildPropertiesWithDepTracking(b,this.binds.optional):this.buildProperties(b,this.binds.optional);this.buildImplied(b)}};
a.buildImplied=function(b){var c=b.left,d=b.right,e=b.top,f=b.bottom,g=this.properties,h=g.width?b.width:0,i=g.height?b.height:0,j,k;if(h==null||d==null||c==null){j=this.parent?this.parent.instance():null;k=true;var p=j?j.width:h+c+d;if(h==null)h=p-(d=d||0)-(c=c||0);else if(d==null)if(c==null)c=d=(p-h)/2;else d=p-h-c;else c=p-h-d}if(i==null||f==null||e==null){k||(j=this.parent?this.parent.instance():null);j=j?j.height:i+e+f;if(i==null)i=j-(e=e||0)-(f=f||0);else if(f==null)f=e==null?(e=(j-i)/2):j-
i-e;else e=j-i-f}b.left=c;b.right=d;b.top=e;b.bottom=f;if(g.width)b.width=h;if(g.height)b.height=i;if(g.textStyle&&!b.textStyle)b.textStyle=pv.FillStyle.transparent;if(g.fillStyle&&!b.fillStyle)b.fillStyle=pv.FillStyle.transparent;if(g.strokeStyle&&!b.strokeStyle)b.strokeStyle=pv.FillStyle.transparent};
a.mouse=function(){var b=this.root.canvas(),c=pv.scrollOffset(b),d=pv.event,e=c[0]+d.clientX*1;c=c[1]+d.clientY*1;if(pv.renderer()!=="svgweb"){do{e-=b.offsetLeft;c-=b.offsetTop}while(b=b.offsetParent)}b=pv.Transform.identity;var f=this.properties.transform?this:this.parent;d=[];do d.push(f);while(f=f.parent);for(;f=d.pop();){f=f.instance();b=b.translate(f.left,f.top).times(f.transform)}b=b.invert();return pv.vector(e*b.k+b.x,c*b.k+b.y)};
a.event=function(b,c){c=pv.functor(c);var d=this.$handlers[b];if(d)if(d instanceof Array)d.push(c);else d=[d,c];else d=c;this.$handlers[b]=d;return this};
a.context=function(b,c,d){function e(l,r){pv.Mark.scene=l;g.index=r;if(l){var m=l.mark,n=m,o=[];do{o.push(n);h.push(l[r].data);n.index=r;n.scene=l;r=l.parentIndex;l=l.parent}while(n=n.parent);l=o.length-1;for(r=1;l>0;l--){n=o[l];n.scale=r;r*=n.scene[n.index].transform.k}if(o=m.children){m=m.scene[m.index];l=0;for(var s=o.length;l<s;l++){n=o[l];n.scene=m.children[l];n.scale=r}}}}function f(l){if(l){l=l.mark;var r,m=l.children;if(m)for(var n=0,o=m.length;n<o;n++){r=m[n];delete r.scene;delete r.scale}r=
l;do{h.pop();if(r.parent){delete r.scene;delete r.scale}delete r.index}while(r=r.parent)}}var g=pv.Mark.prototype,h=pv.Mark.stack,i=pv.Mark.scene,j=g.index;if(b&&b===i&&c===j)try{d.apply(this,h)}catch(k){pv.error(k);throw k;}finally{pv.Mark.scene=i;g.index=j}else{f(i,j);e(b,c);try{d.apply(this,h)}catch(p){pv.error(p);throw p;}finally{f(b,c);e(i,j)}}};
pv.Mark.dispatch=function(b,c,d,e){var f=c.mark,g=c.parent,h=f.$handlers[b];if(f.root.animatingCount)return true;if(!h)return g&&pv.Mark.dispatch(b,g,c.parentIndex,e);f.context(c,d,function(){var i=pv.Mark.stack.concat(e);if(h instanceof Array){var j;h.forEach(function(k){if((k=k.apply(f,i))&&k.render)(j||(j=[])).push(k)});j&&j.forEach(function(k){k.render()})}else(f=h.apply(f,i))&&f.render&&f.render()});return true};
pv.Mark.prototype.eachInstance=function(b,c){function d(i,j,k){var p;j===h||(p=f[j]);var l=i.length;if(l>0){for(var r=0;r<l;r++){var m=i[r];if(j===h)b.call(c,i[r],k);else if(m.visible){var n=m.children[p];if(n){m=k.times(m.transform).translate(m.left,m.top);d(n,j+1,m)}}}b.call(c,g,null)}}for(var e=this,f=[],g={isBreak:true,visible:false,datum:{}};e.parent;){f.unshift(e.childIndex);e=e.parent}if(e=e.scene){var h=f.length;d(e,0,pv.Transform.identity)}};
pv.Mark.prototype.toScreenTransform=function(){var b=pv.Transform.identity;if(this instanceof pv.Panel)b=b.translate(this.left(),this.top()).times(this.transform());var c=this.parent;if(c){do b=b.translate(c.left(),c.top()).times(c.transform());while(c=c.parent)}return b};pv.Mark.prototype.transition=function(){return new pv.Transition(this)};pv.Mark.prototype.on=function(b){return this["$"+b]=new pv.Transient(this)};pv.Anchor=function(b){pv.Mark.call(this);this.target=b;this.parent=b.parent};
pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String);pv.Anchor.prototype.extend=function(b){this.proto=b;return this};pv.Area=function(){pv.Mark.call(this)};
pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("segmented",Boolean).property("interpolate",String).property("tension",Number);pv.Area.prototype.type="area";pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
pv.Area.prototype.buildImplied=function(b){if(b.height==null)b.height=0;if(b.width==null)b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Area.fixed={lineWidth:1,lineJoin:1,strokeMiterLimit:1,lineCap:1,strokeStyle:1,strokeDasharray:1,fillStyle:1,segmented:1,interpolate:1,tension:1};
pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);var b=this.binds,c=b.required;b=b.optional;for(var d=0,e=b.length;d<e;d++){var f=b[d];f.fixed=f.name in pv.Area.fixed;if(f.name=="segmented"){c.push(f);b.splice(d,1);d--;e--}}this.binds.$required=c;this.binds.$optional=b};
pv.Area.prototype.buildInstance=function(b){var c=this.binds;if(this.index){var d=c.fixed;if(!d){d=c.fixed=[];function e(i){return!i.fixed||(d.push(i),false)}c.required=c.required.filter(e);if(!this.scene[0].segmented)c.optional=c.optional.filter(e)}if(c=d.length)for(var f=this.scene[0],g=0;g<c;g++){var h=d[g].name;b[h]=f[h]}}else{c.required=c.$required;c.optional=c.$optional;c.fixed=null}pv.Mark.prototype.buildInstance.call(this,b)};
pv.Area.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})};pv.Bar=function(){pv.Mark.call(this)};
pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Bar.prototype.type="bar";pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).lineCap("butt").strokeDasharray("none");pv.Dot=function(){pv.Mark.call(this)};
pv.Dot.prototype=pv.extend(pv.Mark).property("shape",String).property("shapeAngle",Number).property("shapeRadius",Number).property("shapeSize",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);pv.Dot.prototype.type="dot";pv.Dot.prototype.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).shape("circle").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).lineCap("butt").strokeDasharray("none");
pv.Dot.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).left(function(){var c=this.scene.target[this.index];switch(this.name()){case "bottom":case "top":case "center":return c.left;case "left":return null}return c.left+c.shapeRadius}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+c.shapeRadius:null}).top(function(){var c=this.scene.target[this.index];switch(this.name()){case "left":case "right":case "center":return c.top;case "top":return null}return c.top+
c.shapeRadius}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+c.shapeRadius:null}).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "bottom":return"top"}return"bottom"})};
pv.Dot.prototype.buildImplied=function(b){var c=b.shapeRadius,d=b.shapeSize;if(c==null)if(d==null){b.shapeSize=20.25;b.shapeRadius=4.5}else b.shapeRadius=Math.sqrt(d);else if(d==null)b.shapeSize=c*c;pv.Mark.prototype.buildImplied.call(this,b)};pv.Label=function(){pv.Mark.call(this)};
pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String);pv.Label.prototype.type="label";pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3);
pv.Line=function(){pv.Mark.call(this)};pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeStyle",pv.fillStyle).property("strokeDasharray",String).property("fillStyle",pv.fillStyle).property("segmented",Boolean).property("interpolate",String).property("eccentricity",Number).property("tension",Number);a=pv.Line.prototype;a.type="line";a.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
a.bind=pv.Area.prototype.bind;a.buildInstance=pv.Area.prototype.buildInstance;a.anchor=function(b){return pv.Area.prototype.anchor.call(this,b).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center";case "right":return"left"}}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "top":return"bottom";case "bottom":return"top"}})};pv.Rule=function(){pv.Mark.call(this)};
pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Rule.prototype.type="rule";pv.Rule.prototype.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(false).lineCap("butt").strokeDasharray("none");pv.Rule.prototype.anchor=pv.Line.prototype.anchor;
pv.Rule.prototype.buildImplied=function(b){var c=b.left,d=b.right;if(b.width!=null||c==null&&d==null||d!=null&&c!=null)b.height=0;else b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Panel=function(){pv.Bar.call(this);this.children=[];this.root=this;this.$dom=pv.$&&pv.$.s};pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(b){return typeof b=="string"?document.getElementById(b):b});a=pv.Panel.prototype;a.type="panel";
a.animatingCount=0;a.zOrderChildCount=0;a.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible");a.anchor=function(b){b=pv.Bar.prototype.anchor.call(this,b);b.parent=this;return b};a.add=function(b){b=new b;b.parent=this;b.root=this.root;b.childIndex=this.children.length;this.children.push(b);return b};a.bind=function(){pv.Mark.prototype.bind.call(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].bind()};
a.buildInstance=function(b){pv.Bar.prototype.buildInstance.call(this,b);if(b.visible){var c=this.scale*b.transform.k;pv.Mark.prototype.index=-1;for(var d=this.children,e=b.children||(b.children=[]),f=0,g=d.length;f<g;f++){b=d[f];b.scene=e[f];b.scale=c;b.build()}for(f=0;f<g;f++){b=d[f];e[f]=b.scene;delete b.scene;delete b.scale}e.length=g}};
a.buildImplied=function(b){if(!this.parent){var c=b.canvas;if(pv.renderer()==="batik")if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}}else c=document.lastChild;else if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}var d;if(b.width==null){d=parseFloat(pv.css(c,"width"));b.width=d-b.left-b.right}if(b.height==null){d=parseFloat(pv.css(c,"height"));b.height=d-b.top-b.bottom}}else{d=
this.$canvas||(this.$canvas=[]);if(!(c=d[this.index])){c=d[this.index]=document.createElement(pv.renderer()=="svgweb"?"div":"span");if(this.$dom)this.$dom.parentNode.insertBefore(c,this.$dom);else{for(d=document.body;d.lastChild&&d.lastChild.tagName;)d=d.lastChild;if(d!=document.body)d=d.parentNode;d.appendChild(c)}}}b.canvas=c}if(!b.transform)b.transform=pv.Transform.identity;pv.Mark.prototype.buildImplied.call(this,b)};pv.Panel.updateCreateId=function(b){b.$pvCreateId=(b.$pvCreateId||0)+1};
pv.Image=function(){pv.Bar.call(this)};pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number);a=pv.Image.prototype;a.type="image";a.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null);a.image=function(b){this.$image=function(){var c=b.apply(this,arguments);return c==null?pv.Color.transparent:typeof c=="string"?pv.color(c):c};return this};
a.bind=function(){pv.Bar.prototype.bind.call(this);var b=this.binds,c=this;do b.image=c.$image;while(!b.image&&(c=c.proto))};
a.buildImplied=function(b){pv.Bar.prototype.buildImplied.call(this,b);if(b.visible){if(b.imageWidth==null)b.imageWidth=b.width;if(b.imageHeight==null)b.imageHeight=b.height;if(b.url==null&&this.binds.image){var c=this.$canvas||(this.$canvas=document.createElement("canvas")),d=c.getContext("2d"),e=b.imageWidth,f=b.imageHeight,g=pv.Mark.stack;c.width=e;c.height=f;b=(b.image=d.createImageData(e,f)).data;g.unshift(null,null);for(d=c=0;c<f;c++){g[1]=c;for(var h=0;h<e;h++){g[0]=h;var i=this.binds.image.apply(this,
g);b[d++]=i.r;b[d++]=i.g;b[d++]=i.b;b[d++]=255*i.a}}g.splice(0,2)}}};pv.Wedge=function(){pv.Mark.call(this)};
pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);a=pv.Wedge.prototype;a.type="wedge";
a.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var b=this.sibling();return b?b.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");a.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2};a.midAngle=function(){return(this.startAngle()+this.endAngle())/2};
a.anchor=function(b){function c(f){return f.innerRadius||f.angle<2*Math.PI}function d(f){return(f.innerRadius+f.outerRadius)/2}function e(f){return(f.startAngle+f.endAngle)/2}return pv.Mark.prototype.anchor.call(this,b).left(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "outer":return f.left+f.outerRadius*Math.cos(e(f));case "inner":return f.left+f.innerRadius*Math.cos(e(f));case "start":return f.left+d(f)*Math.cos(f.startAngle);case "center":return f.left+d(f)*Math.cos(e(f));
case "end":return f.left+d(f)*Math.cos(f.endAngle)}return f.left}).top(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "outer":return f.top+f.outerRadius*Math.sin(e(f));case "inner":return f.top+f.innerRadius*Math.sin(e(f));case "start":return f.top+d(f)*Math.sin(f.startAngle);case "center":return f.top+d(f)*Math.sin(e(f));case "end":return f.top+d(f)*Math.sin(f.endAngle)}return f.top}).textAlign(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "outer":return pv.Wedge.upright(e(f))?
"right":"left";case "inner":return pv.Wedge.upright(e(f))?"left":"right"}return"center"}).textBaseline(function(){var f=this.scene.target[this.index];if(c(f))switch(this.name()){case "start":return pv.Wedge.upright(f.startAngle)?"top":"bottom";case "end":return pv.Wedge.upright(f.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var f=this.scene.target[this.index],g=0;if(c(f))switch(this.name()){case "center":case "inner":case "outer":g=e(f);break;case "start":g=f.startAngle;break;case "end":g=
f.endAngle;break}return pv.Wedge.upright(g)?g:g+Math.PI})};pv.Wedge.upright=function(b){b%=2*Math.PI;b=b<0?2*Math.PI+b:b;return b<Math.PI/2||b>=3*Math.PI/2};pv.Wedge.prototype.buildImplied=function(b){if(b.angle==null)b.angle=b.endAngle-b.startAngle;else if(b.endAngle==null)b.endAngle=b.startAngle+b.angle;pv.Mark.prototype.buildImplied.call(this,b)};
pv.Ease=function(){function b(n){return function(o){return 1-n(1-o)}}function c(n){return function(o){return 0.5*(o<0.5?n(2*o):2-n(2-2*o))}}function d(n){return function(o){return o<0?0:o>1?1:Math.pow(o,n)}}function e(n){return 1-Math.cos(n*Math.PI/2)}function f(n){return n?Math.pow(2,10*(n-1))-0.001:0}function g(n){return-(Math.sqrt(1-n*n)-1)}function h(n,o){var s;o||(o=0.45);if(!n||n<1){n=1;s=o/4}else s=o/(2*Math.PI)*Math.asin(1/n);return function(t){return t<=0||t>=1?t:-(n*Math.pow(2,10*--t)*Math.sin((t-
s)*2*Math.PI/o))}}function i(n){n||(n=1.70158);return function(o){return o*o*((n+1)*o-n)}}function j(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+0.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+0.9375:7.5625*(n-=2.625/2.75)*n+0.984375}var k=d(2),p=d(3),l=h(),r=i(),m={linear:pv.identity,"quad-in":k,"quad-out":b(k),"quad-in-out":c(k),"quad-out-in":c(b(k)),"cubic-in":p,"cubic-out":b(p),"cubic-in-out":c(p),"cubic-out-in":c(b(p)),"sin-in":e,"sin-out":b(e),"sin-in-out":c(e),"sin-out-in":c(b(e)),
"exp-in":f,"exp-out":b(f),"exp-in-out":c(f),"exp-out-in":c(b(f)),"circle-in":g,"circle-out":b(g),"circle-in-out":c(g),"circle-out-in":c(b(g)),"elastic-in":l,"elastic-out":b(l),"elastic-in-out":c(l),"elastic-out-in":c(b(l)),"back-in":r,"back-out":b(r),"back-in-out":c(r),"back-out-in":c(b(r)),"bounce-in":j,"bounce-out":b(j),"bounce-in-out":c(j),"bounce-out-in":c(b(j))};pv.ease=function(n){return m[n]};return{reverse:b,reflect:c,linear:function(){return pv.identity},sin:function(){return e},exp:function(){return f},
circle:function(){return g},elastic:h,back:i,bounce:j,poly:d}}();
pv.Transition=function(b){function c(o){for(var s={},t=0;t<o.length;t++){var u=o[t];if(u.id)s[u.id]=u}return s}function d(o,s,t,u){var q;if(s in m){var x=pv.Scale.interpolator(t[s],u[s]);q=function(w){t[s]=x(w)}}else q=function(w){if(w>0.5)t[s]=u[s]};q.next=o.head;o.head=q}function e(o,s,t){for(var u in s)u!="children"&&s[u]!=t[u]&&d(o,u,s,t);if(s.children)for(u=0;u<s.children.length;u++)f(o,s.children[u],t.children[u])}function f(o,s,t){for(var u=s.mark,q=c(s),x=c(t),w=0;w<s.length;w++){var y=s[w],
v=y.id?x[y.id]:t[w];y.index=w;if(y.visible){if(!(v&&v.visible)){var A=g(s,w,u.$exit,t);y.transition=v?2:(t.push(A),1);v=A}e(o,y,v)}}for(w=0;w<t.length;w++){v=t[w];y=v.id?q[v.id]:s[w];if(!(y&&y.visible)&&v.visible){A=g(t,w,u.$enter,s);if(y)s[y.index]=A;else s.push(A);e(o,A,v)}}}function g(o,s,t,u){var q=pv.extend(o[s]),x=o.mark,w=x.root.scene,y=(t||n).$properties,v;if(u.target&&(v=u.target[u.length])){o=pv.extend(o);o.target=pv.extend(u.target);o.target[s]=v}var A={};for(t=0;t<y.length;t++)A[y[t].name]=
1;y=x.binds.optional.filter(function(B){return!(B.name in A)}).concat(y);x.context(o,s,function(){this.buildProperties(q,y);this.buildImplied(q)});x.root.scene=w;return q}function h(o){for(var s=0,t=0;s<o.length;s++){var u=o[s];if(u.transition!=1){o[t++]=u;if(u.transition==2)u.visible=false;u.children&&u.children.forEach(h)}}o.length=t}function i(){b.root.animatingCount--;if(r){var o=r;r=null;o()}}var j=this,k=pv.ease("cubic-in-out"),p=250,l,r,m={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,
outerRadius:1,radius:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},n=new pv.Transient;j.ease=function(o){return arguments.length?(k=typeof o=="function"?o:pv.ease(o),j):k};j.duration=function(o){return arguments.length?(p=Number(o),j):p};j.start=function(o){r=o;b.root.animatingCount++;if(b.parent){i();throw new Error("Animated partial rendering is not supported.");}try{b.$transition&&b.$transition.stop();b.$transition=
j;var s=pv.Mark.prototype.index,t=b.scene,u;b.scene=null;b.bind();b.build();u=b.scene;b.scene=t;pv.Mark.prototype.index=s;var q=Date.now(),x={};f(x,t,u)}catch(w){i();throw w;}l=setInterval(function(){for(var y=Math.max(0,Math.min(1,(Date.now()-q)/p)),v=k(y),A=x.head;A;A=A.next)A(v);if(y==1){h(b.scene);j.stop()}pv.Scene.updateAll(t)},24)};j.stop=function(){clearInterval(l);i()}};pv.Transient=function(b){pv.Mark.call(this);this.fillStyle(null).strokeStyle(null).textStyle(null);this.on=function(c){return b.on(c)}};
pv.Transient.prototype=pv.extend(pv.Mark);pv.simulation=function(b){return new pv.Simulation(b)};pv.Simulation=function(b){for(var c=0;c<b.length;c++)this.particle(b[c])};a=pv.Simulation.prototype;a.particle=function(b){b.next=this.particles;if(isNaN(b.px))b.px=b.x;if(isNaN(b.py))b.py=b.y;if(isNaN(b.fx))b.fx=0;if(isNaN(b.fy))b.fy=0;this.particles=b;return this};a.force=function(b){b.next=this.forces;this.forces=b;return this};a.constraint=function(b){b.next=this.constraints;this.constraints=b;return this};
a.stabilize=function(b){var c;arguments.length||(b=3);for(var d=0;d<b;d++){var e=new pv.Quadtree(this.particles);for(c=this.constraints;c;c=c.next)c.apply(this.particles,e)}for(c=this.particles;c;c=c.next){c.px=c.x;c.py=c.y}return this};
a.step=function(){var b;for(b=this.particles;b;b=b.next){var c=b.px,d=b.py;b.px=b.x;b.py=b.y;b.x+=b.vx=b.x-c+b.fx;b.y+=b.vy=b.y-d+b.fy}c=new pv.Quadtree(this.particles);for(b=this.constraints;b;b=b.next)b.apply(this.particles,c);for(b=this.particles;b;b=b.next)b.fx=b.fy=0;for(b=this.forces;b;b=b.next)b.apply(this.particles,c)};
pv.Quadtree=function(b){function c(k,p,l,r,m,n){if(!(isNaN(p.x)||isNaN(p.y)))if(k.leaf)if(k.p){if(!(Math.abs(k.p.x-p.x)+Math.abs(k.p.y-p.y)<0.01)){var o=k.p;k.p=null;d(k,o,l,r,m,n)}d(k,p,l,r,m,n)}else k.p=p;else d(k,p,l,r,m,n)}function d(k,p,l,r,m,n){var o=(l+m)*0.5,s=(r+n)*0.5,t=p.x>=o,u=p.y>=s;k.leaf=false;switch((u<<1)+t){case 0:k=k.c1||(k.c1=new pv.Quadtree.Node);break;case 1:k=k.c2||(k.c2=new pv.Quadtree.Node);break;case 2:k=k.c3||(k.c3=new pv.Quadtree.Node);break;case 3:k=k.c4||(k.c4=new pv.Quadtree.Node);
break}if(t)l=o;else m=o;if(u)r=s;else n=s;c(k,p,l,r,m,n)}var e,f=Number.POSITIVE_INFINITY,g=f,h=Number.NEGATIVE_INFINITY,i=h;for(e=b;e;e=e.next){if(e.x<f)f=e.x;if(e.y<g)g=e.y;if(e.x>h)h=e.x;if(e.y>i)i=e.y}e=h-f;var j=i-g;if(e>j)i=g+e;else h=f+j;this.xMin=f;this.yMin=g;this.xMax=h;this.yMax=i;this.root=new pv.Quadtree.Node;for(e=b;e;e=e.next)c(this.root,e,f,g,h,i)};pv.Quadtree.Node=function(){this.leaf=true;this.p=this.c4=this.c3=this.c2=this.c1=null};pv.Force={};
pv.Force.charge=function(b){function c(k){function p(m){c(m);k.cn+=m.cn;l+=m.cn*m.cx;r+=m.cn*m.cy}var l=0,r=0;k.cn=0;if(!k.leaf){k.c1&&p(k.c1);k.c2&&p(k.c2);k.c3&&p(k.c3);k.c4&&p(k.c4)}if(k.p){k.cn+=b;l+=b*k.p.x;r+=b*k.p.y}k.cx=l/k.cn;k.cy=r/k.cn}function d(k,p,l,r,m,n){var o=k.cx-p.x,s=k.cy-p.y,t=1/Math.sqrt(o*o+s*s);if(k.leaf&&k.p!=p||(m-l)*t<i){if(!(t<h)){if(t>f)t=f;k=k.cn*t*t*t;o=o*k;s=s*k;p.fx+=o;p.fy+=s}}else if(!k.leaf){var u=(l+m)*0.5,q=(r+n)*0.5;k.c1&&d(k.c1,p,l,r,u,q);k.c2&&d(k.c2,p,u,r,
m,q);k.c3&&d(k.c3,p,l,q,u,n);k.c4&&d(k.c4,p,u,q,m,n);if(!(t<h)){if(t>f)t=f;if(k.p&&k.p!=p){k=b*t*t*t;o=o*k;s=s*k;p.fx+=o;p.fy+=s}}}}var e=2,f=1/e,g=500,h=1/g,i=0.9,j={};arguments.length||(b=-40);j.constant=function(k){if(arguments.length){b=Number(k);return j}return b};j.domain=function(k,p){if(arguments.length){e=Number(k);f=1/e;g=Number(p);h=1/g;return j}return[e,g]};j.theta=function(k){if(arguments.length){i=Number(k);return j}return i};j.apply=function(k,p){c(p.root);for(k=k;k;k=k.next)d(p.root,
k,p.xMin,p.yMin,p.xMax,p.yMax)};return j};pv.Force.drag=function(b){var c={};arguments.length||(b=0.1);c.constant=function(d){if(arguments.length){b=d;return c}return b};c.apply=function(d){if(b)for(d=d;d;d=d.next){d.fx-=b*d.vx;d.fy-=b*d.vy}};return c};
pv.Force.spring=function(b){var c=0.1,d=20,e,f,g={};arguments.length||(b=0.1);g.links=function(h){if(arguments.length){e=h;f=h.map(function(i){return 1/Math.sqrt(Math.max(i.sourceNode.linkDegree,i.targetNode.linkDegree))});return g}return e};g.constant=function(h){if(arguments.length){b=Number(h);return g}return b};g.damping=function(h){if(arguments.length){c=Number(h);return g}return c};g.length=function(h){if(arguments.length){d=Number(h);return g}return d};g.apply=function(){for(var h=0;h<e.length;h++){var i=
e[h].sourceNode,j=e[h].targetNode,k=i.x-j.x,p=i.y-j.y,l=Math.sqrt(k*k+p*p),r=l?1/l:1;r=(b*f[h]*(l-d)+c*f[h]*(k*(i.vx-j.vx)+p*(i.vy-j.vy))*r)*r;k=-r*(l?k:0.01*(0.5-Math.random()));p=-r*(l?p:0.01*(0.5-Math.random()));i.fx+=k;i.fy+=p;j.fx-=k;j.fy-=p}};return g};pv.Constraint={};
pv.Constraint.collision=function(b){function c(k,p,l,r,m,n){if(!k.leaf){var o=(l+m)*0.5,s=(r+n)*0.5,t=s<i,u=o>f,q=o<h;if(s>g){k.c1&&u&&c(k.c1,p,l,r,o,s);k.c2&&q&&c(k.c2,p,o,r,m,s)}if(t){k.c3&&u&&c(k.c3,p,l,s,o,n);k.c4&&q&&c(k.c4,p,o,s,m,n)}}if(k.p&&k.p!=p){l=p.x-k.p.x;r=p.y-k.p.y;m=Math.sqrt(l*l+r*r);n=e+b(k.p);if(m<n){m=(m-n)/m*0.5;l*=m;r*=m;p.x-=l;p.y-=r;k.p.x+=l;k.p.y+=r}}}var d=1,e,f,g,h,i,j={};arguments.length||(e=10);j.repeat=function(k){if(arguments.length){d=Number(k);return j}return d};j.apply=
function(k,p){var l,r,m=-Infinity;for(l=k;l;l=l.next){r=b(l);if(r>m)m=r}for(var n=0;n<d;n++)for(l=k;l;l=l.next){r=(e=b(l))+m;f=l.x-r;h=l.x+r;g=l.y-r;i=l.y+r;c(p.root,l,p.xMin,p.yMin,p.xMax,p.yMax)}};return j};pv.Constraint.position=function(b){var c=1,d={};arguments.length||(b=function(e){return e.fix});d.alpha=function(e){if(arguments.length){c=Number(e);return d}return c};d.apply=function(e){for(e=e;e;e=e.next){var f=b(e);if(f){e.x+=(f.x-e.x)*c;e.y+=(f.y-e.y)*c;e.fx=e.fy=e.vx=e.vy=0}}};return d};
pv.Constraint.bound=function(){var b={},c,d;b.x=function(e,f){if(arguments.length){c={min:Math.min(e,f),max:Math.max(e,f)};return this}return c};b.y=function(e,f){if(arguments.length){d={min:Math.min(e,f),max:Math.max(e,f)};return this}return d};b.apply=function(e){if(c)for(var f=e;f;f=f.next)f.x=f.x<c.min?c.min:f.x>c.max?c.max:f.x;if(d)for(f=e;f;f=f.next)f.y=f.y<d.min?d.min:f.y>d.max?d.max:f.y};return b};pv.Layout=function(){pv.Panel.call(this)};pv.Layout.prototype=pv.extend(pv.Panel);
pv.Layout.prototype.property=pv.Mark.prototype.localProperty;
pv.Layout.Network=function(){pv.Layout.call(this);var b=this;this.$id=pv.id();(this.node=(new pv.Mark).data(function(){return b.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(c){return c.x}).top(function(c){return c.y})).parent=this;this.link=(new pv.Mark).extend(this.node).data(function(c){return[c.sourceNode,c.targetNode]}).fillStyle(null).lineWidth(function(c,d){return d.linkValue*1.5}).strokeStyle("rgba(0,0,0,.2)");this.link.add=function(c){return b.add(pv.Panel).data(function(){return b.links()}).add(c).extend(this)};
(this.label=(new pv.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(c){return c.nodeName||c.nodeValue}).textAngle(function(c){c=c.midAngle;return pv.Wedge.upright(c)?c:c+Math.PI}).textAlign(function(c){return pv.Wedge.upright(c.midAngle)?"left":"right"})).parent=this};
pv.Layout.Network.prototype=pv.extend(pv.Layout).property("nodes",function(b){return b.map(function(c,d){if(typeof c!="object")c={nodeValue:c};c.index=d;return c})}).property("links",function(b){return b.map(function(c){if(isNaN(c.linkValue))c.linkValue=isNaN(c.value)?1:c.value;return c})});pv.Layout.Network.prototype.reset=function(){this.$id=pv.id();return this};pv.Layout.Network.prototype.buildProperties=function(b,c){if((b.$id||0)<this.$id)pv.Layout.prototype.buildProperties.call(this,b,c)};
pv.Layout.Network.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);if(b.$id>=this.$id)return true;b.$id=this.$id;b.nodes.forEach(function(c){c.linkDegree=0});b.links.forEach(function(c){var d=c.linkValue;(c.sourceNode||(c.sourceNode=b.nodes[c.source])).linkDegree+=d;(c.targetNode||(c.targetNode=b.nodes[c.target])).linkDegree+=d})};pv.Layout.Hierarchy=function(){pv.Layout.Network.call(this);this.link.strokeStyle("#ccc")};pv.Layout.Hierarchy.prototype=pv.extend(pv.Layout.Network);
pv.Layout.Hierarchy.prototype.buildImplied=function(b){if(!b.links)b.links=pv.Layout.Hierarchy.links.call(this);pv.Layout.Network.prototype.buildImplied.call(this,b)};pv.Layout.Hierarchy.links=function(){return this.nodes().filter(function(b){return b.parentNode}).map(function(b){return{sourceNode:b,targetNode:b.parentNode,linkValue:1}})};
pv.Layout.Hierarchy.NodeLink={buildImplied:function(b){function c(m){return m.parentNode?m.depth*(l-p)+p:0}function d(m){return m.parentNode?(m.breadth-0.25)*2*Math.PI:0}function e(m){switch(h){case "left":return m.depth*j;case "right":return j-m.depth*j;case "top":return m.breadth*j;case "bottom":return j-m.breadth*j;case "radial":return j/2+c(m)*Math.cos(m.midAngle)}}function f(m){switch(h){case "left":return m.breadth*k;case "right":return k-m.breadth*k;case "top":return m.depth*k;case "bottom":return k-
m.depth*k;case "radial":return k/2+c(m)*Math.sin(m.midAngle)}}var g=b.nodes,h=b.orient,i=/^(top|bottom)$/.test(h),j=b.width,k=b.height;if(h=="radial"){var p=b.innerRadius,l=b.outerRadius;if(p==null)p=0;if(l==null)l=Math.min(j,k)/2}for(b=0;b<g.length;b++){var r=g[b];r.midAngle=h=="radial"?d(r):i?Math.PI/2:0;r.x=e(r);r.y=f(r);if(r.firstChild)r.midAngle+=Math.PI}}};
pv.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(b){return b.dx}).height(function(b){return b.dy}).innerRadius(function(b){return b.innerRadius}).outerRadius(function(b){return b.outerRadius}).startAngle(function(b){return b.startAngle}).angle(function(b){return b.angle});this.label.textAlign("center").left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2});delete this.link},buildImplied:function(b){function c(q,x){return(q+
x)/(1+x)}function d(q){switch(l){case "left":return c(q.minDepth,o)*m;case "right":return(1-c(q.maxDepth,o))*m;case "top":return q.minBreadth*m;case "bottom":return(1-q.maxBreadth)*m;case "radial":return m/2}}function e(q){switch(l){case "left":return q.minBreadth*n;case "right":return(1-q.maxBreadth)*n;case "top":return c(q.minDepth,o)*n;case "bottom":return(1-c(q.maxDepth,o))*n;case "radial":return n/2}}function f(q){switch(l){case "left":case "right":return(q.maxDepth-q.minDepth)/(1+o)*m;case "top":case "bottom":return(q.maxBreadth-
q.minBreadth)*m;case "radial":return q.parentNode?(q.innerRadius+q.outerRadius)*Math.cos(q.midAngle):0}}function g(q){switch(l){case "left":case "right":return(q.maxBreadth-q.minBreadth)*n;case "top":case "bottom":return(q.maxDepth-q.minDepth)/(1+o)*n;case "radial":return q.parentNode?(q.innerRadius+q.outerRadius)*Math.sin(q.midAngle):0}}function h(q){return Math.max(0,c(q.minDepth,o/2))*(t-s)+s}function i(q){return c(q.maxDepth,o/2)*(t-s)+s}function j(q){return(q.parentNode?q.minBreadth-0.25:0)*
2*Math.PI}function k(q){return(q.parentNode?q.maxBreadth-q.minBreadth:1)*2*Math.PI}var p=b.nodes,l=b.orient,r=/^(top|bottom)$/.test(l),m=b.width,n=b.height,o=-p[0].minDepth;if(l=="radial"){var s=b.innerRadius,t=b.outerRadius;if(s==null)s=0;if(s)o*=2;if(t==null)t=Math.min(m,n)/2}for(b=0;b<p.length;b++){var u=p[b];u.x=d(u);u.y=e(u);if(l=="radial"){u.innerRadius=h(u);u.outerRadius=i(u);u.startAngle=j(u);u.angle=k(u);u.midAngle=u.startAngle+u.angle/2}else u.midAngle=r?-Math.PI/2:0;u.dx=f(u);u.dy=g(u)}}};
pv.Layout.Grid=function(){pv.Layout.call(this);var b=this;(this.cell=(new pv.Mark).data(function(){return b.scene[b.index].$grid}).width(function(){return b.width()/b.cols()}).height(function(){return b.height()/b.rows()}).left(function(){return this.width()*(this.index%b.cols())}).top(function(){return this.height()*Math.floor(this.index/b.cols())})).parent=this};pv.Layout.Grid.prototype=pv.extend(pv.Layout).property("rows").property("cols");pv.Layout.Grid.prototype.defaults=(new pv.Layout.Grid).extend(pv.Layout.prototype.defaults).rows(1).cols(1);
pv.Layout.Grid.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=b.rows,d=b.cols;if(typeof d=="object")c=pv.transpose(d);if(typeof c=="object"){b.$grid=pv.blend(c);b.rows=c.length;b.cols=c[0]?c[0].length:0}else b.$grid=pv.repeat([b.data],c*d)};
pv.Layout.Stack=function(){function b(h){return function(){return e[h](this.parent.index,this.index)}}pv.Layout.call(this);var c=this,d=function(){return null},e={t:d,l:d,r:d,b:d,w:d,h:d},f,g=c.buildImplied;this.buildImplied=function(h){g.call(this,h);var i=h.layers,j=i.length,k,p=h.orient,l=/^(top|bottom)\b/.test(p),r=this.parent[l?"height":"width"](),m=[],n=[],o=[],s=pv.Mark.stack,t={parent:{parent:this}};s.unshift(null);f=[];for(var u=0;u<j;u++){o[u]=[];n[u]=[];t.parent.index=u;s[0]=i[u];f[u]=
this.$values.apply(t.parent,s);if(!u)k=f[u].length;s.unshift(null);for(var q=0;q<k;q++){s[0]=f[u][q];t.index=q;u||(m[q]=this.$x.apply(t,s));o[u][q]=this.$y.apply(t,s)}s.shift()}s.shift();switch(h.order){case "inside-out":var x=o.map(function(B){return pv.max.index(B)});t=pv.range(j).sort(function(B,z){return x[B]-x[z]});i=o.map(function(B){return pv.sum(B)});var w=s=0,y=[],v=[];for(u=0;u<j;u++){q=t[u];if(s<w){s+=i[q];y.push(q)}else{w+=i[q];v.push(q)}}i=v.reverse().concat(y);break;case "reverse":i=
pv.range(j-1,-1,-1);break;default:i=pv.range(j);break}switch(h.offset){case "silohouette":for(q=0;q<k;q++){for(u=t=0;u<j;u++)t+=o[u][q];n[i[0]][q]=(r-t)/2}break;case "wiggle":for(u=t=0;u<j;u++)t+=o[u][0];n[i[0]][0]=t=(r-t)/2;for(q=1;q<k;q++){s=r=0;w=m[q]-m[q-1];for(u=0;u<j;u++)r+=o[u][q];for(u=0;u<j;u++){y=(o[i[u]][q]-o[i[u]][q-1])/(2*w);for(h=0;h<u;h++)y+=(o[i[h]][q]-o[i[h]][q-1])/w;s+=y*o[i[u]][q]}n[i[0]][q]=t-=r?s/r*w:0}break;case "expand":for(q=0;q<k;q++){for(u=h=n[i[0]][q]=0;u<j;u++)h+=o[u][q];
if(h){h=r/h;for(u=0;u<j;u++)o[u][q]*=h}else{h=r/j;for(u=0;u<j;u++)o[u][q]=h}}break;default:for(q=0;q<k;q++)n[i[0]][q]=0;break}for(q=0;q<k;q++){t=n[i[0]][q];for(u=1;u<j;u++){t+=o[i[u-1]][q];n[i[u]][q]=t}}u=p.indexOf("-");j=l?"h":"w";l=u<0?l?"l":"b":p.charAt(u+1);p=p.charAt(0);for(var A in e)e[A]=d;e[l]=function(B,z){return m[z]};e[p]=function(B,z){return n[B][z]};e[j]=function(B,z){return o[B][z]}};this.layer=(new pv.Mark).data(function(){return f[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));
this.layer.add=function(h){return c.add(pv.Panel).data(function(){return c.layers()}).add(h).extend(this)}};pv.Layout.Stack.prototype=pv.extend(pv.Layout).property("orient",String).property("offset",String).property("order",String).property("layers");a=pv.Layout.Stack.prototype;a.defaults=(new pv.Layout.Stack).extend(pv.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]);a.$x=pv.Layout.Stack.prototype.$y=function(){return 0};a.x=function(b){this.$x=pv.functor(b);return this};
a.y=function(b){this.$y=pv.functor(b);return this};a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.Band=function(){function b(j){return function(){return e[j](this.index,this.parent.index)}}pv.Layout.call(this);var c=this,d=c.buildImplied,e,f,g=(new pv.Mark).data(function(){return f[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));this.buildImplied=function(j){d.call(this,j);e=Object.create(pv.Layout.Band.$baseItemProps);f=[];var k=j.layers,p=k.length;if(p>0){var l=j.orient,r=/^(top|bottom)\b/.test(l),m=this.parent[r?"height":"width"]();
k=this._readData(k,f,j);var n=k.length;j.bandOrder==="reverse"&&k.reverse();if(j.order==="reverse"){f.reverse();for(var o=0;o<n;o++)k[o].items.reverse()}switch(j.layout){case "grouped":this._calcGrouped(k,p,j);break;case "stacked":this._calcStacked(k,p,m,j);break}this._bindItemProps(k,e,l,r)}};var h=this.item={end:this,add:function(j){return c.add(pv.Panel).data(function(){return c.layers()}).add(j).extend(g)},order:function(j){c.order(j);return this},w:function(j){c.$iw=pv.functor(j);return this},
h:function(j){c.$ih=pv.functor(j);return this},horizontalRatio:function(j){c.$ihorizRatio=pv.functor(j);return this},verticalMargin:function(j){c.$ivertiMargin=pv.functor(j);return this}},i=this.band={end:this,w:function(j){c.$bw=pv.functor(j);return this},x:function(j){c.$bx=pv.functor(j);return this},order:function(j){c.bandOrder(j);return this},differentialControl:function(j){c.$bDiffControl=pv.functor(j);return this}};this.band.item=h;this.item.band=i};
pv.Layout.Band.$baseItemProps=function(){var b=function(){return null};return{t:b,l:b,r:b,b:b,w:b,h:b}}();pv.Layout.Band.prototype=pv.extend(pv.Layout).property("orient",String).property("layout",String).property("layers").property("yZero",Number).property("verticalMode",String).property("horizontalMode",String).property("order",String).property("bandOrder",String);a=pv.Layout.Band.prototype;a.defaults=(new pv.Layout.Band).extend(pv.Layout.prototype.defaults).orient("bottom-left").layout("grouped").yZero(0).layers([[]]);
a.$bx=pv.Layout.Band.prototype.$bw=pv.Layout.Band.prototype.$bDiffControl=pv.Layout.Band.prototype.$iw=pv.Layout.Band.prototype.$ih=pv.Layout.Band.prototype.$ivertiMargin=pv.functor(0);a.$ihorizRatio=pv.functor(0.9);a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.prototype._readData=function(b,c,d){var e=b.length,f=[],g,h=pv.Mark.stack,i={parent:{parent:this}};h.unshift(null);for(var j=0;j<e;j++){i.parent.index=j;h[0]=b[j];var k=c[j]=this.$values.apply(i.parent,h);if(!j)g=k.length;h.unshift(null);for(var p=0;p<g;p++){h[0]=k[p];i.index=p;var l=f[p];l||(l=f[p]={horizRatio:this.$ihorizRatio.apply(i,h),vertiMargin:this.$ivertiMargin.apply(i,h),w:this.$bw.apply(i,h),x:this.$bx.apply(i,h),diffControl:this.$bDiffControl?this.$bDiffControl.apply(i,h):0,
items:[]});var r=this.$ih.apply(i,h);l.items[j]={y:d.yZero||0,x:0,w:this.$iw.apply(i,h),h:r!=null?Math.abs(r):r,dir:r<0?-1:1}}h.shift()}h.shift();return f};
pv.Layout.Band.prototype._calcGrouped=function(b,c,d){for(var e=0,f=b.length;e<f;e++){for(var g=b[e],h=g.items,i=g.w,j=g.horizRatio,k=0,p=0;p<c;p++)k+=h[p].w;if(c===1)j=1;else j>0&&j<=1||(j=1);if(i==null)g.w=k/j;else if(d.horizontalMode==="expand"){i=j*i;if(k){k=i/k;for(p=0;p<c;p++)h[p].w*=k}else{k=i/c;for(p=0;p<c;p++)h[p].w=k}k=i}p=k/j;g=g.x-p/2;j=c>1?(p-k)/(c-1):0;for(p=0;p<c;p++){k=h[p];k.x=g;g+=k.w+j;if(k.dir<0)k.y-=k.h}}};
pv.Layout.Band.prototype._calcStacked=function(b,c,d,e){var f=b.length,g;if(e.verticalMode==="expand")for(var h=0;h<f;h++){g=b[h].items;for(var i=null,j=0,k=0;k<c;k++){var p=g[k];p.dir=1;p=p.h;if(p!=null){j++;i+=p}}if(j)if(i){i=d/i;for(k=0;k<c;k++){p=g[k].h;if(p!=null)g[k].h=p*i}}else{i=d/j;for(k=0;k<c;k++){p=g[k].h;if(p!=null)g[k].h=i}}}d=c=e.yZero;for(h=0;h<f;h++){g=b[h];e=g.x;k=g.diffControl;p=k<0;i=g.vertiMargin>0?g.vertiMargin:0;g=g.items;j=this._layoutItemsOfDir(+1,p,g,i,e,d);var l;if(j.existsOtherDir)l=
this._layoutItemsOfDir(-1,p,g,i,e,d);if(k){if(Math.abs(k)===1){g=d;d=j.yOffset;if(l)d-=g-l.yOffset}}else d=c}};pv.Layout.Band.prototype._layoutItemsOfDir=function(b,c,d,e,f,g){for(var h=false,i=e/2,j=c?-b:b,k=0,p=d.length;k<p;k+=1){var l=d[c?p-k-1:k];if(l.dir===b){var r=l.h||0;if(j>0){l.y=g+i;g+=r}else{l.y=g-(r-i);g-=r}r=l.h-e;l.h=r>0?r:0;l.x=f-l.w/2}else h=true}return{existsOtherDir:h,yOffset:g}};
pv.Layout.Band.prototype._bindItemProps=function(b,c,d,e){var f=d.indexOf("-"),g=e?"h":"w",h=e?"w":"h";e=f<0?e?"l":"b":d.charAt(f+1);d=d.charAt(0);c[e]=function(i,j){return b[i].items[j].x};c[d]=function(i,j){return b[i].items[j].y};c[h]=function(i,j){return b[i].items[j].w};c[g]=function(i,j){return b[i].items[j].h||0}};
pv.Layout.Treemap=function(){pv.Layout.Hierarchy.call(this);this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(b){return b.dx}).height(function(b){return b.dy});this.label.visible(function(b){return!b.firstChild}).left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2}).textAlign("center").textAngle(function(b){return b.dx>b.dy?0:-Math.PI/2});(this.leaf=(new pv.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(b){return!b.firstChild})).parent=
this;delete this.link};pv.Layout.Treemap.prototype=pv.extend(pv.Layout.Hierarchy).property("round",Boolean).property("paddingLeft",Number).property("paddingRight",Number).property("paddingTop",Number).property("paddingBottom",Number).property("mode",String).property("order",String);a=pv.Layout.Treemap.prototype;a.defaults=(new pv.Layout.Treemap).extend(pv.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending");a.padding=function(b){return this.paddingLeft(b).paddingRight(b).paddingTop(b).paddingBottom(b)};
a.$size=function(b){return Number(b.nodeValue)};a.size=function(b){this.$size=pv.functor(b);return this};
a.buildImplied=function(b){function c(n,o,s,t,u,q,x){for(var w=0,y=0;w<n.length;w++){var v=n[w];if(s){v.x=t+y;v.y=u;y+=v.dx=r(q*v.size/o);v.dy=x}else{v.x=t;v.y=u+y;v.dx=q;y+=v.dy=r(x*v.size/o)}}if(v)if(s)v.dx+=q-y;else v.dy+=x-y}function d(n,o){for(var s=-Infinity,t=Infinity,u=0,q=0;q<n.length;q++){var x=n[q].size;if(x<t)t=x;if(x>s)s=x;u+=x}u*=u;o*=o;return Math.max(o*s/u,u/(o*t))}function e(n,o){function s(B){var z=q==y,D=pv.sum(B,l),E=y?r(D/y):0;c(B,D,z,t,u,z?q:E,z?E:x);if(z){u+=E;x-=E}else{t+=
E;q-=E}y=Math.min(q,x);return z}var t=n.x+i,u=n.y+k,q=n.dx-i-j,x=n.dy-k-p;if(m!="squarify")c(n.childNodes,n.size,m=="slice"?true:m=="dice"?false:o&1,t,u,q,x);else{var w=[];o=Infinity;var y=Math.min(q,x),v=q*x/n.size;if(!(n.size<=0)){n.visitBefore(function(B){B.size*=v});for(n=n.childNodes.slice();n.length;){var A=n[n.length-1];if(A.size){w.push(A);v=d(w,y);if(v<=o){n.pop();o=v}else{w.pop();s(w);w.length=0;o=Infinity}}else n.pop()}if(s(w))for(o=0;o<w.length;o++)w[o].dy+=x;else for(o=0;o<w.length;o++)w[o].dx+=
q}}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var f=this,g=b.nodes[0],h=pv.Mark.stack,i=b.paddingLeft,j=b.paddingRight,k=b.paddingTop,p=b.paddingBottom,l=function(n){return n.size},r=b.round?Math.round:Number,m=b.mode;h.unshift(null);g.visitAfter(function(n,o){n.depth=o;n.x=n.y=n.dx=n.dy=0;n.size=n.firstChild?pv.sum(n.childNodes,function(s){return s.size}):f.$size.apply(f,(h[0]=n,h))});h.shift();switch(b.order){case "ascending":g.sort(function(n,o){return n.size-o.size});break;
case "descending":g.sort(function(n,o){return o.size-n.size});break;case "reverse":g.reverse();break}g.x=0;g.y=0;g.dx=b.width;g.dy=b.height;g.visitBefore(e)}};pv.Layout.Tree=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Tree.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String);pv.Layout.Tree.prototype.defaults=(new pv.Layout.Tree).extend(pv.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top");
pv.Layout.Tree.prototype.buildImplied=function(b){function c(q){var x,w,y;if(q.firstChild){x=q.firstChild;w=q.lastChild;for(var v=y=x;v;v=v.nextSibling){c(v);y=e(v,y)}i(q);w=0.5*(x.prelim+w.prelim);if(x=q.previousSibling){q.prelim=x.prelim+k(q.depth,true);q.mod=q.prelim-w}else q.prelim=w}else if(x=q.previousSibling)q.prelim=x.prelim+k(q.depth,true)}function d(q,x,w){q.breadth=q.prelim+x;x+=q.mod;for(q=q.firstChild;q;q=q.nextSibling)d(q,x,w)}function e(q,x){var w=q.previousSibling;if(w){var y=q,v=
q,A=w;w=q.parentNode.firstChild;var B=y.mod,z=v.mod,D=A.mod,E=w.mod;A=g(A);for(y=f(y);A&&y;){A=A;y=y;w=f(w);v=g(v);v.ancestor=q;var C=A.prelim+D-(y.prelim+B)+k(A.depth,false);if(C>0){h(j(A,q,x),q,C);B+=C;z+=C}D+=A.mod;B+=y.mod;E+=w.mod;z+=v.mod;A=g(A);y=f(y)}if(A&&!g(v)){v.thread=A;v.mod+=D-z}if(y&&!f(w)){w.thread=y;w.mod+=B-E;x=q}}return x}function f(q){return q.firstChild||q.thread}function g(q){return q.lastChild||q.thread}function h(q,x,w){var y=x.number-q.number;x.change-=w/y;x.shift+=w;q.change+=
w/y;x.prelim+=w;x.mod+=w}function i(q){var x=0,w=0;for(q=q.lastChild;q;q=q.previousSibling){q.prelim+=x;q.mod+=x;w+=q.change;x+=q.shift+w}}function j(q,x,w){return q.ancestor.parentNode==x.parentNode?q.ancestor:w}function k(q,x){return(x?1:s+1)/(m=="radial"?q:1)}function p(q){return m=="radial"?q.breadth/n:0}function l(q){switch(m){case "left":return q.depth;case "right":return t-q.depth;case "top":case "bottom":return q.breadth+t/2;case "radial":return t/2+q.depth*Math.cos(p(q))}}function r(q){switch(m){case "left":case "right":return q.breadth+
u/2;case "top":return q.depth;case "bottom":return u-q.depth;case "radial":return u/2+q.depth*Math.sin(p(q))}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var m=b.orient,n=b.depth,o=b.breadth,s=b.group,t=b.width,u=b.height;b=b.nodes[0];b.visitAfter(function(q,x){q.ancestor=q;q.prelim=0;q.mod=0;q.change=0;q.shift=0;q.number=q.previousSibling?q.previousSibling.number+1:0;q.depth=x});c(b);d(b,-b.prelim,0);b.visitAfter(function(q){q.breadth*=o;q.depth*=n;q.midAngle=p(q);q.x=l(q);q.y=r(q);
if(q.firstChild)q.midAngle+=Math.PI;delete q.breadth;delete q.depth;delete q.ancestor;delete q.prelim;delete q.mod;delete q.change;delete q.shift;delete q.number;delete q.thread})}};pv.Layout.Indent=function(){pv.Layout.Hierarchy.call(this);this.link.interpolate("step-after")};pv.Layout.Indent.prototype=pv.extend(pv.Layout.Hierarchy).property("depth",Number).property("breadth",Number);pv.Layout.Indent.prototype.defaults=(new pv.Layout.Indent).extend(pv.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15);
pv.Layout.Indent.prototype.buildImplied=function(b){function c(h,i,j){h.x=f+j++*e;h.y=g+i++*d;h.midAngle=0;for(h=h.firstChild;h;h=h.nextSibling)i=c(h,i,j);return i}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var d=b.breadth,e=b.depth,f=0,g=0;c(b.nodes[0],1,1)}};pv.Layout.Pack=function(){pv.Layout.Hierarchy.call(this);this.node.shapeRadius(function(b){return b.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)");this.label.textAlign("center");delete this.link};
pv.Layout.Pack.prototype=pv.extend(pv.Layout.Hierarchy).property("spacing",Number).property("order",String);pv.Layout.Pack.prototype.defaults=(new pv.Layout.Pack).extend(pv.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending");pv.Layout.Pack.prototype.$radius=function(){return 1};pv.Layout.Pack.prototype.size=function(b){this.$radius=typeof b=="function"?function(){return Math.sqrt(b.apply(this,arguments))}:(b=Math.sqrt(b),function(){return b});return this};
pv.Layout.Pack.prototype.buildImplied=function(b){function c(l){var r=pv.Mark.stack;r.unshift(null);for(var m=0,n=l.length;m<n;m++){var o=l[m];if(!o.firstChild)o.radius=h.$radius.apply(h,(r[0]=o,r))}r.shift()}function d(l){var r=[];for(l=l.firstChild;l;l=l.nextSibling){if(l.firstChild)l.radius=d(l);l.n=l.p=l;r.push(l)}switch(b.order){case "ascending":r.sort(function(m,n){return m.radius-n.radius});break;case "descending":r.sort(function(m,n){return n.radius-m.radius});break;case "reverse":r.reverse();
break}return e(r)}function e(l){function r(C){s=Math.min(C.x-C.radius,s);t=Math.max(C.x+C.radius,t);u=Math.min(C.y-C.radius,u);q=Math.max(C.y+C.radius,q)}function m(C,F){var G=C.n;C.n=F;F.p=C;F.n=G;G.p=F}function n(C,F){C.n=F;F.p=C}function o(C,F){var G=F.x-C.x,H=F.y-C.y;C=C.radius+F.radius;return C*C-G*G-H*H>0.001}var s=Infinity,t=-Infinity,u=Infinity,q=-Infinity,x,w,y,v,A;x=l[0];x.x=-x.radius;x.y=0;r(x);if(l.length>1){w=l[1];w.x=w.radius;w.y=0;r(w);if(l.length>2){y=l[2];f(x,w,y);r(y);m(x,y);x.p=
y;m(y,w);w=x.n;for(var B=3;B<l.length;B++){f(x,w,y=l[B]);var z=0,D=1,E=1;for(v=w.n;v!=w;v=v.n,D++)if(o(v,y)){z=1;break}if(z==1)for(A=x.p;A!=v.p;A=A.p,E++)if(o(A,y)){if(E<D){z=-1;v=A}break}if(z==0){m(x,y);w=y;r(y)}else if(z>0){n(x,v);w=v;B--}else if(z<0){n(v,w);x=v;B--}}}}x=(s+t)/2;w=(u+q)/2;for(B=y=0;B<l.length;B++){v=l[B];v.x-=x;v.y-=w;y=Math.max(y,v.radius+Math.sqrt(v.x*v.x+v.y*v.y))}return y+b.spacing}function f(l,r,m){var n=r.radius+m.radius,o=l.radius+m.radius,s=r.x-l.x;r=r.y-l.y;var t=Math.sqrt(s*
s+r*r),u=(o*o+t*t-n*n)/(2*o*t);n=Math.acos(u);u=u*o;o=Math.sin(n)*o;s/=t;r/=t;m.x=l.x+u*s+o*r;m.y=l.y+u*r-o*s}function g(l,r,m,n){for(var o=l.firstChild;o;o=o.nextSibling){o.x+=l.x;o.y+=l.y;g(o,r,m,n)}l.x=r+n*l.x;l.y=m+n*l.y;l.radius*=n}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var h=this,i=b.nodes,j=i[0];c(i);j.x=0;j.y=0;j.radius=d(j);i=this.width();var k=this.height(),p=1/Math.max(2*j.radius/i,2*j.radius/k);g(j,i/2,k/2,p)}};
pv.Layout.Force=function(){pv.Layout.Network.call(this);this.link.lineWidth(function(b,c){return Math.sqrt(c.linkValue)*1.5});this.label.textAlign("center")};
pv.Layout.Force.prototype=pv.extend(pv.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number);pv.Layout.Force.prototype.defaults=(new pv.Layout.Force).extend(pv.Layout.Network.prototype.defaults).dragConstant(0.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(0.9).springConstant(0.1).springDamping(0.3).springLength(20);
pv.Layout.Force.prototype.buildImplied=function(b){function c(p){return p.fix?1:p.vx*p.vx+p.vy*p.vy}if(pv.Layout.Network.prototype.buildImplied.call(this,b)){if(b=b.$force){b.next=this.binds.$force;this.binds.$force=b}}else{for(var d=this,e=b.nodes,f=b.links,g=b.iterations,h=b.width,i=b.height,j=0,k;j<e.length;j++){k=e[j];if(isNaN(k.x))k.x=h/2+40*Math.random()-20;if(isNaN(k.y))k.y=i/2+40*Math.random()-20}k=pv.simulation(e);k.force(pv.Force.drag(b.dragConstant));k.force(pv.Force.charge(b.chargeConstant).domain(b.chargeMinDistance,
b.chargeMaxDistance).theta(b.chargeTheta));k.force(pv.Force.spring(b.springConstant).damping(b.springDamping).length(b.springLength).links(f));k.constraint(pv.Constraint.position());b.bound&&k.constraint(pv.Constraint.bound().x(6,h-6).y(6,i-6));if(g==null){k.step();k.step();b.$force=this.binds.$force={next:this.binds.$force,nodes:e,min:1.0E-4*(f.length+1),sim:k};if(!this.$timer)this.$timer=setInterval(function(){for(var p=false,l=d.binds.$force;l;l=l.next)if(pv.max(l.nodes,c)>l.min){l.sim.step();
p=true}p&&d.render()},42)}else for(j=0;j<g;j++)k.step()}};pv.Layout.Cluster=function(){pv.Layout.Hierarchy.call(this);var b,c=this.buildImplied;this.buildImplied=function(d){c.call(this,d);b=/^(top|bottom)$/.test(d.orient)?"step-before":/^(left|right)$/.test(d.orient)?"step-after":"linear"};this.link.interpolate(function(){return b})};
pv.Layout.Cluster.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);pv.Layout.Cluster.prototype.defaults=(new pv.Layout.Cluster).extend(pv.Layout.Hierarchy.prototype.defaults).group(0).orient("top");
pv.Layout.Cluster.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=b.nodes[0],d=b.group,e,f,g=0,h=0.5-d/2,i=undefined;c.visitAfter(function(j){if(j.firstChild)j.depth=1+pv.max(j.childNodes,function(k){return k.depth});else{if(d&&i!=j.parentNode){i=j.parentNode;g+=d}g++;j.depth=0}});e=1/g;f=1/c.depth;i=undefined;c.visitAfter(function(j){if(j.firstChild)j.breadth=pv.mean(j.childNodes,function(k){return k.breadth});else{if(d&&i!=j.parentNode){i=j.parentNode;
h+=d}j.breadth=e*h++}j.depth=1-j.depth*f});c.visitAfter(function(j){j.minBreadth=j.firstChild?j.firstChild.minBreadth:j.breadth-e/2;j.maxBreadth=j.firstChild?j.lastChild.maxBreadth:j.breadth+e/2});c.visitBefore(function(j){j.minDepth=j.parentNode?j.parentNode.maxDepth:0;j.maxDepth=j.parentNode?j.depth+c.depth:j.minDepth+2*c.depth});c.minDepth=-f;pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Cluster.Fill=function(){pv.Layout.Cluster.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};
pv.Layout.Cluster.Fill.prototype=pv.extend(pv.Layout.Cluster);pv.Layout.Cluster.Fill.prototype.buildImplied=function(b){pv.Layout.Cluster.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Partition=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Partition.prototype=pv.extend(pv.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);
pv.Layout.Partition.prototype.defaults=(new pv.Layout.Partition).extend(pv.Layout.Hierarchy.prototype.defaults).orient("top");pv.Layout.Partition.prototype.$size=function(){return 1};pv.Layout.Partition.prototype.size=function(b){this.$size=b;return this};
pv.Layout.Partition.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=this,d=b.nodes[0],e=pv.Mark.stack,f=0;e.unshift(null);d.visitAfter(function(h,i){if(i>f)f=i;h.size=h.firstChild?pv.sum(h.childNodes,function(j){return j.size}):c.$size.apply(c,(e[0]=h,e))});e.shift();switch(b.order){case "ascending":d.sort(function(h,i){return h.size-i.size});break;case "descending":d.sort(function(h,i){return i.size-h.size});break}var g=1/f;d.minBreadth=0;d.breadth=
0.5;d.maxBreadth=1;d.visitBefore(function(h){for(var i=h.minBreadth,j=h.maxBreadth-i,k=h.firstChild;k;k=k.nextSibling){k.minBreadth=i;k.maxBreadth=i+=k.size/h.size*j;k.breadth=(i+k.minBreadth)/2}});d.visitAfter(function(h,i){h.minDepth=(i-1)*g;h.maxDepth=h.depth=i*g});pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Partition.Fill=function(){pv.Layout.Partition.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};pv.Layout.Partition.Fill.prototype=pv.extend(pv.Layout.Partition);
pv.Layout.Partition.Fill.prototype.buildImplied=function(b){pv.Layout.Partition.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Arc=function(){pv.Layout.Network.call(this);var b,c,d,e=this.buildImplied;this.buildImplied=function(f){e.call(this,f);c=f.directed;b=f.orient=="radial"?"linear":"polar";d=f.orient=="right"||f.orient=="top"};this.link.data(function(f){var g=f.sourceNode;f=f.targetNode;return d!=(c||g.breadth<f.breadth)?[g,f]:[f,g]}).interpolate(function(){return b})};
pv.Layout.Arc.prototype=pv.extend(pv.Layout.Network).property("orient",String).property("directed",Boolean);pv.Layout.Arc.prototype.defaults=(new pv.Layout.Arc).extend(pv.Layout.Network.prototype.defaults).orient("bottom");pv.Layout.Arc.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Arc.prototype.buildImplied=function(b){function c(m){switch(g){case "top":return-Math.PI/2;case "bottom":return Math.PI/2;case "left":return Math.PI;case "right":return 0;case "radial":return(m-0.25)*2*Math.PI}}function d(m){switch(g){case "top":case "bottom":return m*j;case "left":return 0;case "right":return j;case "radial":return j/2+p*Math.cos(c(m))}}function e(m){switch(g){case "top":return 0;case "bottom":return k;case "left":case "right":return m*k;case "radial":return k/2+p*Math.sin(c(m))}}
if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var f=b.nodes,g=b.orient,h=this.$sort,i=pv.range(f.length),j=b.width,k=b.height,p=Math.min(j,k)/2;h&&i.sort(function(m,n){return h(f[m],f[n])});for(b=0;b<f.length;b++){var l=f[i[b]],r=l.breadth=(b+0.5)/f.length;l.x=d(r);l.y=e(r);l.midAngle=c(r)}}};
pv.Layout.Horizon=function(){pv.Layout.call(this);var b=this,c,d,e,f,g,h,i=this.buildImplied;this.buildImplied=function(j){i.call(this,j);c=j.bands;d=j.mode;e=Math.round((d=="color"?0.5:1)*j.height);f=j.backgroundStyle;g=pv.ramp(f,j.negativeStyle).domain(0,c);h=pv.ramp(f,j.positiveStyle).domain(0,c)};c=(new pv.Panel).data(function(){return pv.range(c*2)}).overflow("hidden").height(function(){return e}).top(function(j){return d=="color"?(j&1)*e:0}).fillStyle(function(j){return j?null:f});this.band=
(new pv.Mark).top(function(j,k){return d=="mirror"&&k&1?(k+1>>1)*e:null}).bottom(function(j,k){return d=="mirror"?k&1?null:(k+1>>1)*-e:(k&1||-1)*(k+1>>1)*e}).fillStyle(function(j,k){return(k&1?g:h)((k>>1)+1)});this.band.add=function(j){return b.add(pv.Panel).extend(c).add(j).extend(this)}};pv.Layout.Horizon.prototype=pv.extend(pv.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",pv.color).property("positiveStyle",pv.color).property("negativeStyle",pv.color);
pv.Layout.Horizon.prototype.defaults=(new pv.Layout.Horizon).extend(pv.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728");
pv.Layout.Rollup=function(){pv.Layout.Network.call(this);var b=this,c,d,e=b.buildImplied;this.buildImplied=function(f){e.call(this,f);c=f.$rollup.nodes;d=f.$rollup.links};this.node.data(function(){return c}).shapeSize(function(f){return f.nodes.length*20});this.link.interpolate("polar").eccentricity(0.8);this.link.add=function(f){return b.add(pv.Panel).data(function(){return d}).add(f).extend(this)}};pv.Layout.Rollup.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);
pv.Layout.Rollup.prototype.x=function(b){this.$x=pv.functor(b);return this};pv.Layout.Rollup.prototype.y=function(b){this.$y=pv.functor(b);return this};
pv.Layout.Rollup.prototype.buildImplied=function(b){function c(n){return h[n]+","+i[n]}if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var d=b.nodes,e=b.links,f=b.directed,g=d.length,h=[],i=[],j=0,k={},p={},l=pv.Mark.stack,r={parent:this};l.unshift(null);for(var m=0;m<g;m++){r.index=m;l[0]=d[m];h[m]=this.$x.apply(r,l);i[m]=this.$y.apply(r,l)}l.shift();for(m=0;m<d.length;m++){g=c(m);l=k[g];if(!l){l=k[g]=pv.extend(d[m]);l.index=j++;l.x=h[m];l.y=i[m];l.nodes=[]}l.nodes.push(d[m])}for(m=0;m<
e.length;m++){j=e[m].targetNode;d=k[c(e[m].sourceNode.index)];j=k[c(j.index)];g=!f&&d.index>j.index?j.index+","+d.index:d.index+","+j.index;(l=p[g])||(l=p[g]={sourceNode:d,targetNode:j,linkValue:0,links:[]});l.links.push(e[m]);l.linkValue+=e[m].linkValue}b.$rollup={nodes:pv.values(k),links:pv.values(p)}}};
pv.Layout.Matrix=function(){pv.Layout.Network.call(this);var b,c,d,e,f,g=this.buildImplied;this.buildImplied=function(h){g.call(this,h);b=h.nodes.length;c=h.width/b;d=h.height/b;e=h.$matrix.labels;f=h.$matrix.pairs};this.link.data(function(){return f}).left(function(){return c*(this.index%b)}).top(function(){return d*Math.floor(this.index/b)}).width(function(){return c}).height(function(){return d}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(h){return h.linkValue?"#555":"#eee"}).parent=
this;delete this.link.add;this.label.data(function(){return e}).left(function(){return this.index&1?c*((this.index>>1)+0.5):0}).top(function(){return this.index&1?0:d*((this.index>>1)+0.5)}).textMargin(4).textAlign(function(){return this.index&1?"left":"right"}).textAngle(function(){return this.index&1?-Math.PI/2:0});delete this.node};pv.Layout.Matrix.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);pv.Layout.Matrix.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Matrix.prototype.buildImplied=function(b){if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var c=b.nodes,d=b.links,e=this.$sort,f=c.length,g=pv.range(f),h=[],i=[],j={};b.$matrix={labels:h,pairs:i};e&&g.sort(function(m,n){return e(c[m],c[n])});for(var k=0;k<f;k++)for(var p=0;p<f;p++){var l=g[k],r=g[p];i.push(j[l+"."+r]={row:k,col:p,sourceNode:c[l],targetNode:c[r],linkValue:0})}for(k=0;k<f;k++){l=g[k];h.push(c[l],c[l])}for(k=0;k<d.length;k++){h=d[k];f=h.sourceNode.index;g=h.targetNode.index;
h=h.linkValue;j[f+"."+g].linkValue+=h;b.directed||(j[g+"."+f].linkValue+=h)}}};
pv.Layout.Bullet=function(){pv.Layout.call(this);var b=this,c=b.buildImplied,d=b.x=pv.Scale.linear(),e,f,g,h,i;this.buildImplied=function(j){c.call(this,i=j);e=j.orient;f=/^left|right$/.test(e);g=pv.ramp("#bbb","#eee").domain(0,Math.max(1,i.ranges.length-1));h=pv.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,i.measures.length-1))};(this.range=new pv.Mark).data(function(){return i.ranges}).reverse(true).left(function(){return e=="left"?0:null}).top(function(){return e=="top"?0:null}).right(function(){return e==
"right"?0:null}).bottom(function(){return e=="bottom"?0:null}).width(function(j){return f?d(j):null}).height(function(j){return f?null:d(j)}).fillStyle(function(){return g(this.index)}).antialias(false).parent=b;(this.measure=new pv.Mark).extend(this.range).data(function(){return i.measures}).left(function(){return e=="left"?0:f?null:this.parent.width()/3.25}).top(function(){return e=="top"?0:f?this.parent.height()/3.25:null}).right(function(){return e=="right"?0:f?null:this.parent.width()/3.25}).bottom(function(){return e==
"bottom"?0:f?this.parent.height()/3.25:null}).fillStyle(function(){return h(this.index)}).parent=b;(this.marker=new pv.Mark).data(function(){return i.markers}).left(function(j){return e=="left"?d(j):f?null:this.parent.width()/2}).top(function(j){return e=="top"?d(j):f?this.parent.height()/2:null}).right(function(j){return e=="right"?d(j):null}).bottom(function(j){return e=="bottom"?d(j):null}).strokeStyle("black").shape("bar").shapeAngle(function(){return f?0:Math.PI/2}).parent=b;(this.tick=new pv.Mark).data(function(){return d.ticks(7)}).left(function(j){return e==
"left"?d(j):null}).top(function(j){return e=="top"?d(j):null}).right(function(j){return e=="right"?d(j):f?null:-6}).bottom(function(j){return e=="bottom"?d(j):f?-8:null}).height(function(){return f?6:null}).width(function(){return f?null:6}).parent=b};pv.Layout.Bullet.prototype=pv.extend(pv.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("maximum",Number);pv.Layout.Bullet.prototype.defaults=(new pv.Layout.Bullet).extend(pv.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]);
pv.Layout.Bullet.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=this.parent[/^left|right$/.test(b.orient)?"width":"height"]();b.maximum=b.maximum||pv.max([].concat(b.ranges,b.markers,b.measures));this.x.domain(0,b.maximum).range(0,c)};pv.Behavior={};
pv.Behavior.drag=function(){function b(j,k){f=this.index;e=this.scene;var p=this.mouse();h=((g=j).fix=pv.vector(j.x,j.y)).minus(p);i={x:this.parent.width()-(j.dx||0),y:this.parent.height()-(j.dy||0)};e.mark.context(e,f,function(){this.render()});pv.Mark.dispatch("dragstart",e,f,k)}function c(j){if(e){e.mark.context(e,f,function(){var k=this.mouse();g.x=g.fix.x=Math.max(0,Math.min(h.x+k.x,i.x));g.y=g.fix.y=Math.max(0,Math.min(h.y+k.y,i.y));this.render()});pv.Mark.dispatch("drag",e,f,j)}}function d(j){if(e){g.fix=
null;e.mark.context(e,f,function(){this.render()});pv.Mark.dispatch("dragend",e,f,j);e=null}}var e,f,g,h,i;pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",d);return b};
pv.Behavior.point=function(b){function c(p,l){p=p[l];l={cost:Infinity};for(var r=(p.visible?p.children.length:0)-1;r>=0;r--){var m=p.children[r],n=m.mark,o;if(n.type=="panel"){n.scene=m;for(var s=m.length-1;s>=0;s--){n.index=s;o=c(m,s);if(o.cost<l.cost)l=o}delete n.scene;delete n.index}else if(n.$handlers.point){n=n.mouse();for(s=m.length-1;s>=0;s--){var t=m[s];o=n.x-t.left-(t.width||0)/2;t=n.y-t.top-(t.height||0)/2;var u=h*o*o+i*t*t;if(u<l.cost){l.distance=o*o+t*t;l.cost=u;l.scene=m;l.index=s}}}}return l}
function d(p){var l=c(this.scene,this.index);if(l.cost==Infinity||l.distance>k)l=null;if(f){if(l&&f.scene==l.scene&&f.index==l.index)return;pv.Mark.dispatch("unpoint",f.scene,f.index,p)}if(f=l){pv.Mark.dispatch("point",l.scene,l.index,p);if(!j&&this.type==="panel"){j=this;j.event("mouseout",function(){e.call(j.scene.$g,arguments[arguments.length-1])})}else pv.listen(this.root.canvas(),"mouseout",e)}}function e(p){if(f&&!pv.ancestor(this,p.relatedTarget)){pv.Mark.dispatch("unpoint",f.scene,f.index,
p);f=null}}var f,g=null,h=1,i=1,j=null,k=arguments.length?b*b:900;d.collapse=function(p){if(arguments.length){g=String(p);switch(g){case "y":h=1;i=0;break;case "x":h=0;i=1;break;default:i=h=1;break}return d}return g};return d};
pv.Behavior.select=function(){function b(i,j){f=this.index;e=this.scene;h=this.mouse();g=i;g.x=h.x;g.y=h.y;g.dx=g.dy=0;pv.Mark.dispatch("selectstart",e,f,j)}function c(i){if(e){e.mark.context(e,f,function(){var j=this.mouse();g.x=Math.max(0,Math.min(h.x,j.x));g.y=Math.max(0,Math.min(h.y,j.y));g.dx=Math.min(this.width(),Math.max(j.x,h.x))-g.x;g.dy=Math.min(this.height(),Math.max(j.y,h.y))-g.y;this.render()});pv.Mark.dispatch("select",e,f,i)}}function d(i){if(e){pv.Mark.dispatch("selectend",e,f,i);
e=null}}var e,f,g,h;pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",d);return b};
pv.Behavior.resize=function(b){function c(j,k){g=this.index;f=this.scene;i=this.mouse();h=j;switch(b){case "left":i.x=h.x+h.dx;break;case "right":i.x=h.x;break;case "top":i.y=h.y+h.dy;break;case "bottom":i.y=h.y;break}pv.Mark.dispatch("resizestart",f,g,k)}function d(j){if(f){f.mark.context(f,g,function(){var k=this.mouse();h.x=Math.max(0,Math.min(i.x,k.x));h.y=Math.max(0,Math.min(i.y,k.y));h.dx=Math.min(this.parent.width(),Math.max(k.x,i.x))-h.x;h.dy=Math.min(this.parent.height(),Math.max(k.y,i.y))-
h.y;this.render()});pv.Mark.dispatch("resize",f,g,j)}}function e(j){if(f){pv.Mark.dispatch("resizeend",f,g,j);f=null}}var f,g,h,i;pv.listen(window,"mousemove",d);pv.listen(window,"mouseup",e);return c};
pv.Behavior.pan=function(){function b(){f=this.index;e=this.scene;h=pv.vector(pv.event.pageX,pv.event.pageY);g=this.transform();i=1/(g.k*this.scale);if(j)j={x:(1-g.k)*this.width(),y:(1-g.k)*this.height()}}function c(k){if(e){e.mark.context(e,f,function(){var p=g.translate((pv.event.pageX-h.x)*i,(pv.event.pageY-h.y)*i);if(j){p.x=Math.max(j.x,Math.min(0,p.x));p.y=Math.max(j.y,Math.min(0,p.y))}this.transform(p).render()});pv.Mark.dispatch("pan",e,f,k)}}function d(){e=null}var e,f,g,h,i,j;b.bound=function(k){if(arguments.length){j=
Boolean(k);return this}return Boolean(j)};pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",d);return b};
pv.Behavior.zoom=function(b){function c(e){var f=this.mouse(),g=pv.event.wheel*b;f=this.transform().translate(f.x,f.y).scale(g<0?1E3/(1E3-g):(1E3+g)/1E3).translate(-f.x,-f.y);if(d){f.k=Math.max(1,f.k);f.x=Math.max((1-f.k)*this.width(),Math.min(0,f.x));f.y=Math.max((1-f.k)*this.height(),Math.min(0,f.y))}this.transform(f).render();pv.Mark.dispatch("zoom",this.scene,this.index,e)}var d;arguments.length||(b=1/48);c.bound=function(e){if(arguments.length){d=Boolean(e);return this}return Boolean(d)};return c};
pv.Geo=function(){};
pv.Geo.projections={mercator:{project:function(b){return{x:b.lng/180,y:b.lat>85?1:b.lat<-85?-1:Math.log(Math.tan(Math.PI/4+pv.radians(b.lat)/2))/Math.PI}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(2*Math.atan(Math.exp(b.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(b){return{x:b.lng/180,y:Math.sin(pv.radians(b.lat))}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(Math.asin(b.y))}}},sinusoidal:{project:function(b){return{x:pv.radians(b.lng)*Math.cos(pv.radians(b.lat))/Math.PI,
y:b.lat/90}},invert:function(b){return{lng:pv.degrees(b.x*Math.PI/Math.cos(b.y*Math.PI/2)),lat:b.y*90}}},aitoff:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);var d=Math.acos(Math.cos(b)*Math.cos(c/2));return{x:2*(d?Math.cos(b)*Math.sin(c/2)*d/Math.sin(d):0)/Math.PI,y:2*(d?Math.sin(b)*d/Math.sin(d):0)/Math.PI}},invert:function(b){var c=b.y*Math.PI/2;return{lng:pv.degrees(b.x*Math.PI/2/Math.cos(c)),lat:pv.degrees(c)}}},hammer:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);
var d=Math.sqrt(1+Math.cos(b)*Math.cos(c/2));return{x:2*Math.SQRT2*Math.cos(b)*Math.sin(c/2)/d/3,y:Math.SQRT2*Math.sin(b)/d/1.5}},invert:function(b){var c=b.x*3;b=b.y*1.5;var d=Math.sqrt(1-c*c/16-b*b/4);return{lng:pv.degrees(2*Math.atan2(d*c,2*(2*d*d-1))),lat:pv.degrees(Math.asin(d*b))}}},identity:{project:function(b){return{x:b.lng/180,y:b.lat/90}},invert:function(b){return{lng:b.x*180,lat:b.y*90}}}};
pv.Geo.scale=function(b){function c(m){if(!l||m.lng!=l.lng||m.lat!=l.lat){l=m;m=d(m);r={x:j(m.x),y:k(m.y)}}return r}function d(m){return i.project({lng:m.lng-p.lng,lat:m.lat})}function e(m){m=i.invert(m);m.lng+=p.lng;return m}var f={x:0,y:0},g={x:1,y:1},h=[],i=pv.Geo.projections.identity,j=pv.Scale.linear(-1,1).range(0,1),k=pv.Scale.linear(-1,1).range(1,0),p={lng:0,lat:0},l,r;c.x=function(m){return c(m).x};c.y=function(m){return c(m).y};c.ticks={lng:function(m){var n;if(h.length>1){var o=pv.Scale.linear();
if(m==undefined)m=10;n=o.domain(h,function(s){return s.lat}).ticks(m);m=o.domain(h,function(s){return s.lng}).ticks(m)}else{n=pv.range(-80,81,10);m=pv.range(-180,181,10)}return m.map(function(s){return n.map(function(t){return{lat:t,lng:s}})})},lat:function(m){return pv.transpose(c.ticks.lng(m))}};c.invert=function(m){return e({x:j.invert(m.x),y:k.invert(m.y)})};c.domain=function(m,n){if(arguments.length){h=m instanceof Array?arguments.length>1?pv.map(m,n):m:Array.prototype.slice.call(arguments);
if(h.length>1){var o=h.map(function(t){return t.lng}),s=h.map(function(t){return t.lat});p={lng:(pv.max(o)+pv.min(o))/2,lat:(pv.max(s)+pv.min(s))/2};o=h.map(d);j.domain(o,function(t){return t.x});k.domain(o,function(t){return t.y})}else{p={lng:0,lat:0};j.domain(-1,1);k.domain(-1,1)}l=null;return this}return h};c.range=function(m,n){if(arguments.length){if(typeof m=="object"){f={x:Number(m.x),y:Number(m.y)};g={x:Number(n.x),y:Number(n.y)}}else{f={x:0,y:0};g={x:Number(m),y:Number(n)}}j.range(f.x,g.x);
k.range(g.y,f.y);l=null;return this}return[f,g]};c.projection=function(m){if(arguments.length){i=typeof m=="string"?pv.Geo.projections[m]||pv.Geo.projections.identity:m;return this.domain(h)}return m};pv.copyOwn(c,pv.Scale.common);arguments.length&&c.projection(b);return c};

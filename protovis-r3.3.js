// 616881d
var a;if(!Array.prototype.map)Array.prototype.map=function(b,c){for(var e=this.length,d=new Array(e),g=0;g<e;g++)if(g in this)d[g]=b.call(c,this[g],g,this);return d};if(!Array.prototype.filter)Array.prototype.filter=function(b,c){for(var e=this.length,d=[],g=0;g<e;g++)if(g in this){var h=this[g];b.call(c,h,g,this)&&d.push(h)}return d};if(!Array.prototype.forEach)Array.prototype.forEach=function(b,c){for(var e=this.length>>>0,d=0;d<e;d++)d in this&&b.call(c,this[d],d,this)};
if(!Array.prototype.reduce)Array.prototype.reduce=function(b,c){var e=this.length;if(!e&&arguments.length==1)throw new Error("reduce: empty array, no initial value");var d=0;if(arguments.length<2)for(;;){if(d in this){c=this[d++];break}if(++d>=e)throw new Error("reduce: no values, no initial value");}for(;d<e;d++)if(d in this)c=b(c,this[d],d,this);return c};var pv={};pv.version={major:3,minor:3};pv.identity=function(b){return b};pv.index=function(){return this.index};pv.child=function(){return this.childIndex};
pv.parent=function(){return this.parent.index};pv.extend=Object.create?function(b){return Object.create(b.prototype||b)}:function(b){function c(){}c.prototype=b.prototype||b;return new c};
pv.parse=function(b){for(var c=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),e,d,g=0,h="";e=c.exec(b);){e=e.index+e[0].length;if(b.charAt(e)!="{"){h+=b.substring(g,e)+"{return ";g=e;for(var i=0;i>=0&&e<b.length;e++){var j=b.charAt(e);switch(j){case '"':case "'":for(;++e<b.length&&(d=b.charAt(e))!=j;)d=="\\"&&e++;break;case "[":case "(":i++;break;case "]":case ")":i--;break;case ";":case ",":i==0&&i--;break}}h+=pv.parse(b.substring(g,--e))+";}";g=e}c.lastIndex=e}h+=b.substring(g);return h};
pv.css=function(b,c){return window.getComputedStyle?window.getComputedStyle(b,null).getPropertyValue(c):b.currentStyle[c]};pv.error=function(b){typeof console==="undefined"||!console.error?alert(b):console.error(b)};pv.listen=function(b,c,e){e=pv.listener(e);if(c==="load"||c==="onload")return pv.listenForPageLoad(e);if(b.addEventListener)b.addEventListener(c,e,false);else{if(b===window)b=document.documentElement;b.attachEvent("on"+c,e)}return e};
pv.unlisten=function(b,c,e){if(e.$listener)e=e.$listener;b.removeEventListener?b.removeEventListener(c,e,false):b.detachEvent("on"+c,e)};pv.listener=function(b){return b.$listener||(b.$listener=function(c){try{pv.event=c=pv.fixEvent(c);return b.call(this,c)}catch(e){pv.error(e)}finally{delete pv.event}})};
pv.fixEvent=function(b){if(b.pageX==null&&b.clientX!=null){var c=b.target&&b.target.ownerDocument||document,e=c.documentElement;c=c.body;b.pageX=b.clientX*1+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0);b.pageY=b.clientY*1+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)}return b};pv.ancestor=function(b,c){for(;c;){if(c==b)return true;c=c.parentNode}return false};
pv.getWindow=function(b){return b!=null&&b==b.window?b:b.nodeType===9?b.defaultView||b.parentWindow:false};pv.elementOffset=function(b){var c,e,d,g,h={top:0,left:0};if(d=b&&b.ownerDocument){e=d.body;if(e!==b){c=d.documentElement;if(typeof b.getBoundingClientRect!=="undefined")h=b.getBoundingClientRect();b=pv.getWindow(d);d=c.clientTop||e.clientTop||0;e=c.clientLeft||e.clientLeft||0;g=b.pageYOffset||c.scrollTop;return{top:h.top+g-d,left:h.left+(b.pageXOffset||c.scrollLeft)-e}}}};
pv.listenForPageLoad=function(b){document.readyState==="complete"&&b();if(pv.renderer()==="svgweb")window.addEventListener("SVGLoad",b,false);else if(document.addEventListener)window.addEventListener("load",b,false);else document.attachEvent&&window.attachEvent("onload",b)};pv.renderer=function(){var b=typeof document.svgImplementation!=="undefined"?document.svgImplementation:typeof window.svgweb==="undefined"?"nativesvg":"svgweb";pv.renderer=function(){return b};return b};
pv.id=function(){var b=1;return function(){return b++}}();pv.functor=function(b){return typeof b=="function"?b:function(){return b}};pv.get=function(b,c,e){var d;return b&&(d=b[c])!=null?d:e};pv.renderer()!=="batik"&&pv.listen(window,"load",function(){pv.$={i:0,x:document.getElementsByTagName("script")};for(pv.$.xlen=pv.$.x.length;pv.$.i<pv.$.xlen;pv.$.i++){pv.$.s=pv.$.x[pv.$.i];if(pv.$.s.type=="text/javascript+protovis")try{window.eval(pv.parse(pv.$.s.text))}catch(b){pv.error(b)}}delete pv.$});
pv.Format={};pv.Format.re=function(b){return b.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")};pv.Format.pad=function(b,c,e){c=c-String(e).length;return c<1?e:(new Array(c+1)).join(b)+e};
pv.Format.date=function(b){function c(d){return b.replace(/%[a-zA-Z0-9]/g,function(g){switch(g){case "%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d.getDay()];case "%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][d.getDay()];case "%h":case "%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][d.getMonth()];case "%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()];
case "%c":return d.toLocaleString();case "%C":return e("0",2,Math.floor(d.getFullYear()/100)%100);case "%d":return e("0",2,d.getDate());case "%x":case "%D":return e("0",2,d.getMonth()+1)+"/"+e("0",2,d.getDate())+"/"+e("0",2,d.getFullYear()%100);case "%e":return e(" ",2,d.getDate());case "%H":return e("0",2,d.getHours());case "%I":return(g=d.getHours()%12)?e("0",2,g):12;case "%m":return e("0",2,d.getMonth()+1);case "%M":return e("0",2,d.getMinutes());case "%n":return"\n";case "%p":return d.getHours()<
12?"AM":"PM";case "%T":case "%X":case "%r":g=d.getHours()%12;return(g?e("0",2,g):12)+":"+e("0",2,d.getMinutes())+":"+e("0",2,d.getSeconds())+" "+(d.getHours()<12?"AM":"PM");case "%R":return e("0",2,d.getHours())+":"+e("0",2,d.getMinutes());case "%S":return e("0",2,d.getSeconds());case "%Q":return e("0",3,d.getMilliseconds());case "%t":return"\t";case "%u":return(g=d.getDay())?g:1;case "%w":return d.getDay();case "%y":return e("0",2,d.getFullYear()%100);case "%Y":return d.getFullYear();case "%%":return"%"}return g})}
var e=pv.Format.pad;c.format=c;c.parse=function(d){var g=1970,h=0,i=1,j=0,k=0,l=0,n=[function(){}],m=pv.Format.re(b).replace(/%[a-zA-Z0-9]/g,function(p){switch(p){case "%b":n.push(function(o){h={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[o]});return"([A-Za-z]+)";case "%h":case "%B":n.push(function(o){h={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[o]});return"([A-Za-z]+)";case "%e":case "%d":n.push(function(o){i=
o});return"([0-9]+)";case "%I":case "%H":n.push(function(o){j=o});return"([0-9]+)";case "%m":n.push(function(o){h=o-1});return"([0-9]+)";case "%M":n.push(function(o){k=o});return"([0-9]+)";case "%p":n.push(function(o){if(j==12){if(o=="am")j=0}else if(o=="pm")j=Number(j)+12});return"(am|pm)";case "%S":n.push(function(o){l=o});return"([0-9]+)";case "%y":n.push(function(o){o=Number(o);g=o+(0<=o&&o<69?2E3:o>=69&&o<100?1900:0)});return"([0-9]+)";case "%Y":n.push(function(o){g=o});return"([0-9]+)";case "%%":n.push(function(){});
return"%"}return p});(d=d.match(m))&&d.forEach(function(p,o){n[o](p)});return new Date(g,h,i,j,k,l)};return c};
pv.Format.time=function(b){function c(d){d=Number(d);switch(b){case "short":if(d>=31536E6)return(d/31536E6).toFixed(1)+" years";else if(d>=6048E5)return(d/6048E5).toFixed(1)+" weeks";else if(d>=864E5)return(d/864E5).toFixed(1)+" days";else if(d>=36E5)return(d/36E5).toFixed(1)+" hours";else if(d>=6E4)return(d/6E4).toFixed(1)+" minutes";return(d/1E3).toFixed(1)+" seconds";case "long":var g=[],h=d%36E5/6E4>>0;g.push(e("0",2,d%6E4/1E3>>0));if(d>=36E5){var i=d%864E5/36E5>>0;g.push(e("0",2,h));if(d>=864E5){g.push(e("0",
2,i));g.push(Math.floor(d/864E5).toFixed())}else g.push(i.toFixed())}else g.push(h.toFixed());return g.reverse().join(":")}}var e=pv.Format.pad;c.format=c;c.parse=function(d){switch(b){case "short":for(var g=/([0-9,.]+)\s*([a-z]+)/g,h,i=0;h=g.exec(d);){var j=parseFloat(h[0].replace(",","")),k=0;switch(h[2].toLowerCase()){case "year":case "years":k=31536E6;break;case "week":case "weeks":k=6048E5;break;case "day":case "days":k=864E5;break;case "hour":case "hours":k=36E5;break;case "minute":case "minutes":k=
6E4;break;case "second":case "seconds":k=1E3;break}i+=j*k}return i;case "long":h=d.replace(",","").split(":").reverse();i=0;if(h.length)i+=parseFloat(h[0])*1E3;if(h.length>1)i+=parseFloat(h[1])*6E4;if(h.length>2)i+=parseFloat(h[2])*36E5;if(h.length>3)i+=parseFloat(h[3])*864E5;return i}};return c};
pv.Format.number=function(){function b(q){if(Infinity>h)q=Math.round(q*i)/i;var r=String(Math.abs(q)).split("."),v=r[0];if(v.length>e)v=v.substring(v.length-e);if(l&&v.length<c)v=(new Array(c-v.length+1)).join(j)+v;if(v.length>3)v=v.replace(/\B(?=(?:\d{3})+(?!\d))/g,m);if(!l&&v.length<d)v=(new Array(d-v.length+1)).join(j)+v;r[0]=q<0?p+v+o:v;q=r[1]||"";if(q.length>h)q=r[1]=q.substr(0,h);if(q.length<g)r[1]=q+(new Array(g-q.length+1)).join(k);return r.join(n)}var c=0,e=Infinity,d=0,g=0,h=0,i=1,j="0",
k="0",l=true,n=".",m=",",p="\u2212",o="";b.format=b;b.parse=function(q){var r=pv.Format.re;q=String(q).split(n);if(q.length==1)q[1]="";q[0].replace(new RegExp("^("+r(j)+")*"),"");q[1].replace(new RegExp("("+r(k)+")*$"),"");r=q[0].replace(new RegExp(r(m),"g"),"");if(r.length>e)r=r.substring(r.length-e);q=q[1]?Number("0."+q[1]):0;if(Infinity>h)q=Math.round(q*i)/i;return Math.round(r)+q};b.integerDigits=function(q,r){if(arguments.length){c=Number(q);e=arguments.length>1?Number(r):c;d=c+Math.floor(c/
3)*m.length;return this}return[c,e]};b.fractionDigits=function(q,r){if(arguments.length){g=Number(q);h=arguments.length>1?Number(r):g;i=Math.pow(10,h);return this}return[g,h]};b.integerPad=function(q){if(arguments.length){j=String(q);l=/\d/.test(j);return this}return j};b.fractionPad=function(q){if(arguments.length){k=String(q);return this}return k};b.decimal=function(q){if(arguments.length){n=String(q);return this}return n};b.group=function(q){if(arguments.length){m=q?String(q):"";d=c+Math.floor(c/
3)*m.length;return this}return m};b.negativeAffix=function(q,r){if(arguments.length){p=String(q||"");o=String(r||"");return this}return[p,o]};return b};
(function(){var b;pv.Text={};pv.Text.createCache=function(){return new c};pv.Text.usingCache=function(d,g,h){if(!(d instanceof c))throw new Error("Not a valid cache.");var i=b;b=d;try{return g.call(h)}finally{b=i}};pv.Text.measure=function(d,g){d=d==null?"":""+d;var h=b&&b.get(g,d);if(!h){h=d?this.measureCore(d,g):{width:0,height:0};b&&b.put(g,d,h)}return h};pv.Text.fontHeight=function(d){return pv.Text.measure("M",d).height};pv.Text.measureCore=function(){function d(){return h||(h=g())}function g(){var j=
document.createElement("div");j.id="pvSVGText_"+(new Date).getTime();var k=j.style;k.position="absolute";k.visibility="hidden";k.width=0;k.height=0;k.left=0;k.top=0;var l=pv.SvgScene.create("svg");l.setAttribute("font-size","10px");l.setAttribute("font-family","sans-serif");j.appendChild(l);k=pv.SvgScene.create("text");l.appendChild(k);l=pv.renderer()==="svgweb"?document.createTextNode("",true):document.createTextNode("");k.appendChild(l);document.body.appendChild(j);return k}var h,i="10px sans-serif";
return function(j,k){k||(k=null);var l=d();if(i!==k){i=k;pv.SvgScene.setStyle(l,{font:k})}l.firstChild.nodeValue=""+j;var n;try{n=l.getBBox()}catch(m){typeof console.error==="function"&&console.error("GetBBox failed: ",m);throw m;}return{width:n.width,height:n.height}}}();var c=function(){this._fontsCache={}},e=Object.prototype.hasOwnProperty;c.prototype._getFont=function(d){d=d||"";return e.call(this._fontsCache,d)?this._fontsCache[d]:(this._fontsCache[d]={})};c.prototype.get=function(d,g){g=g||
"";d=this._getFont(d);return e.call(d,g)?d[g]:null};c.prototype.put=function(d,g,h){return this._getFont(d)[g||""]=h}})();pv.map=function(b,c){var e={};return c?b.map(function(d,g){e.index=g;return c.call(e,d)}):b.slice()};pv.repeat=function(b,c){if(arguments.length==1)c=2;return pv.blend(pv.range(c).map(function(){return b}))};pv.array=function(b,c){var e=b>=0?new Array(b):[];if(c!==undefined)for(var d=0;d<b;d++)e[d]=c;return e};
pv.cross=function(b,c){for(var e=[],d=0,g=b.length,h=c.length;d<g;d++)for(var i=0,j=b[d];i<h;i++)e.push([j,c[i]]);return e};pv.blend=function(b){return Array.prototype.concat.apply([],b)};
pv.transpose=function(b){var c=b.length,e=pv.max(b,function(i){return i.length});if(e>c){b.length=e;for(var d=c;d<e;d++)b[d]=new Array(c);for(d=0;d<c;d++)for(var g=d+1;g<e;g++){var h=b[d][g];b[d][g]=b[g][d];b[g][d]=h}}else{for(d=0;d<e;d++)b[d].length=c;for(d=0;d<c;d++)for(g=0;g<d;g++){h=b[d][g];b[d][g]=b[g][d];b[g][d]=h}}b.length=e;for(d=0;d<e;d++)b[d].length=c;return b};pv.normalize=function(b,c){b=pv.map(b,c);c=pv.sum(b);for(var e=0;e<b.length;e++)b[e]/=c;return b};
pv.permute=function(b,c,e){if(!e)e=pv.identity;var d=new Array(c.length),g={};c.forEach(function(h,i){g.index=h;d[i]=e.call(g,b[h])});return d};pv.numerate=function(b,c){if(!c)c=pv.identity;var e={},d={};b.forEach(function(g,h){d.index=h;e[c.call(d,g)]=h});return e};pv.uniq=function(b,c){if(!c)c=pv.identity;var e={},d=[],g={},h;b.forEach(function(i,j){g.index=j;h=c.call(g,i);h in e||(e[h]=d.push(h))});return d};pv.naturalOrder=function(b,c){return b<c?-1:b>c?1:0};
pv.reverseOrder=function(b,c){return c<b?-1:c>b?1:0};pv.search=function(b,c,e){if(!e)e=pv.identity;for(var d=0,g=b.length-1;d<=g;){var h=d+g>>1,i=e(b[h]);if(i<c)d=h+1;else if(i>c)g=h-1;else return h}return-d-1};pv.search.index=function(b,c,e){b=pv.search(b,c,e);return b<0?-b-1:b};
pv.range=function(b,c,e){if(arguments.length==1){c=b;b=0}if(e==undefined)e=1;if((c-b)/e==Infinity)throw new Error("range must be finite");var d=[],g=0,h;c-=(c-b)*1.0E-10;if(e<0)for(;(h=b+e*g++)>c;)d.push(h);else for(;(h=b+e*g++)<c;)d.push(h);return d};pv.random=function(b,c,e){if(arguments.length==1){c=b;b=0}if(e==undefined)e=1;return e?Math.floor(Math.random()*(c-b)/e)*e+b:Math.random()*(c-b)+b};
pv.sum=function(b,c){var e={};return b.reduce(c?function(d,g,h){e.index=h;return d+c.call(e,g)}:function(d,g){return d+g},0)};pv.max=function(b,c){if(c==pv.index)return b.length-1;return Math.max.apply(null,c?pv.map(b,c):b)};pv.max.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return b.length-1;if(!c)c=pv.identity;for(var e=0,d=-Infinity,g={},h=0;h<b.length;h++){g.index=h;var i=c.call(g,b[h]);if(i>d){d=i;e=h}}return e};
pv.min=function(b,c){if(c==pv.index)return 0;return Math.min.apply(null,c?pv.map(b,c):b)};pv.min.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return 0;if(!c)c=pv.identity;for(var e=0,d=Infinity,g={},h=0;h<b.length;h++){g.index=h;var i=c.call(g,b[h]);if(i<d){d=i;e=h}}return e};pv.mean=function(b,c){return pv.sum(b,c)/b.length};
pv.median=function(b,c){if(c==pv.index)return(b.length-1)/2;b=pv.map(b,c).sort(pv.naturalOrder);if(b.length%2)return b[Math.floor(b.length/2)];c=b.length/2;return(b[c-1]+b[c])/2};pv.variance=function(b,c){if(b.length<1)return NaN;if(b.length==1)return 0;var e=pv.mean(b,c),d=0,g={};if(!c)c=pv.identity;for(var h=0;h<b.length;h++){g.index=h;var i=c.call(g,b[h])-e;d+=i*i}return d};pv.deviation=function(b,c){return Math.sqrt(pv.variance(b,c)/(b.length-1))};pv.log=function(b,c){return Math.log(b)/Math.log(c)};
pv.logSymmetric=function(b,c){return b==0?0:b<0?-pv.log(-b,c):pv.log(b,c)};pv.logAdjusted=function(b,c){if(!isFinite(b))return b;var e=b<0;if(b<c)b+=(c-b)/c;return e?-pv.log(b,c):pv.log(b,c)};pv.logFloor=function(b,c){return b>0?Math.pow(c,Math.floor(pv.log(b,c))):-Math.pow(c,-Math.floor(-pv.log(-b,c)))};pv.logCeil=function(b,c){return b>0?Math.pow(c,Math.ceil(pv.log(b,c))):-Math.pow(c,-Math.ceil(-pv.log(-b,c)))};
(function(){var b=Math.PI/180,c=180/Math.PI;pv.radians=function(e){return b*e};pv.degrees=function(e){return c*e}})();pv.keys=function(b){var c=[];for(var e in b)c.push(e);return c};pv.entries=function(b){var c=[];for(var e in b)c.push({key:e,value:b[e]});return c};pv.values=function(b){var c=[];for(var e in b)c.push(b[e]);return c};pv.dict=function(b,c){for(var e={},d={},g=0;g<b.length;g++)if(g in b){var h=b[g];d.index=g;e[h]=c.call(d,h)}return e};pv.hasOwnProp=Object.prototype.hasOwnProperty;
pv.copyOwn=function(b,c){if(c){var e=pv.hasOwnProp;for(var d in c)if(e.call(c,d))b[d]=c[d]}return b};pv.dom=function(b){return new pv.Dom(b)};pv.Dom=function(b){this.$map=b};pv.Dom.prototype.$leaf=function(b){return typeof b!="object"};pv.Dom.prototype.leaf=function(b){if(arguments.length){this.$leaf=b;return this}return this.$leaf};
pv.Dom.prototype.root=function(b){function c(g){var h=new pv.Dom.Node;for(var i in g){var j=g[i];h.appendChild(e(j)?new pv.Dom.Node(j):c(j)).nodeName=i}return h}var e=this.$leaf,d=c(this.$map);d.nodeName=b;return d};pv.Dom.prototype.nodes=function(){return this.root().nodes()};pv.Dom.Node=function(b){if(b!==undefined)this.nodeValue=b;this.childNodes=[]};a=pv.Dom.Node.prototype;a.nodeValue=undefined;a.parentNode=null;a.firstChild=null;a.lastChild=null;a.previousSibling=null;a.nextSibling=null;
a._firstDirtyChildIndex=Infinity;a.removeChild=function(b){b=this.childNodes.indexOf(b);if(b===-1)throw new Error("child not found");return this.removeAt(b)};a.appendChild=function(b){var c=b.parentNode;c&&c.removeChild(b);c=this.lastChild;b.parentNode=this;if(b.previousSibling=c){c.nextSibling=b;b._childIndex=c._childIndex+1}else{this.firstChild=b;b._childIndex=0}this.lastChild=b;this.childNodes.push(b);return b};
a.insertBefore=function(b,c){if(!c)return this.appendChild(b);c=this.childNodes.indexOf(c);if(c===-1)throw new Error("child not found");return this.insertAt(b,c)};
a.insertAt=function(b,c){if(c==null)return this.appendChild(b);var e=this.childNodes,d=e.length;if(c===d)return this.appendChild(b);if(c>d)throw new Error("Index out of range.");(d=b.parentNode)&&d.removeChild(b);d=c+1;if(d<this._firstDirtyChildIndex)this._firstDirtyChildIndex=d;e=e[c];b.parentNode=this;b.nextSibling=e;b._childIndex=c;d=b.previousSibling=e.previousSibling;e.previousSibling=b;if(d)d.nextSibling=b;else{if(e===this.lastChild)this.lastChild=b;this.firstChild=b}this.childNodes.splice(c,
0,b);return b};a.removeAt=function(b){var c=this.childNodes,e=c[b];if(e){c.splice(b,1);if(b<c.length)if(b<this._firstDirtyChildIndex)this._firstDirtyChildIndex=b;b=e.previousSibling;c=e.nextSibling;if(b)b.nextSibling=c;else this.firstChild=c;if(c)c.previousSibling=b;else this.lastChild=b;e.nextSibling=null;e.previousSibling=null;e.parentNode=null}return e};
a.replaceChild=function(b,c){var e=this.childNodes,d=e.indexOf(c);if(d===-1)throw new Error("child not found");var g=b.parentNode;g&&g.removeChild(b);b.parentNode=this;b.nextSibling=c.nextSibling;b._childIndex=c._childIndex;if(g=b.previousSibling=c.previousSibling)g.nextSibling=b;else this.firstChild=b;if(g=c.nextSibling)g.previousSibling=b;else this.lastChild=b;e[d]=b;return c};
a.childIndex=function(){var b=this.parentNode;if(b){var c=b._firstDirtyChildIndex;if(c<Infinity){var e=b.childNodes;if(c<e.length)for(e=e[c];e;e=e.nextSibling)e._childIndex=c++;delete b._firstDirtyChildIndex}return this._childIndex}return-1};a.visitBefore=function(b){function c(e,d){b(e,d);for(e=e.firstChild;e;e=e.nextSibling)c(e,d+1)}c(this,0)};a.visitAfter=function(b){function c(e,d){for(var g=e.firstChild;g;g=g.nextSibling)c(g,d+1);b(e,d)}c(this,0)};
a.sort=function(b){if(this.firstChild){delete this._firstDirtyChildIndex;this.childNodes.sort(b);var c=this.firstChild=this.childNodes[0],e;delete c.previousSibling;c._childIndex=0;for(var d=1;d<this.childNodes.length;d++){c.sort(b);e=this.childNodes[d];e._childIndex=d;e.previousSibling=c;c=c.nextSibling=e}this.lastChild=c;delete c.nextSibling;c.sort(b)}return this};
a.reverse=function(){var b=[];this.visitAfter(function(c){for(delete this._firstDirtyChildIndex;c.lastChild;)b.push(c.removeChild(c.lastChild));for(var e;e=b.pop();)c.insertBefore(e,c.firstChild)});return this};a.nodes=function(){function b(e){c.push(e);e.childNodes.forEach(b)}var c=[];b(this,c);return c};
a.toggle=function(b){if(b)return this.toggled?this.visitBefore(function(e){e.toggled&&e.toggle()}):this.visitAfter(function(e){e.toggled||e.toggle()});b=this;if(b.toggled){for(var c;c=b.toggled.pop();)b.appendChild(c);delete b.toggled}else if(b.lastChild)for(b.toggled=[];b.lastChild;)b.toggled.push(b.removeChild(b.lastChild))};pv.nodes=function(b){for(var c=new pv.Dom.Node,e=0;e<b.length;e++)c.appendChild(new pv.Dom.Node(b[e]));return c.nodes()};pv.tree=function(b){return new pv.Tree(b)};
pv.Tree=function(b){this.array=b};pv.Tree.prototype.keys=function(b){this.k=b;return this};pv.Tree.prototype.value=function(b){this.v=b;return this};pv.Tree.prototype.map=function(){for(var b={},c={},e=0;e<this.array.length;e++){c.index=e;for(var d=this.array[e],g=this.k.call(c,d),h=b,i=0;i<g.length-1;i++)h=h[g[i]]||(h[g[i]]={});h[g[i]]=this.v?this.v.call(c,d):d}return b};pv.nest=function(b){return new pv.Nest(b)};pv.Nest=function(b){this.array=b;this.keys=[]};a=pv.Nest.prototype;
a.key=function(b){this.keys.push(b);return this};a.sortKeys=function(b){this.keys[this.keys.length-1].order=b||pv.naturalOrder;return this};a.sortValues=function(b){this.order=b||pv.naturalOrder;return this};a.map=function(){for(var b={},c=[],e,d=0;d<this.array.length;d++){var g=this.array[d],h=b;for(e=0;e<this.keys.length-1;e++){var i=this.keys[e](g);h[i]||(h[i]={});h=h[i]}i=this.keys[e](g);if(!h[i]){e=[];c.push(e);h[i]=e}h[i].push(g)}if(this.order)for(e=0;e<c.length;e++)c[e].sort(this.order);return b};
a.entries=function(){function b(e){var d=[];for(var g in e){var h=e[g];d.push({key:g,values:h instanceof Array?h:b(h)})}return d}function c(e,d){var g=this.keys[d].order;g&&e.sort(function(i,j){return g(i.key,j.key)});if(++d<this.keys.length)for(var h=0;h<e.length;h++)c.call(this,e[h].values,d);return e}return c.call(this,b(this.map()),0)};a.rollup=function(b){function c(e){for(var d in e){var g=e[d];if(g instanceof Array)e[d]=b(g);else c(g)}return e}return c(this.map())};pv.flatten=function(b){return new pv.Flatten(b)};
pv.Flatten=function(b){this.map=b;this.keys=[]};pv.Flatten.prototype.key=function(b,c){this.keys.push({name:b,value:c});delete this.$leaf;return this};pv.Flatten.prototype.leaf=function(b){this.keys.length=0;this.$leaf=b;return this};
pv.Flatten.prototype.array=function(){function b(i,j){if(j<d.length-1)for(var k in i){e.push(k);b(i[k],j+1);e.pop()}else c.push(e.concat(i))}var c=[],e=[],d=this.keys,g=this.$leaf;if(g){function h(i,j){if(g(i))c.push({keys:e.slice(),value:i});else for(var k in i){e.push(k);h(i[k],j+1);e.pop()}}h(this.map,0);return c}b(this.map,0);return c.map(function(i){for(var j={},k=0;k<d.length;k++){var l=d[k],n=i[k];j[l.name]=l.value?l.value.call(null,n):n}return j})};pv.Transform=function(){};
pv.Transform.prototype={k:1,x:0,y:0};pv.Transform.identity=new pv.Transform;pv.Transform.prototype.translate=function(b,c){var e=new pv.Transform;e.k=this.k;e.x=this.k*b+this.x;e.y=this.k*c+this.y;return e};pv.Transform.prototype.scale=function(b){var c=new pv.Transform;c.k=this.k*b;c.x=this.x;c.y=this.y;return c};pv.Transform.prototype.invert=function(){var b=new pv.Transform,c=1/this.k;b.k=c;b.x=-this.x*c;b.y=-this.y*c;return b};
pv.Transform.prototype.times=function(b){var c=new pv.Transform;c.k=this.k*b.k;c.x=this.k*b.x+this.x;c.y=this.k*b.y+this.y;return c};pv.Scale=function(){};
pv.Scale.interpolator=function(b,c){if(typeof b=="number")return function(g){return g*(c-b)+b};var e=b.type&&b.type!=="solid",d=c.type&&c.type!=="solid";if(e||d){b=e?b:pv.color(b).rgb();c=d?c:pv.color(c).rgb();return function(g){return g<0.5?b:c}}b=pv.color(b).rgb();c=pv.color(c).rgb();return function(g){var h=b.a*(1-g)+c.a*g;if(h<1.0E-5)h=0;return b.a==0?pv.rgb(c.r,c.g,c.b,h):c.a==0?pv.rgb(b.r,b.g,b.b,h):pv.rgb(Math.round(b.r*(1-g)+c.r*g),Math.round(b.g*(1-g)+c.g*g),Math.round(b.b*(1-g)+c.b*g),h)}};
pv.Scale.common={by:function(b){function c(){return e(b.apply(this,arguments))}var e=this;for(var d in e)c[d]=e[d];return c},by1:function(b){function c(g){return e(b.call(this,g))}var e=this;for(var d in e)c[d]=e[d];return c},transform:function(b){function c(){return b.call(this,e.apply(e,arguments))}var e=this;for(var d in e)c[d]=e[d];return c}};
pv.Scale.quantitative=function(){function b(v){return new Date(v)}function c(v){var u=pv.search(e,v);if(u<0)u=-u-2;u=Math.max(0,Math.min(h.length-1,u));return h[u]((k(v)-d[u])/(d[u+1]-d[u]))}var e=[0,1],d=[0,1],g=[0,1],h=[pv.identity],i=Number,j=false,k=pv.identity,l=pv.identity,n=String,m=null,p,o,q,r;c.transform=function(v,u){k=function(t){return j?-v(-t):v(t)};l=function(t){return j?-u(-t):u(t)};d=e.map(k);return this};c.domain=function(v,u,t){if(arguments.length){var s;if(v instanceof Array){if(arguments.length<
2)u=pv.identity;if(arguments.length<3)t=u;s=v.length&&u(v[0]);e=v.length?[pv.min(v,u),pv.max(v,t)]:[]}else{s=v;e=Array.prototype.slice.call(arguments).map(Number)}if(e.length){if(e.length==1)e=[e[0],e[0]]}else e=[-Infinity,Infinity];j=(e[0]||e[e.length-1])<0;d=e.map(k);i=s instanceof Date?b:Number;return this}return e.map(i)};c.range=function(){if(arguments.length){g=Array.prototype.slice.call(arguments);if(g.length){if(g.length==1)g=[g[0],g[0]]}else g=[-Infinity,Infinity];h=[];for(var v=0;v<g.length-
1;v++)h.push(pv.Scale.interpolator(g[v],g[v+1]));return this}return g};c.invert=function(v){var u=pv.search(g,v);if(u<0)u=-u-2;u=Math.max(0,Math.min(h.length-1,u));return i(l(d[u]+(v-g[u])/(g[u+1]-g[u])*(d[u+1]-d[u])))};c.ticks=function(v,u){var t=e[0],s=e[e.length-1],x=s<t,w=x?s:t;s=x?t:s;t=s-w;if(!t||!isFinite(t)){if(i==b)n=pv.Format.date("%x");return[i(w)]}if(i==b){function A(C,E){switch(E){case 31536E6:C.setMonth(0);case 2592E6:C.setDate(1);case 6048E5:E==6048E5&&C.setDate(C.getDate()-C.getDay());
case 864E5:C.setHours(0);case 36E5:C.setMinutes(0);case 6E4:C.setSeconds(0);case 1E3:C.setMilliseconds(0)}}var y,B,z=1;if(t>=15768E7){y=31536E6;u="%Y";B=function(C){C.setFullYear(C.getFullYear()+z)}}else if(t>=1296E7){y=2592E6;u="%m/%Y";B=function(C){C.setMonth(C.getMonth()+z)}}else if(t>=3024E6){y=6048E5;u="%m/%d";B=function(C){C.setDate(C.getDate()+7*z)}}else if(t>=432E6){y=864E5;u="%m/%d";B=function(C){C.setDate(C.getDate()+z)}}else if(t>=18E6){y=36E5;u="%I:%M %p";B=function(C){C.setHours(C.getHours()+
z)}}else if(t>=3E5){y=6E4;u="%I:%M %p";B=function(C){C.setMinutes(C.getMinutes()+z)}}else if(t>=5E3){y=1E3;u="%I:%M:%S";B=function(C){C.setSeconds(C.getSeconds()+z)}}else{y=1;u="%S.%Qs";B=function(C){C.setTime(C.getTime()+z)}}y=o?o:y;u=p?p:u;q=y;n=pv.Format.date(u);w=new Date(w);u=[];A(w,y);t=t/y;if(t>10)switch(y){case 36E5:z=t>20?6:3;w.setHours(Math.floor(w.getHours()/z)*z);break;case 2592E6:z=t>24?3:t>12?2:1;w.setMonth(Math.floor(w.getMonth()/z)*z);break;case 6048E5:z=t>15?3:t>10?2:1;w.setDate(Math.floor(w.getDate()/
(7*z))*7*z);break;case 864E5:z=t>=30?5:t>=15?3:2;w.setDate(Math.floor(w.getDate()/z)*z);break;case 6E4:z=t>30?15:t>15?10:5;w.setMinutes(Math.floor(w.getMinutes()/z)*z);break;case 1E3:z=t>90?15:t>60?10:5;w.setSeconds(Math.floor(w.getSeconds()/z)*z);break;case 1:z=t>1E3?250:t>200?100:t>100?50:t>50?25:5;w.setMilliseconds(Math.floor(w.getMilliseconds()/z)*z);break;default:z=pv.logCeil(t/15,10);if(t/z<2)z/=5;else if(t/z<5)z/=2;w.setFullYear(Math.floor(w.getFullYear()/z)*z);break}if(o){z=1;B=function(C){C.setSeconds(C.getSeconds()+
z*o/1E3)}}for(;;){B(w);if(w>s)break;u.push(new Date(w))}return x?u.reverse():u}if(v==null)v=10;y=pv.get(u,"roundInside",true);B=pv.get(u,"numberExponentMin",-Infinity);u=pv.get(u,"numberExponentMax",+Infinity);var D=Math.floor(pv.log(t/v,10)),F=false;if(D>u){D=u;F=true}else if(D<B){D=B;F=true}z=Math.pow(10,D);t=v/(t/z);if(t<=0.15&&D<u-1)z*=10;else if(t<=0.35)z*=5;else if(t<=0.75)z*=2;D=Math.floor(pv.log(z,10)+1.0E-10);t=z*Math[y?"ceil":"floor"](w/z);s=z*Math[y?"floor":"ceil"](s/z);r=Math.max(0,-D);
n=pv.Format.number().fractionDigits(r);s=pv.range(t,s+z,z);x&&s.reverse();s.roundInside=y;s.step=z;s.exponent=D;s.exponentOverflow=F;s.exponentMin=B;s.exponentMax=u;return s};c.dateTickFormat=function(){if(arguments.length){p=arguments[0];return this}return p};c.dateTickPrecision=function(){if(arguments.length){o=arguments[0];return this}return o};c.tickFormatter=function(v){if(arguments.length){m=v;return this}return m};c.tickFormat=function(v){v=m?m(v,i!==Number?q:r):n(v);return v==null?"":""+v};
c.nice=function(){if(e.length!=2)return this;var v=e[0],u=e[e.length-1],t=u<v,s=t?u:v;v=t?v:u;u=v-s;if(!u||!isFinite(u))return this;u=Math.pow(10,Math.round(Math.log(u)/Math.log(10))-1);e=[Math.floor(s/u)*u,Math.ceil(v/u)*u];t&&e.reverse();d=e.map(k);return this};pv.copyOwn(c,pv.Scale.common);c.domain.apply(c,arguments);return c};pv.Scale.linear=function(){var b=pv.Scale.quantitative();b.domain.apply(b,arguments);return b};
pv.Scale.log=function(){var b=pv.Scale.quantitative(1,10),c,e,d=function(h){return Math.log(h)/e},g=function(h){return Math.pow(c,h)};b.ticks=function(){var h=b.domain(),i=h[0]<0,j=Math.floor(i?-d(-h[0]):d(h[0])),k=Math.ceil(i?-d(-h[1]):d(h[1])),l=[];if(i)for(l.push(-g(-j));j++<k;)for(i=c-1;i>0;i--)l.push(-g(-j)*i);else{for(;j<k;j++)for(i=1;i<c;i++)l.push(g(j)*i);l.push(g(j))}for(j=0;l[j]<h[0];j++);for(k=l.length;l[k-1]>h[1];k--);return l.slice(j,k)};b.tickFormat=function(h){return h.toPrecision(1)};
b.nice=function(){var h=b.domain();return b.domain(pv.logFloor(h[0],c),pv.logCeil(h[1],c))};b.base=function(h){if(arguments.length){c=Number(h);e=Math.log(c);b.transform(d,g);return this}return c};b.domain.apply(b,arguments);return b.base(10)};pv.Scale.root=function(){var b=pv.Scale.quantitative();b.power=function(c){if(arguments.length){var e=Number(c),d=1/e;b.transform(function(g){return Math.pow(g,d)},function(g){return Math.pow(g,e)});return this}return e};b.domain.apply(b,arguments);return b.power(2)};
pv.Scale.ordinal=function(){function b(g){g in e||(e[g]=c.push(g)-1);return d[e[g]%d.length]}var c=[],e={},d=[];b.domain=function(g,h){if(arguments.length){g=g instanceof Array?arguments.length>1?pv.map(g,h):g:Array.prototype.slice.call(arguments);c=[];for(var i={},j=0;j<g.length;j++){var k=g[j];if(!(k in i)){i[k]=true;c.push(k)}}e=pv.numerate(c);return this}return c};b.range=function(g,h){if(arguments.length){d=g instanceof Array?arguments.length>1?pv.map(g,h):g:Array.prototype.slice.call(arguments);
if(typeof d[0]=="string")d=d.map(pv.color);d.min=d[0];d.max=d[d.length-1];return this}return d};b.split=function(g,h){var i=h-g,j=this.domain().length,k=0;if(i===0)d=pv.array(j,g);else if(j){k=(h-g)/j;d=pv.range(g+k/2,h,k)}d.min=g;d.max=h;d.step=k;return this};b.splitBandedCenter=function(g,h,i){b.split(g,h);if(i==null)i=1;d.band=d.step*i;d.margin=d.step-d.band;d.min=g;d.max=h;return this};b.splitBandedFlushCenter=function(g,h,i){if(i==null)i=1;var j=h-g,k=this.domain().length,l=0,n=0,m=0;if(j===
0)d=pv.array(k,g);else if(k){n=j*i/k;m=k>1?(j-k*n)/(k-1):0;l=m+n;d=pv.range(g+n/2,h,l)}d.step=l;d.band=n;d.margin=m;d.min=g;d.max=h;return this};b.splitFlush=function(g,h){var i=this.domain().length,j=(h-g)/(i-1);d=i==1?[(g+h)/2]:pv.range(g,h+j/2,j);d.min=g;d.max=h;return this};b.splitBanded=function(g,h,i){if(arguments.length<3)i=1;if(i<0){var j=this.domain().length;j=(h-g- -i*j)/(j+1);d=pv.range(g+j,h,j-i);d.band=-i}else{j=(h-g)/(this.domain().length+(1-i));d=pv.range(g+j*(1-i),h,j);d.band=j*i;
d.step=j;d.margin=j-d.band}d.min=g;d.max=h;return this};b.invertIndex=function(g,h){var i=this.domain().length;if(i===0)return-1;var j=this.range(),k=j.max-j.min;if(k===0)return 0;if(g>=j.max)return i;if(g<j.min)return 0;g=(g-j.min)/(k/i);return h?g:Math.round(g)};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);return b};
pv.Scale.quantile=function(){function b(i){return h(Math.max(0,Math.min(e,pv.search.index(d,i)-1))/e)}var c=-1,e=-1,d=[],g=[],h=pv.Scale.linear();b.quantiles=function(i){if(arguments.length){c=Number(i);if(c<0){d=[g[0]].concat(g);e=g.length-1}else{d=[];d[0]=g[0];for(var j=1;j<=c;j++)d[j]=g[~~(j*(g.length-1)/c)];e=c-1}return this}return d};b.domain=function(i,j){if(arguments.length){g=i instanceof Array?pv.map(i,j):Array.prototype.slice.call(arguments);g.sort(pv.naturalOrder);b.quantiles(c);return this}return g};
b.range=function(){if(arguments.length){h.range.apply(h,arguments);return this}return h.range()};pv.copyOwn(b,pv.Scale.common);b.domain.apply(b,arguments);return b};
pv.histogram=function(b,c){var e=true;return{bins:function(d){var g=pv.map(b,c),h=[];arguments.length||(d=pv.Scale.linear(g).ticks());for(var i=0;i<d.length-1;i++){var j=h[i]=[];j.x=d[i];j.dx=d[i+1]-d[i];j.y=0}for(i=0;i<g.length;i++){j=pv.search.index(d,g[i])-1;j=h[Math.max(0,Math.min(h.length-1,j))];j.y++;j.push(b[i])}if(!e)for(i=0;i<h.length;i++)h[i].y/=g.length;return h},frequency:function(d){if(arguments.length){e=Boolean(d);return this}return e}}};
(function(){pv.Shape=function(){};var b={x:1,y:1};pv.Shape.dist2=function(d,g,h){h=h||b;var i=d.x-g.x;d=d.y-g.y;i=i*i;d=d*d;return{cost:i+d,dist2:h.x*i+h.y*d}};var c=2*Math.PI,e=Math.atan2;pv.Shape.normalizeAngle=function(d){d%=c;if(d<0)d+=c;return d};pv.Shape.atan2Norm=function(d,g){d=e(d,g);if(d<0)d+=c;return d};pv.Shape.prototype.hasArea=function(){return true}})();
(function(){var b=pv.Shape.dist2,c=Math.cos,e=Math.sin,d=Math.sqrt;pv.vector=function(h,i){return new g(h,i)};pv.Vector=function(h,i){this.x=h;this.y=i};var g=pv.Shape.Point=pv.Vector;pv.Vector.prototype=pv.extend(pv.Shape);pv.Vector.prototype.perp=function(){return new g(-this.y,this.x)};pv.Vector.prototype.rotate=function(h){var i=c(h);h=e(h);return new g(i*this.x-h*this.y,h*this.x+i*this.y)};pv.Vector.prototype.norm=function(){var h=this.length();return this.times(h?1/h:1)};pv.Vector.prototype.length=
function(){return d(this.x*this.x+this.y*this.y)};pv.Vector.prototype.times=function(h){return new g(this.x*h,this.y*h)};pv.Vector.prototype.plus=function(h,i){return arguments.length==1?new g(this.x+h.x,this.y+h.y):new g(this.x+h,this.y+i)};pv.Vector.prototype.minus=function(h,i){return arguments.length==1?new g(this.x-h.x,this.y-h.y):new g(this.x-h,this.y-i)};pv.Vector.prototype.dot=function(h,i){return arguments.length==1?this.x*h.x+this.y*h.y:this.x*h+this.y*i};pv.Vector.prototype.hasArea=function(){return false};
pv.Vector.prototype.clone=function(){return new g(this.x,this.y)};pv.Vector.prototype.apply=function(h){return new g(h.x+h.k*this.x,h.y+h.k*this.y)};pv.Vector.prototype.intersectsRect=function(h){return this.x>=h.x&&this.x<=h.x2&&this.y>=h.y&&this.y<=h.y2};pv.Vector.prototype.containsPoint=function(h){return this.x===h.x&&this.y===h.y};pv.Vector.prototype.points=function(){return[this]};pv.Vector.prototype.edges=function(){return[]};pv.Vector.prototype.center=function(){return this};pv.Vector.prototype.distance2=
function(h,i){return b(this,h,i)}})();
(function(){var b=pv.Shape.Point,c=pv.Shape.dist2;pv.Shape.Line=function(d,g,h,i){this.x=d||0;this.y=g||0;this.x2=h||0;this.y2=i||0};var e=pv.Shape.Line;e.prototype=pv.extend(pv.Shape);e.prototype.hasArea=function(){return false};e.prototype.clone=function(){return new e(this.x,this.y,this.x2,this.x2)};e.prototype.apply=function(d){return new e(d.x+d.k*this.x,d.y+d.k*this.y,d.x+d.k*this.x2,d.y+d.k*this.y2)};e.prototype.points=function(){return[new b(this.x,this.y),new b(this.x2,this.y2)]};e.prototype.edges=
function(){return[this]};e.prototype.center=function(){return new b((this.x+this.x2)/2,(this.y+this.y2)/2)};e.prototype.normal=function(d,g){d=this.points();var h=d[1].minus(d[0]).perp().norm();if(g)if(d[0].minus(g).dot(h)<0)h=h.times(-1);return h};e.prototype.intersectsRect=function(d){var g,h,i=this.points();h=i.length;for(g=0;g<h;g++)if(i[g].intersectsRect(d))return true;d=d.edges();h=d.length;for(g=0;g<h;g++)if(this.intersectsLine(d[g]))return true;return false};e.prototype.containsPoint=function(d){var g=
this.x,h=this.x2,i=this.y,j=this.y2;return g<=d.x&&d.x<=h&&(g===h?Math.min(i,j)<=d.y&&d.y<=Math.max(i,j):Math.abs((j-i)/(h-g)*(d.x-g)+i-d.y)<=1.0E-10)};e.prototype.intersectsLine=function(d){var g=this,h=g.x2-g.x,i=g.y2-g.y,j=d.x2-d.x,k=d.y2-d.y,l=k*h-j*i;if(l===0)return false;var n=g.y-d.y;d=g.x-d.x;j=j*n-k*d;h=h*n-i*d;if(l===0)return j===0&&h===0;i=j/l;if(i<0||i>1)return false;l=h/l;if(l<0||l>1)return false;return true};e.prototype.distance2=function(d,g){var h=this,i={x:this.x2,y:this.y2},j=c(h,
i).dist2;if(j<=1.0E-10)return c(d,h,g);var k=i.x-h.x,l=i.y-h.y;j=((d.x-h.x)*k+(d.y-h.y)*l)/j;if(j<0)return c(d,h,g);if(j>1)return c(d,i,g);return c(d,{x:h.x+j*k,y:h.y+j*l},g)}})();
(function(){var b=pv.Shape.Point,c=pv.Shape.Line;pv.Shape.Polygon=function(d){this._points=d||[]};var e=pv.Shape.Polygon;e.prototype=pv.extend(pv.Shape);e.prototype.points=function(){return this._points};e.prototype.clone=function(){return new e(this.points().slice())};e.prototype.apply=function(d){for(var g=this.points(),h=g.length,i=new Array(h),j=0;j<h;j++)i[j]=g[j].apply(d);return new e(i)};e.prototype.intersectsRect=function(d){var g,h,i=this.points();h=i.length;for(g=0;g<h;g++)if(i[g].intersectsRect(d))return true;
i=this.edges();h=i.length;for(g=0;g<h;g++)if(i[g].intersectsRect(d))return true;return false};e.prototype.edges=function(){var d=this._edges;if(!d){d=this._edges=[];var g=this.points(),h=g.length;if(h){for(var i=g[0],j=i,k,l=1;l<h;l++){k=g[l];d.push(new c(i.x,i.y,k.x,k.y));i=k}h>2&&d.push(new c(k.x,k.y,j.x,j.y))}}return d};e.prototype.distance2=function(d,g){var h={cost:Infinity,dist2:Infinity};this.edges().forEach(function(i){i=i.distance2(d,g);if(i.cost<h.cost)h=i},this);return h};e.prototype.center=
function(){for(var d=this.points(),g=0,h=0,i=0,j=d.length;i<j;i++){var k=d[i];g+=k.x;h+=k.y}return new b(g/j,h/j)};e.prototype.containsPoint=function(d){var g=this.bbox();if(!g.containsPoint(d))return false;var h=new c(g.x-g.dx*0.01,d.y,d.x,d.y),i=0;this.edges().forEach(function(j){j.intersectsLine(h)&&i++});return(i&1)===1};e.prototype.bbox=function(){var d=this._bbox;if(!d){var g,h;this.points().forEach(function(i){if(g==null)g={x:i.x,y:i.y};else{if(i.x<g.x)g.x=i.x;if(i.y<g.y)g.y=i.y}if(h==null)h=
{x:i.x,y:i.y};else{if(i.x>h.x)h.x=i.x;if(i.y>h.y)h.y=i.y}});if(g)d=this._bbox=new pv.Shape.Rect(g.x,g.y,h.x-g.x,h.y-g.y)}return d}})();
(function(){var b=pv.Shape.Point,c=pv.Shape.Line;pv.Shape.Rect=function(d,g,h,i){this.x=d||0;this.y=g||0;this.dx=h||0;this.dy=i||0;if(this.dx<0){this.dx=-this.dx;this.x-=this.dx}if(this.dy<0){this.dy=-this.dy;this.y-=this.dy}this.x2=this.x+this.dx;this.y2=this.y+this.dy};var e=pv.Shape.Rect;e.prototype=pv.extend(pv.Shape.Polygon);e.prototype.clone=function(){var d=Object.create(e.prototype);d.x=this.x;d.y=this.y;d.dx=this.dx;d.dy=this.dy;d.x2=this.x2;d.y2=this.y2;return d};e.prototype.apply=function(d){return new e(d.x+
d.k*this.x,d.y+d.k*this.y,d.k*this.dx,d.k*this.dy)};e.prototype.containsPoint=function(d){return this.x<=d.x&&d.x<=this.x2&&this.y<=d.y&&d.y<=this.y2};e.prototype.intersectsRect=function(d){return this.x2>d.x&&this.x<d.x2&&this.y2>d.y&&this.y<d.y2};e.prototype.edges=function(){if(!this._edges){var d=this.x,g=this.y,h=this.x2,i=this.y2;this._edges=[new c(d,g,h,g),new c(h,g,h,i),new c(h,i,d,i),new c(d,i,d,g)]}return this._edges};e.prototype.center=function(){return new b(this.x+this.dx/2,this.y+this.dy/
2)};e.prototype.points=function(){var d=this._points;if(!d){d=this.x;var g=this.y,h=this.x2,i=this.y2;d=this._points=[new b(d,g),new b(h,g),new b(h,i),new b(d,i)]}return d};e.prototype.bbox=function(){return this.clone()}})();
(function(){var b=pv.Shape.Point,c=pv.Shape.dist2,e=Math.sqrt,d=Math.abs,g=Math.pow;pv.Shape.Circle=function(i,j,k){this.x=i||0;this.y=j||0;this.radius=k||0};var h=pv.Shape.Circle;h.prototype=pv.extend(pv.Shape);h.prototype.clone=function(){return new h(this.x,this.y,this.radius)};h.prototype.apply=function(i){return new h(i.x+i.k*this.x,i.y+i.k*this.y,i.k*this.radius)};h.prototype.intersectsRect=function(i){var j=i.dx/2,k=i.dy/2,l=this.radius,n=d(this.x-i.x-j);i=d(this.y-i.y-k);if(n>j+l||i>k+l)return false;
if(n<=j||i<=k)return true;return g(n-j,2)+g(i-k,2)<=l*l};h.prototype.intersectLine=function(i,j){var k=i.x2-i.x,l=i.y2-i.y,n=this.x-i.x,m=this.y-i.y,p=k*k+l*l,o=this.radius,q=(k*n+l*m)/p;n=q*q-(n*n+m*m-o*o)/p;if(!(n<0)){p=e(n);m=q-p;q=q+p;p=[];if(j||m>=0&&m<=1)p.push(new b(i.x+k*m,i.y+l*m));if(n!==0)if(j||q>=0&&q<=1)p.push(new b(i.x+k*q,i.y+l*q));return p}};h.prototype.points=function(){return[this.center()]};h.prototype.center=function(){return new b(this.x,this.y)};h.prototype.normal=function(i){return i.minus(this.x,
this.y).norm()};h.prototype.containsPoint=function(i){var j=i.x-this.x;i=i.y-this.y;var k=this.radius;return j*j+i*i<=k*k};h.prototype.distance2=function(i,j){var k=this.radius;k=i.minus(this).norm().times(k).plus(this);return c(i,k,j)}})();
(function(){var b=pv.Shape.Point,c=pv.Shape.dist2,e=pv.Shape.normalizeAngle,d=pv.Shape.atan2Norm,g=Math.cos,h=Math.sin,i=Math.sqrt;pv.Shape.Arc=function(l,n,m,p,o){this.x=l;this.y=n;this.radius=m;this.startAngle=e(p);this.angleSpan=e(o);this.endAngle=this.startAngle+this.angleSpan};var j=pv.Shape.Arc;j.prototype=pv.extend(pv.Shape);j.prototype.hasArea=function(){return false};j.prototype.clone=function(){var l=Object.create(j.prototype),n=this;l.x=n.x;l.y=n.y;l.radius=n.radius;l.startAngle=n.startAngle;
l.angleSpan=n.angleSpan;l.endAngle=n.endAngle;return l};j.prototype.apply=function(l){return new j(l.x+l.k*this.x,l.y+l.k*this.y,l.k*this.radius,this.startAngle,this.angleSpan)};j.prototype.containsPoint=function(l){var n=l.x-this.x;l=l.y-this.y;var m=i(n*n+l*l);if(Math.abs(m-this.radius)<=1.0E-10){n=d(l,n);return this.startAngle<=n&&n<=this.endAngle}return false};j.prototype.intersectsRect=function(l){var n,m,p=this.points();m=p.length;for(n=0;n<m;n++)if(p[n].intersectsRect(l))return true;l=l.edges();
m=l.length;for(n=0;n<m;n++)if(this.intersectLine(l[n]))return true;return false};var k=pv.Shape.Circle.prototype.intersectLine;j.prototype.intersectLine=function(l,n){if(l=k.call(this,l,n)){l=l.filter(function(m){return this.containsPoint(m)},this);if(l.length)return l}};j.prototype.points=function(){var l=this.x,n=this.y,m=this.radius,p=this.startAngle,o=this.endAngle;return[new b(l+m*g(p),n+m*h(p)),new b(l+m*g(o),n+m*h(o))]};j.prototype.center=function(){var l=this.y,n=this.radius,m=(this.startAngle+
this.endAngle)/2;return new b(this.x+n*g(m),l+n*h(m))};j.prototype.normal=function(l,n){l=l.minus(this.x,this.y).norm();if(n)if(this.center().minus(n).dot(l)<0)l=l.times(-1);return l};j.prototype.distance2=function(l,n){var m=d(l.y-this.y,l.x-this.x);if(this.startAngle<=m&&m<=this.endAngle){m=new b(this.x+this.radius*g(m),this.y+this.radius*h(m));return c(l,m,n)}var p=this.points();m=c(l,p[0],n);l=c(l,p[1],n);return m.cost<l.cost?m:l}})();
(function(){var b=pv.Shape.Arc,c=pv.Shape.Line,e=pv.Shape.Point,d=Math.cos,g=Math.sin,h=Math.sqrt,i=pv.Shape.atan2Norm,j=pv.Shape.normalizeAngle;pv.Shape.Wedge=function(l,n,m,p,o,q){this.x=l;this.y=n;this.innerRadius=m;this.outerRadius=p;this.startAngle=j(o);this.angleSpan=j(q);this.endAngle=this.startAngle+this.angleSpan};var k=pv.Shape.Wedge;k.prototype=pv.extend(pv.Shape);k.prototype.clone=function(){return new k(this.x,this.y,this.innerRadius,this.outerRadius,this.startAngle,this.angleSpan)};
k.prototype.apply=function(l){return new k(l.x+l.k*this.x,l.y+l.k*this.y,l.k*this.innerRadius,l.k*this.outerRadius,this.startAngle,this.angleSpan)};k.prototype.containsPoint=function(l){var n=l.x-this.x;l=l.y-this.y;var m=h(n*n+l*l);if(m>=this.innerRadius&&m<=this.outerRadius){n=i(l,n);return this.startAngle<=n&&n<=this.endAngle}return false};k.prototype.intersectsRect=function(l){var n,m,p=this.points();m=p.length;for(n=0;n<m;n++)if(p[n].intersectsRect(l))return true;p=l.points();m=p.length;for(n=
0;n<m;n++)if(this.containsPoint(p[n]))return true;p=this.edges();m=p.length;for(n=0;n<m;n++)if(p[n].intersectsRect(l))return true;return false};k.prototype.points=function(){this._points||this.edges();return this._points};k.prototype.edges=function(){var l=this._edges;if(!l){var n=this.x,m=this.y,p=this.innerRadius,o=this.outerRadius,q=this.startAngle,r=this.endAngle,v=this.angleSpan,u=d(q),t=g(q);l=d(r);var s=g(r),x;if(p>0){x=new e(n+p*u,m+p*t);r=new e(n+p*l,m+p*s)}else x=r=new e(n,m);u=new e(n+
o*u,m+o*t);t=new e(n+o*l,m+o*s);l=this._edges=[];p>0&&l.push(new b(n,m,p,q,v));l.push(new c(x.x,x.y,u.x,u.y),new b(n,m,o,q,v),new c(r.x,r.y,t.x,t.y));n=this._points=[x,u,t];p>0&&n.push(r)}return l};k.prototype.distance2=function(l,n){var m={cost:Infinity,dist2:Infinity};this.edges().forEach(function(p){p=p.distance2(l,n);if(p.cost<m.cost)m=p});return m};k.prototype.center=function(){var l=(this.startAngle+this.endAngle)/2,n=(this.innerRadius+this.outerRadius)/2;return new e(this.x+n*d(l),this.y+n*
g(l))}})();
pv.color=function(b){if(b.rgb)return b.rgb();var c=/([a-z]+)\((.*)\)/i.exec(b);if(c){var e=c[2].split(","),d=1;switch(c[1]){case "hsla":case "rgba":d=parseFloat(e[3]);if(!d)return pv.Color.transparent;break}switch(c[1]){case "hsla":case "hsl":b=parseFloat(e[0]);var g=parseFloat(e[1])/100;e=parseFloat(e[2])/100;return(new pv.Color.Hsl(b,g,e,d)).rgb();case "rgba":case "rgb":function h(k){var l=parseFloat(k);return k[k.length-1]=="%"?Math.round(l*2.55):l}g=h(e[0]);var i=h(e[1]),j=h(e[2]);return pv.rgb(g,
i,j,d)}}if(d=pv.Color.names[b])return d;if(b.charAt(0)=="#"){if(b.length==4){g=b.charAt(1);g+=g;i=b.charAt(2);i+=i;j=b.charAt(3);j+=j}else if(b.length==7){g=b.substring(1,3);i=b.substring(3,5);j=b.substring(5,7)}return pv.rgb(parseInt(g,16),parseInt(i,16),parseInt(j,16),1)}return new pv.Color(b,1)};pv.Color=function(b,c){this.color=b;this.opacity=c;this.key="solid "+b+" alpha("+c+")"};a=pv.Color.prototype;a.hsl=function(){return this.rgb().hsl()};a.brighter=function(b){return this.rgb().brighter(b)};
a.darker=function(b){return this.rgb().darker(b)};a.alphaBlend=function(b){var c=this.rgb(),e=c.a;if(e===1)return this;b=b?pv.color(b):pv.Color.names.white;b=b.rgb();var d=1-e;return pv.rgb(d*c.r+e*b.r,d*c.g+e*b.g,d*c.b+e*b.b,1)};a.rgbDecimal=function(b){b=this.alphaBlend(b);return b.r<<16|b.g<<8|b.b};a.isDark=function(){return this.rgbDecimal()<8388607.5};pv.rgb=function(b,c,e,d){return new pv.Color.Rgb(b,c,e,arguments.length==4?d:1)};
pv.Color.Rgb=function(b,c,e,d){pv.Color.call(this,d?"rgb("+b+","+c+","+e+")":"none",d);this.r=b;this.g=c;this.b=e;this.a=d};pv.Color.Rgb.prototype=pv.extend(pv.Color);a=pv.Color.Rgb.prototype;a.red=function(b){return pv.rgb(b,this.g,this.b,this.a)};a.green=function(b){return pv.rgb(this.r,b,this.b,this.a)};a.blue=function(b){return pv.rgb(this.r,this.g,b,this.a)};a.alpha=function(b){return pv.rgb(this.r,this.g,this.b,b)};a.rgb=function(){return this};
a.brighter=function(b){b=Math.pow(0.7,b!=null?b:1);var c=this.r,e=this.g,d=this.b;if(!c&&!e&&!d)return pv.rgb(30,30,30,this.a);if(c&&c<30)c=30;if(e&&e<30)e=30;if(d&&d<30)d=30;return pv.rgb(Math.min(255,Math.floor(c/b)),Math.min(255,Math.floor(e/b)),Math.min(255,Math.floor(d/b)),this.a)};a.darker=function(b){b=Math.pow(0.7,b!=null?b:1);return pv.rgb(Math.max(0,Math.floor(b*this.r)),Math.max(0,Math.floor(b*this.g)),Math.max(0,Math.floor(b*this.b)),this.a)};
a.hsl=function(){var b=this.r/255,c=this.g/255,e=this.b/255,d=Math.max(b,c,e),g=Math.min(b,c,e),h=(d+g)/2,i;if(d===g)i=g=0;else{var j=d-g;g=h>0.5?j/(2-d-g):j/(d+g);switch(d){case b:i=(c-e)/j+(c<e?6:0);break;case c:i=(e-b)/j+2;break;case e:i=(b-c)/j+4;break}i/=6}return pv.hsl(i*360,g,h,this.a)};a.complementary=function(){return this.hsl().complementary().rgb()};pv.hsl=function(b,c,e,d){return new pv.Color.Hsl(b,c,e,arguments.length==4?d:1)};
pv.Color.Hsl=function(b,c,e,d){pv.Color.call(this,"hsl("+b+","+c*100+"%,"+e*100+"%)",d);this.h=b;this.s=c;this.l=e;this.a=d};pv.Color.Hsl.prototype=pv.extend(pv.Color);a=pv.Color.Hsl.prototype;a.hsl=function(){return this};a.hue=function(b){return pv.hsl(b,this.s,this.l,this.a)};a.saturation=function(b){return pv.hsl(this.h,b,this.l,this.a)};a.lightness=function(b){return pv.hsl(this.h,this.s,b,this.a)};a.alpha=function(b){return pv.hsl(this.h,this.s,this.l,b)};
a.complementary=function(){return pv.hsl((this.h+180)%360,1-this.s,1-this.l,this.a)};a.rgb=function(){function b(j){if(j>360)j-=360;else if(j<0)j+=360;if(j<60)return i+(h-i)*j/60;if(j<180)return h;if(j<240)return i+(h-i)*(240-j)/60;return i}function c(j){return Math.round(b(j)*255)}var e=this.h,d=this.s,g=this.l;e%=360;if(e<0)e+=360;d=Math.max(0,Math.min(d,1));g=Math.max(0,Math.min(g,1));var h=g<=0.5?g*(1+d):g+d-g*d,i=2*g-h;return pv.rgb(c(e+120),c(e),c(e-120),this.a)};
pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)};
(function(){var b=pv.Color.names;b.none=b.transparent;for(var c in b)b[c]=pv.color(b[c])})();pv.colors=function(){var b=pv.Scale.ordinal();b.range.apply(b,arguments);return b};pv.Colors={};pv.Colors.category10=function(){var b=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");b.domain.apply(b,arguments);return b};
pv.Colors.category20=function(){var b=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");b.domain.apply(b,arguments);return b};
pv.Colors.category19=function(){var b=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");b.domain.apply(b,arguments);return b};
(function(){function b(m){var p=e(m);if(!p.length)return null;var o=Math.PI,q,r=p[0];if(r.indexOf("to ")===0){if(q=/^to\s+(?:((top|bottom)(?:\s+(left|right))?)|((left|right)(?:\\s+(top|bottom))?))$/.exec(r)){if(q[1]){o=q[2];if(q[3])o+=" "+q[3]}else{o=q[5];if(q[6])o=q[6]+" "+o}o=pv.radians(g[o]);p.shift()}}else{q=parseFloat(r);if(!isNaN(q)){o=q;if(/^.*?deg$/.test(r))o=pv.radians(o);p.shift()}}p=d(p);switch(p.length){case 0:return null;case 1:return new pv.FillStyle.Solid(p[0].color,1)}return new pv.FillStyle.LinearGradient(o,
p,m)}function c(m){var p=e(m);if(!p.length)return null;p=d(p);switch(p.length){case 0:return null;case 1:return new pv.FillStyle.Solid(p[0].color,1)}return new pv.FillStyle.RadialGradient(50,50,p,m)}function e(m){var p={},o=0;m=m.replace(/\b\w+?\(.*?\)/g,function(r){var v="__color"+o++;p[v]=r;return v});var q=m.split(/\s*,\s*/);if(!q.length)return null;o&&q.forEach(function(r,v){if(p.hasOwnProperty(r))q[v]=p[r]});return q}function d(m){function p(y){var B=v.length;if(B){var z=r;y=(y-z)/(B+1);for(var D=
0;D<B;D++){z+=y;v[D].offset=z}v.length=0}}for(var o=[],q=+Infinity,r=-Infinity,v=[],u=0,t=m.length;u<t;){var s=/^(.+?)\s*([+\-]?[e\.\d]+%)?$/i.exec(m[u++]);if(s){var x={color:pv.color(s[1])};s=parseFloat(s[2]);if(isNaN(s))if(o.length){if(u===t)s=Math.max(r,100)}else s=0;o.push(x);if(isNaN(s))v.push(x);else{x.offset=s;p(s);if(s>r)r=s;else if(s<r)s=r;if(s<q)q=s}}}if(o.length>=2&&(q<0||r>100)){var w=[],A=[];o.forEach(function(y){w.push(y.offset);A.push(y.color)});m=pv.scale.linear().domain(w).range(A);
if(q<0){for(;o.length&&o[0].offset<=0;)o.shift();o.unshift({offset:0,color:m(0)})}if(r>100){for(;o.length&&o[o.length-1].offset>=100;)o.pop();o.push({offset:100,color:m(100)})}}return o}pv.fillStyle=function(m){if(m.type)return m;if(m.rgb)return new pv.FillStyle.Solid(m.color,m.opacity);var p=/^\s*([a-z\-]+)\(\s*(.*?)\s*\)\s*$/.exec(m);if(p)switch(p[1]){case "linear-gradient":return b(p[2]);case "radial-gradient":return c(p[2])}return new pv.FillStyle.Solid(pv.color(m))};var g={top:0,"top right":45,
right:90,"bottom right":135,bottom:180,"bottom left":225,left:270,"top left":315},h=pv.FillStyle=function(m){this.key=this.type=m};h.prototype=new pv.Color("none",1);h.prototype.rgb=function(){var m=pv.color(this.color);if(this.opacity!==m.opacity)m=m.alpha(this.opacity);return m};h.prototype.alphaBlend=function(m){return this.rgb().alphaBlend(m)};h.prototype.rgbDecimal=function(m){return this.rgb().rgbDecimal(m)};h.prototype.isDark=function(){return this.rgb().isDark()};var i=pv.FillStyle.Solid=
function(m,p){h.call(this,"solid");if(m.rgb){this.color=m.color;this.opacity=m.opacity}else{this.color=m;this.opacity=p}this.key+=" "+this.color+" alpha("+this.opacity+")"};i.prototype=pv.extend(pv.FillStyle);i.prototype.alpha=function(m){return new i(this.color,m)};i.prototype.brighter=function(m){return new i(this.rgb().brighter(m))};i.prototype.darker=function(m){return new i(this.rgb().darker(m))};i.prototype.complementary=function(){return new i(this.rgb().complementary())};pv.FillStyle.transparent=
new i(pv.Color.transparent);var j=0,k=pv.FillStyle.Gradient=function(m,p){h.call(this,m);this.id=++j;this.stops=p;if(p.length)this.color=p[0].color.color;this.key+=" stops("+p.map(function(o){var q=o.color;return q.color+" alpha("+q.opacity+") at("+o.offset+")"}).join(", ")+")"};k.prototype=pv.extend(pv.FillStyle);k.prototype.rgb=function(){return this.stops.length?this.stops[0].color:undefined};k.prototype.alpha=function(m){return this._clone(this.stops.map(function(p){return{offset:p.offset,color:p.color.alpha(m)}}))};
k.prototype.darker=function(m){return this._clone(this.stops.map(function(p){return{offset:p.offset,color:p.color.darker(m)}}))};k.prototype.brighter=function(m){return this._clone(this.stops.map(function(p){return{offset:p.offset,color:p.color.brighter(m)}}))};k.prototype.complementary=function(){return this._clone(this.stops.map(function(m){return{offset:m.offset,color:m.color.complementary()}}))};k.prototype.alphaBlend=function(m){return this._clone(this.stops.map(function(p){return{offset:p.offset,
color:p.color.alphaBlend(m)}}))};var l=pv.FillStyle.LinearGradient=function(m,p){k.call(this,"lineargradient",p);this.angle=m;this.key+=" angle("+m+")"};l.prototype=pv.extend(k);l.prototype._clone=function(m){return new l(this.angle,m)};var n=pv.FillStyle.RadialGradient=function(m,p,o){k.call(this,"radialgradient",o);this.cx=m;this.cy=p;this.key+=" center("+m+","+p+")"};n.prototype=pv.extend(k);n.prototype._clone=function(){return new n(this.cx,this.cy)}})();
pv.ramp=function(){var b=pv.Scale.linear();b.range.apply(b,arguments);return b};
pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter",
"stroke-linecap":"butt","stroke-miterlimit":8,"stroke-dasharray":"none"},css:{font:"10px sans-serif"}}};pv.SvgScene.updateAll=function(b){if(b.length&&b[0].reverse&&b.type!=="line"&&b.type!=="area"){for(var c=pv.extend(b),e=0,d=b.length-1;d>=0;e++,d--)c[e]=b[d];b=c}this.removeSiblings(this[b.type](b))};pv.SvgScene.create=function(b){return document.createElementNS(this.svg,b)};
pv.SvgScene.expect=function(b,c,e,d,g,h){var i;if(b){i=b.tagName;if(i==="defs"){if(b=b.nextSibling)i=b.tagName}else if(i==="a")b=b.firstChild}if(b){if(i!==c){c=this.create(c);b.parentNode.replaceChild(c,b);b=c}}else b=this.create(c);g&&this.setAttributes(b,g);h&&this.setStyle(b,h);return b};pv.SvgScene.setAttributes=function(b,c){var e=this.implicit.svg;for(var d in c){var g=c[d];g==null||g==e[d]?b.removeAttribute(d):b.setAttribute(d,g)}};
pv.SvgScene.setStyle=function(b,c){var e=this.implicit.css;switch(pv.renderer()){case "batik":for(var d in c){var g=c[d];g==null||g==e[d]?b.removeAttribute(d):b.style.setProperty(d,g)}break;case "svgweb":for(d in c){g=c[d];g==null||g==e[d]||(b.style[d]=g)}break;default:for(d in c){g=c[d];if(g==null||g==e[d])b.style.removeProperty(d);else b.style[d]=g}}};pv.SvgScene.append=function(b,c,e){b.$scene={scenes:c,index:e};b=this.title(b,c[e]);b.parentNode||c.$g.appendChild(b);return b.nextSibling};
pv.SvgScene.title=function(b,c){var e=b.parentNode;if(e&&e.tagName!="a")e=null;if(c.title){if(!e){e=this.create("a");e.setAttributeNS(this.xlink,"xlink:href","");b.parentNode&&b.parentNode.replaceChild(e,b);e.appendChild(b)}e.setAttributeNS(this.xlink,"xlink:title",c.title);for(var d=null,g=b.firstChild;g!=null;g=g.nextSibling)if(g.nodeName=="title"){d=g;break}if(d)d.removeChild(d.firstChild);else{d=this.create("title");b.appendChild(d)}pv.renderer()=="svgweb"?d.appendChild(document.createTextNode(c.title,
true)):d.appendChild(document.createTextNode(c.title));return e}e&&e.parentNode.replaceChild(b,e);return b};pv.SvgScene.dispatch=pv.listener(function(b){var c=b.target.$scene;if(c){var e=b.type;switch(e){case "DOMMouseScroll":e="mousewheel";b.wheel=-480*b.detail;break;case "mousewheel":b.wheel=(window.opera?12:1)*b.wheelDelta;break}if(pv.Mark.dispatch(e,c.scenes,c.index,b)){b.preventDefault();b.stopPropagation()}}});
pv.SvgScene.removeSiblings=function(b){for(;b;){var c=b.nextSibling;b.nodeName!=="defs"&&b.parentNode.removeChild(b);b=c}};pv.SvgScene.undefined=function(){};pv.SvgScene.removeFillStyleDefinitions=function(b){b=b.$g.getElementsByTagName("defs");if(b.length===1){b=pv.renderer()!=="batik"?b[0]:new cgg.element(b.item(0));for(var c=b.firstChild;c;){var e=c.nextSibling;if(c.nodeName=="linearGradient"||c.nodeName=="radialGradient")b.removeChild(c);c=e}}};
(function(){var b={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},c={shortdash:[3,1],shortdot:[1,1],shortdashdot:[3,1,1,1],shortdashdotdot:[3,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};pv.SvgScene.isStandardDashStyle=function(e){return c.hasOwnProperty(e)};pv.SvgScene.translateDashStyleAlias=function(e){return b.hasOwnProperty(e)?
b[e]:e};pv.SvgScene.parseDasharray=function(e){var d=e.strokeDasharray;if(d&&d!=="none"){d=this.translateDashStyleAlias(d);var g=c[d];d=g?g:d.split(/[\s,]+/);var h=e.lineWidth,i=(e.lineCap||"butt")==="butt";d=d.map(function(j,k){j=+j;if(!i)if(k%2)j++;else j-=1;if(j<=0)j=0.001;return j*h/this.scale},this).join(" ")}else d=null;return d}})();
(function(){function b(e){return Math.abs(e)<=1.0E-12?0:e}var c=0;pv.SvgScene.addFillStyleDefinition=function(e,d){if(!(!d.type||d.type==="solid")){var g=d.type==="lineargradient";if(g||d.type==="radialgradient"){var h=e.$g;e=h.getElementsByTagName("defs");h=e.length?pv.renderer()!=="batik"?e.item(0):new cgg.element(e.item(0)):h.appendChild(this.create("defs"));var i="__pv_gradient"+d.id;e=undefined;if(!e){e="__pv_gradient"+d.id+"_inst_"+ ++c;h=h.appendChild(this.create(g?"linearGradient":"radialGradient"));
h.setAttribute("id",e);h.setAttribute("class",i);if(g){i=d.angle-Math.PI/2;g=Math.abs(i%(Math.PI/2))-Math.PI/4;var j=Math.abs(Math.SQRT2/2*Math.cos(g));g=j*Math.cos(i);var k=j*Math.sin(i);i=b(0.5-g);j=b(0.5-k);g=b(0.5+g);k=b(0.5+k);h.setAttribute("x1",i);h.setAttribute("y1",j);h.setAttribute("x2",g);h.setAttribute("y2",k)}g=d.stops;i=0;for(j=g.length;i<j;i++){k=g[i];var l=h.appendChild(this.create("stop")),n=k.color;l.setAttribute("offset",k.offset+"%");l.setAttribute("stop-color",n.color);l.setAttribute("stop-opacity",
n.opacity+"")}d.color="url(#"+e+")"}}}}})();
pv.SvgScene.pathBasis=function(){function b(d,g,h,i,j){return{x:d[0]*g.left+d[1]*h.left+d[2]*i.left+d[3]*j.left,y:d[0]*g.top+d[1]*h.top+d[2]*i.top+d[3]*j.top}}var c=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],e=function(d,g,h,i){var j=b(c[1],d,g,h,i),k=b(c[2],d,g,h,i);d=b(c[3],d,g,h,i);return"C"+j.x+","+j.y+","+k.x+","+k.y+","+d.x+","+d.y};e.segment=function(d,g,h,i){var j=b(c[0],d,g,h,i),k=b(c[1],d,g,h,i),l=b(c[2],d,g,h,i);d=b(c[3],d,g,h,i);return["M"+j.x+","+j.y,"C"+k.x+","+k.y+
","+l.x+","+l.y+","+d.x+","+d.y]};return e}();pv.SvgScene.curveBasis=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";d="";var g=b[c],h=g,i=g,j=b[c+1];d+=this.pathBasis(g,h,i,j);for(c=c+2;c<=e;c++){g=h;h=i;i=j;j=b[c];d+=this.pathBasis(g,h,i,j)}d+=this.pathBasis(h,i,j,j);d+=this.pathBasis(i,j,j,j);return d};
pv.SvgScene.curveBasisSegments=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";d=[];var g=b[c],h=g,i=g,j=b[c+1],k=this.pathBasis.segment(g,h,i,j);g=h;h=i;i=j;j=b[c+2];k[1]+=this.pathBasis(g,h,i,j);d.push(k);for(c=c+3;c<=e;c++){g=h;h=i;i=j;j=b[c];d.push(this.pathBasis.segment(g,h,i,j))}b=this.pathBasis.segment(h,i,j,j);b[1]+=this.pathBasis(i,j,j,j);d.push(b);return d};
pv.SvgScene.curveHermite=function(b,c,e,d){var g;if(e==null){g=b.length;e=0}else g=d-e+1;d=c.length;if(d<1||g!==d&&g!==d+2)return"";var h=g!==d;g="";var i=b[e],j=b[e+1],k=c[0],l=k,n=e+1;if(h){g+="Q"+(j.left-k.x*2/3)+","+(j.top-k.y*2/3)+","+j.left+","+j.top;i=b[e+1];n=e+2}if(d>1){l=c[1];j=b[n];n++;g+="C"+(i.left+k.x)+","+(i.top+k.y)+","+(j.left-l.x)+","+(j.top-l.y)+","+j.left+","+j.top;for(e=2;e<d;e++,n++){j=b[n];l=c[e];g+="S"+(j.left-l.x)+","+(j.top-l.y)+","+j.left+","+j.top}}if(h){b=b[n];g+="Q"+
(j.left+l.x*2/3)+","+(j.top+l.y*2/3)+","+b.left+","+b.top}return g};
pv.SvgScene.curveHermiteSegments=function(b,c,e,d){var g;if(e==null){g=b.length;e=0}else g=d-e+1;d=c.length;if(d<1||g!==d&&g!==d+2)return[];var h=g!==d;g=[];var i=b[e],j=i,k=c[0],l=k,n=e+1;if(h){j=b[e+1];g.push(["M"+i.left+","+i.top,"Q"+(j.left-l.x*2/3)+","+(j.top-l.y*2/3)+","+j.left+","+j.top]);n=e+2}for(e=1;e<d;e++,n++){i=j;k=l;j=b[n];l=c[e];g.push(["M"+i.left+","+i.top,"C"+(i.left+k.x)+","+(i.top+k.y)+","+(j.left-l.x)+","+(j.top-l.y)+","+j.left+","+j.top])}if(h){b=b[n];g.push(["M"+j.left+","+j.top,
"Q"+(j.left+l.x*2/3)+","+(j.top+l.y*2/3)+","+b.left+","+b.top])}return g};pv.SvgScene.cardinalTangents=function(b,c,e,d){if(e==null){d=b.length;e=0;d=d-1}var g=[];c=(1-c)/2;var h=b[e],i=b[e+1],j=b[e+2];for(e=e+3;e<=d;e++){g.push({x:c*(j.left-h.left),y:c*(j.top-h.top)});h=i;i=j;j=b[e]}g.push({x:c*(j.left-h.left),y:c*(j.top-h.top)});return g};
pv.SvgScene.curveCardinal=function(b,c,e,d){var g;if(e==null){g=b.length;e=0;d=g-1}else g=d-e+1;if(g<=2)return"";return this.curveHermite(b,this.cardinalTangents(b,c,e,d),e,d)};pv.SvgScene.curveCardinalSegments=function(b,c,e,d){var g;if(e==null){g=b.length;e=0;d=g-1}else g=d-e+1;if(g<=2)return"";return this.curveHermiteSegments(b,this.cardinalTangents(b,c,e,d),e,d)};
pv.SvgScene.monotoneTangents=function(b,c,e){if(c==null){e=b.length;c=0}else e=e-c+1;var d=[],g=[],h=[],i=[],j=0,k;for(j=0;j<e-1;j++){k=c+j;var l=b[k+1].left-b[k].left;g[j]=Math.abs(l)<=1.0E-12?0:(b[k+1].top-b[k].top)/l}h[0]=g[0];i[0]=b[c+1].left-b[c].left;j=1;for(k=c+j;j<e-1;j++,k++){h[j]=(g[j-1]+g[j])/2;i[j]=(b[k+1].left-b[k-1].left)/2}h[j]=g[j-1];i[j]=b[k].left-b[k-1].left;for(j=0;j<e-1;j++)if(g[j]==0){h[j]=0;h[j+1]=0}for(j=0;j<e-1;j++)if(!(Math.abs(h[j])<1.0E-5||Math.abs(h[j+1])<1.0E-5)){b=h[j]/
g[j];c=h[j+1]/g[j];k=b*b+c*c;if(k>9){k=3/Math.sqrt(k);h[j]=k*b*g[j];h[j+1]=k*c*g[j]}}for(j=0;j<e;j++){g=1+h[j]*h[j];d.push({x:i[j]/3/g,y:h[j]*i[j]/3/g})}return d};pv.SvgScene.curveMonotone=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";return this.curveHermite(b,this.monotoneTangents(b,c,e),c,e)};
pv.SvgScene.curveMonotoneSegments=function(b,c,e){var d;if(c==null){d=b.length;c=0;e=d-1}else d=e-c+1;if(d<=2)return"";return this.curveHermiteSegments(b,this.monotoneTangents(b,c,e),c,e)};pv.SvgScene.area=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);var e=b.length;if(!e)return c;var d=b[0];if(d.segmented==="smart")return this.areaSegmentedSmart(c,b);if(d.segmented)return this.areaSegmentedFull(c,b);return this.areaFixed(c,b,0,e-1,true)};
pv.SvgScene.areaFixed=function(b,c,e,d,g){if(d-e+1===1)return this.lineAreaDot(b,c,e);var h=c[e];if(!h.visible)return b;var i=h.fillStyle,j=h.strokeStyle;if(!i.opacity&&!j.opacity)return b;this.addFillStyleDefinition(c,i);this.addFillStyleDefinition(c,j);var k=false,l=false,n=false,m=false,p=false;switch(h.interpolate){case "basis":k=true;break;case "cardinal":l=true;break;case "monotone":n=true;break;case "step-after":m=true;break;case "step-before":p=true;break}l=k||l||n;k=[];var o;for(n=e;n<=d;n++){o=
c[n];if(o.width||o.height){for(var q=n+1;q<=d;q++){o=c[q];if(!o.width&&!o.height)break}n>e&&!m&&n--;q<=d&&!p&&q++;k.push((l&&q-n>2?this.areaPathCurve:this.areaPathStraight).call(this,c,n,q-1,h));n=q-1}}if(!k.length)return b;d=j.opacity;b=this.expect(b,"path",c,e,{"shape-rendering":h.antialias?null:"crispEdges","pointer-events":g?h.events:"none",cursor:h.cursor,d:"M"+k.join("ZM")+"Z",fill:i.color,"fill-opacity":i.opacity||null,stroke:j.color,"stroke-opacity":d||null,"stroke-width":d?h.lineWidth/this.scale:
null,"stroke-linecap":h.lineCap,"stroke-linejoin":h.lineJoin,"stroke-miterlimit":h.strokeMiterLimit,"stroke-dasharray":d?this.parseDasharray(h):null});h.svg&&this.setAttributes(b,h.svg);h.css&&this.setStyle(b,h.css);return this.append(b,c,e)};
pv.SvgScene.areaSegmentedSmart=function(b,c){b||(b=c.$g.appendChild(this.create("g")));var e=b;b=e.firstChild;var d=this.expect(b,"g",c,0,{"pointer-events":"none"});d.parentNode||e.appendChild(d);c.$g=d;b=d.firstChild;var g=c.mark.$hasHandlers?[]:null;b=this.eachLineAreaSegment(b,c,function(i,j,k,l){var n=this.areaSegmentPaths(j,k,l),m=n.top,p=n.bottom;g&&g.push(n);return this.eachLineAreaSegment(i,j,{breakOnKeyChange:true,from:k,to:l},function(o,q,r,v){var u=q[r],t=u.fillStyle,s=u.strokeStyle;this.addFillStyleDefinition(q,
t);this.addFillStyleDefinition(q,s);if(r===v)return this.lineAreaDotAlone(o,q,r);v=this.areaJoinPaths(m,p,r-r,v-r-1);var x=s.opacity;t={"shape-rendering":u.antialias?null:"crispEdges","pointer-events":"none",cursor:u.cursor,d:v,fill:t.color,"fill-opacity":t.opacity||null,stroke:s.color,"stroke-opacity":x||null,"stroke-width":x?u.lineWidth/this.scale:null,"stroke-linecap":u.lineCap,"stroke-linejoin":u.lineJoin,"stroke-miterlimit":u.strokeMiterLimit,"stroke-dasharray":x?this.parseDasharray(u):null};
o=this.expect(o,"path",q,r,t,u.css);return this.append(o,q,r)})});this.removeSiblings(b);var h;if(g){b=d.nextSibling;h=this.expect(b,"g",c,0);h.parentNode||e.appendChild(h);c.$g=h;b=h.firstChild;g.forEach(function(i){var j=i.from,k=i.top,l=i.bottom,n=k.length,m={"shape-rendering":"crispEdges",fill:"rgb(127,127,127)","fill-opacity":0.005,stroke:null};k.forEach(function(p,o){var q=j+o,r=c[q],v=r.events;if(v&&v!=="none"){o=l[n-o-1];var u=Object.create(m);u["pointer-events"]=v;u.cursor=r.cursor;u.d=p.join("")+
"L"+o[0].substr(1)+o[1]+"Z";b=this.expect(b,"path",c,q,u);b=this.append(b,c,q)}},this)},this);this.removeSiblings(b)}c.$g=e;return(h||d).nextSibling};pv.SvgScene.areaSegmentPaths=function(b,c,e){return this.areaSegmentCurvePaths(b,c,e)||this.areaSegmentStraightPaths(b,c,e)};
pv.SvgScene.areaSegmentCurvePaths=function(b,c,e){var d=e-c+1,g=b[c],h=g.interpolate==="basis",i=!h&&g.interpolate==="cardinal";if(h||i||g.interpolate=="monotone"){for(var j=[],k=[],l=0;l<d;l++){var n=b[e-l];j.push(b[c+l]);k.push({left:n.left+n.width,top:n.top+n.height})}if(h){b=this.curveBasisSegments(j);g=this.curveBasisSegments(k)}else if(i){b=this.curveCardinalSegments(j,g.tension);g=this.curveCardinalSegments(k,g.tension)}else{b=this.curveMonotoneSegments(j);g=this.curveMonotoneSegments(k)}if(b||
b.length)return{from:c,top:b,bottom:g}}};pv.SvgScene.areaSegmentStraightPaths=function(b,c,e){for(var d=[],g=[],h=e,i=c;c<h;c++,e--){var j=b[c],k=b[e],l=["M"+j.left+","+j.top];k=["M"+(k.left+k.width)+","+(k.top+k.height)];var n=b[c+1],m=b[e-1];switch(j.interpolate){case "step-before":l.push("V"+n.top+"H"+n.left);break;case "step-after":l.push("H"+n.left+"V"+n.top);break;default:l.push("L"+n.left+","+n.top)}k.push("L"+(m.left+m.width)+","+(m.top+m.height));d.push(l);g.push(k)}return{from:i,top:d,bottom:g}};
pv.SvgScene.areaJoinPaths=function(b,c,e,d){for(var g="",h="",i=e,j=b.length-1-d;i<=d;i++,j++){var k=b[i],l=c[j];if(i===e){k=k.join("");l="L"+l[0].substr(1)+l[1]}else{k=k[1];l=l[1]}g+=k;h+=l}return g+h+"Z"};
pv.SvgScene.areaSegmentedFull=function(b,c){var e=c.length,d,g,h=this.areaSegmentCurvePaths(c,0,e-1);if(h){d=h.top;g=h.bottom}for(h=0;h<e-1;h++){var i=c[h],j=c[h+1];if(i.visible&&j.visible){var k=i.fillStyle,l=i.strokeStyle;if(k.opacity||l.opacity){if(d){j=d[h].join("");var n="L"+g[e-h-2].join("").substr(1);j=j+n+"Z"}else{n=i;var m=j;switch(i.interpolate){case "step-before":n=j;break;case "step-after":m=i;break}j="M"+i.left+","+n.top+"L"+j.left+","+m.top+"L"+(j.left+j.width)+","+(m.top+m.height)+
"L"+(i.left+i.width)+","+(n.top+n.height)+"Z"}b=this.expect(b,"path",c,h,{"shape-rendering":i.antialias?null:"crispEdges","pointer-events":i.events,cursor:i.cursor,d:j,fill:k.color,"fill-opacity":k.opacity||null,stroke:l.color,"stroke-opacity":l.opacity||null,"stroke-width":l.opacity?i.lineWidth/this.scale:null});i.svg&&this.setAttributes(b,i.svg);i.css&&this.setStyle(b,i.css);b=this.append(b,c,h)}}}return b};
pv.SvgScene.areaPathStraight=function(b,c,e,d){for(var g=[],h=[],i=e;c<=i;c++,e--){var j=b[c],k=b[e];j=j.left+","+j.top;k=k.left+k.width+","+(k.top+k.height);if(c<i){var l=b[c+1],n=b[e-1];switch(d.interpolate){case "step-before":j+="V"+l.top;k+="H"+(n.left+n.width);break;case "step-after":j+="H"+l.left;k+="V"+(n.top+n.height);break}}g.push(j);h.push(k)}return g.concat(h).join("L")};
pv.SvgScene.areaPathCurve=function(b,c,e,d){for(var g=[],h=[],i=e;c<=i;c++,e--){var j=b[e];g.push(b[c]);h.push({left:j.left+j.width,top:j.top+j.height})}switch(d.interpolate){case "basis":b=this.curveBasis(g);d=this.curveBasis(h);break;case "cardinal":b=this.curveCardinal(g,d.tension);d=this.curveCardinal(h,d.tension);break;default:b=this.curveMonotone(g);d=this.curveMonotone(h)}return g[0].left+","+g[0].top+b+"L"+h[0].left+","+h[0].top+d};pv.SvgScene.minBarWidth=1;pv.SvgScene.minBarHeight=1;
pv.SvgScene.minBarLineWidth=0.2;
pv.SvgScene.bar=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var e=0;e<b.length;e++){var d=b[e];if(!(!d.visible||Math.abs(d.width)<=1.0E-10||Math.abs(d.height)<=1.0E-10)){if(d.width<this.minBarWidth)d.width=this.minBarWidth;if(d.height<this.minBarHeight)d.height=this.minBarHeight;var g=d.fillStyle,h=d.strokeStyle;if(g.opacity||h.opacity){g.type&&g.type!=="solid"&&this.addFillStyleDefinition(b,g);h.type&&h.type!="solid"&&this.addFillStyleDefinition(b,h);var i;if(h.opacity){i=
d.lineWidth;i=i<1.0E-10?0:Math.max(this.minBarLineWidth,i/this.scale)}else i=null;c=this.expect(c,"rect",b,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1.0E-10,d.width),height:Math.max(1.0E-10,d.height),fill:g.color,"fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":i,"stroke-linecap":d.lineCap,"stroke-dasharray":h.opacity?this.parseDasharray(d):null});d.svg&&this.setAttributes(c,
d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,e)}}}return c};
pv.SvgScene.dot=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var e=0;e<b.length;e++){var d=b[e];if(d.visible){var g=d.fillStyle,h=d.strokeStyle;if(g.opacity||h.opacity){g.type&&g.type!=="solid"&&this.addFillStyleDefinition(b,g);h.type&&h.type!="solid"&&this.addFillStyleDefinition(b,h);var i=d.shapeRadius,j=null;switch(d.shape){case "cross":j="M"+-i+","+-i+"L"+i+","+i+"M"+i+","+-i+"L"+-i+","+i;break;case "triangle":j=i;var k=i*1.1547;j="M0,"+j+"L"+k+","+-j+" "+-k+","+-j+
"Z";break;case "diamond":i*=Math.SQRT2;j="M0,"+-i+"L"+i+",0 0,"+i+" "+-i+",0Z";break;case "square":j="M"+-i+","+-i+"L"+i+","+-i+" "+i+","+i+" "+-i+","+i+"Z";break;case "tick":j="M0,0L0,"+-d.shapeSize;break;case "bar":j="M0,"+d.shapeSize/2+"L0,"+-(d.shapeSize/2);break}g={"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,fill:g.color,"fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":h.opacity?d.lineWidth/this.scale:
null,"stroke-linecap":d.lineCap,"stroke-dasharray":h.opacity?this.parseDasharray(d):null};if(j){g.transform="translate("+d.left+","+d.top+")";if(d.shapeAngle)g.transform+=" rotate("+180*d.shapeAngle/Math.PI+")";g.d=j;c=this.expect(c,"path",b,e,g)}else{g.cx=d.left;g.cy=d.top;g.r=i;c=this.expect(c,"circle",b,e,g)}d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,e)}}}return c};
pv.SvgScene.image=function(b){for(var c=b.$g.firstChild,e=0;e<b.length;e++){var d=b[e];if(d.visible){c=this.fill(c,b,e);if(d.image){c=this.expect(c,"foreignObject",b,e,{cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);var g=c.firstChild||c.appendChild(document.createElementNS(this.xhtml,"canvas"));g.$scene={scenes:b,index:e};g.style.width=d.width;g.style.height=d.height;g.width=d.imageWidth;g.height=d.imageHeight;g.getContext("2d").putImageData(d.image,
0,0)}else{c=this.expect(c,"image",b,e,{preserveAspectRatio:"none",cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c.setAttributeNS(this.xlink,"xlink:href",d.url)}c=this.append(c,b,e);c=this.stroke(c,b,e)}}return c};
pv.SvgScene.label=function(b){for(var c=b.$g.firstChild,e=0;e<b.length;e++){var d=b[e];if(d.visible){var g=d.textStyle;if(g.opacity&&d.text){var h=0,i=0,j=0,k="start";switch(d.textBaseline){case "middle":if(pv.renderer()=="svgweb")i=3;else j=".35em";break;case "top":if(pv.renderer()=="svgweb")i=9+d.textMargin;else{j=".71em";i=d.textMargin}break;case "bottom":i="-"+d.textMargin;break}switch(d.textAlign){case "right":k="end";h="-"+d.textMargin;break;case "center":k="middle";break;case "left":h=d.textMargin;
break}c=this.expect(c,"text",b,e,{"pointer-events":d.events,cursor:d.cursor,x:h,y:i,dy:j,transform:"translate("+d.left+","+d.top+")"+(d.textAngle?" rotate("+180*d.textAngle/Math.PI+")":"")+(this.scale!=1?" scale("+1/this.scale+")":""),fill:g.color,"fill-opacity":g.opacity||null,"text-anchor":k},{font:d.font,"text-shadow":d.textShadow,"text-decoration":d.textDecoration});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);if(c.firstChild)c.firstChild.nodeValue=d.text;else pv.renderer()==
"svgweb"?c.appendChild(document.createTextNode(d.text,true)):c.appendChild(document.createTextNode(d.text));c=this.append(c,b,e)}}}return c};pv.SvgScene.line=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);var e=b.length;if(!e)return c;var d=b[0];if(d.segmented==="smart")return this.lineSegmentedSmart(c,b);if(e<2)return c;if(d.segmented)return this.lineSegmentedFull(c,b);return this.lineFixed(c,b)};
pv.SvgScene.lineFixed=function(b,c){var e=c.length;if(e===1)return this.lineAreaDotAlone(b,c,0);var d=c[0];if(!d.visible)return b;var g=d.fillStyle,h=d.strokeStyle;if(!g.opacity&&!h.opacity)return b;this.addFillStyleDefinition(c,g);this.addFillStyleDefinition(c,h);var i="M"+d.left+","+d.top,j=e>2;if(j)switch(d.interpolate){case "basis":i+=this.curveBasis(c);break;case "cardinal":i+=this.curveCardinal(c,d.tension);break;case "monotone":i+=this.curveMonotone(c);break;default:j=false}if(!j)for(j=1;j<
e;j++)i+=this.lineSegmentPath(c[j-1],c[j]);e=h.opacity;g={"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,d:i,fill:g.color,"fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":e||null,"stroke-width":e?d.lineWidth/this.scale:null,"stroke-linecap":d.lineCap,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,"stroke-dasharray":e?this.parseDasharray(d):null};b=this.expect(b,"path",c,0,g,d.css);d.svg&&this.setAttributes(b,d.svg);return this.append(b,
c,0)};
pv.SvgScene.lineSegmentedSmart=function(b,c){b||(b=c.$g.appendChild(this.create("g")));var e=b;b=e.firstChild;var d=this.expect(b,"g",c,0,{"pointer-events":"none"});d.parentNode||e.appendChild(d);c.$g=d;b=d.firstChild;var g=c.mark.$hasHandlers?[]:null;b=this.eachLineAreaSegment(b,c,function(i,j,k,l){var n=this.lineSegmentPaths(j,k,l);g&&g.push({from:k,paths:n});return this.eachLineAreaSegment(i,j,{breakOnKeyChange:true,from:k,to:l},function(m,p,o,q){var r=p[o],v=r.fillStyle;this.addFillStyleDefinition(p,v);
var u=r.strokeStyle;this.addFillStyleDefinition(p,u);if(o===q)return this.lineAreaDotAlone(m,p,o);q=this.lineJoinPaths(n,o-o,q-o-1);var t=u.opacity;v={"shape-rendering":r.antialias?null:"crispEdges","pointer-events":"none",cursor:r.cursor,d:q,fill:v.color,"fill-opacity":v.opacity||null,stroke:u.color,"stroke-opacity":t||null,"stroke-width":t?r.lineWidth/this.scale:null,"stroke-linecap":r.lineCap,"stroke-linejoin":r.lineJoin,"stroke-miterlimit":r.strokeMiterLimit,"stroke-dasharray":t?this.parseDasharray(r):
null};m=this.expect(m,"path",p,o,v,r.css);return this.append(m,p,o)})});this.removeSiblings(b);var h;if(g){b=d.nextSibling;h=this.expect(b,"g",c,0);h.parentNode||e.appendChild(h);c.$g=h;b=h.firstChild;g.forEach(function(i){var j=i.from,k={"shape-rendering":"crispEdges",fill:"rgb(127,127,127)","fill-opacity":0.005,stroke:"rgb(127,127,127)","stroke-opacity":0.005,"stroke-width":10,"stroke-dasharray":null};i.paths.forEach(function(l,n){n=j+n;var m=c[n],p=m.events;if(p&&p!=="none"){var o=Object.create(k);
o["pointer-events"]=p;o.cursor=m.cursor;o.d=l.join("");b=this.expect(b,"path",c,n,o);b=this.append(b,c,n)}},this)},this);this.removeSiblings(b)}c.$g=e;return(h||d).nextSibling};
pv.SvgScene.lineSegmentedFull=function(b,c){var e=c[0],d;switch(e.interpolate){case "basis":d=this.curveBasisSegments(c);break;case "cardinal":d=this.curveCardinalSegments(c,e.tension);break;case "monotone":d=this.curveMonotoneSegments(c);break}e=0;for(var g=c.length-1;e<g;e++){var h=c[e],i=c[e+1];if(h.visible&&i.visible){var j=h.strokeStyle,k=pv.FillStyle.transparent;if(j.opacity){if(h.interpolate=="linear"&&h.lineJoin=="miter"){k=j;j=pv.FillStyle.transparent;i=this.pathJoin(c[e-1],h,i,c[e+2])}else i=
d?d[e].join(""):"M"+h.left+","+h.top+this.lineSegmentPath(h,i);b=this.expect(b,"path",c,e,{"shape-rendering":h.antialias?null:"crispEdges","pointer-events":h.events,cursor:h.cursor,d:i,fill:k.color,"fill-opacity":k.opacity||null,stroke:j.color,"stroke-opacity":j.opacity||null,"stroke-width":j.opacity?h.lineWidth/this.scale:null,"stroke-linejoin":h.lineJoin});h.svg&&this.setAttributes(b,h.svg);h.css&&this.setStyle(b,h.css);b=this.append(b,c,e)}}}return b};
pv.SvgScene.lineSegmentPath=function(b,c){var e=1;switch(b.interpolate){case "polar-reverse":e=0;case "polar":var d=c.left-b.left,g=c.top-b.top;b=1-b.eccentricity;d=Math.sqrt(d*d+g*g)/(2*b);if(b<=0||b>1)break;return"A"+d+","+d+" 0 0,"+e+" "+c.left+","+c.top;case "step-before":return"V"+c.top+"H"+c.left;case "step-after":return"H"+c.left+"V"+c.top}return"L"+c.left+","+c.top};
pv.SvgScene.lineSegmentPaths=function(b,c,e){var d=b[c],g;switch(d.interpolate){case "basis":g=this.curveBasisSegments(b,c,e);break;case "cardinal":g=this.curveCardinalSegments(b,d.tension,c,e);break;case "monotone":g=this.curveMonotoneSegments(b,c,e);break}if(!g||!g.length){g=[];for(c=c+1;c<=e;c++){d=b[c-1];g.push(["M"+d.left+","+d.top,this.lineSegmentPath(d,b[c])])}}return g};pv.strokeMiterLimit=4;
pv.SvgScene.pathJoin=function(b,c,e,d){var g=[],h,i=c.lineWidth/this.scale,j=pv.vector(c.left,c.top),k=pv.vector(e.left,e.top),l=k.minus(j),n=l.perp().norm(),m=n.times(i/2),p=j.plus(m),o=j.minus(m),q=k.plus(m);m=k.minus(m);if(!b||!b.visible)g.push(o,p);else{var r=pv.vector(b.left,b.top),v=j.minus(r),u=v.perp().norm().plus(n).norm();r=this.lineIntersect(j,u,p,l);u=this.lineIntersect(j,u,o,l);h=r.minus(u).length();b=(i+b.lineWidth/this.scale)/2;h=h/b;c=c.strokeMiterLimit||pv.strokeMiterLimit;if(h<=
c)g.push(u,r);else{c=l.times(-1);c=v.norm().plus(c.norm()).norm();j=j.plus(c.times(b/2));c.dot(n)>=0?g.push(u,j,p):g.push(o,j,r)}}if(!d||!d.visible)g.push(q,m);else{j=pv.vector(d.left,d.top).minus(k);o=j.perp().norm().plus(n).norm();p=this.lineIntersect(k,o,q,l);o=this.lineIntersect(k,o,m,l);h=p.minus(o).length();d=(d.lineWidth/this.scale+i)/2;h=h/d;c=e.strokeMiterLimit||pv.strokeMiterLimit;if(h<=c)g.push(p,o);else{e=j.times(-1);l=l.norm().plus(e.norm()).norm();k=k.plus(l.times(d/2));l.dot(n)>=0?
g.push(q,k,o):g.push(p,k,m)}}n=g.shift();return"M"+n.x+","+n.y+"L"+g.map(function(t){return t.x+","+t.y}).join(" ")};pv.SvgScene.lineIntersect=function(b,c,e,d){return b.plus(c.times(e.minus(b).dot(d.perp())/c.dot(d.perp())))};pv.SvgScene.lineJoinPaths=function(b,c,e){var d=b[c].join("");for(c=c+1;c<=e;c++)d+=b[c][1];return d};pv.SvgScene.lineAreaDotAlone=function(b){return b};
pv.SvgScene.eachLineAreaSegment=function(b,c,e,d){if(typeof e==="function"){d=e;e=null}var g=pv.get(e,"breakOnKeyChange",false),h=pv.get(e,"from")||0,i=pv.get(e,"to",c.length-1),j,k;if(g){j=[];k=[]}for(h=h;h<=i;){var l=c[h];if(this.isSceneVisible(l)){g&&this.lineAreaSceneKey(l,j);var n;for(l=h;;){var m=l+1;if(m>i){n=m;break}var p=c[m];if(!this.isSceneVisible(p)){n=m+1;break}l=m;if(g){this.lineAreaSceneKey(p,k);if(!this.equalSceneKeys(j,k)){n=l;break}}}b=d.call(this,b,c,h,l,e);h=n}else h++}return b};
pv.SvgScene.lineAreaSceneKey=function(b,c){c[0]=b.fillStyle.key;c[1]=b.strokeStyle.key;c[2]=b.lineWidth;c[3]=b.strokeDasharray||"none";c[4]=b.interpolate;return c};pv.SvgScene.isSceneVisible=function(b){return b.visible&&(b.fillStyle.opacity>0||b.strokeStyle.opacity>0)};pv.SvgScene.equalSceneKeys=function(b,c){for(var e=0,d=b.length;e<d;e++)if(b[e]!==c[e])return false;return true};
pv.SvgScene.panel=function(b){for(var c=b.$g,e=c&&c.firstChild,d=false,g=0;g<b.length;g++){var h=b[g];if(h.visible){if(!b.parent){if(pv.renderer()!=="batik")h.canvas.style.display="inline-block";if(c&&c.parentNode!=h.canvas)e=(c=h.canvas.firstChild)&&c.firstChild;if(!c){c=this.create(pv.renderer()!=="batik"?"svg":"g");c.setAttribute("font-size","10px");c.setAttribute("font-family","sans-serif");c.setAttribute("fill","none");c.setAttribute("stroke","none");c.setAttribute("stroke-width",1.5);c.setAttribute("style",
"-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");if(typeof c.onselectstart!=="undefined"){c.setAttribute("unselectable","on");c.onselectstart=function(){return false}}if(pv.renderer()==="svgweb"){c.setAttribute("width",h.width+h.left+h.right);c.setAttribute("height",h.height+h.top+h.bottom);var i=document.createDocumentFragment(true);c.addEventListener("SVGLoad",function(){var o=this;(function(){if(d){d=
false;o.appendChild(i);for(var q=0;q<pv.Scene.events.length;q++)o.addEventListener(pv.Scene.events[q],pv.SvgScene.dispatch,false);b.$g=o;b.$g.__ready=true}else setTimeout(arguments.callee,10)})()},false);svgweb.appendChild(c,h.canvas);c=i}else{for(var j=0;j<this.events.length;j++)c.addEventListener(this.events[j],this.dispatch,false);c=h.canvas.appendChild(c);c.__ready=true}e=c.firstChild}b.$g=c;if(c.__ready){c.setAttribute("width",h.width+h.left+h.right);c.setAttribute("height",h.height+h.top+h.bottom)}}if(h.overflow===
"hidden"){j=pv.id().toString(36);var k=this.expect(e,"g",b,g,{"clip-path":"url(#"+j+")"});k.parentNode||c.appendChild(k);b.$g=c=k;e=k.firstChild;e=this.expect(e,"clipPath",b,g,{id:j});j=e.firstChild||e.appendChild(this.create("rect"));j.setAttribute("x",h.left);j.setAttribute("y",h.top);j.setAttribute("width",h.width);j.setAttribute("height",h.height);e.parentNode||c.appendChild(e);e=e.nextSibling}e=this.fill(e,b,g);j=this.scale;var l=h.transform,n=h.left+l.x,m=h.top+l.y;this.scale*=l.k;if(h.children.length){var p=
{transform:"translate("+n+","+m+")"+(l.k!=1?" scale("+l.k+")":"")};this.eachChild(b,g,function(o){o.$g=e=this.expect(e,"g",b,g,p);this.updateAll(o);e.parentNode||c.appendChild(e);e=e.nextSibling})}this.scale=j;e=this.stroke(e,b,g);if(h.overflow==="hidden"){b.$g=c=k.parentNode;e=k.nextSibling}}}d=true;return e};
pv.SvgScene.eachChild=function(b,c,e,d){if(b.mark.zOrderChildCount){b=b[c].children.slice(0);b.sort(function(g,h){var i=g.mark._zOrder-h.mark._zOrder;if(i===0)i=g.childIndex-h.childIndex;return i});b.forEach(e,d||this)}else b[c].children.forEach(e,d||this)};
pv.SvgScene.fill=function(b,c,e){this.removeFillStyleDefinitions(c);var d=c[e],g=d.fillStyle;if(g.opacity||d.events=="all"){g.type&&g.type!=="solid"&&this.addFillStyleDefinition(c,g);b=this.expect(b,"rect",c,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height,fill:g.color,"fill-opacity":g.opacity,stroke:null});b=this.append(b,c,e)}return b};
pv.SvgScene.stroke=function(b,c,e){var d=c[e],g=d.strokeStyle;if(g.opacity||d.events=="all"){b=this.expect(b,"rect",c,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events=="all"?"stroke":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1.0E-10,d.width),height:Math.max(1.0E-10,d.height),fill:null,stroke:g.color,"stroke-opacity":g.opacity,"stroke-width":d.lineWidth/this.scale,"stroke-linecap":d.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(d):null});b=this.append(b,
c,e)}return b};pv.SvgScene.minRuleLineWidth=1;
pv.SvgScene.rule=function(b){for(var c=b.$g.firstChild,e=0;e<b.length;e++){var d=b[e];if(d.visible){var g=d.strokeStyle;if(g.opacity){var h=d.lineWidth;h=h<1.0E-10?0:Math.max(this.minRuleLineWidth,h/this.scale);c=this.expect(c,"line",b,e,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x1:d.left,y1:d.top,x2:d.left+d.width,y2:d.top+d.height,stroke:g.color,"stroke-opacity":g.opacity,"stroke-width":h,"stroke-linecap":d.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(d):
null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,e)}}}return c};
pv.SvgScene.wedge=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var e=0;e<b.length;e++){var d=b[e];if(d.visible){var g=d.fillStyle,h=d.strokeStyle;if(g.opacity||h.opacity){var i=d.innerRadius,j=d.outerRadius,k=Math.abs(d.angle);if(k>=2*Math.PI)i=i?"M0,"+j+"A"+j+","+j+" 0 1,1 0,"+-j+"A"+j+","+j+" 0 1,1 0,"+j+"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":"M0,"+j+"A"+j+","+j+" 0 1,1 0,"+-j+"A"+j+","+j+" 0 1,1 0,"+j+"Z";else{var l=Math.min(d.startAngle,d.endAngle),
n=Math.max(d.startAngle,d.endAngle),m=Math.cos(l),p=Math.cos(n);l=Math.sin(l);n=Math.sin(n);i=i?"M"+j*m+","+j*l+"A"+j+","+j+" 0 "+(k<Math.PI?"0":"1")+",1 "+j*p+","+j*n+"L"+i*p+","+i*n+"A"+i+","+i+" 0 "+(k<Math.PI?"0":"1")+",0 "+i*m+","+i*l+"Z":"M"+j*m+","+j*l+"A"+j+","+j+" 0 "+(k<Math.PI?"0":"1")+",1 "+j*p+","+j*n+"L0,0Z"}g.type&&g.type!=="solid"&&this.addFillStyleDefinition(b,g);h.type&&h.type!="solid"&&this.addFillStyleDefinition(b,h);c=this.expect(c,"path",b,e,{"shape-rendering":d.antialias?null:
"crispEdges","pointer-events":d.events,cursor:d.cursor,transform:"translate("+d.left+","+d.top+")",d:i,fill:g.color,"fill-rule":"evenodd","fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":h.opacity?d.lineWidth/this.scale:null,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,"stroke-linecap":d.lineCap,"stroke-dasharray":h.opacity?this.parseDasharray(d):null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,
b,e)}}}return c};pv.Mark=function(){this.$properties=[];this.$propertiesMap={};this.$handlers={}};pv.Mark.prototype.properties={};pv.Mark.cast={};pv.Mark.prototype.property=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;pv.Mark.prototype.propertyMethod(b,false,pv.Mark.cast[b]=c);return this};
pv.Mark.prototype.localProperty=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;var e=pv.Mark.cast[b];if(c)pv.Mark.cast[b]=e=c;this.propertyMethod(b,false,e);return this};
pv.Mark.prototype.propertyMethod=function(b,c,e){e||(e=pv.Mark.cast[b]);this[b]=function(d,g){if(c&&this.scene){var h=this.scene.defs;if(arguments.length){h[b]={id:d==null?0:pv.id(),value:d!=null&&e?e(d):d};return this}return h[b]?h[b].value:null}if(arguments.length){this.setPropertyValue(b,d,c,e,false,g);return this}if(h=pv.propertyEval){var i=this.binds,j=i.properties[b];if(j){i=i.net;var k=i[b];if(k==null)k=i[b]=0;(j.dependents||(j.dependents={}))[h.name]=true;(pv.propertyEvalDependencies||(pv.propertyEvalDependencies=
{}))[b]=true;if(k>=pv.propertyEvalNetIndex)pv.propertyEvalNetIndex=k+1}}return this.instance()[b]}};pv.Mark.funPropertyCaller=function(b,c){var e=pv.Mark.stack;return function(){var d=b.apply(this,e);return d!=null?c(d):d}};
pv.Mark.prototype.setPropertyValue=function(b,c,e,d,g,h){e=!e<<1|typeof c==="function";if(e&1&&d)c=pv.Mark.funPropertyCaller(c,d);else if(c!=null&&d)c=d(c);var i=this.$propertiesMap;d=this.$properties;c={name:b,id:pv.id(),value:c,type:e,tag:h};h=i[b];i[b]=c;if(h)for(b=0;b<d.length;b++)if(d[b]===h){d.splice(b,1);break}d.push(c);if(g&&h&&e===3){c.proto=h;c.root=h.root||h}return c};
pv.Mark.prototype.intercept=function(b,c,e){this.setPropertyValue(b,c,false,pv.get(e,"noCast")?null:pv.Mark.cast[b],true,pv.get(e,"tag"));return this};pv.Mark.prototype.propertyValue=function(b,c){var e=this.$propertiesMap[b];if(e)return e.value;if(c){if(this.proto){c=this.proto.propertyValueRecursive(b);if(c!==undefined)return c}return this.defaults.propertyValueRecursive(b)}};pv.Mark.prototype.propertyValueRecursive=function(b){var c=this.$propertiesMap[b];if(c)return c.value;if(this.proto)return this.proto.propertyValueRecursive(b)};
pv.Mark.stack=[];pv.Mark.prototype.property("data").property("visible",Boolean).property("css",Object).property("svg",Object).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String);a=pv.Mark.prototype;a.childIndex=-1;a.index=-1;a.scale=1;a._zOrder=0;a.defaults=(new pv.Mark).data(function(b){return[b]}).visible(true).antialias(true).events("painted");
a.extend=function(b){this.proto=b;this.target=b.target;return this};a.add=function(b){return this.parent.add(b).extend(this)};a.def=function(b,c){this.propertyMethod(b,true);return this[b](arguments.length>1?c:null)};a.zOrder=function(b){if(!arguments.length)return this._zOrder;b=+b||0;if(this._zOrder!==b){this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount--;this._zOrder=b;this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount++}return this};
a.anchor=function(b){b||(b="center");return(new pv.Anchor(this)).name(b).data(function(){return this.scene.target.map(function(c){return c.data})}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var c=this.scene.target[this.index],e=c.width||0;switch(this.name()){case "bottom":case "top":case "center":return c.left+e/2;case "left":return null}return c.left+e}).top(function(){var c=this.scene.target[this.index],
e=c.height||0;switch(this.name()){case "left":case "right":case "center":return c.top+e/2;case "top":return null}return c.top+e}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+(c.width||0):null}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+(c.height||0):null}).textAlign(function(){switch(this.name()){case "bottom":case "top":case "center":return"center";case "right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";
case "top":return"top"}return"bottom"})};a.anchorTarget=function(){return this.target};a.margin=function(b){return this.left(b).right(b).top(b).bottom(b)};a.instance=function(b){var c=this.scene||this.parent.instance(-1).children[this.childIndex],e=!arguments.length||this.hasOwnProperty("index")?this.index:b;return c[e<0?c.length-1:e]};
a.instances=function(b){for(var c=this,e=[],d;!(d=c.scene);){b=b.parent;e.push({index:b.index,childIndex:c.childIndex});c=c.parent}for(;e.length;){b=e.pop();d=d[b.index].children[b.childIndex]}if(this.hasOwnProperty("index")){e=pv.extend(d[this.index]);e.right=e.top=e.left=e.bottom=0;return[e]}return d};a.first=function(){return this.scene[0]};a.last=function(){return this.scene[this.scene.length-1]};a.sibling=function(){return this.index==0?null:this.scene[this.index-1]};
a.cousin=function(){var b=this.parent;return(b=b&&b.sibling())&&b.children?b.children[this.childIndex][this.index]:null};a.render=function(){this.parent&&!this.root.scene?this.root.render():this.renderCore()};
a.renderCore=function(){function b(j,k,l){j.scale=l;if(k<i){var n=k>=d.length;n&&d.unshift(null);try{if(j.hasOwnProperty("index"))c(j,k,l,n);else{for(var m=0,p=j.scene.length;m<p;m++){j.index=m;c(j,k,l,n)}delete j.index}}finally{n&&d.shift()}}else{j.build();pv.Scene.scale=l;pv.Scene.updateAll(j.scene)}delete j.scale}function c(j,k,l,n){var m=j.scene[j.index];if(m.visible){var p=j.children,o=m.children,q=g[k],r=p[q];r.scene||q++;for(j=0;j<q;j++)p[j].scene=o[j];if(n)d[0]=m.data;b(r,k+1,l*m.transform.k);
for(j=0;j<q;j++)p[j].scene=undefined}}for(var e=this.parent,d=pv.Mark.stack,g=[],h=this;h.parent;h=h.parent)g.unshift(h.childIndex);var i=g.length;for(this.bind();e&&!e.hasOwnProperty("index");)e=e.parent;this.context(e?e.scene:undefined,e?e.index:-1,function(){b(this.root,0,1)})};
a.bind=function(){function b(j){do for(var k=j.$properties,l=k.length-1;l>=0;l--){var n=k[l],m=c[n.name];if(m){if(m.type===3){var p=m.root;if(p){if(!p.proto){p.proto=n;m.root=n}}else m.proto=m.root=n}}else{c[n.name]=n;switch(n.name){case "data":e=n;break;case "visible":case "id":d.push(n);break;default:g[n.type].push(n);break}}}while(j=j.proto)}var c={},e,d=[],g=[[],[],[],[]];b(this);b(this.defaults);g[1].reverse();g[3].reverse();var h=this;do for(var i in h.properties)i in c||g[2].push(c[i]={name:i,
type:2,value:null});while(h=h.proto);h=g[0].concat(g[1]);for(i=0;i<h.length;i++)this.propertyMethod(h[i].name,true);this.binds={properties:c,net:{},data:e,defs:h,required:d,optional:pv.blend(g)}};a.updateNet=function(b,c){function e(i,j){if(j>(h[i.name]||0)){h[i.name]=j;if(i=i.dependents){j++;for(var k in i)if(i.hasOwnProperty(k)){var l=g[k];l&&e(l,j)}}}}var d=this.binds,g=d.properties,h=d.net;e(b,c)};
a.build=function(){var b=this.scene,c=pv.Mark.stack;if(!b){b=this.scene=[];b.mark=this;b.type=this.type;b.childIndex=this.childIndex;if(this.parent){b.parent=this.parent.scene;b.parentIndex=this.parent.index}}if(this.target)b.target=this.target.instances(b);if(this.binds.defs.length){var e=b.defs;if(!e)b.defs=e={};for(var d=0;d<this.binds.defs.length;d++){var g=this.binds.defs[d],h=e[g.name];if(!h||g.id>h.id)e[g.name]={id:0,value:g.type&1?g.value.apply(this,c):g.value}}}e=this.binds.data;e=e.type&
1?e.value.apply(this,c):e.value;g=pv.Mark.prototype;c.unshift(null);try{var i=b.length=e.length;for(d=0;d<i;d++){g.index=this.index=d;var j=b[d]||(b[d]={});j.data=c[0]=e[d];this.buildInstance(j)}}finally{g.index=-1;delete this.index;c.shift()}return this};
a.buildProperties=function(b,c){for(var e=pv.Mark.stack,d=0,g=c.length;d<g;d++){var h=c[d],i;switch(h.type){case 3:var j=pv.propertyProto;try{pv.propertyProto=h.proto;i=h.value.apply(this,e)}finally{pv.propertyProto=j}break;case 2:i=h.value;break;case 0:case 1:i=this.scene.defs[h.name].value;break}b[h.name]=i}};a.delegate=function(b,c){var e=pv.propertyProto;if(e&&(!c||e.tag===c)){c=this.evalProperty(e);if(c!==undefined)return c}return b};
a.hasDelegate=function(b){var c=pv.propertyProto;return!!c&&(!b||c.tag===b)};a.evalProperty=function(b){switch(b.type){case 3:var c=pv.propertyProto;try{pv.propertyProto=b.proto;return b.value.apply(this,pv.Mark.stack)}finally{pv.propertyProto=c}case 2:return b.value;case 0:case 1:return this.scene.defs[b.name].value}};
a.buildPropertiesWithDepTracking=function(b,c){var e=this.binds.net,d,g,h,i,j,k,l=pv.Mark.stack,n=c.length;try{for(;;){h=null;k={};for(var m=0;m<n;m++){var p=c[m],o=p.name;k[o]=true;if(!i||i[o]){var q;switch(p.type){case 3:pv.propertyEval=p;pv.propertyEvalNetIndex=d=e[o]||0;pv.propertyEvalDependencies=null;var r=pv.propertyProto;try{pv.propertyProto=p.proto;q=p.value.apply(this,l)}finally{pv.propertyProto=r}g=pv.propertyEvalNetIndex;if(g>d){var v=pv.propertyEvalDependencies;for(var u in v)if(v.hasOwnProperty(u)&&
!k.hasOwnProperty(o)){h||(h={});h[u]=true}this.updateNet(p,g)}break;case 2:q=p.value;break;case 0:case 1:q=this.scene.defs[o].value;break}b[o]=q}}if(!h)break;i=h;j=pv.numerate(c,function(t){return t.name});c.sort(function(t,s){var x=pv.naturalOrder(e[t.name]||0,e[s.name]||0);x||(x=pv.naturalOrder(j[t.name],j[s.name]));return x});j=null}}finally{pv.propertyEval=null;pv.propertyEvalNetIndex=null;pv.propertyEvalDependencies=null}};
a.buildInstance=function(b){this.buildProperties(b,this.binds.required);if(b.visible){this.index===0?this.buildPropertiesWithDepTracking(b,this.binds.optional):this.buildProperties(b,this.binds.optional);this.buildImplied(b)}};
a.buildImplied=function(b){var c=b.left,e=b.right,d=b.top,g=b.bottom,h=this.properties,i=h.width?b.width:0,j=h.height?b.height:0,k,l;if(i==null||e==null||c==null){k=this.parent?this.parent.instance():null;l=true;var n=k?k.width:i+c+e;if(i==null)i=n-(e=e||0)-(c=c||0);else if(e==null)if(c==null)c=e=(n-i)/2;else e=n-i-c;else c=n-i-e}if(j==null||g==null||d==null){l||(k=this.parent?this.parent.instance():null);k=k?k.height:j+d+g;if(j==null)j=k-(d=d||0)-(g=g||0);else if(g==null)g=d==null?(d=(k-j)/2):k-
j-d;else d=k-j-g}b.left=c;b.right=e;b.top=d;b.bottom=g;if(h.width)b.width=i;if(h.height)b.height=j;if(h.textStyle&&!b.textStyle)b.textStyle=pv.FillStyle.transparent;if(h.fillStyle&&!b.fillStyle)b.fillStyle=pv.FillStyle.transparent;if(h.strokeStyle&&!b.strokeStyle)b.strokeStyle=pv.FillStyle.transparent};
a.mouse=function(){var b=this.root.canvas(),c=pv.event,e=c.pageX;c=c.pageY;var d=pv.elementOffset(b);if(d){e-=d.left;c-=d.top;if(b=pv.getWindow(b.ownerDocument).getComputedStyle(b,null)){e-=parseFloat(b.paddingLeft||0);c-=parseFloat(b.paddingTop||0)}}b=pv.Transform.identity;var g=this.properties.transform?this:this.parent;d=[];do d.push(g);while(g=g.parent);for(;g=d.pop();){g=g.instance();b=b.translate(g.left,g.top).times(g.transform)}b=b.invert();return pv.vector(e*b.k+b.x,c*b.k+b.y)};
a.event=function(b,c){c=pv.functor(c);var e=this.$handlers[b];if(e)if(e instanceof Array)e.push(c);else e=[e,c];else e=c;this.$hasHandlers=true;this.$handlers[b]=e;return this};
a.context=function(b,c,e){function d(m,p){pv.Mark.scene=m;h.index=p;if(m){var o=m.mark,q=o,r=[];do{r.push(q);i.push(m[p].data);q.index=p;q.scene=m;if(q=q.parent){p=m.parentIndex;m=m.parent}}while(q);m=1;for(p=r.length-1;p>0;p--){q=r[p];q.scale=m;m*=q.scene[q.index].transform.k}o.scale=m;r=o.children;var v;if(r&&(v=r.length)>0){q=o.scene[o.index];m*=q.transform.k;o=q.children;for(p=0;p<v;p++){q=r[p];q.scene=o[p];q.scale=m}}}}function g(m){if(m){var p=m.mark,o=p.children;if(o)for(var q=0,r=o.length;q<
r;q++){m=o[q];m.scene=undefined;m.scale=1}m=p;do{i.pop();delete m.index;if(p=m.parent){m.scene=undefined;m.scale=1}}while(m=p)}}var h=pv.Mark.prototype,i=pv.Mark.stack,j=pv.Mark.scene,k=h.index;if(b&&b===j&&c===k)try{e.apply(this,i)}catch(l){pv.error(l);throw l;}finally{pv.Mark.scene=j;h.index=k}else{g(j,k);d(b,c);try{e.apply(this,i)}catch(n){pv.error(n);throw n;}finally{g(b,c);d(j,k)}}};
pv.Mark.getEventHandler=function(b,c,e,d){var g=c.mark.$handlers[b];if(g)return[g,b,c,e,d];if(e=c.parent)return this.getEventHandler(b,e,c.parentIndex,d)};pv.Mark.dispatch=function(b,c,e,d){var g=c.mark.root;if(g.animatingCount)return true;var h;if(g=g.$interceptors&&g.$interceptors[b])for(var i=0,j=g.length;i<j;i++){if(h=g[i](b,d))break;if(h===false)return true}if(!h){h=this.getEventHandler(b,c,e,d);if(!h)return false}return this.handle.apply(this,h)};
pv.Mark.handle=function(b,c,e,d,g){var h=e.mark;h.context(e,d,function(){var i=pv.Mark.stack.concat(g);if(b instanceof Array){var j;b.forEach(function(k){if((k=k.apply(h,i))&&k.render)(j||(j=[])).push(k)});j&&j.forEach(function(k){k.render()})}else(h=b.apply(h,i))&&h.render&&h.render()});return true};a=pv.Mark.prototype;a.addEventInterceptor=function(b,c,e){var d=this.root;if(d){d=d.$interceptors||(d.$interceptors={});b=d[b]||(d[b]=[]);e?b.unshift(c):b.push(c)}};
a.eachInstance=function(b,c){function e(i,j,k){var l=i.length;if(l>0){var n;j===h||(n=g[j]);for(var m=0;m<l;m++){var p=i[m];if(p.visible)if(j===h)b.call(c,i,m,k);else{var o=p.children[n];if(o){p=k.times(p.transform).translate(p.left,p.top);e(o,j+1,p)}}}}}for(var d=this,g=[];d.parent;){g.unshift(d.childIndex);d=d.parent}if(d=d.scene){var h=g.length;e(d,0,pv.Transform.identity)}};
a.toScreenTransform=function(){var b=pv.Transform.identity;if(this instanceof pv.Panel)b=b.translate(this.left(),this.top()).times(this.transform());var c=this.parent;if(c){do b=b.translate(c.left(),c.top()).times(c.transform());while(c=c.parent)}return b};a.transition=function(){return new pv.Transition(this)};a.on=function(b){return this["$"+b]=new pv.Transient(this)};
a.getShape=function(b,c,e){var d=b[c];if(!d.visible)return null;if(e==null)e=0;var g="_shape_inset_"+e;return d[g]||(d[g]=this.getShapeCore(b,c,e))};a.getShapeCore=function(b,c,e){var d=b[c];b=d.left;c=d.top;var g=d.width;d=d.height;if(e>0&&e<=1){var h=e*g;e=e*d;b+=h;c+=e;g-=h*2;d-=e*2}return new pv.Shape.Rect(b,c,g,d)};pv.Anchor=function(b){pv.Mark.call(this);this.target=b;this.parent=b.parent};pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String);
pv.Anchor.prototype.extend=function(b){this.proto=b;return this};pv.Area=function(){pv.Mark.call(this)};pv.Area.castSegmented=function(b){if(!b)return"";switch(b){case "smart":case "full":break;default:b="full"}return b};
pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("tension",Number);pv.Area.prototype.type="area";pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
pv.Area.prototype.buildImplied=function(b){if(b.height==null)b.height=0;if(b.width==null)b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Area.fixed={lineWidth:1,lineJoin:1,strokeMiterLimit:1,lineCap:1,strokeStyle:1,strokeDasharray:1,fillStyle:1,segmented:1,interpolate:1,tension:1};
pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);var b=this.binds,c=b.required;b=b.optional;for(var e=0,d=b.length;e<d;e++){var g=b[e];g.fixed=g.name in pv.Area.fixed;if(g.name=="segmented"){c.push(g);b.splice(e,1);e--;d--}}this.binds.$required=c;this.binds.$optional=b};
pv.Area.prototype.buildInstance=function(b){var c=this.binds;if(this.index){var e=c.fixed;if(!e){e=c.fixed=[];function d(j){return!j.fixed||(e.push(j),false)}c.required=c.required.filter(d);if(!this.scene[0].segmented)c.optional=c.optional.filter(d)}if(c=e.length)for(var g=this.scene[0],h=0;h<c;h++){var i=e[h].name;b[i]=g[i]}}else{c.required=c.$required;c.optional=c.$optional;c.fixed=null}pv.Mark.prototype.buildInstance.call(this,b)};
pv.Area.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})};
pv.Area.prototype.getShapeCore=function(b,c){var e=b[c],d=e.width||0,g=e.height||0,h=e.left;e=e.top;var i=c+1<b.length?b[c+1]:null;if(!i||!i.visible)return new pv.Shape.Line(h,e,h+d,e+g);b=i.left;c=i.top;var j=i.height||0;i=i.width||0;return new pv.Shape.Polygon([new pv.Vector(h,e),new pv.Vector(b,c),new pv.Vector(b+i,c+j),new pv.Vector(h+d,e+g)])};pv.Bar=function(){pv.Mark.call(this)};
pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Bar.prototype.type="bar";pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).lineCap("butt").strokeDasharray("none");pv.Dot=function(){pv.Mark.call(this)};
pv.Dot.prototype=pv.extend(pv.Mark).property("shape",String).property("shapeAngle",Number).property("shapeRadius",Number).property("shapeSize",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);a=pv.Dot.prototype;a.type="dot";a.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).shape("circle").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).lineCap("butt").strokeDasharray("none");
a.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).left(function(){var c=this.scene.target[this.index];switch(this.name()){case "bottom":case "top":case "center":return c.left;case "left":return null}return c.left+c.shapeRadius}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+c.shapeRadius:null}).top(function(){var c=this.scene.target[this.index];switch(this.name()){case "left":case "right":case "center":return c.top;case "top":return null}return c.top+
c.shapeRadius}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+c.shapeRadius:null}).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "bottom":return"top"}return"bottom"})};
a.buildImplied=function(b){var c=b.shapeRadius,e=b.shapeSize;if(c==null)if(e==null){b.shapeSize=20.25;b.shapeRadius=4.5}else b.shapeRadius=Math.sqrt(e);else if(e==null)b.shapeSize=c*c;pv.Mark.prototype.buildImplied.call(this,b)};a.getShapeCore=function(b,c){b=b[c];c=b.shapeRadius;var e=b.left,d=b.top;switch(b.shape){case "diamond":c*=Math.SQRT2;case "square":case "cross":return new pv.Shape.Rect(e-c,d-c,2*c,2*c)}return new pv.Shape.Circle(e,d,c)};pv.Label=function(){pv.Mark.call(this)};
pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String);pv.Label.prototype.type="label";pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3);
pv.Label.prototype.getShapeCore=function(b,c,e){b=b[c];var d=pv.Text.measure(b.text,b.font);c=b.left;var g=b.top,h=d.width;d=d.height;if(e>0&&e<=1){var i=e*h;e=e*d;c+=i;g+=e;h-=i*2;d-=e*2}return pv.Label.getPolygon(h,d,b.textAlign,b.textBaseline,b.textAngle,b.textMargin).apply(pv.Transform.identity.translate(c,g))};
pv.Label.getPolygon=function(b,c,e,d,g,h){var i,j;switch(d){case "middle":j=c/2;break;case "top":j=h+c;break;case "bottom":j=-h;break}switch(e){case "right":i=-h-b;break;case "center":i=-b/2;break;case "left":i=h;break}e=new pv.Vector(i,j);b=e.plus(b,0);d=b.plus(0,-c);c=e.plus(0,-c);if(g!==0){e=e.rotate(g);b=b.rotate(g);c=c.rotate(g);d=d.rotate(g)}return new pv.Shape.Polygon([e,b,d,c])};pv.Line=function(){pv.Mark.call(this)};
pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeStyle",pv.fillStyle).property("strokeDasharray",String).property("fillStyle",pv.fillStyle).property("segmented",pv.Area.castSegmented).property("interpolate",String).property("eccentricity",Number).property("tension",Number);a=pv.Line.prototype;a.type="line";a.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
a.bind=pv.Area.prototype.bind;a.buildInstance=pv.Area.prototype.buildInstance;a.anchor=function(b){return pv.Area.prototype.anchor.call(this,b).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center";case "right":return"left"}}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "top":return"bottom";case "bottom":return"top"}})};
a.getShapeCore=function(b,c){var e=b[c];b=c+1<b.length?b[c+1]:null;if(b==null||!b.visible)return new pv.Shape.Point(e.left,e.top);return new pv.Shape.Line(e.left,e.top,b.left,b.top)};pv.Rule=function(){pv.Mark.call(this)};pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);a=pv.Rule.prototype;a.type="rule";a.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(false).lineCap("butt").strokeDasharray("none");
a.anchor=pv.Line.prototype.anchor;a.buildImplied=function(b){var c=b.left,e=b.right;if(b.width!=null||c==null&&e==null||e!=null&&c!=null)b.height=0;else b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};a.getShapeCore=function(b,c){b=b[c];return new pv.Shape.Line(b.left,b.top,b.left+b.width,b.top+b.height)};pv.Panel=function(){pv.Bar.call(this);this.children=[];this.root=this;this.$dom=pv.$&&pv.$.s};
pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(b){return typeof b=="string"?document.getElementById(b):b});a=pv.Panel.prototype;a.type="panel";a.animatingCount=0;a.zOrderChildCount=0;a.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible");a.anchor=function(b){b=pv.Bar.prototype.anchor.call(this,b);b.parent=this;return b};
a.add=function(b){b=new b;b.parent=this;b.root=this.root;b.childIndex=this.children.length;this.children.push(b);return b};a.bind=function(){pv.Mark.prototype.bind.call(this);for(var b=this.children,c=0,e=b.length;c<e;c++)b[c].bind()};
a.buildInstance=function(b){pv.Bar.prototype.buildInstance.call(this,b);if(b.visible){var c=this.scale*b.transform.k;pv.Mark.prototype.index=-1;for(var e=this.children,d=b.children||(b.children=[]),g=0,h=e.length;g<h;g++){b=e[g];b.scene=d[g];b.scale=c;b.build()}for(g=0;g<h;g++){b=e[g];d[g]=b.scene;delete b.scene;delete b.scale}d.length=h}};
a.buildImplied=function(b){if(!this.parent){var c=b.canvas;if(pv.renderer()==="batik")if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}}else c=document.lastChild;else if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}var e;if(b.width==null){e=parseFloat(pv.css(c,"width"));b.width=e-b.left-b.right}if(b.height==null){e=parseFloat(pv.css(c,"height"));b.height=e-b.top-b.bottom}}else{e=
this.$canvas||(this.$canvas=[]);if(!(c=e[this.index])){c=e[this.index]=document.createElement(pv.renderer()=="svgweb"?"div":"span");if(this.$dom)this.$dom.parentNode.insertBefore(c,this.$dom);else{for(e=document.body;e.lastChild&&e.lastChild.tagName;)e=e.lastChild;if(e!=document.body)e=e.parentNode;e.appendChild(c)}}}b.canvas=c}if(!b.transform)b.transform=pv.Transform.identity;pv.Mark.prototype.buildImplied.call(this,b)};pv.Panel.updateCreateId=function(b){b.$pvCreateId=(b.$pvCreateId||0)+1};
pv.Image=function(){pv.Bar.call(this)};pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number);a=pv.Image.prototype;a.type="image";a.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null);a.image=function(b){this.$image=function(){var c=b.apply(this,arguments);return c==null?pv.Color.transparent:typeof c=="string"?pv.color(c):c};return this};
a.bind=function(){pv.Bar.prototype.bind.call(this);var b=this.binds,c=this;do b.image=c.$image;while(!b.image&&(c=c.proto))};
a.buildImplied=function(b){pv.Bar.prototype.buildImplied.call(this,b);if(b.visible){if(b.imageWidth==null)b.imageWidth=b.width;if(b.imageHeight==null)b.imageHeight=b.height;if(b.url==null&&this.binds.image){var c=this.$canvas||(this.$canvas=document.createElement("canvas")),e=c.getContext("2d"),d=b.imageWidth,g=b.imageHeight,h=pv.Mark.stack;c.width=d;c.height=g;b=(b.image=e.createImageData(d,g)).data;h.unshift(null,null);for(e=c=0;c<g;c++){h[1]=c;for(var i=0;i<d;i++){h[0]=i;var j=this.binds.image.apply(this,
h);b[e++]=j.r;b[e++]=j.g;b[e++]=j.b;b[e++]=255*j.a}}h.splice(0,2)}}};pv.Wedge=function(){pv.Mark.call(this)};
pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);a=pv.Wedge.prototype;a.type="wedge";
a.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var b=this.sibling();return b?b.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");a.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2};a.midAngle=function(){return(this.startAngle()+this.endAngle())/2};
a.anchor=function(b){function c(g){return g.innerRadius||g.angle<2*Math.PI}function e(g){return(g.innerRadius+g.outerRadius)/2}function d(g){return(g.startAngle+g.endAngle)/2}return pv.Mark.prototype.anchor.call(this,b).left(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "outer":return g.left+g.outerRadius*Math.cos(d(g));case "inner":return g.left+g.innerRadius*Math.cos(d(g));case "start":return g.left+e(g)*Math.cos(g.startAngle);case "center":return g.left+e(g)*Math.cos(d(g));
case "end":return g.left+e(g)*Math.cos(g.endAngle)}return g.left}).top(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "outer":return g.top+g.outerRadius*Math.sin(d(g));case "inner":return g.top+g.innerRadius*Math.sin(d(g));case "start":return g.top+e(g)*Math.sin(g.startAngle);case "center":return g.top+e(g)*Math.sin(d(g));case "end":return g.top+e(g)*Math.sin(g.endAngle)}return g.top}).textAlign(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "outer":return pv.Wedge.upright(d(g))?
"right":"left";case "inner":return pv.Wedge.upright(d(g))?"left":"right"}return"center"}).textBaseline(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "start":return pv.Wedge.upright(g.startAngle)?"top":"bottom";case "end":return pv.Wedge.upright(g.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var g=this.scene.target[this.index],h=0;if(c(g))switch(this.name()){case "center":case "inner":case "outer":h=d(g);break;case "start":h=g.startAngle;break;case "end":h=
g.endAngle;break}return pv.Wedge.upright(h)?h:h+Math.PI})};pv.Wedge.upright=function(b){b%=2*Math.PI;b=b<0?2*Math.PI+b:b;return b<Math.PI/2||b>=3*Math.PI/2};pv.Wedge.prototype.buildImplied=function(b){if(b.angle==null)b.angle=b.endAngle-b.startAngle;else if(b.endAngle==null)b.endAngle=b.startAngle+b.angle;pv.Mark.prototype.buildImplied.call(this,b)};pv.Wedge.prototype.getShapeCore=function(b,c){b=b[c];return new pv.Shape.Wedge(b.left,b.top,b.innerRadius,b.outerRadius,b.startAngle,b.angle)};
pv.Ease=function(){function b(q){return function(r){return 1-q(1-r)}}function c(q){return function(r){return 0.5*(r<0.5?q(2*r):2-q(2-2*r))}}function e(q){return function(r){return r<0?0:r>1?1:Math.pow(r,q)}}function d(q){return 1-Math.cos(q*Math.PI/2)}function g(q){return q?Math.pow(2,10*(q-1))-0.001:0}function h(q){return-(Math.sqrt(1-q*q)-1)}function i(q,r){var v;r||(r=0.45);if(!q||q<1){q=1;v=r/4}else v=r/(2*Math.PI)*Math.asin(1/q);return function(u){return u<=0||u>=1?u:-(q*Math.pow(2,10*--u)*Math.sin((u-
v)*2*Math.PI/r))}}function j(q){q||(q=1.70158);return function(r){return r*r*((q+1)*r-q)}}function k(q){return q<1/2.75?7.5625*q*q:q<2/2.75?7.5625*(q-=1.5/2.75)*q+0.75:q<2.5/2.75?7.5625*(q-=2.25/2.75)*q+0.9375:7.5625*(q-=2.625/2.75)*q+0.984375}var l=e(2),n=e(3),m=i(),p=j(),o={linear:pv.identity,"quad-in":l,"quad-out":b(l),"quad-in-out":c(l),"quad-out-in":c(b(l)),"cubic-in":n,"cubic-out":b(n),"cubic-in-out":c(n),"cubic-out-in":c(b(n)),"sin-in":d,"sin-out":b(d),"sin-in-out":c(d),"sin-out-in":c(b(d)),
"exp-in":g,"exp-out":b(g),"exp-in-out":c(g),"exp-out-in":c(b(g)),"circle-in":h,"circle-out":b(h),"circle-in-out":c(h),"circle-out-in":c(b(h)),"elastic-in":m,"elastic-out":b(m),"elastic-in-out":c(m),"elastic-out-in":c(b(m)),"back-in":p,"back-out":b(p),"back-in-out":c(p),"back-out-in":c(b(p)),"bounce-in":k,"bounce-out":b(k),"bounce-in-out":c(k),"bounce-out-in":c(b(k))};pv.ease=function(q){return o[q]};return{reverse:b,reflect:c,linear:function(){return pv.identity},sin:function(){return d},exp:function(){return g},
circle:function(){return h},elastic:i,back:j,bounce:k,poly:e}}();
pv.Transition=function(b){function c(r){for(var v={},u=0;u<r.length;u++){var t=r[u];if(t.id)v[t.id]=t}return v}function e(r,v,u,t){var s;if(v in o){var x=pv.Scale.interpolator(u[v],t[v]);s=function(w){u[v]=x(w)}}else s=function(w){if(w>0.5)u[v]=t[v]};s.next=r.head;r.head=s}function d(r,v,u){for(var t in v)t!="children"&&v[t]!=u[t]&&e(r,t,v,u);if(v.children)for(t=0;t<v.children.length;t++)g(r,v.children[t],u.children[t])}function g(r,v,u){for(var t=v.mark,s=c(v),x=c(u),w=0;w<v.length;w++){var A=v[w],
y=A.id?x[A.id]:u[w];A.index=w;if(A.visible){if(!(y&&y.visible)){var B=h(v,w,t.$exit,u);A.transition=y?2:(u.push(B),1);y=B}d(r,A,y)}}for(w=0;w<u.length;w++){y=u[w];A=y.id?s[y.id]:v[w];if(!(A&&A.visible)&&y.visible){B=h(u,w,t.$enter,v);if(A)v[A.index]=B;else v.push(B);d(r,B,y)}}}function h(r,v,u,t){var s=pv.extend(r[v]),x=r.mark,w=x.root.scene,A=(u||q).$properties,y;if(t.target&&(y=t.target[t.length])){r=pv.extend(r);r.target=pv.extend(t.target);r.target[v]=y}var B={};for(u=0;u<A.length;u++)B[A[u].name]=
1;A=x.binds.optional.filter(function(z){return!(z.name in B)}).concat(A);x.context(r,v,function(){this.buildProperties(s,A);this.buildImplied(s)});x.root.scene=w;return s}function i(r){for(var v=0,u=0;v<r.length;v++){var t=r[v];if(t.transition!=1){r[u++]=t;if(t.transition==2)t.visible=false;t.children&&t.children.forEach(i)}}r.length=u}function j(){b.root.animatingCount--;if(p){var r=p;p=null;r()}}var k=this,l=pv.ease("cubic-in-out"),n=250,m,p,o={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,
outerRadius:1,radius:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},q=new pv.Transient;k.ease=function(r){return arguments.length?(l=typeof r=="function"?r:pv.ease(r),k):l};k.duration=function(r){return arguments.length?(n=Number(r),k):n};k.start=function(r){p=r;b.root.animatingCount++;if(b.parent){j();throw new Error("Animated partial rendering is not supported.");}try{b.$transition&&b.$transition.stop();b.$transition=
k;var v=pv.Mark.prototype.index,u=b.scene,t;b.scene=null;b.bind();b.build();t=b.scene;b.scene=u;pv.Mark.prototype.index=v;var s=Date.now(),x={};g(x,u,t)}catch(w){j();throw w;}m=setInterval(function(){for(var A=Math.max(0,Math.min(1,(Date.now()-s)/n)),y=l(A),B=x.head;B;B=B.next)B(y);if(A==1){i(b.scene);k.stop()}pv.Scene.updateAll(u)},24)};k.stop=function(){clearInterval(m);j()}};pv.Transient=function(b){pv.Mark.call(this);this.fillStyle(null).strokeStyle(null).textStyle(null);this.on=function(c){return b.on(c)}};
pv.Transient.prototype=pv.extend(pv.Mark);pv.simulation=function(b){return new pv.Simulation(b)};pv.Simulation=function(b){for(var c=0;c<b.length;c++)this.particle(b[c])};a=pv.Simulation.prototype;a.particle=function(b){b.next=this.particles;if(isNaN(b.px))b.px=b.x;if(isNaN(b.py))b.py=b.y;if(isNaN(b.fx))b.fx=0;if(isNaN(b.fy))b.fy=0;this.particles=b;return this};a.force=function(b){b.next=this.forces;this.forces=b;return this};a.constraint=function(b){b.next=this.constraints;this.constraints=b;return this};
a.stabilize=function(b){var c;arguments.length||(b=3);for(var e=0;e<b;e++){var d=new pv.Quadtree(this.particles);for(c=this.constraints;c;c=c.next)c.apply(this.particles,d)}for(c=this.particles;c;c=c.next){c.px=c.x;c.py=c.y}return this};
a.step=function(){var b;for(b=this.particles;b;b=b.next){var c=b.px,e=b.py;b.px=b.x;b.py=b.y;b.x+=b.vx=b.x-c+b.fx;b.y+=b.vy=b.y-e+b.fy}c=new pv.Quadtree(this.particles);for(b=this.constraints;b;b=b.next)b.apply(this.particles,c);for(b=this.particles;b;b=b.next)b.fx=b.fy=0;for(b=this.forces;b;b=b.next)b.apply(this.particles,c)};
pv.Quadtree=function(b){function c(l,n,m,p,o,q){if(!(isNaN(n.x)||isNaN(n.y)))if(l.leaf)if(l.p){if(!(Math.abs(l.p.x-n.x)+Math.abs(l.p.y-n.y)<0.01)){var r=l.p;l.p=null;e(l,r,m,p,o,q)}e(l,n,m,p,o,q)}else l.p=n;else e(l,n,m,p,o,q)}function e(l,n,m,p,o,q){var r=(m+o)*0.5,v=(p+q)*0.5,u=n.x>=r,t=n.y>=v;l.leaf=false;switch((t<<1)+u){case 0:l=l.c1||(l.c1=new pv.Quadtree.Node);break;case 1:l=l.c2||(l.c2=new pv.Quadtree.Node);break;case 2:l=l.c3||(l.c3=new pv.Quadtree.Node);break;case 3:l=l.c4||(l.c4=new pv.Quadtree.Node);
break}if(u)m=r;else o=r;if(t)p=v;else q=v;c(l,n,m,p,o,q)}var d,g=Number.POSITIVE_INFINITY,h=g,i=Number.NEGATIVE_INFINITY,j=i;for(d=b;d;d=d.next){if(d.x<g)g=d.x;if(d.y<h)h=d.y;if(d.x>i)i=d.x;if(d.y>j)j=d.y}d=i-g;var k=j-h;if(d>k)j=h+d;else i=g+k;this.xMin=g;this.yMin=h;this.xMax=i;this.yMax=j;this.root=new pv.Quadtree.Node;for(d=b;d;d=d.next)c(this.root,d,g,h,i,j)};pv.Quadtree.Node=function(){this.leaf=true;this.p=this.c4=this.c3=this.c2=this.c1=null};pv.Force={};
pv.Force.charge=function(b){function c(l){function n(o){c(o);l.cn+=o.cn;m+=o.cn*o.cx;p+=o.cn*o.cy}var m=0,p=0;l.cn=0;if(!l.leaf){l.c1&&n(l.c1);l.c2&&n(l.c2);l.c3&&n(l.c3);l.c4&&n(l.c4)}if(l.p){l.cn+=b;m+=b*l.p.x;p+=b*l.p.y}l.cx=m/l.cn;l.cy=p/l.cn}function e(l,n,m,p,o,q){var r=l.cx-n.x,v=l.cy-n.y,u=1/Math.sqrt(r*r+v*v);if(l.leaf&&l.p!=n||(o-m)*u<j){if(!(u<i)){if(u>g)u=g;l=l.cn*u*u*u;r=r*l;v=v*l;n.fx+=r;n.fy+=v}}else if(!l.leaf){var t=(m+o)*0.5,s=(p+q)*0.5;l.c1&&e(l.c1,n,m,p,t,s);l.c2&&e(l.c2,n,t,p,
o,s);l.c3&&e(l.c3,n,m,s,t,q);l.c4&&e(l.c4,n,t,s,o,q);if(!(u<i)){if(u>g)u=g;if(l.p&&l.p!=n){l=b*u*u*u;r=r*l;v=v*l;n.fx+=r;n.fy+=v}}}}var d=2,g=1/d,h=500,i=1/h,j=0.9,k={};arguments.length||(b=-40);k.constant=function(l){if(arguments.length){b=Number(l);return k}return b};k.domain=function(l,n){if(arguments.length){d=Number(l);g=1/d;h=Number(n);i=1/h;return k}return[d,h]};k.theta=function(l){if(arguments.length){j=Number(l);return k}return j};k.apply=function(l,n){c(n.root);for(l=l;l;l=l.next)e(n.root,
l,n.xMin,n.yMin,n.xMax,n.yMax)};return k};pv.Force.drag=function(b){var c={};arguments.length||(b=0.1);c.constant=function(e){if(arguments.length){b=e;return c}return b};c.apply=function(e){if(b)for(e=e;e;e=e.next){e.fx-=b*e.vx;e.fy-=b*e.vy}};return c};
pv.Force.spring=function(b){var c=0.1,e=20,d,g,h={};arguments.length||(b=0.1);h.links=function(i){if(arguments.length){d=i;g=i.map(function(j){return 1/Math.sqrt(Math.max(j.sourceNode.linkDegree,j.targetNode.linkDegree))});return h}return d};h.constant=function(i){if(arguments.length){b=Number(i);return h}return b};h.damping=function(i){if(arguments.length){c=Number(i);return h}return c};h.length=function(i){if(arguments.length){e=Number(i);return h}return e};h.apply=function(){for(var i=0;i<d.length;i++){var j=
d[i].sourceNode,k=d[i].targetNode,l=j.x-k.x,n=j.y-k.y,m=Math.sqrt(l*l+n*n),p=m?1/m:1;p=(b*g[i]*(m-e)+c*g[i]*(l*(j.vx-k.vx)+n*(j.vy-k.vy))*p)*p;l=-p*(m?l:0.01*(0.5-Math.random()));n=-p*(m?n:0.01*(0.5-Math.random()));j.fx+=l;j.fy+=n;k.fx-=l;k.fy-=n}};return h};pv.Constraint={};
pv.Constraint.collision=function(b){function c(l,n,m,p,o,q){if(!l.leaf){var r=(m+o)*0.5,v=(p+q)*0.5,u=v<j,t=r>g,s=r<i;if(v>h){l.c1&&t&&c(l.c1,n,m,p,r,v);l.c2&&s&&c(l.c2,n,r,p,o,v)}if(u){l.c3&&t&&c(l.c3,n,m,v,r,q);l.c4&&s&&c(l.c4,n,r,v,o,q)}}if(l.p&&l.p!=n){m=n.x-l.p.x;p=n.y-l.p.y;o=Math.sqrt(m*m+p*p);q=d+b(l.p);if(o<q){o=(o-q)/o*0.5;m*=o;p*=o;n.x-=m;n.y-=p;l.p.x+=m;l.p.y+=p}}}var e=1,d,g,h,i,j,k={};arguments.length||(d=10);k.repeat=function(l){if(arguments.length){e=Number(l);return k}return e};k.apply=
function(l,n){var m,p,o=-Infinity;for(m=l;m;m=m.next){p=b(m);if(p>o)o=p}for(var q=0;q<e;q++)for(m=l;m;m=m.next){p=(d=b(m))+o;g=m.x-p;i=m.x+p;h=m.y-p;j=m.y+p;c(n.root,m,n.xMin,n.yMin,n.xMax,n.yMax)}};return k};pv.Constraint.position=function(b){var c=1,e={};arguments.length||(b=function(d){return d.fix});e.alpha=function(d){if(arguments.length){c=Number(d);return e}return c};e.apply=function(d){for(d=d;d;d=d.next){var g=b(d);if(g){d.x+=(g.x-d.x)*c;d.y+=(g.y-d.y)*c;d.fx=d.fy=d.vx=d.vy=0}}};return e};
pv.Constraint.bound=function(){var b={},c,e;b.x=function(d,g){if(arguments.length){c={min:Math.min(d,g),max:Math.max(d,g)};return this}return c};b.y=function(d,g){if(arguments.length){e={min:Math.min(d,g),max:Math.max(d,g)};return this}return e};b.apply=function(d){if(c)for(var g=d;g;g=g.next)g.x=g.x<c.min?c.min:g.x>c.max?c.max:g.x;if(e)for(g=d;g;g=g.next)g.y=g.y<e.min?e.min:g.y>e.max?e.max:g.y};return b};pv.Layout=function(){pv.Panel.call(this)};pv.Layout.prototype=pv.extend(pv.Panel);
pv.Layout.prototype.property=pv.Mark.prototype.localProperty;
pv.Layout.Network=function(){pv.Layout.call(this);var b=this;this.$id=pv.id();(this.node=(new pv.Mark).data(function(){return b.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(c){return c.x}).top(function(c){return c.y})).parent=this;this.link=(new pv.Mark).extend(this.node).data(function(c){return[c.sourceNode,c.targetNode]}).fillStyle(null).lineWidth(function(c,e){return e.linkValue*1.5}).strokeStyle("rgba(0,0,0,.2)");this.link.add=function(c){return b.add(pv.Panel).data(function(){return b.links()}).add(c).extend(this)};
(this.label=(new pv.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(c){return c.nodeName||c.nodeValue}).textAngle(function(c){c=c.midAngle;return pv.Wedge.upright(c)?c:c+Math.PI}).textAlign(function(c){return pv.Wedge.upright(c.midAngle)?"left":"right"})).parent=this};
pv.Layout.Network.prototype=pv.extend(pv.Layout).property("nodes",function(b){return b.map(function(c,e){if(typeof c!="object")c={nodeValue:c};c.index=e;return c})}).property("links",function(b){return b.map(function(c){if(isNaN(c.linkValue))c.linkValue=isNaN(c.value)?1:c.value;return c})});pv.Layout.Network.prototype.reset=function(){this.$id=pv.id();return this};pv.Layout.Network.prototype.buildProperties=function(b,c){if((b.$id||0)<this.$id)pv.Layout.prototype.buildProperties.call(this,b,c)};
pv.Layout.Network.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);if(b.$id>=this.$id)return true;b.$id=this.$id;b.nodes.forEach(function(c){c.linkDegree=0});b.links.forEach(function(c){var e=c.linkValue;(c.sourceNode||(c.sourceNode=b.nodes[c.source])).linkDegree+=e;(c.targetNode||(c.targetNode=b.nodes[c.target])).linkDegree+=e})};pv.Layout.Hierarchy=function(){pv.Layout.Network.call(this);this.link.strokeStyle("#ccc")};pv.Layout.Hierarchy.prototype=pv.extend(pv.Layout.Network);
pv.Layout.Hierarchy.prototype.buildImplied=function(b){if(!b.links)b.links=pv.Layout.Hierarchy.links.call(this);pv.Layout.Network.prototype.buildImplied.call(this,b)};pv.Layout.Hierarchy.links=function(){return this.nodes().filter(function(b){return b.parentNode}).map(function(b){return{sourceNode:b,targetNode:b.parentNode,linkValue:1}})};
pv.Layout.Hierarchy.NodeLink={buildImplied:function(b){function c(o){return o.parentNode?o.depth*(m-n)+n:0}function e(o){return o.parentNode?(o.breadth-0.25)*2*Math.PI:0}function d(o){switch(i){case "left":return o.depth*k;case "right":return k-o.depth*k;case "top":return o.breadth*k;case "bottom":return k-o.breadth*k;case "radial":return k/2+c(o)*Math.cos(o.midAngle)}}function g(o){switch(i){case "left":return o.breadth*l;case "right":return l-o.breadth*l;case "top":return o.depth*l;case "bottom":return l-
o.depth*l;case "radial":return l/2+c(o)*Math.sin(o.midAngle)}}var h=b.nodes,i=b.orient,j=/^(top|bottom)$/.test(i),k=b.width,l=b.height;if(i=="radial"){var n=b.innerRadius,m=b.outerRadius;if(n==null)n=0;if(m==null)m=Math.min(k,l)/2}for(b=0;b<h.length;b++){var p=h[b];p.midAngle=i=="radial"?e(p):j?Math.PI/2:0;p.x=d(p);p.y=g(p);if(p.firstChild)p.midAngle+=Math.PI}}};
pv.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(b){return b.dx}).height(function(b){return b.dy}).innerRadius(function(b){return b.innerRadius}).outerRadius(function(b){return b.outerRadius}).startAngle(function(b){return b.startAngle}).angle(function(b){return b.angle});this.label.textAlign("center").left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2});delete this.link},buildImplied:function(b){function c(s,x){return(s+
x)/(1+x)}function e(s){switch(m){case "left":return c(s.minDepth,r)*o;case "right":return(1-c(s.maxDepth,r))*o;case "top":return s.minBreadth*o;case "bottom":return(1-s.maxBreadth)*o;case "radial":return o/2}}function d(s){switch(m){case "left":return s.minBreadth*q;case "right":return(1-s.maxBreadth)*q;case "top":return c(s.minDepth,r)*q;case "bottom":return(1-c(s.maxDepth,r))*q;case "radial":return q/2}}function g(s){switch(m){case "left":case "right":return(s.maxDepth-s.minDepth)/(1+r)*o;case "top":case "bottom":return(s.maxBreadth-
s.minBreadth)*o;case "radial":return s.parentNode?(s.innerRadius+s.outerRadius)*Math.cos(s.midAngle):0}}function h(s){switch(m){case "left":case "right":return(s.maxBreadth-s.minBreadth)*q;case "top":case "bottom":return(s.maxDepth-s.minDepth)/(1+r)*q;case "radial":return s.parentNode?(s.innerRadius+s.outerRadius)*Math.sin(s.midAngle):0}}function i(s){return Math.max(0,c(s.minDepth,r/2))*(u-v)+v}function j(s){return c(s.maxDepth,r/2)*(u-v)+v}function k(s){return(s.parentNode?s.minBreadth-0.25:0)*
2*Math.PI}function l(s){return(s.parentNode?s.maxBreadth-s.minBreadth:1)*2*Math.PI}var n=b.nodes,m=b.orient,p=/^(top|bottom)$/.test(m),o=b.width,q=b.height,r=-n[0].minDepth;if(m=="radial"){var v=b.innerRadius,u=b.outerRadius;if(v==null)v=0;if(v)r*=2;if(u==null)u=Math.min(o,q)/2}for(b=0;b<n.length;b++){var t=n[b];t.x=e(t);t.y=d(t);if(m=="radial"){t.innerRadius=i(t);t.outerRadius=j(t);t.startAngle=k(t);t.angle=l(t);t.midAngle=t.startAngle+t.angle/2}else t.midAngle=p?-Math.PI/2:0;t.dx=g(t);t.dy=h(t)}}};
pv.Layout.Grid=function(){pv.Layout.call(this);var b=this;(this.cell=(new pv.Mark).data(function(){return b.scene[b.index].$grid}).width(function(){return b.width()/b.cols()}).height(function(){return b.height()/b.rows()}).left(function(){return this.width()*(this.index%b.cols())}).top(function(){return this.height()*Math.floor(this.index/b.cols())})).parent=this};pv.Layout.Grid.prototype=pv.extend(pv.Layout).property("rows").property("cols");pv.Layout.Grid.prototype.defaults=(new pv.Layout.Grid).extend(pv.Layout.prototype.defaults).rows(1).cols(1);
pv.Layout.Grid.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=b.rows,e=b.cols;if(typeof e=="object")c=pv.transpose(e);if(typeof c=="object"){b.$grid=pv.blend(c);b.rows=c.length;b.cols=c[0]?c[0].length:0}else b.$grid=pv.repeat([b.data],c*e)};
pv.Layout.Stack=function(){function b(i){return function(){return d[i](this.parent.index,this.index)}}pv.Layout.call(this);var c=this,e=function(){return null},d={t:e,l:e,r:e,b:e,w:e,h:e},g,h=c.buildImplied;this.buildImplied=function(i){h.call(this,i);var j=i.layers,k=j.length,l,n=i.orient,m=/^(top|bottom)\b/.test(n),p=this.parent[m?"height":"width"](),o=[],q=[],r=[],v=pv.Mark.stack,u={parent:{parent:this}};v.unshift(null);g=[];for(var t=0;t<k;t++){r[t]=[];q[t]=[];u.parent.index=t;v[0]=j[t];g[t]=
this.$values.apply(u.parent,v);if(!t)l=g[t].length;v.unshift(null);for(var s=0;s<l;s++){v[0]=g[t][s];u.index=s;t||(o[s]=this.$x.apply(u,v));r[t][s]=this.$y.apply(u,v)}v.shift()}v.shift();switch(i.order){case "inside-out":var x=r.map(function(z){return pv.max.index(z)});u=pv.range(k).sort(function(z,D){return x[z]-x[D]});j=r.map(function(z){return pv.sum(z)});var w=v=0,A=[],y=[];for(t=0;t<k;t++){s=u[t];if(v<w){v+=j[s];A.push(s)}else{w+=j[s];y.push(s)}}j=y.reverse().concat(A);break;case "reverse":j=
pv.range(k-1,-1,-1);break;default:j=pv.range(k);break}switch(i.offset){case "silohouette":for(s=0;s<l;s++){for(t=u=0;t<k;t++)u+=r[t][s];q[j[0]][s]=(p-u)/2}break;case "wiggle":for(t=u=0;t<k;t++)u+=r[t][0];q[j[0]][0]=u=(p-u)/2;for(s=1;s<l;s++){v=p=0;w=o[s]-o[s-1];for(t=0;t<k;t++)p+=r[t][s];for(t=0;t<k;t++){A=(r[j[t]][s]-r[j[t]][s-1])/(2*w);for(i=0;i<t;i++)A+=(r[j[i]][s]-r[j[i]][s-1])/w;v+=A*r[j[t]][s]}q[j[0]][s]=u-=p?v/p*w:0}break;case "expand":for(s=0;s<l;s++){for(t=i=q[j[0]][s]=0;t<k;t++)i+=r[t][s];
if(i){i=p/i;for(t=0;t<k;t++)r[t][s]*=i}else{i=p/k;for(t=0;t<k;t++)r[t][s]=i}}break;default:for(s=0;s<l;s++)q[j[0]][s]=0;break}for(s=0;s<l;s++){u=q[j[0]][s];for(t=1;t<k;t++){u+=r[j[t-1]][s];q[j[t]][s]=u}}t=n.indexOf("-");k=m?"h":"w";m=t<0?m?"l":"b":n.charAt(t+1);n=n.charAt(0);for(var B in d)d[B]=e;d[m]=function(z,D){return o[D]};d[n]=function(z,D){return q[z][D]};d[k]=function(z,D){return r[z][D]}};this.layer=(new pv.Mark).data(function(){return g[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));
this.layer.add=function(i){return c.add(pv.Panel).data(function(){return c.layers()}).add(i).extend(this)}};pv.Layout.Stack.prototype=pv.extend(pv.Layout).property("orient",String).property("offset",String).property("order",String).property("layers");a=pv.Layout.Stack.prototype;a.defaults=(new pv.Layout.Stack).extend(pv.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]);a.$x=pv.Layout.Stack.prototype.$y=function(){return 0};a.x=function(b){this.$x=pv.functor(b);return this};
a.y=function(b){this.$y=pv.functor(b);return this};a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.Band=function(){function b(k){return function(){return d[k](this.index,this.parent.index)}}pv.Layout.call(this);var c=this,e=c.buildImplied,d,g,h=(new pv.Mark).data(function(){return g[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));this.buildImplied=function(k){e.call(this,k);d=Object.create(pv.Layout.Band.$baseItemProps);g=[];var l=k.layers,n=l.length;if(n>0){var m=k.orient,p=/^(top|bottom)\b/.test(m),o=this.parent[p?"height":"width"]();
l=this._readData(l,g,k);var q=l.length;k.bandOrder==="reverse"&&l.reverse();if(k.order==="reverse"){g.reverse();for(var r=0;r<q;r++)l[r].items.reverse()}switch(k.layout){case "grouped":this._calcGrouped(l,n,k);break;case "stacked":this._calcStacked(l,n,o,k);break}this._bindItemProps(l,d,m,p)}};var i=this.item={end:this,add:function(k){return c.add(pv.Panel).data(function(){return c.layers()}).add(k).extend(h)},order:function(k){c.order(k);return this},w:function(k){c.$iw=pv.functor(k);return this},
h:function(k){c.$ih=pv.functor(k);return this},horizontalRatio:function(k){c.$ihorizRatio=pv.functor(k);return this},verticalMargin:function(k){c.$ivertiMargin=pv.functor(k);return this}},j=this.band={end:this,w:function(k){c.$bw=pv.functor(k);return this},x:function(k){c.$bx=pv.functor(k);return this},order:function(k){c.bandOrder(k);return this},differentialControl:function(k){c.$bDiffControl=pv.functor(k);return this}};this.band.item=i;this.item.band=j};
pv.Layout.Band.$baseItemProps=function(){var b=function(){return null};return{t:b,l:b,r:b,b:b,w:b,h:b}}();pv.Layout.Band.prototype=pv.extend(pv.Layout).property("orient",String).property("layout",String).property("layers").property("yZero",Number).property("verticalMode",String).property("horizontalMode",String).property("order",String).property("bandOrder",String);a=pv.Layout.Band.prototype;a.defaults=(new pv.Layout.Band).extend(pv.Layout.prototype.defaults).orient("bottom-left").layout("grouped").yZero(0).layers([[]]);
a.$bx=pv.Layout.Band.prototype.$bw=pv.Layout.Band.prototype.$bDiffControl=pv.Layout.Band.prototype.$iw=pv.Layout.Band.prototype.$ih=pv.Layout.Band.prototype.$ivertiMargin=pv.functor(0);a.$ihorizRatio=pv.functor(0.9);a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.prototype._readData=function(b,c,e){var d=b.length,g=[],h,i=pv.Mark.stack,j={parent:{parent:this}};i.unshift(null);for(var k=0;k<d;k++){j.parent.index=k;i[0]=b[k];var l=c[k]=this.$values.apply(j.parent,i);if(!k)h=l.length;i.unshift(null);for(var n=0;n<h;n++){i[0]=l[n];j.index=n;var m=g[n];m||(m=g[n]={horizRatio:this.$ihorizRatio.apply(j,i),vertiMargin:this.$ivertiMargin.apply(j,i),w:this.$bw.apply(j,i),x:this.$bx.apply(j,i),diffControl:this.$bDiffControl?this.$bDiffControl.apply(j,i):0,
items:[]});var p=this.$ih.apply(j,i);m.items[k]={y:e.yZero||0,x:0,w:this.$iw.apply(j,i),h:p!=null?Math.abs(p):p,dir:p<0?-1:1}}i.shift()}i.shift();return g};
pv.Layout.Band.prototype._calcGrouped=function(b,c,e){for(var d=0,g=b.length;d<g;d++){for(var h=b[d],i=h.items,j=h.w,k=h.horizRatio,l=0,n=0;n<c;n++)l+=i[n].w;if(c===1)k=1;else k>0&&k<=1||(k=1);if(j==null)h.w=l/k;else if(e.horizontalMode==="expand"){j=k*j;if(l){l=j/l;for(n=0;n<c;n++)i[n].w*=l}else{l=j/c;for(n=0;n<c;n++)i[n].w=l}l=j}n=l/k;h=h.x-n/2;k=c>1?(n-l)/(c-1):0;for(n=0;n<c;n++){l=i[n];l.x=h;h+=l.w+k;if(l.dir<0)l.y-=l.h}}};
pv.Layout.Band.prototype._calcStacked=function(b,c,e,d){var g=b.length,h;if(d.verticalMode==="expand")for(var i=0;i<g;i++){h=b[i].items;for(var j=null,k=0,l=0;l<c;l++){var n=h[l];n.dir=1;n=n.h;if(n!=null){k++;j+=n}}if(k)if(j){j=e/j;for(l=0;l<c;l++){n=h[l].h;if(n!=null)h[l].h=n*j}}else{j=e/k;for(l=0;l<c;l++){n=h[l].h;if(n!=null)h[l].h=j}}}e=c=d.yZero;for(i=0;i<g;i++){h=b[i];d=h.x;l=h.diffControl;n=l<0;j=h.vertiMargin>0?h.vertiMargin:0;h=h.items;k=this._layoutItemsOfDir(+1,n,h,j,d,e);var m;if(k.existsOtherDir)m=
this._layoutItemsOfDir(-1,n,h,j,d,e);if(l){if(Math.abs(l)===1){h=e;e=k.yOffset;if(m)e-=h-m.yOffset}}else e=c}};pv.Layout.Band.prototype._layoutItemsOfDir=function(b,c,e,d,g,h){for(var i=false,j=d/2,k=c?-b:b,l=0,n=e.length;l<n;l+=1){var m=e[c?n-l-1:l];if(m.dir===b){var p=m.h||0;if(k>0){m.y=h+j;h+=p}else{m.y=h-(p-j);h-=p}p=m.h-d;m.h=p>0?p:0;m.x=g-m.w/2}else i=true}return{existsOtherDir:i,yOffset:h}};
pv.Layout.Band.prototype._bindItemProps=function(b,c,e,d){var g=e.indexOf("-"),h=d?"h":"w",i=d?"w":"h";d=g<0?d?"l":"b":e.charAt(g+1);e=e.charAt(0);c[d]=function(j,k){return b[j].items[k].x};c[e]=function(j,k){return b[j].items[k].y};c[i]=function(j,k){return b[j].items[k].w};c[h]=function(j,k){return b[j].items[k].h||0}};
pv.Layout.Treemap=function(){pv.Layout.Hierarchy.call(this);this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(b){return b.dx}).height(function(b){return b.dy});this.label.visible(function(b){return!b.firstChild}).left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2}).textAlign("center").textAngle(function(b){return b.dx>b.dy?0:-Math.PI/2});(this.leaf=(new pv.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(b){return!b.firstChild})).parent=
this;delete this.link};pv.Layout.Treemap.prototype=pv.extend(pv.Layout.Hierarchy).property("round",Boolean).property("paddingLeft",Number).property("paddingRight",Number).property("paddingTop",Number).property("paddingBottom",Number).property("mode",String).property("order",String);a=pv.Layout.Treemap.prototype;a.defaults=(new pv.Layout.Treemap).extend(pv.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending");a.padding=function(b){return this.paddingLeft(b).paddingRight(b).paddingTop(b).paddingBottom(b)};
a.$size=function(b){return Number(b.nodeValue)};a.size=function(b){this.$size=pv.functor(b);return this};
a.buildImplied=function(b){function c(q,r,v,u,t,s,x){for(var w=0,A=0;w<q.length;w++){var y=q[w];if(v){y.x=u+A;y.y=t;A+=y.dx=p(s*y.size/r);y.dy=x}else{y.x=u;y.y=t+A;y.dx=s;A+=y.dy=p(x*y.size/r)}}if(y)if(v)y.dx+=s-A;else y.dy+=x-A}function e(q,r){for(var v=-Infinity,u=Infinity,t=0,s=0;s<q.length;s++){var x=q[s].size;if(x<u)u=x;if(x>v)v=x;t+=x}t*=t;r*=r;return Math.max(r*v/t,t/(r*u))}function d(q,r){function v(z){var D=s==A,F=pv.sum(z,m),C=A?p(F/A):0;c(z,F,D,u,t,D?s:C,D?C:x);if(D){t+=C;x-=C}else{u+=
C;s-=C}A=Math.min(s,x);return D}var u=q.x+j,t=q.y+l,s=q.dx-j-k,x=q.dy-l-n;if(o!="squarify")c(q.childNodes,q.size,o=="slice"?true:o=="dice"?false:r&1,u,t,s,x);else{var w=[];r=Infinity;var A=Math.min(s,x),y=s*x/q.size;if(!(q.size<=0)){q.visitBefore(function(z){z.size*=y});for(q=q.childNodes.slice();q.length;){var B=q[q.length-1];if(B.size){w.push(B);y=e(w,A);if(y<=r){q.pop();r=y}else{w.pop();v(w);w.length=0;r=Infinity}}else q.pop()}if(v(w))for(r=0;r<w.length;r++)w[r].dy+=x;else for(r=0;r<w.length;r++)w[r].dx+=
s}}}pv.Layout.Hierarchy.prototype.buildImplied.call(this,b);var g=this,h=b.nodes[0],i=pv.Mark.stack,j=b.paddingLeft,k=b.paddingRight,l=b.paddingTop,n=b.paddingBottom,m=function(q){return q.size},p=b.round?Math.round:Number,o=b.mode;i.unshift(null);try{h.visitAfter(function(q,r){q.depth=r;q.x=q.y=q.dx=q.dy=0;q.size=q.firstChild?pv.sum(q.childNodes,function(v){return v.size}):g.$size.apply(g,(i[0]=q,i))})}finally{i.shift()}switch(b.order){case "ascending":h.sort(function(q,r){return q.size-r.size});
break;case "descending":h.sort(function(q,r){return r.size-q.size});break;case "reverse":h.reverse();break}h.x=0;h.y=0;h.dx=b.width;h.dy=b.height;h.visitBefore(d)};pv.Layout.Tree=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Tree.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String);pv.Layout.Tree.prototype.defaults=(new pv.Layout.Tree).extend(pv.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top");
pv.Layout.Tree.prototype.buildImplied=function(b){function c(s){var x,w,A;if(s.firstChild){x=s.firstChild;w=s.lastChild;for(var y=A=x;y;y=y.nextSibling){c(y);A=d(y,A)}j(s);w=0.5*(x.prelim+w.prelim);if(x=s.previousSibling){s.prelim=x.prelim+l(s.depth,true);s.mod=s.prelim-w}else s.prelim=w}else if(x=s.previousSibling)s.prelim=x.prelim+l(s.depth,true)}function e(s,x,w){s.breadth=s.prelim+x;x+=s.mod;for(s=s.firstChild;s;s=s.nextSibling)e(s,x,w)}function d(s,x){var w=s.previousSibling;if(w){var A=s,y=
s,B=w;w=s.parentNode.firstChild;var z=A.mod,D=y.mod,F=B.mod,C=w.mod;B=h(B);for(A=g(A);B&&A;){B=B;A=A;w=g(w);y=h(y);y.ancestor=s;var E=B.prelim+F-(A.prelim+z)+l(B.depth,false);if(E>0){i(k(B,s,x),s,E);z+=E;D+=E}F+=B.mod;z+=A.mod;C+=w.mod;D+=y.mod;B=h(B);A=g(A)}if(B&&!h(y)){y.thread=B;y.mod+=F-D}if(A&&!g(w)){w.thread=A;w.mod+=z-C;x=s}}return x}function g(s){return s.firstChild||s.thread}function h(s){return s.lastChild||s.thread}function i(s,x,w){var A=x.number-s.number;x.change-=w/A;x.shift+=w;s.change+=
w/A;x.prelim+=w;x.mod+=w}function j(s){var x=0,w=0;for(s=s.lastChild;s;s=s.previousSibling){s.prelim+=x;s.mod+=x;w+=s.change;x+=s.shift+w}}function k(s,x,w){return s.ancestor.parentNode==x.parentNode?s.ancestor:w}function l(s,x){return(x?1:v+1)/(o=="radial"?s:1)}function n(s){return o=="radial"?s.breadth/q:0}function m(s){switch(o){case "left":return s.depth;case "right":return u-s.depth;case "top":case "bottom":return s.breadth+u/2;case "radial":return u/2+s.depth*Math.cos(n(s))}}function p(s){switch(o){case "left":case "right":return s.breadth+
t/2;case "top":return s.depth;case "bottom":return t-s.depth;case "radial":return t/2+s.depth*Math.sin(n(s))}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var o=b.orient,q=b.depth,r=b.breadth,v=b.group,u=b.width,t=b.height;b=b.nodes[0];b.visitAfter(function(s,x){s.ancestor=s;s.prelim=0;s.mod=0;s.change=0;s.shift=0;s.number=s.previousSibling?s.previousSibling.number+1:0;s.depth=x});c(b);e(b,-b.prelim,0);b.visitAfter(function(s){s.breadth*=r;s.depth*=q;s.midAngle=n(s);s.x=m(s);s.y=p(s);
if(s.firstChild)s.midAngle+=Math.PI;delete s.breadth;delete s.depth;delete s.ancestor;delete s.prelim;delete s.mod;delete s.change;delete s.shift;delete s.number;delete s.thread})}};pv.Layout.Indent=function(){pv.Layout.Hierarchy.call(this);this.link.interpolate("step-after")};pv.Layout.Indent.prototype=pv.extend(pv.Layout.Hierarchy).property("depth",Number).property("breadth",Number);pv.Layout.Indent.prototype.defaults=(new pv.Layout.Indent).extend(pv.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15);
pv.Layout.Indent.prototype.buildImplied=function(b){function c(i,j,k){i.x=g+k++*d;i.y=h+j++*e;i.midAngle=0;for(i=i.firstChild;i;i=i.nextSibling)j=c(i,j,k);return j}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var e=b.breadth,d=b.depth,g=0,h=0;c(b.nodes[0],1,1)}};pv.Layout.Pack=function(){pv.Layout.Hierarchy.call(this);this.node.shapeRadius(function(b){return b.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)");this.label.textAlign("center");delete this.link};
pv.Layout.Pack.prototype=pv.extend(pv.Layout.Hierarchy).property("spacing",Number).property("order",String);pv.Layout.Pack.prototype.defaults=(new pv.Layout.Pack).extend(pv.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending");pv.Layout.Pack.prototype.$radius=function(){return 1};pv.Layout.Pack.prototype.size=function(b){this.$radius=typeof b=="function"?function(){return Math.sqrt(b.apply(this,arguments))}:(b=Math.sqrt(b),function(){return b});return this};
pv.Layout.Pack.prototype.buildImplied=function(b){function c(m){var p=pv.Mark.stack;p.unshift(null);for(var o=0,q=m.length;o<q;o++){var r=m[o];if(!r.firstChild)r.radius=i.$radius.apply(i,(p[0]=r,p))}p.shift()}function e(m){var p=[];for(m=m.firstChild;m;m=m.nextSibling){if(m.firstChild)m.radius=e(m);m.n=m.p=m;p.push(m)}switch(b.order){case "ascending":p.sort(function(o,q){return o.radius-q.radius});break;case "descending":p.sort(function(o,q){return q.radius-o.radius});break;case "reverse":p.reverse();
break}return d(p)}function d(m){function p(E){v=Math.min(E.x-E.radius,v);u=Math.max(E.x+E.radius,u);t=Math.min(E.y-E.radius,t);s=Math.max(E.y+E.radius,s)}function o(E,G){var H=E.n;E.n=G;G.p=E;G.n=H;H.p=G}function q(E,G){E.n=G;G.p=E}function r(E,G){var H=G.x-E.x,I=G.y-E.y;E=E.radius+G.radius;return E*E-H*H-I*I>0.001}var v=Infinity,u=-Infinity,t=Infinity,s=-Infinity,x,w,A,y,B;x=m[0];x.x=-x.radius;x.y=0;p(x);if(m.length>1){w=m[1];w.x=w.radius;w.y=0;p(w);if(m.length>2){A=m[2];g(x,w,A);p(A);o(x,A);x.p=
A;o(A,w);w=x.n;for(var z=3;z<m.length;z++){g(x,w,A=m[z]);var D=0,F=1,C=1;for(y=w.n;y!=w;y=y.n,F++)if(r(y,A)){D=1;break}if(D==1)for(B=x.p;B!=y.p;B=B.p,C++)if(r(B,A)){if(C<F){D=-1;y=B}break}if(D==0){o(x,A);w=A;p(A)}else if(D>0){q(x,y);w=y;z--}else if(D<0){q(y,w);x=y;z--}}}}x=(v+u)/2;w=(t+s)/2;for(z=A=0;z<m.length;z++){y=m[z];y.x-=x;y.y-=w;A=Math.max(A,y.radius+Math.sqrt(y.x*y.x+y.y*y.y))}return A+b.spacing}function g(m,p,o){var q=p.radius+o.radius,r=m.radius+o.radius,v=p.x-m.x;p=p.y-m.y;var u=Math.sqrt(v*
v+p*p),t=(r*r+u*u-q*q)/(2*r*u);q=Math.acos(t);t=t*r;r=Math.sin(q)*r;v/=u;p/=u;o.x=m.x+t*v+r*p;o.y=m.y+t*p-r*v}function h(m,p,o,q){for(var r=m.firstChild;r;r=r.nextSibling){r.x+=m.x;r.y+=m.y;h(r,p,o,q)}m.x=p+q*m.x;m.y=o+q*m.y;m.radius*=q}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var i=this,j=b.nodes,k=j[0];c(j);k.x=0;k.y=0;k.radius=e(k);j=this.width();var l=this.height(),n=1/Math.max(2*k.radius/j,2*k.radius/l);h(k,j/2,l/2,n)}};
pv.Layout.Force=function(){pv.Layout.Network.call(this);this.link.lineWidth(function(b,c){return Math.sqrt(c.linkValue)*1.5});this.label.textAlign("center")};
pv.Layout.Force.prototype=pv.extend(pv.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number);pv.Layout.Force.prototype.defaults=(new pv.Layout.Force).extend(pv.Layout.Network.prototype.defaults).dragConstant(0.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(0.9).springConstant(0.1).springDamping(0.3).springLength(20);
pv.Layout.Force.prototype.buildImplied=function(b){function c(n){return n.fix?1:n.vx*n.vx+n.vy*n.vy}if(pv.Layout.Network.prototype.buildImplied.call(this,b)){if(b=b.$force){b.next=this.binds.$force;this.binds.$force=b}}else{for(var e=this,d=b.nodes,g=b.links,h=b.iterations,i=b.width,j=b.height,k=0,l;k<d.length;k++){l=d[k];if(isNaN(l.x))l.x=i/2+40*Math.random()-20;if(isNaN(l.y))l.y=j/2+40*Math.random()-20}l=pv.simulation(d);l.force(pv.Force.drag(b.dragConstant));l.force(pv.Force.charge(b.chargeConstant).domain(b.chargeMinDistance,
b.chargeMaxDistance).theta(b.chargeTheta));l.force(pv.Force.spring(b.springConstant).damping(b.springDamping).length(b.springLength).links(g));l.constraint(pv.Constraint.position());b.bound&&l.constraint(pv.Constraint.bound().x(6,i-6).y(6,j-6));if(h==null){l.step();l.step();b.$force=this.binds.$force={next:this.binds.$force,nodes:d,min:1.0E-4*(g.length+1),sim:l};if(!this.$timer)this.$timer=setInterval(function(){for(var n=false,m=e.binds.$force;m;m=m.next)if(pv.max(m.nodes,c)>m.min){m.sim.step();
n=true}n&&e.render()},42)}else for(k=0;k<h;k++)l.step()}};pv.Layout.Cluster=function(){pv.Layout.Hierarchy.call(this);var b,c=this.buildImplied;this.buildImplied=function(e){c.call(this,e);b=/^(top|bottom)$/.test(e.orient)?"step-before":/^(left|right)$/.test(e.orient)?"step-after":"linear"};this.link.interpolate(function(){return b})};
pv.Layout.Cluster.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);pv.Layout.Cluster.prototype.defaults=(new pv.Layout.Cluster).extend(pv.Layout.Hierarchy.prototype.defaults).group(0).orient("top");
pv.Layout.Cluster.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=b.nodes[0],e=b.group,d,g,h=0,i=0.5-e/2,j=undefined;c.visitAfter(function(k){if(k.firstChild)k.depth=1+pv.max(k.childNodes,function(l){return l.depth});else{if(e&&j!=k.parentNode){j=k.parentNode;h+=e}h++;k.depth=0}});d=1/h;g=1/c.depth;j=undefined;c.visitAfter(function(k){if(k.firstChild)k.breadth=pv.mean(k.childNodes,function(l){return l.breadth});else{if(e&&j!=k.parentNode){j=k.parentNode;
i+=e}k.breadth=d*i++}k.depth=1-k.depth*g});c.visitAfter(function(k){k.minBreadth=k.firstChild?k.firstChild.minBreadth:k.breadth-d/2;k.maxBreadth=k.firstChild?k.lastChild.maxBreadth:k.breadth+d/2});c.visitBefore(function(k){k.minDepth=k.parentNode?k.parentNode.maxDepth:0;k.maxDepth=k.parentNode?k.depth+c.depth:k.minDepth+2*c.depth});c.minDepth=-g;pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Cluster.Fill=function(){pv.Layout.Cluster.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};
pv.Layout.Cluster.Fill.prototype=pv.extend(pv.Layout.Cluster);pv.Layout.Cluster.Fill.prototype.buildImplied=function(b){pv.Layout.Cluster.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Partition=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Partition.prototype=pv.extend(pv.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);
pv.Layout.Partition.prototype.defaults=(new pv.Layout.Partition).extend(pv.Layout.Hierarchy.prototype.defaults).orient("top");pv.Layout.Partition.prototype.$size=function(){return 1};pv.Layout.Partition.prototype.size=function(b){this.$size=b;return this};
pv.Layout.Partition.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=this,e=b.nodes[0],d=pv.Mark.stack,g=0;d.unshift(null);e.visitAfter(function(h,i){if(i>g)g=i;h.size=h.firstChild?pv.sum(h.childNodes,function(j){return j.size}):c.$size.apply(c,(d[0]=h,d))});d.shift();switch(b.order){case "ascending":e.sort(function(h,i){return h.size-i.size});break;case "descending":e.sort(function(h,i){return i.size-h.size});break}e.minBreadth=0;e.breadth=0.5;
e.maxBreadth=1;e.visitBefore(function(h){for(var i=h.minBreadth,j=h.maxBreadth-i,k=h.firstChild;k;k=k.nextSibling){k.minBreadth=i;i+=k.size/h.size*j;k.maxBreadth=i;k.breadth=(i+k.minBreadth)/2}});e.visitAfter(function(h,i){h.minDepth=(i-1)/g;h.maxDepth=h.depth=i/g});pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Partition.Fill=function(){pv.Layout.Partition.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};pv.Layout.Partition.Fill.prototype=pv.extend(pv.Layout.Partition);
pv.Layout.Partition.Fill.prototype.buildImplied=function(b){pv.Layout.Partition.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Arc=function(){pv.Layout.Network.call(this);var b,c,e,d=this.buildImplied;this.buildImplied=function(g){d.call(this,g);c=g.directed;b=g.orient=="radial"?"linear":"polar";e=g.orient=="right"||g.orient=="top"};this.link.data(function(g){var h=g.sourceNode;g=g.targetNode;return e!=(c||h.breadth<g.breadth)?[h,g]:[g,h]}).interpolate(function(){return b})};
pv.Layout.Arc.prototype=pv.extend(pv.Layout.Network).property("orient",String).property("directed",Boolean);pv.Layout.Arc.prototype.defaults=(new pv.Layout.Arc).extend(pv.Layout.Network.prototype.defaults).orient("bottom");pv.Layout.Arc.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Arc.prototype.buildImplied=function(b){function c(o){switch(h){case "top":return-Math.PI/2;case "bottom":return Math.PI/2;case "left":return Math.PI;case "right":return 0;case "radial":return(o-0.25)*2*Math.PI}}function e(o){switch(h){case "top":case "bottom":return o*k;case "left":return 0;case "right":return k;case "radial":return k/2+n*Math.cos(c(o))}}function d(o){switch(h){case "top":return 0;case "bottom":return l;case "left":case "right":return o*l;case "radial":return l/2+n*Math.sin(c(o))}}
if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var g=b.nodes,h=b.orient,i=this.$sort,j=pv.range(g.length),k=b.width,l=b.height,n=Math.min(k,l)/2;i&&j.sort(function(o,q){return i(g[o],g[q])});for(b=0;b<g.length;b++){var m=g[j[b]],p=m.breadth=(b+0.5)/g.length;m.x=e(p);m.y=d(p);m.midAngle=c(p)}}};
pv.Layout.Horizon=function(){pv.Layout.call(this);var b=this,c,e,d,g,h,i,j=this.buildImplied;this.buildImplied=function(k){j.call(this,k);c=k.bands;e=k.mode;d=Math.round((e=="color"?0.5:1)*k.height);g=k.backgroundStyle;h=pv.ramp(g,k.negativeStyle).domain(0,c);i=pv.ramp(g,k.positiveStyle).domain(0,c)};c=(new pv.Panel).data(function(){return pv.range(c*2)}).overflow("hidden").height(function(){return d}).top(function(k){return e=="color"?(k&1)*d:0}).fillStyle(function(k){return k?null:g});this.band=
(new pv.Mark).top(function(k,l){return e=="mirror"&&l&1?(l+1>>1)*d:null}).bottom(function(k,l){return e=="mirror"?l&1?null:(l+1>>1)*-d:(l&1||-1)*(l+1>>1)*d}).fillStyle(function(k,l){return(l&1?h:i)((l>>1)+1)});this.band.add=function(k){return b.add(pv.Panel).extend(c).add(k).extend(this)}};pv.Layout.Horizon.prototype=pv.extend(pv.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",pv.color).property("positiveStyle",pv.color).property("negativeStyle",pv.color);
pv.Layout.Horizon.prototype.defaults=(new pv.Layout.Horizon).extend(pv.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728");
pv.Layout.Rollup=function(){pv.Layout.Network.call(this);var b=this,c,e,d=b.buildImplied;this.buildImplied=function(g){d.call(this,g);c=g.$rollup.nodes;e=g.$rollup.links};this.node.data(function(){return c}).shapeSize(function(g){return g.nodes.length*20});this.link.interpolate("polar").eccentricity(0.8);this.link.add=function(g){return b.add(pv.Panel).data(function(){return e}).add(g).extend(this)}};pv.Layout.Rollup.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);
pv.Layout.Rollup.prototype.x=function(b){this.$x=pv.functor(b);return this};pv.Layout.Rollup.prototype.y=function(b){this.$y=pv.functor(b);return this};
pv.Layout.Rollup.prototype.buildImplied=function(b){function c(q){return i[q]+","+j[q]}if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var e=b.nodes,d=b.links,g=b.directed,h=e.length,i=[],j=[],k=0,l={},n={},m=pv.Mark.stack,p={parent:this};m.unshift(null);for(var o=0;o<h;o++){p.index=o;m[0]=e[o];i[o]=this.$x.apply(p,m);j[o]=this.$y.apply(p,m)}m.shift();for(o=0;o<e.length;o++){h=c(o);m=l[h];if(!m){m=l[h]=pv.extend(e[o]);m.index=k++;m.x=i[o];m.y=j[o];m.nodes=[]}m.nodes.push(e[o])}for(o=0;o<
d.length;o++){k=d[o].targetNode;e=l[c(d[o].sourceNode.index)];k=l[c(k.index)];h=!g&&e.index>k.index?k.index+","+e.index:e.index+","+k.index;(m=n[h])||(m=n[h]={sourceNode:e,targetNode:k,linkValue:0,links:[]});m.links.push(d[o]);m.linkValue+=d[o].linkValue}b.$rollup={nodes:pv.values(l),links:pv.values(n)}}};
pv.Layout.Matrix=function(){pv.Layout.Network.call(this);var b,c,e,d,g,h=this.buildImplied;this.buildImplied=function(i){h.call(this,i);b=i.nodes.length;c=i.width/b;e=i.height/b;d=i.$matrix.labels;g=i.$matrix.pairs};this.link.data(function(){return g}).left(function(){return c*(this.index%b)}).top(function(){return e*Math.floor(this.index/b)}).width(function(){return c}).height(function(){return e}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(i){return i.linkValue?"#555":"#eee"}).parent=
this;delete this.link.add;this.label.data(function(){return d}).left(function(){return this.index&1?c*((this.index>>1)+0.5):0}).top(function(){return this.index&1?0:e*((this.index>>1)+0.5)}).textMargin(4).textAlign(function(){return this.index&1?"left":"right"}).textAngle(function(){return this.index&1?-Math.PI/2:0});delete this.node};pv.Layout.Matrix.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);pv.Layout.Matrix.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Matrix.prototype.buildImplied=function(b){if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var c=b.nodes,e=b.links,d=this.$sort,g=c.length,h=pv.range(g),i=[],j=[],k={};b.$matrix={labels:i,pairs:j};d&&h.sort(function(o,q){return d(c[o],c[q])});for(var l=0;l<g;l++)for(var n=0;n<g;n++){var m=h[l],p=h[n];j.push(k[m+"."+p]={row:l,col:n,sourceNode:c[m],targetNode:c[p],linkValue:0})}for(l=0;l<g;l++){m=h[l];i.push(c[m],c[m])}for(l=0;l<e.length;l++){i=e[l];g=i.sourceNode.index;h=i.targetNode.index;
i=i.linkValue;k[g+"."+h].linkValue+=i;b.directed||(k[h+"."+g].linkValue+=i)}}};
pv.Layout.Bullet=function(){pv.Layout.call(this);var b=this,c=b.buildImplied,e=b.x=pv.Scale.linear(),d,g,h,i,j;this.buildImplied=function(k){c.call(this,j=k);d=k.orient;g=/^left|right$/.test(d);h=pv.ramp("#bbb","#eee").domain(0,Math.max(1,j.ranges.length-1));i=pv.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,j.measures.length-1))};(this.range=new pv.Mark).data(function(){return j.ranges}).reverse(true).left(function(){return d=="left"?0:null}).top(function(){return d=="top"?0:null}).right(function(){return d==
"right"?0:null}).bottom(function(){return d=="bottom"?0:null}).width(function(k){return g?e(k):null}).height(function(k){return g?null:e(k)}).fillStyle(function(){return h(this.index)}).antialias(false).parent=b;(this.measure=new pv.Mark).extend(this.range).data(function(){return j.measures}).left(function(){return d=="left"?0:g?null:this.parent.width()/3.25}).top(function(){return d=="top"?0:g?this.parent.height()/3.25:null}).right(function(){return d=="right"?0:g?null:this.parent.width()/3.25}).bottom(function(){return d==
"bottom"?0:g?this.parent.height()/3.25:null}).fillStyle(function(){return i(this.index)}).parent=b;(this.marker=new pv.Mark).data(function(){return j.markers}).left(function(k){return d=="left"?e(k):g?null:this.parent.width()/2}).top(function(k){return d=="top"?e(k):g?this.parent.height()/2:null}).right(function(k){return d=="right"?e(k):null}).bottom(function(k){return d=="bottom"?e(k):null}).strokeStyle("black").shape("bar").shapeAngle(function(){return g?0:Math.PI/2}).parent=b;(this.tick=new pv.Mark).data(function(){return e.ticks(7)}).left(function(k){return d==
"left"?e(k):null}).top(function(k){return d=="top"?e(k):null}).right(function(k){return d=="right"?e(k):g?null:-6}).bottom(function(k){return d=="bottom"?e(k):g?-8:null}).height(function(){return g?6:null}).width(function(){return g?null:6}).parent=b};pv.Layout.Bullet.prototype=pv.extend(pv.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("maximum",Number);pv.Layout.Bullet.prototype.defaults=(new pv.Layout.Bullet).extend(pv.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]);
pv.Layout.Bullet.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=this.parent[/^left|right$/.test(b.orient)?"width":"height"]();b.maximum=b.maximum||pv.max([].concat(b.ranges,b.markers,b.measures));this.x.domain(0,b.maximum).range(0,c)};pv.Behavior={};
pv.Behavior.dragBase=function(b){function c(p){if(!n){n=true;this.addEventInterceptor("click",i,true)}if(!j){var o=this.root.scene.$g;j=[[o,"mousemove",pv.listen(o,"mousemove",e)],[o,"mouseup",pv.listen(o,"mouseup",d)],[document,"mousemove",pv.listen(document,"mousemove",e)],[document,"mouseup",pv.listen(document,"mouseup",d)]]}var q=arguments[arguments.length-1];k=q.target;l=false;q.stopPropagation();o=this.mouse();var r=this.scene,v=this.index;m=r[v].drag={phase:"start",m:o,m1:o,m2:null,d:p,scene:r,
index:v};q=g(q,m);b.dragstart.call(this,q);q=m.m;if(q!==o){o.x=q.x;o.y=q.y}}function e(p){if(m){m.phase="move";p.stopPropagation();p=g(p,m);var o=m.scene;o.mark.context(o,m.index,function(){var q=m.m2||m.m1,r=this.mouse();if(!(q&&r.distance2(q).dist2<=2)){m.m=m.m2=r;b.drag.call(this,p);q=m.m;if(q!==r){r.x=q.x;r.y=q.y}}})}}function d(p){if(m){m.phase="end";var o=m.m2;o=o&&m.m1.distance2(o).dist2>0.1;m.canceled=!o;(l=o&&k===p.target)||(k=null);p.stopPropagation();p=g(p,m);if(j){j.forEach(function(r){pv.unlisten.apply(pv,
r)});j=null}o=m.scene;var q=m.index;try{o.mark.context(o,q,function(){b.dragend.call(this,p)})}finally{m=null;delete o[q].drag}}}function g(p,o){try{p.drag=o;return p}catch(q){}o={};for(var r in p){var v=p[r];o[r]=typeof v!=="function"?v:h(f,p)}o._sourceEvent=p;return o}function h(p,o){return function(){return p.apply(o,arguments)}}function i(p,o){if(l&&k===o.target){l=false;k=null;return false}}var j,k,l,n,m;b.autoRender=true;b.positionConstraint=null;b.bound=function(p,o){return Math.max(m.min[o],
Math.min(m.max[o],p))};c.autoRender=function(p){if(arguments.length){b.autoRender=!!p;return c}return b.autoRender};c.positionConstraint=function(p){if(arguments.length){b.positionConstraint=p;return c}return b.positionConstraint};return c};
pv.Behavior.drag=function(){var b=null,c=1,e=1,d,g={dragstart:function(i){var j=i.drag;j.type="drag";var k=j.d,l=pv.vector(k.x,k.y);k.fix=l;k.drag=j;d=l.minus(j.m1);l=this.parent;j.max={x:l.width()-(k.dx||0),y:l.height()-(k.dy||0)};j.min={x:0,y:0};g.autoRender&&this.render();pv.Mark.dispatch("dragstart",j.scene,j.index,i)},drag:function(i){var j=i.drag,k=j.d;j.m=d.plus(j.m2);var l=g.positionConstraint;l&&l(j);l=j.m;if(c)k.x=k.fix.x=g.bound(l.x,"x");if(e)k.y=k.fix.y=g.bound(l.y,"y");g.autoRender&&
this.render();pv.Mark.dispatch("drag",j.scene,j.index,i)},dragend:function(i){var j=i.drag,k=j.d;d=k.fix=null;g.autoRender&&this.render();try{pv.Mark.dispatch("dragend",j.scene,j.index,i)}finally{delete k.drag}}},h=pv.Behavior.dragBase(g);h.collapse=function(i){if(arguments.length){b=String(i);switch(b){case "y":c=1;e=0;break;case "x":c=0;e=1;break;default:e=c=1;break}return h}return b};return h};
pv.Behavior.point=function(b){function c(n,m){n=n[m];m={cost:Infinity};for(var p=(n.visible?n.children.length:0)-1;p>=0;p--){var o=n.children[p],q=o.mark,r;if(q.type=="panel"){q.scene=o;for(var v=o.length-1;v>=0;v--){q.index=v;r=c(o,v);if(r.cost<m.cost)m=r}delete q.scene;delete q.index}else if(q.$handlers.point){q=q.mouse();for(v=o.length-1;v>=0;v--){var u=o[v];r=q.x-u.left-(u.width||0)/2;u=q.y-u.top-(u.height||0)/2;var t=i*r*r+j*u*u;if(t<m.cost){m.distance=r*r+u*u;m.cost=t;m.scene=o;m.index=v}}}}return m}
function e(n){var m=c(this.scene,this.index);if(m.cost==Infinity||m.distance>l)m=null;if(g){if(m&&g.scene==m.scene&&g.index==m.index)return;pv.Mark.dispatch("unpoint",g.scene,g.index,n)}if(g=m){pv.Mark.dispatch("point",m.scene,m.index,n);if(!k&&this.type==="panel"){k=this;k.event("mouseout",function(){d.call(k.scene.$g,arguments[arguments.length-1])})}else pv.listen(this.root.canvas(),"mouseout",d)}}function d(n){if(g&&!pv.ancestor(this,n.relatedTarget)){pv.Mark.dispatch("unpoint",g.scene,g.index,
n);g=null}}var g,h=null,i=1,j=1,k=null,l=arguments.length?b*b:900;e.collapse=function(n){if(arguments.length){h=String(n);switch(h){case "y":i=1;j=0;break;case "x":i=0;j=1;break;default:j=i=1;break}return e}return h};return e};
pv.Behavior.select=function(){var b=null,c=1,e=1,d=false,g={dragstart:function(i){var j=i.drag;j.type="select";var k=j.d;k.drag=j;j.max={x:this.width(),y:this.height()};j.min={x:0,y:0};var l=g.positionConstraint;if(l){j.m=j.m.clone();l(j)}l=j.m;if(c){k.x=g.bound(l.x,"x");if(!d)k.dx=0}if(e){k.y=g.bound(l.y,"y");if(!d)k.dy=0}pv.Mark.dispatch("selectstart",j.scene,j.index,i)},drag:function(i){var j=i.drag,k=j.m1,l=j.d;j.max.x=this.width();j.max.y=this.height();var n=g.positionConstraint;if(n){j.m=j.m.clone();
n(j)}n=j.m;if(c){var m=Math.min(k.x,n.x);m=g.bound(m,"x");l.x=m;if(!d){var p=Math.max(n.x,k.x);p=g.bound(p,"x");l.dx=p-m}}if(e){m=Math.min(k.y,n.y);m=g.bound(m,"y");l.y=m;if(!d){k=Math.max(n.y,k.y);k=g.bound(k,"y");l.dy=k-m}}g.autoRender&&this.render();pv.Mark.dispatch("select",j.scene,j.index,i)},dragend:function(i){var j=i.drag;try{pv.Mark.dispatch("selectend",j.scene,j.index,i)}finally{delete j.d.drag}}},h=pv.Behavior.dragBase(g);h.collapse=function(i){if(arguments.length){b=String(i);switch(b){case "y":c=
1;e=0;break;case "x":c=0;e=1;break;default:e=c=1;break}return h}return b};h.preserveLength=function(i){if(arguments.length){d=!!i;return h}return d};return h};
pv.Behavior.resize=function(b){var c=false,e=b==="left"||b==="right",d={dragstart:function(h){var i=h.drag;i.type="resize";var j=i.m1,k=i.d;k.drag=i;switch(b){case "left":j.x=k.x+k.dx;break;case "right":j.x=k.x;break;case "top":j.y=k.y+k.dy;break;case "bottom":j.y=k.y;break}j=this.parent;i.max={x:j.width(),y:j.height()};i.min={x:0,y:0};pv.Mark.dispatch("resizestart",i.scene,i.index,h)},drag:function(h){var i=h.drag,j=i.m1,k=d.positionConstraint;if(k){i.m=i.m.clone();k(i)}var l=i.m;k=i.d;if(!c||e){var n=
Math.min(j.x,l.x),m=Math.max(l.x,j.x);n=d.bound(n,"x");m=d.bound(m,"x");k.x=n;k.dx=m-n}if(!c||!e){n=Math.min(j.y,l.y);j=Math.max(l.y,j.y);d.bound(n,"y");d.bound(j,"y");k.y=n;k.dy=j-n}d.autoRender&&this.render();pv.Mark.dispatch("resize",i.scene,i.index,h)},dragend:function(h){var i=h.drag;max=null;try{pv.Mark.dispatch("resizeend",i.scene,i.index,h)}finally{delete i.d.drag}}},g=pv.Behavior.dragBase(d);g.preserveOrtho=function(h){if(arguments.length){c=!!h;return g}return c};return g};
pv.Behavior.pan=function(){function b(){g=this.index;d=this.scene;i=pv.vector(pv.event.pageX,pv.event.pageY);h=this.transform();j=1/(h.k*this.scale);if(k)k={x:(1-h.k)*this.width(),y:(1-h.k)*this.height()}}function c(l){if(d){d.mark.context(d,g,function(){var n=h.translate((pv.event.pageX-i.x)*j,(pv.event.pageY-i.y)*j);if(k){n.x=Math.max(k.x,Math.min(0,n.x));n.y=Math.max(k.y,Math.min(0,n.y))}this.transform(n).render()});pv.Mark.dispatch("pan",d,g,l)}}function e(){d=null}var d,g,h,i,j,k;b.bound=function(l){if(arguments.length){k=
Boolean(l);return this}return Boolean(k)};pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",e);return b};
pv.Behavior.zoom=function(b){function c(d){var g=this.mouse(),h=pv.event.wheel*b;g=this.transform().translate(g.x,g.y).scale(h<0?1E3/(1E3-h):(1E3+h)/1E3).translate(-g.x,-g.y);if(e){g.k=Math.max(1,g.k);g.x=Math.max((1-g.k)*this.width(),Math.min(0,g.x));g.y=Math.max((1-g.k)*this.height(),Math.min(0,g.y))}this.transform(g).render();pv.Mark.dispatch("zoom",this.scene,this.index,d)}var e;arguments.length||(b=1/48);c.bound=function(d){if(arguments.length){e=Boolean(d);return this}return Boolean(e)};return c};
pv.Geo=function(){};
pv.Geo.projections={mercator:{project:function(b){return{x:b.lng/180,y:b.lat>85?1:b.lat<-85?-1:Math.log(Math.tan(Math.PI/4+pv.radians(b.lat)/2))/Math.PI}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(2*Math.atan(Math.exp(b.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(b){return{x:b.lng/180,y:Math.sin(pv.radians(b.lat))}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(Math.asin(b.y))}}},sinusoidal:{project:function(b){return{x:pv.radians(b.lng)*Math.cos(pv.radians(b.lat))/Math.PI,
y:b.lat/90}},invert:function(b){return{lng:pv.degrees(b.x*Math.PI/Math.cos(b.y*Math.PI/2)),lat:b.y*90}}},aitoff:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);var e=Math.acos(Math.cos(b)*Math.cos(c/2));return{x:2*(e?Math.cos(b)*Math.sin(c/2)*e/Math.sin(e):0)/Math.PI,y:2*(e?Math.sin(b)*e/Math.sin(e):0)/Math.PI}},invert:function(b){var c=b.y*Math.PI/2;return{lng:pv.degrees(b.x*Math.PI/2/Math.cos(c)),lat:pv.degrees(c)}}},hammer:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);
var e=Math.sqrt(1+Math.cos(b)*Math.cos(c/2));return{x:2*Math.SQRT2*Math.cos(b)*Math.sin(c/2)/e/3,y:Math.SQRT2*Math.sin(b)/e/1.5}},invert:function(b){var c=b.x*3;b=b.y*1.5;var e=Math.sqrt(1-c*c/16-b*b/4);return{lng:pv.degrees(2*Math.atan2(e*c,2*(2*e*e-1))),lat:pv.degrees(Math.asin(e*b))}}},identity:{project:function(b){return{x:b.lng/180,y:b.lat/90}},invert:function(b){return{lng:b.x*180,lat:b.y*90}}}};
pv.Geo.scale=function(b){function c(o){if(!m||o.lng!=m.lng||o.lat!=m.lat){m=o;o=e(o);p={x:k(o.x),y:l(o.y)}}return p}function e(o){return j.project({lng:o.lng-n.lng,lat:o.lat})}function d(o){o=j.invert(o);o.lng+=n.lng;return o}var g={x:0,y:0},h={x:1,y:1},i=[],j=pv.Geo.projections.identity,k=pv.Scale.linear(-1,1).range(0,1),l=pv.Scale.linear(-1,1).range(1,0),n={lng:0,lat:0},m,p;c.x=function(o){return c(o).x};c.y=function(o){return c(o).y};c.ticks={lng:function(o){var q;if(i.length>1){var r=pv.Scale.linear();
if(o==undefined)o=10;q=r.domain(i,function(v){return v.lat}).ticks(o);o=r.domain(i,function(v){return v.lng}).ticks(o)}else{q=pv.range(-80,81,10);o=pv.range(-180,181,10)}return o.map(function(v){return q.map(function(u){return{lat:u,lng:v}})})},lat:function(o){return pv.transpose(c.ticks.lng(o))}};c.invert=function(o){return d({x:k.invert(o.x),y:l.invert(o.y)})};c.domain=function(o,q){if(arguments.length){i=o instanceof Array?arguments.length>1?pv.map(o,q):o:Array.prototype.slice.call(arguments);
if(i.length>1){var r=i.map(function(u){return u.lng}),v=i.map(function(u){return u.lat});n={lng:(pv.max(r)+pv.min(r))/2,lat:(pv.max(v)+pv.min(v))/2};r=i.map(e);k.domain(r,function(u){return u.x});l.domain(r,function(u){return u.y})}else{n={lng:0,lat:0};k.domain(-1,1);l.domain(-1,1)}m=null;return this}return i};c.range=function(o,q){if(arguments.length){if(typeof o=="object"){g={x:Number(o.x),y:Number(o.y)};h={x:Number(q.x),y:Number(q.y)}}else{g={x:0,y:0};h={x:Number(o),y:Number(q)}}k.range(g.x,h.x);
l.range(h.y,g.y);m=null;return this}return[g,h]};c.projection=function(o){if(arguments.length){j=typeof o=="string"?pv.Geo.projections[o]||pv.Geo.projections.identity:o;return this.domain(i)}return o};pv.copyOwn(c,pv.Scale.common);arguments.length&&c.projection(b);return c};

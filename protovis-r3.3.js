// 
var a;if(!Array.prototype.map)Array.prototype.map=function(b,c){for(var d=this.length,f=new Array(d),g=0;g<d;g++)if(g in this)f[g]=b.call(c,this[g],g,this);return f};if(!Array.prototype.filter)Array.prototype.filter=function(b,c){for(var d=this.length,f=[],g=0;g<d;g++)if(g in this){var h=this[g];b.call(c,h,g,this)&&f.push(h)}return f};if(!Array.prototype.forEach)Array.prototype.forEach=function(b,c){for(var d=this.length>>>0,f=0;f<d;f++)f in this&&b.call(c,this[f],f,this)};
if(!Array.prototype.reduce)Array.prototype.reduce=function(b,c){var d=this.length;if(!d&&arguments.length==1)throw new Error("reduce: empty array, no initial value");var f=0;if(arguments.length<2)for(;;){if(f in this){c=this[f++];break}if(++f>=d)throw new Error("reduce: no values, no initial value");}for(;f<d;f++)if(f in this)c=b(c,this[f],f,this);return c};var pv={};pv.version={major:3,minor:3};pv.identity=function(b){return b};pv.index=function(){return this.index};pv.child=function(){return this.childIndex};
pv.parent=function(){return this.parent.index};pv.extend=function(b){function c(){}c.prototype=b.prototype||b;return new c};
try{eval("pv.parse = function(x) x;")}catch(e){pv.parse=function(b){for(var c=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),d,f,g=0,h="";d=c.exec(b);){d=d.index+d[0].length;if(b.charAt(d)!="{"){h+=b.substring(g,d)+"{return ";g=d;for(var i=0;i>=0&&d<b.length;d++){var j=b.charAt(d);switch(j){case '"':case "'":for(;++d<b.length&&(f=b.charAt(d))!=j;)f=="\\"&&d++;break;case "[":case "(":i++;break;case "]":case ")":i--;break;case ";":case ",":i==0&&i--;break}}h+=pv.parse(b.substring(g,--d))+
";}";g=d}c.lastIndex=d}h+=b.substring(g);return h}}pv.css=function(b,c){return window.getComputedStyle?window.getComputedStyle(b,null).getPropertyValue(c):b.currentStyle[c]};pv.error=function(b){typeof console=="undefined"?alert(b):console.error(b)};pv.listen=function(b,c,d){if(c=="load"||c=="onload")return pv.listenForPageLoad(pv.listener(d));d=pv.listener(d);b.addEventListener?b.addEventListener(c,d,false):b.attachEvent("on"+c,d);return d};
pv.unlisten=function(b,c,d){if(d.$listener)d=d.$listener;b.removeEventListener?b.removeEventListener(c,d,false):b.detachEvent("on"+c,d)};pv.listener=function(b){return b.$listener||(b.$listener=function(c){try{pv.event=c;return b.call(this,c)}catch(d){pv.error(d)}finally{delete pv.event}})};pv.ancestor=function(b,c){for(;c;){if(c==b)return true;c=c.parentNode}return false};pv.scrollOffset=function(b){for(var c=0,d=0;b;){c+=b.scrollLeft||0;d+=b.scrollTop||0;b=b.parentNode}return[c,d]};
pv.listenForPageLoad=function(b){document.readyState==="complete"&&b();if(pv.renderer()=="svgweb")window.addEventListener("SVGLoad",b,false);else if(document.addEventListener)window.addEventListener("load",b,false);else document.attachEvent&&window.attachEvent("onload",b)};pv.renderer=function(){var b=typeof document.svgImplementation!=="undefined"?document.svgImplementation:typeof window.svgweb==="undefined"?"nativesvg":"svgweb";pv.renderer=function(){return b};return b};
pv.id=function(){var b=1;return function(){return b++}}();pv.functor=function(b){return typeof b=="function"?b:function(){return b}};pv.get=function(b,c,d){var f;return b&&(f=b[c])!=null?f:d};pv.renderer()!=="batik"&&pv.listen(window,"load",function(){pv.$={i:0,x:document.getElementsByTagName("script")};for(pv.$.xlen=pv.$.x.length;pv.$.i<pv.$.xlen;pv.$.i++){pv.$.s=pv.$.x[pv.$.i];if(pv.$.s.type=="text/javascript+protovis")try{window.eval(pv.parse(pv.$.s.text))}catch(b){pv.error(b)}}delete pv.$});
pv.Format={};pv.Format.re=function(b){return b.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")};pv.Format.pad=function(b,c,d){c=c-String(d).length;return c<1?d:(new Array(c+1)).join(b)+d};
pv.Format.date=function(b){function c(f){return b.replace(/%[a-zA-Z0-9]/g,function(g){switch(g){case "%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][f.getDay()];case "%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][f.getDay()];case "%h":case "%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][f.getMonth()];case "%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][f.getMonth()];
case "%c":return f.toLocaleString();case "%C":return d("0",2,Math.floor(f.getFullYear()/100)%100);case "%d":return d("0",2,f.getDate());case "%x":case "%D":return d("0",2,f.getMonth()+1)+"/"+d("0",2,f.getDate())+"/"+d("0",2,f.getFullYear()%100);case "%e":return d(" ",2,f.getDate());case "%H":return d("0",2,f.getHours());case "%I":return(g=f.getHours()%12)?d("0",2,g):12;case "%m":return d("0",2,f.getMonth()+1);case "%M":return d("0",2,f.getMinutes());case "%n":return"\n";case "%p":return f.getHours()<
12?"AM":"PM";case "%T":case "%X":case "%r":g=f.getHours()%12;return(g?d("0",2,g):12)+":"+d("0",2,f.getMinutes())+":"+d("0",2,f.getSeconds())+" "+(f.getHours()<12?"AM":"PM");case "%R":return d("0",2,f.getHours())+":"+d("0",2,f.getMinutes());case "%S":return d("0",2,f.getSeconds());case "%Q":return d("0",3,f.getMilliseconds());case "%t":return"\t";case "%u":return(g=f.getDay())?g:1;case "%w":return f.getDay();case "%y":return d("0",2,f.getFullYear()%100);case "%Y":return f.getFullYear();case "%%":return"%"}return g})}
var d=pv.Format.pad;c.format=c;c.parse=function(f){var g=1970,h=0,i=1,j=0,k=0,l=0,q=[function(){}],m=pv.Format.re(b).replace(/%[a-zA-Z0-9]/g,function(s){switch(s){case "%b":q.push(function(n){h={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[n]});return"([A-Za-z]+)";case "%h":case "%B":q.push(function(n){h={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[n]});return"([A-Za-z]+)";case "%e":case "%d":q.push(function(n){i=
n});return"([0-9]+)";case "%I":case "%H":q.push(function(n){j=n});return"([0-9]+)";case "%m":q.push(function(n){h=n-1});return"([0-9]+)";case "%M":q.push(function(n){k=n});return"([0-9]+)";case "%p":q.push(function(n){if(j==12){if(n=="am")j=0}else if(n=="pm")j=Number(j)+12});return"(am|pm)";case "%S":q.push(function(n){l=n});return"([0-9]+)";case "%y":q.push(function(n){n=Number(n);g=n+(0<=n&&n<69?2E3:n>=69&&n<100?1900:0)});return"([0-9]+)";case "%Y":q.push(function(n){g=n});return"([0-9]+)";case "%%":q.push(function(){});
return"%"}return s});(f=f.match(m))&&f.forEach(function(s,n){q[n](s)});return new Date(g,h,i,j,k,l)};return c};
pv.Format.time=function(b){function c(f){f=Number(f);switch(b){case "short":if(f>=31536E6)return(f/31536E6).toFixed(1)+" years";else if(f>=6048E5)return(f/6048E5).toFixed(1)+" weeks";else if(f>=864E5)return(f/864E5).toFixed(1)+" days";else if(f>=36E5)return(f/36E5).toFixed(1)+" hours";else if(f>=6E4)return(f/6E4).toFixed(1)+" minutes";return(f/1E3).toFixed(1)+" seconds";case "long":var g=[],h=f%36E5/6E4>>0;g.push(d("0",2,f%6E4/1E3>>0));if(f>=36E5){var i=f%864E5/36E5>>0;g.push(d("0",2,h));if(f>=864E5){g.push(d("0",
2,i));g.push(Math.floor(f/864E5).toFixed())}else g.push(i.toFixed())}else g.push(h.toFixed());return g.reverse().join(":")}}var d=pv.Format.pad;c.format=c;c.parse=function(f){switch(b){case "short":for(var g=/([0-9,.]+)\s*([a-z]+)/g,h,i=0;h=g.exec(f);){var j=parseFloat(h[0].replace(",","")),k=0;switch(h[2].toLowerCase()){case "year":case "years":k=31536E6;break;case "week":case "weeks":k=6048E5;break;case "day":case "days":k=864E5;break;case "hour":case "hours":k=36E5;break;case "minute":case "minutes":k=
6E4;break;case "second":case "seconds":k=1E3;break}i+=j*k}return i;case "long":h=f.replace(",","").split(":").reverse();i=0;if(h.length)i+=parseFloat(h[0])*1E3;if(h.length>1)i+=parseFloat(h[1])*6E4;if(h.length>2)i+=parseFloat(h[2])*36E5;if(h.length>3)i+=parseFloat(h[3])*864E5;return i}};return c};
pv.Format.number=function(){function b(o){if(Infinity>h)o=Math.round(o*i)/i;var p=String(Math.abs(o)).split("."),t=p[0];if(t.length>d)t=t.substring(t.length-d);if(l&&t.length<c)t=(new Array(c-t.length+1)).join(j)+t;if(t.length>3)t=t.replace(/\B(?=(?:\d{3})+(?!\d))/g,m);if(!l&&t.length<f)t=(new Array(f-t.length+1)).join(j)+t;p[0]=o<0?s+t+n:t;o=p[1]||"";if(o.length>h)o=p[1]=o.substr(0,h);if(o.length<g)p[1]=o+(new Array(g-o.length+1)).join(k);return p.join(q)}var c=0,d=Infinity,f=0,g=0,h=0,i=1,j="0",
k="0",l=true,q=".",m=",",s="\u2212",n="";b.format=b;b.parse=function(o){var p=pv.Format.re;o=String(o).split(q);if(o.length==1)o[1]="";o[0].replace(new RegExp("^("+p(j)+")*"),"");o[1].replace(new RegExp("("+p(k)+")*$"),"");p=o[0].replace(new RegExp(p(m),"g"),"");if(p.length>d)p=p.substring(p.length-d);o=o[1]?Number("0."+o[1]):0;if(Infinity>h)o=Math.round(o*i)/i;return Math.round(p)+o};b.integerDigits=function(o,p){if(arguments.length){c=Number(o);d=arguments.length>1?Number(p):c;f=c+Math.floor(c/
3)*m.length;return this}return[c,d]};b.fractionDigits=function(o,p){if(arguments.length){g=Number(o);h=arguments.length>1?Number(p):g;i=Math.pow(10,h);return this}return[g,h]};b.integerPad=function(o){if(arguments.length){j=String(o);l=/\d/.test(j);return this}return j};b.fractionPad=function(o){if(arguments.length){k=String(o);return this}return k};b.decimal=function(o){if(arguments.length){q=String(o);return this}return q};b.group=function(o){if(arguments.length){m=o?String(o):"";f=c+Math.floor(c/
3)*m.length;return this}return m};b.negativeAffix=function(o,p){if(arguments.length){s=String(o||"");n=String(p||"");return this}return[s,n]};return b};pv.map=function(b,c){var d={};return c?b.map(function(f,g){d.index=g;return c.call(d,f)}):b.slice()};pv.repeat=function(b,c){if(arguments.length==1)c=2;return pv.blend(pv.range(c).map(function(){return b}))};pv.array=function(b,c){var d=b>=0?new Array(b):[];if(c!==undefined)for(var f=0;f<b;f++)d[f]=c;return d};
pv.cross=function(b,c){for(var d=[],f=0,g=b.length,h=c.length;f<g;f++)for(var i=0,j=b[f];i<h;i++)d.push([j,c[i]]);return d};pv.blend=function(b){return Array.prototype.concat.apply([],b)};
pv.transpose=function(b){var c=b.length,d=pv.max(b,function(i){return i.length});if(d>c){b.length=d;for(var f=c;f<d;f++)b[f]=new Array(c);for(f=0;f<c;f++)for(var g=f+1;g<d;g++){var h=b[f][g];b[f][g]=b[g][f];b[g][f]=h}}else{for(f=0;f<d;f++)b[f].length=c;for(f=0;f<c;f++)for(g=0;g<f;g++){h=b[f][g];b[f][g]=b[g][f];b[g][f]=h}}b.length=d;for(f=0;f<d;f++)b[f].length=c;return b};pv.normalize=function(b,c){b=pv.map(b,c);c=pv.sum(b);for(var d=0;d<b.length;d++)b[d]/=c;return b};
pv.permute=function(b,c,d){if(!d)d=pv.identity;var f=new Array(c.length),g={};c.forEach(function(h,i){g.index=h;f[i]=d.call(g,b[h])});return f};pv.numerate=function(b,c){if(!c)c=pv.identity;var d={},f={};b.forEach(function(g,h){f.index=h;d[c.call(f,g)]=h});return d};pv.uniq=function(b,c){if(!c)c=pv.identity;var d={},f=[],g={},h;b.forEach(function(i,j){g.index=j;h=c.call(g,i);h in d||(d[h]=f.push(h))});return f};pv.naturalOrder=function(b,c){return b<c?-1:b>c?1:0};
pv.reverseOrder=function(b,c){return c<b?-1:c>b?1:0};pv.search=function(b,c,d){if(!d)d=pv.identity;for(var f=0,g=b.length-1;f<=g;){var h=f+g>>1,i=d(b[h]);if(i<c)f=h+1;else if(i>c)g=h-1;else return h}return-f-1};pv.search.index=function(b,c,d){b=pv.search(b,c,d);return b<0?-b-1:b};
pv.range=function(b,c,d){if(arguments.length==1){c=b;b=0}if(d==undefined)d=1;if((c-b)/d==Infinity)throw new Error("range must be finite");var f=[],g=0,h;c-=(c-b)*1.0E-10;if(d<0)for(;(h=b+d*g++)>c;)f.push(h);else for(;(h=b+d*g++)<c;)f.push(h);return f};pv.random=function(b,c,d){if(arguments.length==1){c=b;b=0}if(d==undefined)d=1;return d?Math.floor(Math.random()*(c-b)/d)*d+b:Math.random()*(c-b)+b};
pv.sum=function(b,c){var d={};return b.reduce(c?function(f,g,h){d.index=h;return f+c.call(d,g)}:function(f,g){return f+g},0)};pv.max=function(b,c){if(c==pv.index)return b.length-1;return Math.max.apply(null,c?pv.map(b,c):b)};pv.max.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return b.length-1;if(!c)c=pv.identity;for(var d=0,f=-Infinity,g={},h=0;h<b.length;h++){g.index=h;var i=c.call(g,b[h]);if(i>f){f=i;d=h}}return d};
pv.min=function(b,c){if(c==pv.index)return 0;return Math.min.apply(null,c?pv.map(b,c):b)};pv.min.index=function(b,c){if(!b.length)return-1;if(c==pv.index)return 0;if(!c)c=pv.identity;for(var d=0,f=Infinity,g={},h=0;h<b.length;h++){g.index=h;var i=c.call(g,b[h]);if(i<f){f=i;d=h}}return d};pv.mean=function(b,c){return pv.sum(b,c)/b.length};
pv.median=function(b,c){if(c==pv.index)return(b.length-1)/2;b=pv.map(b,c).sort(pv.naturalOrder);if(b.length%2)return b[Math.floor(b.length/2)];c=b.length/2;return(b[c-1]+b[c])/2};pv.variance=function(b,c){if(b.length<1)return NaN;if(b.length==1)return 0;var d=pv.mean(b,c),f=0,g={};if(!c)c=pv.identity;for(var h=0;h<b.length;h++){g.index=h;var i=c.call(g,b[h])-d;f+=i*i}return f};pv.deviation=function(b,c){return Math.sqrt(pv.variance(b,c)/(b.length-1))};pv.log=function(b,c){return Math.log(b)/Math.log(c)};
pv.logSymmetric=function(b,c){return b==0?0:b<0?-pv.log(-b,c):pv.log(b,c)};pv.logAdjusted=function(b,c){if(!isFinite(b))return b;var d=b<0;if(b<c)b+=(c-b)/c;return d?-pv.log(b,c):pv.log(b,c)};pv.logFloor=function(b,c){return b>0?Math.pow(c,Math.floor(pv.log(b,c))):-Math.pow(c,-Math.floor(-pv.log(-b,c)))};pv.logCeil=function(b,c){return b>0?Math.pow(c,Math.ceil(pv.log(b,c))):-Math.pow(c,-Math.ceil(-pv.log(-b,c)))};
(function(){var b=Math.PI/180,c=180/Math.PI;pv.radians=function(d){return b*d};pv.degrees=function(d){return c*d}})();pv.keys=function(b){var c=[];for(var d in b)c.push(d);return c};pv.entries=function(b){var c=[];for(var d in b)c.push({key:d,value:b[d]});return c};pv.values=function(b){var c=[];for(var d in b)c.push(b[d]);return c};pv.dict=function(b,c){for(var d={},f={},g=0;g<b.length;g++)if(g in b){var h=b[g];f.index=g;d[h]=c.call(f,h)}return d};pv.dom=function(b){return new pv.Dom(b)};
pv.Dom=function(b){this.$map=b};pv.Dom.prototype.$leaf=function(b){return typeof b!="object"};pv.Dom.prototype.leaf=function(b){if(arguments.length){this.$leaf=b;return this}return this.$leaf};pv.Dom.prototype.root=function(b){function c(g){var h=new pv.Dom.Node;for(var i in g){var j=g[i];h.appendChild(d(j)?new pv.Dom.Node(j):c(j)).nodeName=i}return h}var d=this.$leaf,f=c(this.$map);f.nodeName=b;return f};pv.Dom.prototype.nodes=function(){return this.root().nodes()};
pv.Dom.Node=function(b){if(b!==undefined)this.nodeValue=b;this.childNodes=[]};a=pv.Dom.Node.prototype;a.nodeValue=undefined;a.parentNode=null;a.firstChild=null;a.lastChild=null;a.previousSibling=null;a.nextSibling=null;a._firstDirtyChildIndex=Infinity;a.removeChild=function(b){b=this.childNodes.indexOf(b);if(b===-1)throw new Error("child not found");return this.removeAt(b)};
a.appendChild=function(b){var c=b.parentNode;c&&c.removeChild(b);c=this.lastChild;b.parentNode=this;if(b.previousSibling=c){c.nextSibling=b;b._childIndex=c._childIndex+1}else{this.firstChild=b;b._childIndex=0}this.lastChild=b;this.childNodes.push(b);return b};a.insertBefore=function(b,c){if(!c)return this.appendChild(b);c=this.childNodes.indexOf(c);if(c===-1)throw new Error("child not found");return this.insertAt(b,c)};
a.insertAt=function(b,c){if(c==null)return this.appendChild(b);var d=this.childNodes,f=d.length;if(c===f)return this.appendChild(b);if(c>f)throw new Error("Index out of range.");f=c+1;if(f<this._firstDirtyChildIndex)this._firstDirtyChildIndex=f;(f=b.parentNode)&&f.removeChild(b);d=d[c];b.parentNode=this;b.nextSibling=d;b._childIndex=c;if(f=b.previousSibling=d.previousSibling)f.nextSibling=b;else{if(d===this.lastChild)this.lastChild=b;this.firstChild=b}this.childNodes.splice(c,0,b);return b};
a.removeAt=function(b){var c=this.childNodes,d=c[b];if(d){c.splice(b,1);if(b<c.length)if(b<this._firstDirtyChildIndex)this._firstDirtyChildIndex=b;if(b=d.previousSibling)b.nextSibling=d.nextSibling;else this.firstChild=d.nextSibling;if(b=d.nextSibling)b.previousSibling=d.previousSibling;else this.lastChild=d.previousSibling;delete d.nextSibling;delete d.previousSibling;delete d.parentNode}return d};
a.replaceChild=function(b,c){var d=this.childNodes,f=d.indexOf(c);if(f===-1)throw new Error("child not found");var g=b.parentNode;g&&g.removeChild(b);b.parentNode=this;b.nextSibling=c.nextSibling;b._childIndex=c._childIndex;if(g=b.previousSibling=c.previousSibling)g.nextSibling=b;else this.firstChild=b;if(g=c.nextSibling)g.previousSibling=b;else this.lastChild=b;d[f]=b;return c};
a.childIndex=function(){var b=this.parentNode;if(b){var c=b._firstDirtyChildIndex;if(c<Infinity){var d=b.childNodes;if(c<d.length)for(d=d[c];d;d=d.nextSibling)d._childIndex=c++;delete b._firstDirtyChildIndex}return this._childIndex}return-1};a.visitBefore=function(b){function c(d,f){b(d,f);for(d=d.firstChild;d;d=d.nextSibling)c(d,f+1)}c(this,0)};a.visitAfter=function(b){function c(d,f){for(var g=d.firstChild;g;g=g.nextSibling)c(g,f+1);b(d,f)}c(this,0)};
a.sort=function(b){if(this.firstChild){delete c._firstDirtyChildIndex;this.childNodes.sort(b);var c=this.firstChild=this.childNodes[0],d;delete c.previousSibling;c._childIndex=0;for(var f=1;f<this.childNodes.length;f++){c.sort(b);d=this.childNodes[f];d._childIndex=f;d.previousSibling=c;c=c.nextSibling=d}this.lastChild=c;delete c.nextSibling;c.sort(b)}return this};
a.reverse=function(){var b=[];this.visitAfter(function(c){for(;c.lastChild;)b.push(c.removeChild(c.lastChild));for(var d;d=b.pop();)c.insertBefore(d,c.firstChild)});return this};a.nodes=function(){function b(d){c.push(d);d.childNodes.forEach(b)}var c=[];b(this,c);return c};
a.toggle=function(b){if(b)return this.toggled?this.visitBefore(function(d){d.toggled&&d.toggle()}):this.visitAfter(function(d){d.toggled||d.toggle()});b=this;if(b.toggled){for(var c;c=b.toggled.pop();)b.appendChild(c);delete b.toggled}else if(b.lastChild)for(b.toggled=[];b.lastChild;)b.toggled.push(b.removeChild(b.lastChild))};pv.nodes=function(b){for(var c=new pv.Dom.Node,d=0;d<b.length;d++)c.appendChild(new pv.Dom.Node(b[d]));return c.nodes()};pv.tree=function(b){return new pv.Tree(b)};
pv.Tree=function(b){this.array=b};pv.Tree.prototype.keys=function(b){this.k=b;return this};pv.Tree.prototype.value=function(b){this.v=b;return this};pv.Tree.prototype.map=function(){for(var b={},c={},d=0;d<this.array.length;d++){c.index=d;for(var f=this.array[d],g=this.k.call(c,f),h=b,i=0;i<g.length-1;i++)h=h[g[i]]||(h[g[i]]={});h[g[i]]=this.v?this.v.call(c,f):f}return b};pv.nest=function(b){return new pv.Nest(b)};pv.Nest=function(b){this.array=b;this.keys=[]};a=pv.Nest.prototype;
a.key=function(b){this.keys.push(b);return this};a.sortKeys=function(b){this.keys[this.keys.length-1].order=b||pv.naturalOrder;return this};a.sortValues=function(b){this.order=b||pv.naturalOrder;return this};a.map=function(){for(var b={},c=[],d,f=0;f<this.array.length;f++){var g=this.array[f],h=b;for(d=0;d<this.keys.length-1;d++){var i=this.keys[d](g);h[i]||(h[i]={});h=h[i]}i=this.keys[d](g);if(!h[i]){d=[];c.push(d);h[i]=d}h[i].push(g)}if(this.order)for(d=0;d<c.length;d++)c[d].sort(this.order);return b};
a.entries=function(){function b(d){var f=[];for(var g in d){var h=d[g];f.push({key:g,values:h instanceof Array?h:b(h)})}return f}function c(d,f){var g=this.keys[f].order;g&&d.sort(function(i,j){return g(i.key,j.key)});if(++f<this.keys.length)for(var h=0;h<d.length;h++)c.call(this,d[h].values,f);return d}return c.call(this,b(this.map()),0)};a.rollup=function(b){function c(d){for(var f in d){var g=d[f];if(g instanceof Array)d[f]=b(g);else c(g)}return d}return c(this.map())};pv.flatten=function(b){return new pv.Flatten(b)};
pv.Flatten=function(b){this.map=b;this.keys=[]};pv.Flatten.prototype.key=function(b,c){this.keys.push({name:b,value:c});delete this.$leaf;return this};pv.Flatten.prototype.leaf=function(b){this.keys.length=0;this.$leaf=b;return this};
pv.Flatten.prototype.array=function(){function b(i,j){if(j<f.length-1)for(var k in i){d.push(k);b(i[k],j+1);d.pop()}else c.push(d.concat(i))}var c=[],d=[],f=this.keys,g=this.$leaf;if(g){function h(i,j){if(g(i))c.push({keys:d.slice(),value:i});else for(var k in i){d.push(k);h(i[k],j+1);d.pop()}}h(this.map,0);return c}b(this.map,0);return c.map(function(i){for(var j={},k=0;k<f.length;k++){var l=f[k],q=i[k];j[l.name]=l.value?l.value.call(null,q):q}return j})};
pv.vector=function(b,c){return new pv.Vector(b,c)};pv.Vector=function(b,c){this.x=b;this.y=c};a=pv.Vector.prototype;a.perp=function(){return new pv.Vector(-this.y,this.x)};a.rotate=function(b){var c=Math.cos(b);b=Math.sin(b);return new pv.Vector(c*this.x-b*this.y,b*this.x+c*this.y)};a.norm=function(){var b=this.length();return this.times(b?1/b:1)};a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.times=function(b){return new pv.Vector(this.x*b,this.y*b)};
a.plus=function(b,c){return arguments.length==1?new pv.Vector(this.x+b.x,this.y+b.y):new pv.Vector(this.x+b,this.y+c)};a.minus=function(b,c){return arguments.length==1?new pv.Vector(this.x-b.x,this.y-b.y):new pv.Vector(this.x-b,this.y-c)};a.dot=function(b,c){return arguments.length==1?this.x*b.x+this.y*b.y:this.x*b+this.y*c};pv.Transform=function(){};pv.Transform.prototype={k:1,x:0,y:0};pv.Transform.identity=new pv.Transform;
pv.Transform.prototype.translate=function(b,c){var d=new pv.Transform;d.k=this.k;d.x=this.k*b+this.x;d.y=this.k*c+this.y;return d};pv.Transform.prototype.scale=function(b){var c=new pv.Transform;c.k=this.k*b;c.x=this.x;c.y=this.y;return c};pv.Transform.prototype.invert=function(){var b=new pv.Transform,c=1/this.k;b.k=c;b.x=-this.x*c;b.y=-this.y*c;return b};pv.Transform.prototype.times=function(b){var c=new pv.Transform;c.k=this.k*b.k;c.x=this.k*b.x+this.x;c.y=this.k*b.y+this.y;return c};
pv.Scale=function(){};pv.Scale.interpolator=function(b,c){if(typeof b=="number")return function(d){return d*(c-b)+b};b=pv.color(b).rgb();c=pv.color(c).rgb();return function(d){var f=b.a*(1-d)+c.a*d;if(f<1.0E-5)f=0;return b.a==0?pv.rgb(c.r,c.g,c.b,f):c.a==0?pv.rgb(b.r,b.g,b.b,f):pv.rgb(Math.round(b.r*(1-d)+c.r*d),Math.round(b.g*(1-d)+c.g*d),Math.round(b.b*(1-d)+c.b*d),f)}};
pv.Scale.quantitative=function(){function b(o){return new Date(o)}function c(o){var p=pv.search(d,o);if(p<0)p=-p-2;p=Math.max(0,Math.min(h.length-1,p));return h[p]((k(o)-f[p])/(f[p+1]-f[p]))}var d=[0,1],f=[0,1],g=[0,1],h=[pv.identity],i=Number,j=false,k=pv.identity,l=pv.identity,q=String,m=null,s,n;c.transform=function(o,p){k=function(t){return j?-o(-t):o(t)};l=function(t){return j?-p(-t):p(t)};f=d.map(k);return this};c.domain=function(o,p,t){if(arguments.length){var u;if(o instanceof Array){if(arguments.length<
2)p=pv.identity;if(arguments.length<3)t=p;u=o.length&&p(o[0]);d=o.length?[pv.min(o,p),pv.max(o,t)]:[]}else{u=o;d=Array.prototype.slice.call(arguments).map(Number)}if(d.length){if(d.length==1)d=[d[0],d[0]]}else d=[-Infinity,Infinity];j=(d[0]||d[d.length-1])<0;f=d.map(k);i=u instanceof Date?b:Number;return this}return d.map(i)};c.range=function(){if(arguments.length){g=Array.prototype.slice.call(arguments);if(g.length){if(g.length==1)g=[g[0],g[0]]}else g=[-Infinity,Infinity];h=[];for(var o=0;o<g.length-
1;o++)h.push(pv.Scale.interpolator(g[o],g[o+1]));return this}return g};c.invert=function(o){var p=pv.search(g,o);if(p<0)p=-p-2;p=Math.max(0,Math.min(h.length-1,p));return i(l(f[p]+(o-g[p])/(g[p+1]-g[p])*(f[p+1]-f[p])))};c.ticks=function(o,p){var t=d[0],u=d[d.length-1],v=u<t,r=v?u:t;u=v?t:u;t=u-r;if(!t||!isFinite(t)){if(i==b)q=pv.Format.date("%x");return[i(r)]}if(i==b){function y(A,E){switch(E){case 31536E6:A.setMonth(0);case 2592E6:A.setDate(1);case 6048E5:E==6048E5&&A.setDate(A.getDate()-A.getDay());
case 864E5:A.setHours(0);case 36E5:A.setMinutes(0);case 6E4:A.setSeconds(0);case 1E3:A.setMilliseconds(0)}}var x,z,w=1;if(t>=15768E7){x=31536E6;p="%Y";z=function(A){A.setFullYear(A.getFullYear()+w)}}else if(t>=1296E7){x=2592E6;p="%m/%Y";z=function(A){A.setMonth(A.getMonth()+w)}}else if(t>=3024E6){x=6048E5;p="%m/%d";z=function(A){A.setDate(A.getDate()+7*w)}}else if(t>=432E6){x=864E5;p="%m/%d";z=function(A){A.setDate(A.getDate()+w)}}else if(t>=18E6){x=36E5;p="%I:%M %p";z=function(A){A.setHours(A.getHours()+
w)}}else if(t>=3E5){x=6E4;p="%I:%M %p";z=function(A){A.setMinutes(A.getMinutes()+w)}}else if(t>=5E3){x=1E3;p="%I:%M:%S";z=function(A){A.setSeconds(A.getSeconds()+w)}}else{x=1;p="%S.%Qs";z=function(A){A.setTime(A.getTime()+w)}}x=n?n:x;p=s?s:p;q=pv.Format.date(p);r=new Date(r);p=[];y(r,x);t=t/x;if(t>10)switch(x){case 36E5:w=t>20?6:3;r.setHours(Math.floor(r.getHours()/w)*w);break;case 2592E6:w=t>24?3:t>12?2:1;r.setMonth(Math.floor(r.getMonth()/w)*w);break;case 6048E5:w=t>15?3:t>10?2:1;r.setDate(Math.floor(r.getDate()/
(7*w))*7*w);break;case 864E5:w=t>=30?5:t>=15?3:2;r.setDate(Math.floor(r.getDate()/w)*w);break;case 6E4:w=t>30?15:t>15?10:5;r.setMinutes(Math.floor(r.getMinutes()/w)*w);break;case 1E3:w=t>90?15:t>60?10:5;r.setSeconds(Math.floor(r.getSeconds()/w)*w);break;case 1:w=t>1E3?250:t>200?100:t>100?50:t>50?25:5;r.setMilliseconds(Math.floor(r.getMilliseconds()/w)*w);break;default:w=pv.logCeil(t/15,10);if(t/w<2)w/=5;else if(t/w<5)w/=2;r.setFullYear(Math.floor(r.getFullYear()/w)*w);break}if(n){w=1;z=function(A){A.setSeconds(A.getSeconds()+
w*n/1E3)}}for(;;){z(r);if(r>u)break;p.push(new Date(r))}return v?p.reverse():p}if(o==null)o=10;x=pv.get(p,"roundInside",true);z=pv.get(p,"numberExponentMin",-Infinity);p=pv.get(p,"numberExponentMax",+Infinity);var B=Math.floor(pv.log(t/o,10)),C=false;if(B>p){B=p;C=true}else if(B<z){B=z;C=true}w=Math.pow(10,B);t=o/(t/w);if(t<=0.15&&B<p-1)w*=10;else if(t<=0.35)w*=5;else if(t<=0.75)w*=2;B=Math.floor(pv.log(w,10)+1.0E-10);t=w*Math[x?"ceil":"floor"](r/w);u=w*Math[x?"floor":"ceil"](u/w);q=pv.Format.number().fractionDigits(Math.max(0,
-B));u=pv.range(t,u+w,w);v&&u.reverse();u.roundInside=x;u.step=w;u.exponent=B;u.exponentOverflow=C;u.exponentMin=z;u.exponentMax=p;return u};c.dateTickFormat=function(){if(arguments.length){s=arguments[0];return this}return s};c.dateTickPrecision=function(){if(arguments.length){n=arguments[0];return this}return n};c.tickFormatter=function(o){if(arguments.length){m=o;return this}return m};c.tickFormat=function(o){return(m||q)(o)};c.nice=function(){if(d.length!=2)return this;var o=d[0],p=d[d.length-
1],t=p<o,u=t?p:o;o=t?o:p;p=o-u;if(!p||!isFinite(p))return this;p=Math.pow(10,Math.round(Math.log(p)/Math.log(10))-1);d=[Math.floor(u/p)*p,Math.ceil(o/p)*p];t&&d.reverse();f=d.map(k);return this};c.by=function(o){function p(){return c(o.apply(this,arguments))}for(var t in c)p[t]=c[t];return p};c.by1=function(o){function p(u){return c(o.call(this,u))}for(var t in c)p[t]=c[t];return p};c.domain.apply(c,arguments);return c};
pv.Scale.linear=function(){var b=pv.Scale.quantitative();b.domain.apply(b,arguments);return b};
pv.Scale.log=function(){var b=pv.Scale.quantitative(1,10),c,d,f=function(h){return Math.log(h)/d},g=function(h){return Math.pow(c,h)};b.ticks=function(){var h=b.domain(),i=h[0]<0,j=Math.floor(i?-f(-h[0]):f(h[0])),k=Math.ceil(i?-f(-h[1]):f(h[1])),l=[];if(i)for(l.push(-g(-j));j++<k;)for(i=c-1;i>0;i--)l.push(-g(-j)*i);else{for(;j<k;j++)for(i=1;i<c;i++)l.push(g(j)*i);l.push(g(j))}for(j=0;l[j]<h[0];j++);for(k=l.length;l[k-1]>h[1];k--);return l.slice(j,k)};b.tickFormat=function(h){return h.toPrecision(1)};
b.nice=function(){var h=b.domain();return b.domain(pv.logFloor(h[0],c),pv.logCeil(h[1],c))};b.base=function(h){if(arguments.length){c=Number(h);d=Math.log(c);b.transform(f,g);return this}return c};b.domain.apply(b,arguments);return b.base(10)};pv.Scale.root=function(){var b=pv.Scale.quantitative();b.power=function(c){if(arguments.length){var d=Number(c),f=1/d;b.transform(function(g){return Math.pow(g,f)},function(g){return Math.pow(g,d)});return this}return d};b.domain.apply(b,arguments);return b.power(2)};
pv.Scale.ordinal=function(){function b(g){g in d||(d[g]=c.push(g)-1);return f[d[g]%f.length]}var c=[],d={},f=[];b.domain=function(g,h){if(arguments.length){g=g instanceof Array?arguments.length>1?pv.map(g,h):g:Array.prototype.slice.call(arguments);c=[];for(var i={},j=0;j<g.length;j++){var k=g[j];if(!(k in i)){i[k]=true;c.push(k)}}d=pv.numerate(c);return this}return c};b.range=function(g,h){if(arguments.length){f=g instanceof Array?arguments.length>1?pv.map(g,h):g:Array.prototype.slice.call(arguments);
if(typeof f[0]=="string")f=f.map(pv.color);return this}return f};b.split=function(g,h){var i=h-g,j=this.domain().length,k=0;if(i===0)f=pv.array(j,g);else if(j){k=(h-g)/j;f=pv.range(g+k/2,h,k)}f.step=k;return this};b.splitBandedCenter=function(g,h,i){b.split(g,h);if(i==null)i=1;f.band=f.step*i;f.margin=f.step-f.band;return this};b.splitBandedFlushCenter=function(g,h,i){if(i==null)i=1;var j=h-g,k=this.domain().length,l=0,q=0,m=0;if(j===0)f=pv.array(k,g);else if(k){q=j*i/k;m=k>1?(j-k*q)/(k-1):0;l=m+
q;f=pv.range(g+q/2,h,l)}f.step=l;f.band=q;f.margin=m;return this};b.splitFlush=function(g,h){var i=this.domain().length,j=(h-g)/(i-1);f=i==1?[(g+h)/2]:pv.range(g,h+j/2,j);return this};b.splitBanded=function(g,h,i){if(arguments.length<3)i=1;if(i<0){var j=this.domain().length;j=(h-g- -i*j)/(j+1);f=pv.range(g+j,h,j-i);f.band=-i}else{j=(h-g)/(this.domain().length+(1-i));f=pv.range(g+j*(1-i),h,j);f.band=j*i;f.step=j;f.margin=j-f.band}return this};b.by=function(g){function h(){return b(g.apply(this,arguments))}
for(var i in b)h[i]=b[i];return h};b.by1=function(g){function h(j){return b(g.call(this,j))}for(var i in b)h[i]=b[i];return h};b.domain.apply(b,arguments);return b};
pv.Scale.quantile=function(){function b(i){return h(Math.max(0,Math.min(d,pv.search.index(f,i)-1))/d)}var c=-1,d=-1,f=[],g=[],h=pv.Scale.linear();b.quantiles=function(i){if(arguments.length){c=Number(i);if(c<0){f=[g[0]].concat(g);d=g.length-1}else{f=[];f[0]=g[0];for(var j=1;j<=c;j++)f[j]=g[~~(j*(g.length-1)/c)];d=c-1}return this}return f};b.domain=function(i,j){if(arguments.length){g=i instanceof Array?pv.map(i,j):Array.prototype.slice.call(arguments);g.sort(pv.naturalOrder);b.quantiles(c);return this}return g};
b.range=function(){if(arguments.length){h.range.apply(h,arguments);return this}return h.range()};b.by=function(i){function j(){return b(i.apply(this,arguments))}for(var k in b)j[k]=b[k];return j};b.by1=function(i){function j(l){return b(i.call(this,l))}for(var k in b)j[k]=b[k];return j};b.domain.apply(b,arguments);return b};
pv.histogram=function(b,c){var d=true;return{bins:function(f){var g=pv.map(b,c),h=[];arguments.length||(f=pv.Scale.linear(g).ticks());for(var i=0;i<f.length-1;i++){var j=h[i]=[];j.x=f[i];j.dx=f[i+1]-f[i];j.y=0}for(i=0;i<g.length;i++){j=pv.search.index(f,g[i])-1;j=h[Math.max(0,Math.min(h.length-1,j))];j.y++;j.push(b[i])}if(!d)for(i=0;i<h.length;i++)h[i].y/=g.length;return h},frequency:function(f){if(arguments.length){d=Boolean(f);return this}return d}}};
pv.color=function(b){if(b.rgb)return b.rgb();var c=/([a-z]+)\((.*)\)/i.exec(b);if(c){var d=c[2].split(","),f=1;switch(c[1]){case "hsla":case "rgba":f=parseFloat(d[3]);if(!f)return pv.Color.transparent;break}switch(c[1]){case "hsla":case "hsl":b=parseFloat(d[0]);var g=parseFloat(d[1])/100;d=parseFloat(d[2])/100;return(new pv.Color.Hsl(b,g,d,f)).rgb();case "rgba":case "rgb":function h(k){var l=parseFloat(k);return k[k.length-1]=="%"?Math.round(l*2.55):l}g=h(d[0]);var i=h(d[1]),j=h(d[2]);return pv.rgb(g,
i,j,f)}}if(f=pv.Color.names[b])return f;if(b.charAt(0)=="#"){if(b.length==4){g=b.charAt(1);g+=g;i=b.charAt(2);i+=i;j=b.charAt(3);j+=j}else if(b.length==7){g=b.substring(1,3);i=b.substring(3,5);j=b.substring(5,7)}return pv.rgb(parseInt(g,16),parseInt(i,16),parseInt(j,16),1)}return new pv.Color(b,1)};pv.Color=function(b,c){this.color=b;this.opacity=c};pv.Color.prototype.hsl=function(){return this.rgb().hsl()};pv.Color.prototype.brighter=function(b){return this.rgb().brighter(b)};
pv.Color.prototype.darker=function(b){return this.rgb().darker(b)};pv.rgb=function(b,c,d,f){return new pv.Color.Rgb(b,c,d,arguments.length==4?f:1)};pv.Color.Rgb=function(b,c,d,f){pv.Color.call(this,f?"rgb("+b+","+c+","+d+")":"none",f);this.r=b;this.g=c;this.b=d;this.a=f};pv.Color.Rgb.prototype=pv.extend(pv.Color);a=pv.Color.Rgb.prototype;a.red=function(b){return pv.rgb(b,this.g,this.b,this.a)};a.green=function(b){return pv.rgb(this.r,b,this.b,this.a)};
a.blue=function(b){return pv.rgb(this.r,this.g,b,this.a)};a.alpha=function(b){return pv.rgb(this.r,this.g,this.b,b)};a.rgb=function(){return this};a.brighter=function(b){b=Math.pow(0.7,arguments.length?b:1);var c=this.r,d=this.g,f=this.b;if(!c&&!d&&!f)return pv.rgb(30,30,30,this.a);if(c&&c<30)c=30;if(d&&d<30)d=30;if(f&&f<30)f=30;return pv.rgb(Math.min(255,Math.floor(c/b)),Math.min(255,Math.floor(d/b)),Math.min(255,Math.floor(f/b)),this.a)};
a.darker=function(b){b=Math.pow(0.7,arguments.length?b:1);return pv.rgb(Math.max(0,Math.floor(b*this.r)),Math.max(0,Math.floor(b*this.g)),Math.max(0,Math.floor(b*this.b)),this.a)};a.hsl=function(){var b=this.r/255,c=this.g/255,d=this.b/255,f=Math.max(b,c,d),g=Math.min(b,c,d),h=(f+g)/2,i;if(f===g)i=g=0;else{var j=f-g;g=h>0.5?j/(2-f-g):j/(f+g);switch(f){case b:i=(c-d)/j+(c<d?6:0);break;case c:i=(d-b)/j+2;break;case d:i=(b-c)/j+4;break}i/=6}return pv.hsl(i*360,g,h,this.a)};
pv.hsl=function(b,c,d,f){return new pv.Color.Hsl(b,c,d,arguments.length==4?f:1)};pv.Color.Hsl=function(b,c,d,f){pv.Color.call(this,"hsl("+b+","+c*100+"%,"+d*100+"%)",f);this.h=b;this.s=c;this.l=d;this.a=f};pv.Color.Hsl.prototype=pv.extend(pv.Color);a=pv.Color.Hsl.prototype;a.hsl=function(){return this};a.hue=function(b){return pv.hsl(b,this.s,this.l,this.a)};a.saturation=function(b){return pv.hsl(this.h,b,this.l,this.a)};a.lightness=function(b){return pv.hsl(this.h,this.s,b,this.a)};
a.alpha=function(b){return pv.hsl(this.h,this.s,this.l,b)};a.rgb=function(){function b(j){if(j>360)j-=360;else if(j<0)j+=360;if(j<60)return i+(h-i)*j/60;if(j<180)return h;if(j<240)return i+(h-i)*(240-j)/60;return i}function c(j){return Math.round(b(j)*255)}var d=this.h,f=this.s,g=this.l;d%=360;if(d<0)d+=360;f=Math.max(0,Math.min(f,1));g=Math.max(0,Math.min(g,1));var h=g<=0.5?g*(1+f):g+f-g*f,i=2*g-h;return pv.rgb(c(d+120),c(d),c(d-120),this.a)};
pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)};
(function(){var b=pv.Color.names;b.none=b.transparent;for(var c in b)b[c]=pv.color(b[c])})();pv.colors=function(){var b=pv.Scale.ordinal();b.range.apply(b,arguments);return b};pv.Colors={};pv.Colors.category10=function(){var b=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");b.domain.apply(b,arguments);return b};
pv.Colors.category20=function(){var b=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");b.domain.apply(b,arguments);return b};
pv.Colors.category19=function(){var b=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");b.domain.apply(b,arguments);return b};
(function(){function b(m){m=d(m);if(!m.length)return null;var s=Math.PI,n,o=m[0];if(o.indexOf("to ")===0){if(n=/^to\s+(?:((top|bottom)(?:\s+(left|right))?)|((left|right)(?:\\s+(top|bottom))?))$/.exec(o)){if(n[1]){s=n[2];if(n[3])s+=" "+n[3]}else{s=n[5];if(n[6])s=n[6]+" "+s}s=pv.radians(g[s]);m.shift()}}else{n=parseFloat(o);if(!isNaN(n)){s=n;if(/^.*?deg$/.test(o))s=pv.radians(s);m.shift()}}m=f(m);switch(m.length){case 0:return null;case 1:return new pv.FillStyle.Solid(m[0].color,1)}return new pv.FillStyle.LinearGradient(s,
m)}function c(m){m=d(m);if(!m.length)return null;m=f(m);switch(m.length){case 0:return null;case 1:return new pv.FillStyle.Solid(m[0].color,1)}return new pv.FillStyle.RadialGradient(50,50,m)}function d(m){var s={},n=0;m=m.replace(/\b\w+?\(.*?\)/g,function(p){var t="__color"+n++;s[t]=p;return t});var o=m.split(/\s*,\s*/);if(!o.length)return null;n&&o.forEach(function(p,t){if(s.hasOwnProperty(p))o[t]=s[p]});return o}function f(m){function s(w){var B=t.length;if(B){var C=p;w=(w-C)/(B+1);for(var A=0;A<
B;A++){C+=w;t[A].offset=C}t.length=0}}for(var n=[],o=+Infinity,p=-Infinity,t=[],u=0,v=m.length;u<v;){var r=/^(.+?)\s*([+\-]?[e\.\d]+%)?$/i.exec(m[u++]);if(r){var y={color:pv.color(r[1])};r=parseFloat(r[2]);if(isNaN(r))if(n.length){if(u===v)r=Math.max(p,100)}else r=0;n.push(y);if(isNaN(r))t.push(y);else{y.offset=r;s(r);if(r>p)p=r;else if(r<p)r=p;if(r<o)o=r}}}if(n.length>=2&&(o<0||p>100)){var x=[],z=[];n.forEach(function(w){x.push(w.offset);z.push(w.color)});m=pv.scale.linear().domain(x).range(z);if(o<
0){for(;n.length&&n[0].offset<=0;)n.shift();n.unshift({offset:0,color:m(0)})}if(p>100){for(;n.length&&n[n.length-1].offset>=100;)n.pop();n.push({offset:100,color:m(100)})}}return n}pv.fillStyle=function(m){if(m.type)return m;if(m.rgb)return new pv.FillStyle.Solid(m.color,m.opacity);var s=/^\s*([a-z\-]+)\(\s*(.*?)\s*\)\s*$/.exec(m);if(s)switch(s[1]){case "linear-gradient":return b(s[2]);case "radial-gradient":return c(s[2])}return new pv.FillStyle.Solid(pv.color(m))};var g={top:0,"top right":45,right:90,
"bottom right":135,bottom:180,"bottom left":225,left:270,"top left":315},h=pv.FillStyle=function(m){this.type=m};h.prototype=new pv.Color("none",1);h.prototype.rgb=function(){var m=pv.color(this.color);if(this.opacity!==m.opacity)m=m.alpha(this.opacity);return m};var i=pv.FillStyle.Solid=function(m,s){h.call(this,"solid");if(m.rgb){this.color=m.color;this.opacity=m.opacity}else{this.color=m;this.opacity=s}};i.prototype=pv.extend(pv.FillStyle);i.prototype.alpha=function(m){return new i(this.color,
m)};i.prototype.brighter=function(m){return new i(this.rgb().brighter(m))};i.prototype.darker=function(m){return new i(this.color.darker(m))};pv.FillStyle.transparent=new i(pv.Color.transparent);var j=0,k=pv.FillStyle.Gradient=function(m,s){h.call(this,m);this.id=++j;this.stops=s;if(s.length)this.color=s[0].color.color};k.prototype=pv.extend(pv.FillStyle);k.prototype.rgb=function(){return this.stops.length?this.stops[0].color:undefined};k.prototype.alpha=function(m){return this._clone(this.stops.map(function(s){return{offset:s.offset,
color:s.color.alpha(m)}}))};k.prototype.darker=function(m){return this._clone(this.stops.map(function(s){return{offset:s.offset,color:s.color.darker(m)}}))};k.prototype.brighter=function(m){return this._clone(this.stops.map(function(s){return{offset:s.offset,color:s.color.brighter(m)}}))};var l=pv.FillStyle.LinearGradient=function(m,s){k.call(this,"lineargradient",s);this.angle=m};l.prototype=pv.extend(k);l.prototype._clone=function(m){return new l(this.angle,m)};var q=pv.FillStyle.RadialGradient=
function(m,s,n){k.call(this,"radialgradient",n);this.cx=m;this.cy=s};q.prototype=pv.extend(k);q.prototype._clone=function(m){return new q(this.cx,this.cy,m)}})();pv.ramp=function(){var b=pv.Scale.linear();b.range.apply(b,arguments);return b};
pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter",
"stroke-linecap":"butt","stroke-miterlimit":8,"stroke-dasharray":"none"},css:{font:"10px sans-serif"}}};pv.SvgScene.updateAll=function(b){if(b.length&&b[0].reverse&&b.type!="line"&&b.type!="area"){for(var c=pv.extend(b),d=0,f=b.length-1;f>=0;d++,f--)c[d]=b[f];b=c}this.removeSiblings(this[b.type](b))};pv.SvgScene.create=function(b){return document.createElementNS(this.svg,b)};
pv.SvgScene.expect=function(b,c,d,f,g,h){if(b){d=b.tagName;if(d==="defs")b=b.nextSibling;if(d==="a")b=b.firstChild;if(d!==c){c=this.create(c);b.parentNode.replaceChild(c,b);b=c}}else b=this.create(c);g&&this.setAttributes(b,g);h&&this.setStyle(b,h);return b};pv.SvgScene.setAttributes=function(b,c){var d=this.implicit.svg;for(var f in c){var g=c[f];g==null||g==d[f]?b.removeAttribute(f):b.setAttribute(f,g)}};
pv.SvgScene.setStyle=function(b,c){var d=this.implicit.css;switch(pv.renderer()){case "batik":for(var f in c){var g=c[f];g==null||g==d[f]?b.removeAttribute(f):b.style.setProperty(f,g)}break;case "svgweb":for(f in c){g=c[f];g==null||g==d[f]||(b.style[f]=g)}break;default:for(f in c){g=c[f];if(g==null||g==d[f])b.style.removeProperty(f);else b.style[f]=g}}};pv.SvgScene.append=function(b,c,d){b.$scene={scenes:c,index:d};b=this.title(b,c[d]);b.parentNode||c.$g.appendChild(b);return b.nextSibling};
pv.SvgScene.title=function(b,c){var d=b.parentNode;if(d&&d.tagName!="a")d=null;if(c.title){if(!d){d=this.create("a");d.setAttributeNS(this.xlink,"xlink:href","");b.parentNode&&b.parentNode.replaceChild(d,b);d.appendChild(b)}d.setAttributeNS(this.xlink,"xlink:title",c.title);for(var f=null,g=b.firstChild;g!=null;g=g.nextSibling)if(g.nodeName=="title"){f=g;break}if(f)f.removeChild(f.firstChild);else{f=this.create("title");b.appendChild(f)}pv.renderer()=="svgweb"?f.appendChild(document.createTextNode(c.title,
true)):f.appendChild(document.createTextNode(c.title));return d}d&&d.parentNode.replaceChild(b,d);return b};pv.SvgScene.dispatch=pv.listener(function(b){var c=b.target.$scene;if(c){var d=b.type;switch(d){case "DOMMouseScroll":d="mousewheel";b.wheel=-480*b.detail;break;case "mousewheel":b.wheel=(window.opera?12:1)*b.wheelDelta;break}pv.Mark.dispatch(d,c.scenes,c.index,b)&&b.preventDefault()}});
pv.SvgScene.removeSiblings=function(b){for(;b;){var c=b.nextSibling;b.nodeName!="defs"&&b.parentNode.removeChild(b);b=c}};pv.SvgScene.undefined=function(){};pv.SvgScene.removeFillStyleDefinitions=function(b){b=b.$g.getElementsByTagName("defs");if(b.length===1){b=b[0];for(var c=b.firstChild;c;){var d=c.nextSibling;if(c.nodeName=="linearGradient"||c.nodeName=="radialGradient")b.removeChild(c);c=d}}};
(function(){var b={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},c={shortdash:[3,1],shortdot:[1,1],shortdashdot:[3,1,1,1],shortdashdotdot:[3,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};pv.SvgScene.isStandardDashStyle=function(d){return c.hasOwnProperty(d)};pv.SvgScene.translateDashStyleAlias=function(d){return b.hasOwnProperty(d)?
b[d]:d};pv.SvgScene.parseDasharray=function(d){var f=d.strokeDasharray;if(f&&f!=="none"){f=this.translateDashStyleAlias(f);var g=c[f];f=g?g:f.split(/[\s,]+/);var h=d.lineWidth,i=(d.lineCap||"butt")==="butt";f=f.map(function(j,k){j=+j;if(!i)if(k%2)j++;else j-=1;if(j<=0)j=0.001;return j*h/this.scale},this).join(" ")}else f=null;return f}})();
(function(){function b(d){return Math.abs(d)<=1.0E-12?0:d}var c=0;pv.SvgScene.addFillStyleDefinition=function(d,f){var g=f.type==="lineargradient";if(g||f.type==="radialgradient"){var h=d.$g;d=h.getElementsByTagName("defs");h=d.length?d[0]:h.appendChild(this.create("defs"));var i="__pv_gradient"+f.id;d=undefined;if(!d){d="__pv_gradient"+f.id+"_inst_"+ ++c;h=h.appendChild(this.create(g?"linearGradient":"radialGradient"));h.setAttribute("id",d);h.setAttribute("class",i);if(g){i=f.angle-Math.PI/2;g=
Math.abs(i%(Math.PI/2))-Math.PI/4;var j=Math.abs(Math.SQRT2/2*Math.cos(g));g=j*Math.cos(i);var k=j*Math.sin(i);i=b(0.5-g);j=b(0.5-k);g=b(0.5+g);k=b(0.5+k);h.setAttribute("x1",i);h.setAttribute("y1",j);h.setAttribute("x2",g);h.setAttribute("y2",k)}g=f.stops;i=0;for(j=g.length;i<j;i++){k=g[i];var l=h.appendChild(this.create("stop")),q=k.color;l.setAttribute("offset",k.offset+"%");l.setAttribute("stop-color",q.color);l.setAttribute("stop-opacity",q.opacity+"")}f.color="url(#"+d+")"}}}})();
pv.SvgScene.pathBasis=function(){function b(f,g,h,i,j){return{x:f[0]*g.left+f[1]*h.left+f[2]*i.left+f[3]*j.left,y:f[0]*g.top+f[1]*h.top+f[2]*i.top+f[3]*j.top}}var c=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],d=function(f,g,h,i){var j=b(c[1],f,g,h,i),k=b(c[2],f,g,h,i);f=b(c[3],f,g,h,i);return"C"+j.x+","+j.y+","+k.x+","+k.y+","+f.x+","+f.y};d.segment=function(f,g,h,i){var j=b(c[0],f,g,h,i),k=b(c[1],f,g,h,i),l=b(c[2],f,g,h,i);f=b(c[3],f,g,h,i);return"M"+j.x+","+j.y+"C"+k.x+","+k.y+
","+l.x+","+l.y+","+f.x+","+f.y};return d}();pv.SvgScene.curveBasis=function(b){if(b.length<=2)return"";var c="",d=b[0],f=d,g=d,h=b[1];c+=this.pathBasis(d,f,g,h);for(var i=2;i<b.length;i++){d=f;f=g;g=h;h=b[i];c+=this.pathBasis(d,f,g,h)}c+=this.pathBasis(f,g,h,h);c+=this.pathBasis(g,h,h,h);return c};
pv.SvgScene.curveBasisSegments=function(b){if(b.length<=2)return"";var c=[],d=b[0],f=d,g=d,h=b[1],i=this.pathBasis.segment(d,f,g,h);d=f;f=g;g=h;h=b[2];c.push(i+this.pathBasis(d,f,g,h));for(i=3;i<b.length;i++){d=f;f=g;g=h;h=b[i];c.push(this.pathBasis.segment(d,f,g,h))}c.push(this.pathBasis.segment(f,g,h,h)+this.pathBasis(g,h,h,h));return c};
pv.SvgScene.curveHermite=function(b,c){if(c.length<1||b.length!=c.length&&b.length!=c.length+2)return"";var d=b.length!=c.length,f="",g=b[0],h=b[1],i=c[0],j=i,k=1;if(d){f+="Q"+(h.left-i.x*2/3)+","+(h.top-i.y*2/3)+","+h.left+","+h.top;g=b[1];k=2}if(c.length>1){j=c[1];h=b[k];k++;f+="C"+(g.left+i.x)+","+(g.top+i.y)+","+(h.left-j.x)+","+(h.top-j.y)+","+h.left+","+h.top;for(g=2;g<c.length;g++,k++){h=b[k];j=c[g];f+="S"+(h.left-j.x)+","+(h.top-j.y)+","+h.left+","+h.top}}if(d){b=b[k];f+="Q"+(h.left+j.x*2/
3)+","+(h.top+j.y*2/3)+","+b.left+","+b.top}return f};
pv.SvgScene.curveHermiteSegments=function(b,c){if(c.length<1||b.length!=c.length&&b.length!=c.length+2)return[];var d=b.length!=c.length,f=[],g=b[0],h=g,i=c[0],j=i,k=1;if(d){h=b[1];f.push("M"+g.left+","+g.top+"Q"+(h.left-j.x*2/3)+","+(h.top-j.y*2/3)+","+h.left+","+h.top);k=2}for(var l=1;l<c.length;l++,k++){g=h;i=j;h=b[k];j=c[l];f.push("M"+g.left+","+g.top+"C"+(g.left+i.x)+","+(g.top+i.y)+","+(h.left-j.x)+","+(h.top-j.y)+","+h.left+","+h.top)}if(d){b=b[k];f.push("M"+h.left+","+h.top+"Q"+(h.left+j.x*
2/3)+","+(h.top+j.y*2/3)+","+b.left+","+b.top)}return f};pv.SvgScene.cardinalTangents=function(b,c){var d=[];c=(1-c)/2;for(var f=b[0],g=b[1],h=b[2],i=3;i<b.length;i++){d.push({x:c*(h.left-f.left),y:c*(h.top-f.top)});f=g;g=h;h=b[i]}d.push({x:c*(h.left-f.left),y:c*(h.top-f.top)});return d};pv.SvgScene.curveCardinal=function(b,c){if(b.length<=2)return"";return this.curveHermite(b,this.cardinalTangents(b,c))};
pv.SvgScene.curveCardinalSegments=function(b,c){if(b.length<=2)return"";return this.curveHermiteSegments(b,this.cardinalTangents(b,c))};
pv.SvgScene.monotoneTangents=function(b){var c=[],d=[],f=[],g=[],h=0;for(h=0;h<b.length-1;h++)d[h]=(b[h+1].top-b[h].top)/(b[h+1].left-b[h].left);f[0]=d[0];g[0]=b[1].left-b[0].left;for(h=1;h<b.length-1;h++){f[h]=(d[h-1]+d[h])/2;g[h]=(b[h+1].left-b[h-1].left)/2}f[h]=d[h-1];g[h]=b[h].left-b[h-1].left;for(h=0;h<b.length-1;h++)if(d[h]==0){f[h]=0;f[h+1]=0}for(h=0;h<b.length-1;h++)if(!(Math.abs(f[h])<1.0E-5||Math.abs(f[h+1])<1.0E-5)){var i=f[h]/d[h],j=f[h+1]/d[h],k=i*i+j*j;if(k>9){k=3/Math.sqrt(k);f[h]=
k*i*d[h];f[h+1]=k*j*d[h]}}for(h=0;h<b.length;h++){d=1+f[h]*f[h];c.push({x:g[h]/3/d,y:f[h]*g[h]/3/d})}return c};pv.SvgScene.curveMonotone=function(b){if(b.length<=2)return"";return this.curveHermite(b,this.monotoneTangents(b))};pv.SvgScene.curveMonotoneSegments=function(b){if(b.length<=2)return"";return this.curveHermiteSegments(b,this.monotoneTangents(b))};
pv.SvgScene.area=function(b){function c(m,s){for(var n=[],o=[],p=s;m<=p;m++,s--){var t=b[m],u=b[s];t=t.left+","+t.top;u=u.left+u.width+","+(u.top+u.height);if(m<p){var v=b[m+1],r=b[s-1];switch(g.interpolate){case "step-before":t+="V"+v.top;u+="H"+(r.left+r.width);break;case "step-after":t+="H"+v.left;u+="V"+(r.top+r.height);break}}n.push(t);o.push(u)}return n.concat(o).join("L")}function d(m,s){for(var n=[],o=[],p=s;m<=p;m++,s--){var t=b[s];n.push(b[m]);o.push({left:t.left+t.width,top:t.top+t.height})}if(g.interpolate==
"basis"){m=pv.SvgScene.curveBasis(n);s=pv.SvgScene.curveBasis(o)}else if(g.interpolate=="cardinal"){m=pv.SvgScene.curveCardinal(n,g.tension);s=pv.SvgScene.curveCardinal(o,g.tension)}else{m=pv.SvgScene.curveMonotone(n);s=pv.SvgScene.curveMonotone(o)}return n[0].left+","+n[0].top+m+"L"+o[0].left+","+o[0].top+s}var f=b.$g.firstChild;this.removeFillStyleDefinitions(b);if(!b.length)return f;var g=b[0];if(g.segmented)return this.areaSegment(b);if(!g.visible)return f;var h=g.fillStyle,i=g.strokeStyle;if(!h.opacity&&
!i.opacity)return f;h.type&&h.type!=="solid"&&this.addFillStyleDefinition(b,h);i.type&&i.type!="solid"&&this.addFillStyleDefinition(b,i);for(var j=[],k,l=0;l<b.length;l++){k=b[l];if(k.width||k.height){for(var q=l+1;q<b.length;q++){k=b[q];if(!k.width&&!k.height)break}l&&g.interpolate!="step-after"&&l--;q<b.length&&g.interpolate!="step-before"&&q++;j.push((q-l>2&&(g.interpolate=="basis"||g.interpolate=="cardinal"||g.interpolate=="monotone")?d:c)(l,q-1));l=q-1}}if(!j.length)return f;f=this.expect(f,
"path",b,0,{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":g.events,cursor:g.cursor,d:"M"+j.join("ZM")+"Z",fill:h.color,"fill-opacity":h.opacity||null,stroke:i.color,"stroke-opacity":i.opacity||null,"stroke-width":i.opacity?g.lineWidth/this.scale:null,"stroke-linecap":g.lineCap,"stroke-linejoin":g.lineJoin,"stroke-miterlimit":g.strokeMiterLimit,"stroke-dasharray":i.opacity?this.parseDasharray(g):null});g.svg&&this.setAttributes(f,g.svg);g.css&&this.setStyle(f,g.css);return this.append(f,
b,0)};
pv.SvgScene.areaSegment=function(b){var c=b.$g.firstChild,d=b[0],f,g;if(d.interpolate=="basis"||d.interpolate=="cardinal"||d.interpolate=="monotone"){f=[];g=[];for(var h=0,i=b.length;h<i;h++){var j=b[i-h-1];f.push(b[h]);g.push({left:j.left+j.width,top:j.top+j.height})}if(d.interpolate=="basis"){f=this.curveBasisSegments(f);g=this.curveBasisSegments(g)}else if(d.interpolate=="cardinal"){f=this.curveCardinalSegments(f,d.tension);g=this.curveCardinalSegments(g,d.tension)}else{f=this.curveMonotoneSegments(f);g=
this.curveMonotoneSegments(g)}}h=0;for(i=b.length-1;h<i;h++){d=b[h];var k=b[h+1];if(d.visible&&k.visible){var l=d.fillStyle,q=d.strokeStyle;if(l.opacity||q.opacity){if(f){j=f[h];k="L"+g[i-h-1].substr(1);j=j+k+"Z"}else{var m=d;j=k;switch(d.interpolate){case "step-before":m=k;break;case "step-after":j=d;break}j="M"+d.left+","+m.top+"L"+k.left+","+j.top+"L"+(k.left+k.width)+","+(j.top+j.height)+"L"+(d.left+d.width)+","+(m.top+m.height)+"Z"}c=this.expect(c,"path",b,h,{"shape-rendering":d.antialias?null:
"crispEdges","pointer-events":d.events,cursor:d.cursor,d:j,fill:l.color,"fill-opacity":l.opacity||null,stroke:q.color,"stroke-opacity":q.opacity||null,"stroke-width":q.opacity?d.lineWidth/this.scale:null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);c=this.append(c,b,h)}}}return c};pv.SvgScene.minBarWidth=1;pv.SvgScene.minBarHeight=1;pv.SvgScene.minBarLineWidth=0.2;
pv.SvgScene.bar=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var d=0;d<b.length;d++){var f=b[d];if(!(!f.visible||Math.abs(f.width)<=1.0E-10||Math.abs(f.height)<=1.0E-10)){if(f.width<this.minBarWidth)f.width=this.minBarWidth;if(f.height<this.minBarHeight)f.height=this.minBarHeight;var g=f.fillStyle,h=f.strokeStyle;if(g.opacity||h.opacity){g.type&&g.type!=="solid"&&this.addFillStyleDefinition(b,g);h.type&&h.type!="solid"&&this.addFillStyleDefinition(b,h);var i;if(h.opacity){i=
f.lineWidth;i=i<1.0E-10?0:Math.max(this.minBarLineWidth,i/this.scale)}else i=null;c=this.expect(c,"rect",b,d,{"shape-rendering":f.antialias?null:"crispEdges","pointer-events":f.events,cursor:f.cursor,x:f.left,y:f.top,width:Math.max(1.0E-10,f.width),height:Math.max(1.0E-10,f.height),fill:g.color,"fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":i,"stroke-linecap":f.lineCap,"stroke-dasharray":h.opacity?this.parseDasharray(f):null});f.svg&&this.setAttributes(c,
f.svg);f.css&&this.setStyle(c,f.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.dot=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var d=0;d<b.length;d++){var f=b[d];if(f.visible){var g=f.fillStyle,h=f.strokeStyle;if(g.opacity||h.opacity){g.type&&g.type!=="solid"&&this.addFillStyleDefinition(b,g);h.type&&h.type!="solid"&&this.addFillStyleDefinition(b,h);var i=f.shapeRadius,j=null;switch(f.shape){case "cross":j="M"+-i+","+-i+"L"+i+","+i+"M"+i+","+-i+"L"+-i+","+i;break;case "triangle":j=i;var k=i*1.1547;j="M0,"+j+"L"+k+","+-j+" "+-k+","+-j+
"Z";break;case "diamond":i*=Math.SQRT2;j="M0,"+-i+"L"+i+",0 0,"+i+" "+-i+",0Z";break;case "square":j="M"+-i+","+-i+"L"+i+","+-i+" "+i+","+i+" "+-i+","+i+"Z";break;case "tick":j="M0,0L0,"+-f.shapeSize;break;case "bar":j="M0,"+f.shapeSize/2+"L0,"+-(f.shapeSize/2);break}g={"shape-rendering":f.antialias?null:"crispEdges","pointer-events":f.events,cursor:f.cursor,fill:g.color,"fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":h.opacity?f.lineWidth/this.scale:
null,"stroke-linecap":f.lineCap,"stroke-dasharray":h.opacity?this.parseDasharray(f):null};if(j){g.transform="translate("+f.left+","+f.top+")";if(f.shapeAngle)g.transform+=" rotate("+180*f.shapeAngle/Math.PI+")";g.d=j;c=this.expect(c,"path",b,d,g)}else{g.cx=f.left;g.cy=f.top;g.r=i;c=this.expect(c,"circle",b,d,g)}f.svg&&this.setAttributes(c,f.svg);f.css&&this.setStyle(c,f.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.image=function(b){for(var c=b.$g.firstChild,d=0;d<b.length;d++){var f=b[d];if(f.visible){c=this.fill(c,b,d);if(f.image){c=this.expect(c,"foreignObject",b,d,{cursor:f.cursor,x:f.left,y:f.top,width:f.width,height:f.height});f.svg&&this.setAttributes(c,f.svg);f.css&&this.setStyle(c,f.css);var g=c.firstChild||c.appendChild(document.createElementNS(this.xhtml,"canvas"));g.$scene={scenes:b,index:d};g.style.width=f.width;g.style.height=f.height;g.width=f.imageWidth;g.height=f.imageHeight;g.getContext("2d").putImageData(f.image,
0,0)}else{c=this.expect(c,"image",b,d,{preserveAspectRatio:"none",cursor:f.cursor,x:f.left,y:f.top,width:f.width,height:f.height});f.svg&&this.setAttributes(c,f.svg);f.css&&this.setStyle(c,f.css);c.setAttributeNS(this.xlink,"xlink:href",f.url)}c=this.append(c,b,d);c=this.stroke(c,b,d)}}return c};
pv.SvgScene.label=function(b){for(var c=b.$g.firstChild,d=0;d<b.length;d++){var f=b[d];if(f.visible){var g=f.textStyle;if(g.opacity&&f.text){var h=0,i=0,j=0,k="start";switch(f.textBaseline){case "middle":if(pv.renderer()=="svgweb")i=3;else j=".35em";break;case "top":if(pv.renderer()=="svgweb")i=9+f.textMargin;else{j=".71em";i=f.textMargin}break;case "bottom":i="-"+f.textMargin;break}switch(f.textAlign){case "right":k="end";h="-"+f.textMargin;break;case "center":k="middle";break;case "left":h=f.textMargin;
break}c=this.expect(c,"text",b,d,{"pointer-events":f.events,cursor:f.cursor,x:h,y:i,dy:j,transform:"translate("+f.left+","+f.top+")"+(f.textAngle?" rotate("+180*f.textAngle/Math.PI+")":"")+(this.scale!=1?" scale("+1/this.scale+")":""),fill:g.color,"fill-opacity":g.opacity||null,"text-anchor":k},{font:f.font,"text-shadow":f.textShadow,"text-decoration":f.textDecoration});f.svg&&this.setAttributes(c,f.svg);f.css&&this.setStyle(c,f.css);if(c.firstChild)c.firstChild.nodeValue=f.text;else pv.renderer()==
"svgweb"?c.appendChild(document.createTextNode(f.text,true)):c.appendChild(document.createTextNode(f.text));c=this.append(c,b,d)}}}return c};
pv.SvgScene.line=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);if(b.length<2)return c;var d=b[0];if(d.segmented)return this.lineSegment(b);if(!d.visible)return c;var f=d.fillStyle,g=d.strokeStyle;if(!f.opacity&&!g.opacity)return c;g.type&&g.type!="solid"&&this.addFillStyleDefinition(b,g);var h="M"+d.left+","+d.top;if(b.length>2&&(d.interpolate=="basis"||d.interpolate=="cardinal"||d.interpolate=="monotone"))switch(d.interpolate){case "basis":h+=this.curveBasis(b);break;case "cardinal":h+=
this.curveCardinal(b,d.tension);break;case "monotone":h+=this.curveMonotone(b);break}else for(var i=1;i<b.length;i++)h+=this.pathSegment(b[i-1],b[i]);c=this.expect(c,"path",b,0,{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,d:h,fill:f.color,"fill-opacity":f.opacity||null,stroke:g.color,"stroke-opacity":g.opacity||null,"stroke-width":g.opacity?d.lineWidth/this.scale:null,"stroke-linecap":d.lineCap,"stroke-linejoin":d.lineJoin,"stroke-miterlimit":d.strokeMiterLimit,
"stroke-dasharray":g.opacity?this.parseDasharray(d):null});d.svg&&this.setAttributes(c,d.svg);d.css&&this.setStyle(c,d.css);return this.append(c,b,0)};
pv.SvgScene.lineSegment=function(b){var c=b.$g.firstChild,d=b[0],f;switch(d.interpolate){case "basis":f=this.curveBasisSegments(b);break;case "cardinal":f=this.curveCardinalSegments(b,d.tension);break;case "monotone":f=this.curveMonotoneSegments(b);break}d=0;for(var g=b.length-1;d<g;d++){var h=b[d],i=b[d+1];if(h.visible&&i.visible){var j=h.strokeStyle,k=pv.FillStyle.transparent;if(j.opacity){if(h.interpolate=="linear"&&h.lineJoin=="miter"){k=j;j=pv.FillStyle.transparent;i=this.pathJoin(b[d-1],h,i,
b[d+2])}else i=f?f[d]:"M"+h.left+","+h.top+this.pathSegment(h,i);c=this.expect(c,"path",b,d,{"shape-rendering":h.antialias?null:"crispEdges","pointer-events":h.events,cursor:h.cursor,d:i,fill:k.color,"fill-opacity":k.opacity||null,stroke:j.color,"stroke-opacity":j.opacity||null,"stroke-width":j.opacity?h.lineWidth/this.scale:null,"stroke-linejoin":h.lineJoin});h.svg&&this.setAttributes(c,h.svg);h.css&&this.setStyle(c,h.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.pathSegment=function(b,c){var d=1;switch(b.interpolate){case "polar-reverse":d=0;case "polar":var f=c.left-b.left,g=c.top-b.top;b=1-b.eccentricity;f=Math.sqrt(f*f+g*g)/(2*b);if(b<=0||b>1)break;return"A"+f+","+f+" 0 0,"+d+" "+c.left+","+c.top;case "step-before":return"V"+c.top+"H"+c.left;case "step-after":return"H"+c.left+"V"+c.top}return"L"+c.left+","+c.top};pv.SvgScene.lineIntersect=function(b,c,d,f){return b.plus(c.times(d.minus(b).dot(f.perp())/c.dot(f.perp())))};
pv.strokeMiterLimit=4;
pv.SvgScene.pathJoin=function(b,c,d,f){var g=[],h,i=c.lineWidth/this.scale,j=pv.vector(c.left,c.top),k=pv.vector(d.left,d.top),l=k.minus(j),q=l.perp().norm(),m=q.times(i/2),s=j.plus(m),n=j.minus(m),o=k.plus(m);m=k.minus(m);if(!b||!b.visible)g.push(n,s);else{var p=pv.vector(b.left,b.top),t=j.minus(p),u=t.perp().norm().plus(q).norm();p=this.lineIntersect(j,u,s,l);u=this.lineIntersect(j,u,n,l);h=p.minus(u).length();b=(i+b.lineWidth/this.scale)/2;h=h/b;c=c.strokeMiterLimit||pv.strokeMiterLimit;if(h<=
c)g.push(u,p);else{c=l.times(-1);c=t.norm().plus(c.norm()).norm();j=j.plus(c.times(b/2));c.dot(q)>=0?g.push(u,j,s):g.push(n,j,p)}}if(!f||!f.visible)g.push(o,m);else{j=pv.vector(f.left,f.top).minus(k);n=j.perp().norm().plus(q).norm();s=this.lineIntersect(k,n,o,l);n=this.lineIntersect(k,n,m,l);h=s.minus(n).length();f=(f.lineWidth/this.scale+i)/2;h=h/f;c=d.strokeMiterLimit||pv.strokeMiterLimit;if(h<=c)g.push(s,n);else{d=j.times(-1);l=l.norm().plus(d.norm()).norm();k=k.plus(l.times(f/2));l.dot(q)>=0?
g.push(o,k,n):g.push(s,k,m)}}q=g.shift();return"M"+q.x+","+q.y+"L"+g.map(function(v){return v.x+","+v.y}).join(" ")};
pv.SvgScene.panel=function(b){for(var c=b.$g,d=c&&c.firstChild,f=false,g=0;g<b.length;g++){var h=b[g];if(h.visible){if(!b.parent){if(pv.renderer()!=="batik")h.canvas.style.display="inline-block";if(c&&c.parentNode!=h.canvas)d=(c=h.canvas.firstChild)&&c.firstChild;if(!c){c=this.create(pv.renderer()!=="batik"?"svg":"g");c.setAttribute("font-size","10px");c.setAttribute("font-family","sans-serif");c.setAttribute("fill","none");c.setAttribute("stroke","none");c.setAttribute("stroke-width",1.5);c.setAttribute("style",
"-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");if(typeof c.onselectstart!=="undefined"){c.setAttribute("unselectable","on");c.onselectstart=function(){return false}}if(pv.renderer()==="svgweb"){c.setAttribute("width",h.width+h.left+h.right);c.setAttribute("height",h.height+h.top+h.bottom);var i=document.createDocumentFragment(true);c.addEventListener("SVGLoad",function(){var s=this;(function(){if(f){f=
false;s.appendChild(i);for(var n=0;n<pv.Scene.events.length;n++)s.addEventListener(pv.Scene.events[n],pv.SvgScene.dispatch,false);b.$g=s;b.$g.__ready=true}else setTimeout(arguments.callee,10)})()},false);svgweb.appendChild(c,h.canvas);c=i}else{for(var j=0;j<this.events.length;j++)c.addEventListener(this.events[j],this.dispatch,false);c=h.canvas.appendChild(c);c.__ready=true}d=c.firstChild}b.$g=c;if(c.__ready){c.setAttribute("width",h.width+h.left+h.right);c.setAttribute("height",h.height+h.top+h.bottom)}}if(h.overflow==
"hidden"){j=pv.id().toString(36);var k=this.expect(d,"g",b,g,{"clip-path":"url(#"+j+")"});k.parentNode||c.appendChild(k);b.$g=c=k;d=k.firstChild;d=this.expect(d,"clipPath",b,g,{id:j});j=d.firstChild||d.appendChild(this.create("rect"));j.setAttribute("x",h.left);j.setAttribute("y",h.top);j.setAttribute("width",h.width);j.setAttribute("height",h.height);d.parentNode||c.appendChild(d);d=d.nextSibling}d=this.fill(d,b,g);j=this.scale;var l=h.transform,q=h.left+l.x,m=h.top+l.y;this.scale*=l.k;this.eachChild(b,
g,function(s){s.$g=d=this.expect(d,"g",b,g,{transform:"translate("+q+","+m+")"+(l.k!=1?" scale("+l.k+")":"")});this.updateAll(s);d.parentNode||c.appendChild(d);d=d.nextSibling});this.scale=j;d=this.stroke(d,b,g);if(h.overflow=="hidden"){b.$g=c=k.parentNode;d=k.nextSibling}}}f=true;return d};pv.SvgScene.eachChild=function(b,c,d,f){if(b.mark.zOrderChildCount){b=b[c].children.slice(0);b.sort(function(g,h){return g.mark._zOrder-h.mark._zOrder});b.forEach(d,f||this)}else b[c].children.forEach(d,f||this)};
pv.SvgScene.fill=function(b,c,d){this.removeFillStyleDefinitions(c);var f=c[d],g=f.fillStyle;if(g.opacity||f.events=="all"){g.type&&g.type!=="solid"&&this.addFillStyleDefinition(c,g);b=this.expect(b,"rect",c,d,{"shape-rendering":f.antialias?null:"crispEdges","pointer-events":f.events,cursor:f.cursor,x:f.left,y:f.top,width:f.width,height:f.height,fill:g.color,"fill-opacity":g.opacity,stroke:null});b=this.append(b,c,d)}return b};
pv.SvgScene.stroke=function(b,c,d){var f=c[d],g=f.strokeStyle;if(g.opacity||f.events=="all"){b=this.expect(b,"rect",c,d,{"shape-rendering":f.antialias?null:"crispEdges","pointer-events":f.events=="all"?"stroke":f.events,cursor:f.cursor,x:f.left,y:f.top,width:Math.max(1.0E-10,f.width),height:Math.max(1.0E-10,f.height),fill:null,stroke:g.color,"stroke-opacity":g.opacity,"stroke-width":f.lineWidth/this.scale,"stroke-linecap":f.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(f):null});b=this.append(b,
c,d)}return b};pv.SvgScene.minRuleLineWidth=1;
pv.SvgScene.rule=function(b){for(var c=b.$g.firstChild,d=0;d<b.length;d++){var f=b[d];if(f.visible){var g=f.strokeStyle;if(g.opacity){var h=f.lineWidth;h=h<1.0E-10?0:Math.max(this.minRuleLineWidth,h/this.scale);c=this.expect(c,"line",b,d,{"shape-rendering":f.antialias?null:"crispEdges","pointer-events":f.events,cursor:f.cursor,x1:f.left,y1:f.top,x2:f.left+f.width,y2:f.top+f.height,stroke:g.color,"stroke-opacity":g.opacity,"stroke-width":h,"stroke-linecap":f.lineCap,"stroke-dasharray":g.opacity?this.parseDasharray(f):
null});f.svg&&this.setAttributes(c,f.svg);f.css&&this.setStyle(c,f.css);c=this.append(c,b,d)}}}return c};
pv.SvgScene.wedge=function(b){var c=b.$g.firstChild;this.removeFillStyleDefinitions(b);for(var d=0;d<b.length;d++){var f=b[d];if(f.visible){var g=f.fillStyle,h=f.strokeStyle;if(g.opacity||h.opacity){var i=f.innerRadius,j=f.outerRadius,k=Math.abs(f.angle);if(k>=2*Math.PI)i=i?"M0,"+j+"A"+j+","+j+" 0 1,1 0,"+-j+"A"+j+","+j+" 0 1,1 0,"+j+"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":"M0,"+j+"A"+j+","+j+" 0 1,1 0,"+-j+"A"+j+","+j+" 0 1,1 0,"+j+"Z";else{var l=Math.min(f.startAngle,f.endAngle),
q=Math.max(f.startAngle,f.endAngle),m=Math.cos(l),s=Math.cos(q);l=Math.sin(l);q=Math.sin(q);i=i?"M"+j*m+","+j*l+"A"+j+","+j+" 0 "+(k<Math.PI?"0":"1")+",1 "+j*s+","+j*q+"L"+i*s+","+i*q+"A"+i+","+i+" 0 "+(k<Math.PI?"0":"1")+",0 "+i*m+","+i*l+"Z":"M"+j*m+","+j*l+"A"+j+","+j+" 0 "+(k<Math.PI?"0":"1")+",1 "+j*s+","+j*q+"L0,0Z"}g.type&&g.type!=="solid"&&this.addFillStyleDefinition(b,g);h.type&&h.type!="solid"&&this.addFillStyleDefinition(b,h);c=this.expect(c,"path",b,d,{"shape-rendering":f.antialias?null:
"crispEdges","pointer-events":f.events,cursor:f.cursor,transform:"translate("+f.left+","+f.top+")",d:i,fill:g.color,"fill-rule":"evenodd","fill-opacity":g.opacity||null,stroke:h.color,"stroke-opacity":h.opacity||null,"stroke-width":h.opacity?f.lineWidth/this.scale:null,"stroke-linejoin":f.lineJoin,"stroke-miterlimit":f.strokeMiterLimit,"stroke-linecap":f.lineCap,"stroke-dasharray":h.opacity?this.parseDasharray(f):null});f.svg&&this.setAttributes(c,f.svg);f.css&&this.setStyle(c,f.css);c=this.append(c,
b,d)}}}return c};pv.Mark=function(){this.$properties=[];this.$propertiesMap={};this.$handlers={}};pv.Mark.prototype.properties={};pv.Mark.cast={};pv.Mark.prototype.property=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;pv.Mark.prototype.propertyMethod(b,false,pv.Mark.cast[b]=c);return this};
pv.Mark.prototype.localProperty=function(b,c){if(!this.hasOwnProperty("properties"))this.properties=pv.extend(this.properties);this.properties[b]=true;var d=pv.Mark.cast[b];if(c)pv.Mark.cast[b]=d=c;this.propertyMethod(b,false,d);return this};
pv.Mark.prototype.propertyMethod=function(b,c,d){d||(d=pv.Mark.cast[b]);this[b]=function(f,g){if(c&&this.scene){var h=this.scene.defs;if(arguments.length){h[b]={id:f==null?0:pv.id(),value:f!=null&&d?d(f):f};return this}return h[b]?h[b].value:null}if(arguments.length){this.setPropertyValue(b,f,c,d,false,g);return this}if(h=pv.propertyEval){var i=this.binds,j=i.properties[b];if(j){i=i.net;var k=i[b];if(k==null)k=i[b]=0;(j.dependents||(j.dependents={}))[h.name]=true;(pv.propertyEvalDependencies||(pv.propertyEvalDependencies=
{}))[b]=true;if(k>=pv.propertyEvalNetIndex)pv.propertyEvalNetIndex=k+1}}return this.instance()[b]}};pv.Mark.funPropertyCaller=function(b,c){var d=pv.Mark.stack;return function(){var f=b.apply(this,d);return f!=null?c(f):null}};
pv.Mark.prototype.setPropertyValue=function(b,c,d,f,g,h){d=!d<<1|typeof c==="function";if(d&1&&f)c=pv.Mark.funPropertyCaller(c,f);else if(c!=null&&f)c=f(c);var i=this.$propertiesMap;f=this.$properties;c={name:b,id:pv.id(),value:c,type:d,tag:h};h=i[b];i[b]=c;if(h)for(b=0;b<f.length;b++)if(f[b]===h){f.splice(b,1);break}f.push(c);if(g&&h&&d===3){c.proto=h;c.root=h.root||h}return c};
pv.Mark.prototype.intercept=function(b,c,d){this.setPropertyValue(b,c,false,pv.get(d,"noCast")?null:pv.Mark.cast[b],true,pv.get(d,"tag"));return this};pv.Mark.prototype.propertyValue=function(b,c){var d=this.$propertiesMap[b];if(d)return d.value;if(c){if(this.proto){c=this.proto.propertyValueRecursive(b);if(c!==undefined)return c}return this.defaults.propertyValueRecursive(b)}};pv.Mark.prototype.propertyValueRecursive=function(b){var c=this.$propertiesMap[b];if(c)return c.value;if(this.proto)return this.proto.propertyValueRecursive(b)};
pv.Mark.stack=[];pv.Mark.prototype.property("data").property("visible",Boolean).property("datum",Object).property("css",Object).property("svg",Object).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String);a=pv.Mark.prototype;a.childIndex=-1;a.index=-1;a.scale=1;a._zOrder=0;
a.defaults=(new pv.Mark).data(function(b){return[b]}).datum(function(){var b=this.parent;return b?b.scene[b.index].datum:null}).visible(true).antialias(true).events("painted");a.extend=function(b){this.proto=b;this.target=b.target;return this};a.add=function(b){return this.parent.add(b).extend(this)};a.def=function(b,c){this.propertyMethod(b,true);return this[b](arguments.length>1?c:null)};
a.zOrder=function(b){if(!arguments.length)return this._zOrder;b=+b||0;if(this._zOrder!==b){this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount--;this._zOrder=b;this._zOrder!==0&&this.parent&&this.parent.zOrderChildCount++}return this};
a.anchor=function(b){b||(b="center");return(new pv.Anchor(this)).name(b).data(function(){return this.scene.target.map(function(c){return c.data})}).datum(function(){return this.scene.target[this.index].datum}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var c=this.scene.target[this.index],d=c.width||0;switch(this.name()){case "bottom":case "top":case "center":return c.left+d/2;case "left":return null}return c.left+
d}).top(function(){var c=this.scene.target[this.index],d=c.height||0;switch(this.name()){case "left":case "right":case "center":return c.top+d/2;case "top":return null}return c.top+d}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+(c.width||0):null}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+(c.height||0):null}).textAlign(function(){switch(this.name()){case "bottom":case "top":case "center":return"center";case "right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";
case "top":return"top"}return"bottom"})};a.anchorTarget=function(){return this.target};a.margin=function(b){return this.left(b).right(b).top(b).bottom(b)};a.instance=function(b){var c=this.scene||this.parent.instance(-1).children[this.childIndex],d=!arguments.length||this.hasOwnProperty("index")?this.index:b;return c[d<0?c.length-1:d]};
a.instances=function(b){for(var c=this,d=[],f;!(f=c.scene);){b=b.parent;d.push({index:b.index,childIndex:c.childIndex});c=c.parent}for(;d.length;){b=d.pop();f=f[b.index].children[b.childIndex]}if(this.hasOwnProperty("index")){d=pv.extend(f[this.index]);d.right=d.top=d.left=d.bottom=0;return[d]}return f};a.first=function(){return this.scene[0]};a.last=function(){return this.scene[this.scene.length-1]};a.sibling=function(){return this.index==0?null:this.scene[this.index-1]};
a.cousin=function(){var b=this.parent;return(b=b&&b.sibling())&&b.children?b.children[this.childIndex][this.index]:null};a.render=function(){this.parent&&!this.root.scene?this.root.render():this.renderCore()};
a.renderCore=function(){function b(i,j,k){i.scale=k;if(j<g.length){f.unshift(null);try{if(i.hasOwnProperty("index"))c(i,j,k);else{for(var l=0,q=i.scene.length;l<q;l++){i.index=l;c(i,j,k)}delete i.index}}finally{f.shift()}}else{i.build();pv.Scene.scale=k;j=null;if(i.scene&&i.scene.$g&&i.scene.$g.suspendRedraw)j=i.scene.$g.suspendRedraw(1E3);pv.Scene.updateAll(i.scene);j&&i.scene.$g.unsuspendRedraw(j)}delete i.scale}function c(i,j,k){var l=i.scene[i.index],q;if(l.visible){var m=g[j],s=i.children[m];
for(q=0;q<m;q++)i.children[q].scene=l.children[q];f[0]=l.data;if(s.scene)b(s,j+1,k*l.transform.k);else{s.scene=l.children[m];b(s,j+1,k*l.transform.k);delete s.scene}for(q=0;q<m;q++)delete i.children[q].scene}}for(var d=this.parent,f=pv.Mark.stack,g=[],h=this;h.parent;h=h.parent)g.unshift(h.childIndex);for(this.bind();d&&!d.hasOwnProperty("index");)d=d.parent;this.context(d?d.scene:undefined,d?d.index:-1,function(){b(this.root,0,1)})};pv.Mark._requiredPropsPosition={id:0,datum:1,visible:3};a=pv.Mark.prototype;
a.bind=function(){function b(k){do for(var l=k.$properties,q=l.length-1;q>=0;q--){var m=l[q],s=c[m.name];if(s){if(s.type===3){var n=s.root;if(n){if(!n.proto){n.proto=m;s.root=m}}else s.proto=s.root=m}}else{c[m.name]=m;switch(m.name){case "data":d=m;break;case "datum":case "visible":case "id":f.push(m);break;default:g[m.type].push(m);break}}}while(k=k.proto)}var c={},d,f=[],g=[[],[],[],[]],h=pv.Mark._requiredPropsPosition;b(this);b(this.defaults);f.sort(function(k,l){return h[k.name]-h[l.name]});g[1].reverse();
g[3].reverse();var i=this;do for(var j in i.properties)j in c||g[2].push(c[j]={name:j,type:2,value:null});while(i=i.proto);i=g[0].concat(g[1]);for(j=0;j<i.length;j++)this.propertyMethod(i[j].name,true);this.binds={properties:c,net:{},data:d,defs:i,required:f,optional:pv.blend(g)}};a.updateNet=function(b,c){function d(i,j){if(j>(h[i.name]||0)){h[i.name]=j;if(i=i.dependents){j++;for(var k in i)if(i.hasOwnProperty(k)){var l=g[k];l&&d(l,j)}}}}var f=this.binds,g=f.properties,h=f.net;d(b,c)};
a.build=function(){var b=this.scene,c=pv.Mark.stack;if(!b){b=this.scene=[];b.mark=this;b.type=this.type;b.childIndex=this.childIndex;if(this.parent){b.parent=this.parent.scene;b.parentIndex=this.parent.index}}if(this.target)b.target=this.target.instances(b);if(this.binds.defs.length){var d=b.defs;if(!d)b.defs=d={};for(var f=0;f<this.binds.defs.length;f++){var g=this.binds.defs[f],h=d[g.name];if(!h||g.id>h.id)d[g.name]={id:0,value:g.type&1?g.value.apply(this,c):g.value}}}d=this.binds.data;d=d.type&
1?d.value.apply(this,c):d.value;g=pv.Mark.prototype;c.unshift(null);try{var i=b.length=d.length;for(f=0;f<i;f++){g.index=this.index=f;var j=b[f]||(b[f]={});j.data=c[0]=d[f];this.buildInstance(j)}}finally{g.index=-1;delete this.index;c.shift()}return this};
a.buildProperties=function(b,c){for(var d=pv.Mark.stack,f=0,g=c.length;f<g;f++){var h=c[f],i;switch(h.type){case 3:var j=pv.propertyProto;try{pv.propertyProto=h.proto;i=h.value.apply(this,d)}finally{pv.propertyProto=j}break;case 2:i=h.value;break;case 0:case 1:i=this.scene.defs[h.name].value;break}b[h.name]=i}};a.delegate=function(b,c){var d=pv.propertyProto;if(d&&(!c||d.tag===c)){c=this.evalProperty(d);if(c!==undefined)return c}return b};
a.hasDelegate=function(b){var c=pv.propertyProto;return!!c&&(!b||c.tag===b)};a.evalProperty=function(b){switch(b.type){case 3:var c=pv.propertyProto;try{pv.propertyProto=b.proto;return b.value.apply(this,pv.Mark.stack)}finally{pv.propertyProto=c}case 2:return b.value;case 0:case 1:return this.scene.defs[b.name].value}};
a.buildPropertiesWithDepTracking=function(b,c){var d=this.binds.net,f,g,h,i,j,k,l=pv.Mark.stack,q=c.length;try{for(;;){h=null;k={};for(var m=0;m<q;m++){var s=c[m],n=s.name;k[n]=true;if(!i||i[n]){var o;switch(s.type){case 3:pv.propertyEval=s;pv.propertyEvalNetIndex=f=d[n]||0;pv.propertyEvalDependencies=null;var p=pv.propertyProto;try{pv.propertyProto=s.proto;o=s.value.apply(this,l)}finally{pv.propertyProto=p}g=pv.propertyEvalNetIndex;if(g>f){var t=pv.propertyEvalDependencies;for(var u in t)if(t.hasOwnProperty(u)&&
!k.hasOwnProperty(n)){h||(h={});h[u]=true}this.updateNet(s,g)}break;case 2:o=s.value;break;case 0:case 1:o=this.scene.defs[n].value;break}b[n]=o}}if(!h)break;i=h;j=pv.numerate(c,function(v){return v.name});c.sort(function(v,r){var y=pv.naturalOrder(d[v.name]||0,d[r.name]||0);y||(y=pv.naturalOrder(j[v.name],j[r.name]));return y});j=null}}finally{pv.propertyEval=null;pv.propertyEvalNetIndex=null;pv.propertyEvalDependencies=null}};
a.buildInstance=function(b){this.buildProperties(b,this.binds.required);if(b.visible){this.index===0?this.buildPropertiesWithDepTracking(b,this.binds.optional):this.buildProperties(b,this.binds.optional);this.buildImplied(b)}};
a.buildImplied=function(b){var c=b.left,d=b.right,f=b.top,g=b.bottom,h=this.properties,i=h.width?b.width:0,j=h.height?b.height:0,k,l;if(i==null||d==null||c==null){k=this.parent?this.parent.instance():null;l=true;var q=k?k.width:i+c+d;if(i==null)i=q-(d=d||0)-(c=c||0);else if(d==null)if(c==null)c=d=(q-i)/2;else d=q-i-c;else c=q-i-d}if(j==null||g==null||f==null){l||(k=this.parent?this.parent.instance():null);k=k?k.height:j+f+g;if(j==null)j=k-(f=f||0)-(g=g||0);else if(g==null)g=f==null?(f=(k-j)/2):k-
j-f;else f=k-j-g}b.left=c;b.right=d;b.top=f;b.bottom=g;if(h.width)b.width=i;if(h.height)b.height=j;if(h.textStyle&&!b.textStyle)b.textStyle=pv.FillStyle.transparent;if(h.fillStyle&&!b.fillStyle)b.fillStyle=pv.FillStyle.transparent;if(h.strokeStyle&&!b.strokeStyle)b.strokeStyle=pv.FillStyle.transparent};
a.mouse=function(){var b=this.root.canvas(),c=pv.scrollOffset(b),d=pv.event,f=c[0]+d.clientX*1;c=c[1]+d.clientY*1;if(pv.renderer()!=="svgweb"){do{f-=b.offsetLeft;c-=b.offsetTop}while(b=b.offsetParent)}b=pv.Transform.identity;var g=this.properties.transform?this:this.parent;d=[];do d.push(g);while(g=g.parent);for(;g=d.pop();){g=g.instance();b=b.translate(g.left,g.top).times(g.transform)}b=b.invert();return pv.vector(f*b.k+b.x,c*b.k+b.y)};
a.event=function(b,c){c=pv.functor(c);var d=this.$handlers[b];if(d)if(d instanceof Array)d.push(c);else d=[d,c];else d=c;this.$handlers[b]=d;return this};
a.context=function(b,c,d){function f(m,s){pv.Mark.scene=m;h.index=s;if(m){var n=m.mark,o=n,p=[];do{p.push(o);i.push(m[s].data);o.index=s;o.scene=m;s=m.parentIndex;m=m.parent}while(o=o.parent);m=p.length-1;for(s=1;m>0;m--){o=p[m];o.scale=s;s*=o.scene[o.index].transform.k}if(p=n.children){n=n.scene[n.index];m=0;for(var t=p.length;m<t;m++){o=p[m];o.scene=n.children[m];o.scale=s}}}}function g(m){if(m){m=m.mark;var s,n=m.children;if(n)for(var o=0,p=n.length;o<p;o++){s=n[o];delete s.scene;delete s.scale}s=
m;do{i.pop();if(s.parent){delete s.scene;delete s.scale}delete s.index}while(s=s.parent)}}var h=pv.Mark.prototype,i=pv.Mark.stack,j=pv.Mark.scene,k=h.index;if(b&&b===j&&c===k)try{d.apply(this,i)}catch(l){pv.error(l);throw l;}finally{pv.Mark.scene=j;h.index=k}else{g(j,k);f(b,c);try{d.apply(this,i)}catch(q){pv.error(q);throw q;}finally{g(b,c);f(j,k)}}};
pv.Mark.dispatch=function(b,c,d,f){var g=c.mark,h=c.parent,i=g.$handlers[b];if(g.root.animatingCount)return true;if(!i)return h&&pv.Mark.dispatch(b,h,c.parentIndex,f);g.context(c,d,function(){var j=pv.Mark.stack.concat(f);if(i instanceof Array){var k;i.forEach(function(l){if((l=l.apply(g,j))&&l.render)(k||(k=[])).push(l)});k&&k.forEach(function(l){l.render()})}else(g=i.apply(g,j))&&g.render&&g.render()});return true};
pv.Mark.prototype.eachInstance=function(b,c){function d(j,k,l){var q;k===i||(q=g[k]);var m=j.length;if(m>0){for(var s=0;s<m;s++){var n=j[s];if(k===i)b.call(c,j[s],l);else if(n.visible){var o=n.children[q];if(o){n=l.times(n.transform).translate(n.left,n.top);d(o,k+1,n)}}}b.call(c,h,null)}}for(var f=this,g=[],h={isBreak:true,visible:false,datum:{}};f.parent;){g.unshift(f.childIndex);f=f.parent}if(f=f.scene){var i=g.length;d(f,0,pv.Transform.identity)}};
pv.Mark.prototype.toScreenTransform=function(){var b=pv.Transform.identity;if(this instanceof pv.Panel)b=b.translate(this.left(),this.top()).times(this.transform());var c=this.parent;if(c){do b=b.translate(c.left(),c.top()).times(c.transform());while(c=c.parent)}return b};pv.Mark.prototype.transition=function(){return new pv.Transition(this)};pv.Mark.prototype.on=function(b){return this["$"+b]=new pv.Transient(this)};pv.Anchor=function(b){pv.Mark.call(this);this.target=b;this.parent=b.parent};
pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String);pv.Anchor.prototype.extend=function(b){this.proto=b;return this};pv.Area=function(){pv.Mark.call(this)};
pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("segmented",Boolean).property("interpolate",String).property("tension",Number);pv.Area.prototype.type="area";pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
pv.Area.prototype.buildImplied=function(b){if(b.height==null)b.height=0;if(b.width==null)b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Area.fixed={lineWidth:1,lineJoin:1,strokeMiterLimit:1,lineCap:1,strokeStyle:1,strokeDasharray:1,fillStyle:1,segmented:1,interpolate:1,tension:1};
pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);var b=this.binds,c=b.required;b=b.optional;for(var d=0,f=b.length;d<f;d++){var g=b[d];g.fixed=g.name in pv.Area.fixed;if(g.name=="segmented"){c.push(g);b.splice(d,1);d--;f--}}this.binds.$required=c;this.binds.$optional=b};
pv.Area.prototype.buildInstance=function(b){var c=this.binds;if(this.index){var d=c.fixed;if(!d){d=c.fixed=[];function f(j){return!j.fixed||(d.push(j),false)}c.required=c.required.filter(f);if(!this.scene[0].segmented)c.optional=c.optional.filter(f)}if(c=d.length)for(var g=this.scene[0],h=0;h<c;h++){var i=d[h].name;b[i]=g[i]}}else{c.required=c.$required;c.optional=c.$optional;c.fixed=null}pv.Mark.prototype.buildInstance.call(this,b)};
pv.Area.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})};pv.Bar=function(){pv.Mark.call(this)};
pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("fillStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Bar.prototype.type="bar";pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).lineCap("butt").strokeDasharray("none");pv.Dot=function(){pv.Mark.call(this)};
pv.Dot.prototype=pv.extend(pv.Mark).property("shape",String).property("shapeAngle",Number).property("shapeRadius",Number).property("shapeSize",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);pv.Dot.prototype.type="dot";pv.Dot.prototype.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).shape("circle").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).lineCap("butt").strokeDasharray("none");
pv.Dot.prototype.anchor=function(b){return pv.Mark.prototype.anchor.call(this,b).left(function(){var c=this.scene.target[this.index];switch(this.name()){case "bottom":case "top":case "center":return c.left;case "left":return null}return c.left+c.shapeRadius}).right(function(){var c=this.scene.target[this.index];return this.name()=="left"?c.right+c.shapeRadius:null}).top(function(){var c=this.scene.target[this.index];switch(this.name()){case "left":case "right":case "center":return c.top;case "top":return null}return c.top+
c.shapeRadius}).bottom(function(){var c=this.scene.target[this.index];return this.name()=="top"?c.bottom+c.shapeRadius:null}).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "bottom":return"top"}return"bottom"})};
pv.Dot.prototype.buildImplied=function(b){var c=b.shapeRadius,d=b.shapeSize;if(c==null)if(d==null){b.shapeSize=20.25;b.shapeRadius=4.5}else b.shapeRadius=Math.sqrt(d);else if(d==null)b.shapeSize=c*c;pv.Mark.prototype.buildImplied.call(this,b)};pv.Label=function(){pv.Mark.call(this)};
pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String);pv.Label.prototype.type="label";pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3);
pv.Line=function(){pv.Mark.call(this)};pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeStyle",pv.fillStyle).property("strokeDasharray",String).property("fillStyle",pv.fillStyle).property("segmented",Boolean).property("interpolate",String).property("eccentricity",Number).property("tension",Number);a=pv.Line.prototype;a.type="line";a.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(0.7).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");
a.bind=pv.Area.prototype.bind;a.buildInstance=pv.Area.prototype.buildInstance;a.anchor=function(b){return pv.Area.prototype.anchor.call(this,b).textAlign(function(){switch(this.name()){case "left":return"right";case "bottom":case "top":case "center":return"center";case "right":return"left"}}).textBaseline(function(){switch(this.name()){case "right":case "left":case "center":return"middle";case "top":return"bottom";case "bottom":return"top"}})};pv.Rule=function(){pv.Mark.call(this)};
pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineCap",String).property("strokeDasharray",String);pv.Rule.prototype.type="rule";pv.Rule.prototype.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(false).lineCap("butt").strokeDasharray("none");pv.Rule.prototype.anchor=pv.Line.prototype.anchor;
pv.Rule.prototype.buildImplied=function(b){var c=b.left,d=b.right;if(b.width!=null||c==null&&d==null||d!=null&&c!=null)b.height=0;else b.width=0;pv.Mark.prototype.buildImplied.call(this,b)};pv.Panel=function(){pv.Bar.call(this);this.children=[];this.root=this;this.$dom=pv.$&&pv.$.s};pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(b){return typeof b=="string"?document.getElementById(b):b});a=pv.Panel.prototype;a.type="panel";
a.animatingCount=0;a.zOrderChildCount=0;a.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible");a.anchor=function(b){b=pv.Bar.prototype.anchor.call(this,b);b.parent=this;return b};a.add=function(b){b=new b;b.parent=this;b.root=this.root;b.childIndex=this.children.length;this.children.push(b);return b};a.bind=function(){pv.Mark.prototype.bind.call(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].bind()};
a.buildInstance=function(b){pv.Bar.prototype.buildInstance.call(this,b);if(b.visible){var c=this.scale*b.transform.k;pv.Mark.prototype.index=-1;for(var d=this.children,f=b.children||(b.children=[]),g=0,h=d.length;g<h;g++){b=d[g];b.scene=f[g];b.scale=c;b.build()}for(g=0;g<h;g++){b=d[g];f[g]=b.scene;delete b.scene;delete b.scale}f.length=h}};
a.buildImplied=function(b){if(!this.parent){var c=b.canvas;if(pv.renderer()==="batik")if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}}else c=document.lastChild;else if(c){if(c.$panel!=this){pv.Panel.updateCreateId(c);for(c.$panel=this;c.lastChild;)c.removeChild(c.lastChild)}var d;if(b.width==null){d=parseFloat(pv.css(c,"width"));b.width=d-b.left-b.right}if(b.height==null){d=parseFloat(pv.css(c,"height"));b.height=d-b.top-b.bottom}}else{d=
this.$canvas||(this.$canvas=[]);if(!(c=d[this.index])){c=d[this.index]=document.createElement(pv.renderer()=="svgweb"?"div":"span");if(this.$dom)this.$dom.parentNode.insertBefore(c,this.$dom);else{for(d=document.body;d.lastChild&&d.lastChild.tagName;)d=d.lastChild;if(d!=document.body)d=d.parentNode;d.appendChild(c)}}}b.canvas=c}if(!b.transform)b.transform=pv.Transform.identity;pv.Mark.prototype.buildImplied.call(this,b)};pv.Panel.updateCreateId=function(b){b.$pvCreateId=(b.$pvCreateId||0)+1};
pv.Image=function(){pv.Bar.call(this)};pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number);a=pv.Image.prototype;a.type="image";a.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null);a.image=function(b){this.$image=function(){var c=b.apply(this,arguments);return c==null?pv.Color.transparent:typeof c=="string"?pv.color(c):c};return this};
a.bind=function(){pv.Bar.prototype.bind.call(this);var b=this.binds,c=this;do b.image=c.$image;while(!b.image&&(c=c.proto))};
a.buildImplied=function(b){pv.Bar.prototype.buildImplied.call(this,b);if(b.visible){if(b.imageWidth==null)b.imageWidth=b.width;if(b.imageHeight==null)b.imageHeight=b.height;if(b.url==null&&this.binds.image){var c=this.$canvas||(this.$canvas=document.createElement("canvas")),d=c.getContext("2d"),f=b.imageWidth,g=b.imageHeight,h=pv.Mark.stack;c.width=f;c.height=g;b=(b.image=d.createImageData(f,g)).data;h.unshift(null,null);for(d=c=0;c<g;c++){h[1]=c;for(var i=0;i<f;i++){h[0]=i;var j=this.binds.image.apply(this,
h);b[d++]=j.r;b[d++]=j.g;b[d++]=j.b;b[d++]=255*j.a}}h.splice(0,2)}}};pv.Wedge=function(){pv.Mark.call(this)};
pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",pv.fillStyle).property("lineJoin",String).property("strokeMiterLimit",Number).property("lineCap",String).property("strokeDasharray",String).property("fillStyle",pv.fillStyle);a=pv.Wedge.prototype;a.type="wedge";
a.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var b=this.sibling();return b?b.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)).lineJoin("miter").strokeMiterLimit(8).lineCap("butt").strokeDasharray("none");a.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2};a.midAngle=function(){return(this.startAngle()+this.endAngle())/2};
a.anchor=function(b){function c(g){return g.innerRadius||g.angle<2*Math.PI}function d(g){return(g.innerRadius+g.outerRadius)/2}function f(g){return(g.startAngle+g.endAngle)/2}return pv.Mark.prototype.anchor.call(this,b).left(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "outer":return g.left+g.outerRadius*Math.cos(f(g));case "inner":return g.left+g.innerRadius*Math.cos(f(g));case "start":return g.left+d(g)*Math.cos(g.startAngle);case "center":return g.left+d(g)*Math.cos(f(g));
case "end":return g.left+d(g)*Math.cos(g.endAngle)}return g.left}).top(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "outer":return g.top+g.outerRadius*Math.sin(f(g));case "inner":return g.top+g.innerRadius*Math.sin(f(g));case "start":return g.top+d(g)*Math.sin(g.startAngle);case "center":return g.top+d(g)*Math.sin(f(g));case "end":return g.top+d(g)*Math.sin(g.endAngle)}return g.top}).textAlign(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "outer":return pv.Wedge.upright(f(g))?
"right":"left";case "inner":return pv.Wedge.upright(f(g))?"left":"right"}return"center"}).textBaseline(function(){var g=this.scene.target[this.index];if(c(g))switch(this.name()){case "start":return pv.Wedge.upright(g.startAngle)?"top":"bottom";case "end":return pv.Wedge.upright(g.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var g=this.scene.target[this.index],h=0;if(c(g))switch(this.name()){case "center":case "inner":case "outer":h=f(g);break;case "start":h=g.startAngle;break;case "end":h=
g.endAngle;break}return pv.Wedge.upright(h)?h:h+Math.PI})};pv.Wedge.upright=function(b){b%=2*Math.PI;b=b<0?2*Math.PI+b:b;return b<Math.PI/2||b>=3*Math.PI/2};pv.Wedge.prototype.buildImplied=function(b){if(b.angle==null)b.angle=b.endAngle-b.startAngle;else if(b.endAngle==null)b.endAngle=b.startAngle+b.angle;pv.Mark.prototype.buildImplied.call(this,b)};
pv.Ease=function(){function b(o){return function(p){return 1-o(1-p)}}function c(o){return function(p){return 0.5*(p<0.5?o(2*p):2-o(2-2*p))}}function d(o){return function(p){return p<0?0:p>1?1:Math.pow(p,o)}}function f(o){return 1-Math.cos(o*Math.PI/2)}function g(o){return o?Math.pow(2,10*(o-1))-0.001:0}function h(o){return-(Math.sqrt(1-o*o)-1)}function i(o,p){var t;p||(p=0.45);if(!o||o<1){o=1;t=p/4}else t=p/(2*Math.PI)*Math.asin(1/o);return function(u){return u<=0||u>=1?u:-(o*Math.pow(2,10*--u)*Math.sin((u-
t)*2*Math.PI/p))}}function j(o){o||(o=1.70158);return function(p){return p*p*((o+1)*p-o)}}function k(o){return o<1/2.75?7.5625*o*o:o<2/2.75?7.5625*(o-=1.5/2.75)*o+0.75:o<2.5/2.75?7.5625*(o-=2.25/2.75)*o+0.9375:7.5625*(o-=2.625/2.75)*o+0.984375}var l=d(2),q=d(3),m=i(),s=j(),n={linear:pv.identity,"quad-in":l,"quad-out":b(l),"quad-in-out":c(l),"quad-out-in":c(b(l)),"cubic-in":q,"cubic-out":b(q),"cubic-in-out":c(q),"cubic-out-in":c(b(q)),"sin-in":f,"sin-out":b(f),"sin-in-out":c(f),"sin-out-in":c(b(f)),
"exp-in":g,"exp-out":b(g),"exp-in-out":c(g),"exp-out-in":c(b(g)),"circle-in":h,"circle-out":b(h),"circle-in-out":c(h),"circle-out-in":c(b(h)),"elastic-in":m,"elastic-out":b(m),"elastic-in-out":c(m),"elastic-out-in":c(b(m)),"back-in":s,"back-out":b(s),"back-in-out":c(s),"back-out-in":c(b(s)),"bounce-in":k,"bounce-out":b(k),"bounce-in-out":c(k),"bounce-out-in":c(b(k))};pv.ease=function(o){return n[o]};return{reverse:b,reflect:c,linear:function(){return pv.identity},sin:function(){return f},exp:function(){return g},
circle:function(){return h},elastic:i,back:j,bounce:k,poly:d}}();
pv.Transition=function(b){function c(p){for(var t={},u=0;u<p.length;u++){var v=p[u];if(v.id)t[v.id]=v}return t}function d(p,t,u,v){var r;if(t in n){var y=pv.Scale.interpolator(u[t],v[t]);r=function(x){u[t]=y(x)}}else r=function(x){if(x>0.5)u[t]=v[t]};r.next=p.head;p.head=r}function f(p,t,u){for(var v in t)v!="children"&&t[v]!=u[v]&&d(p,v,t,u);if(t.children)for(v=0;v<t.children.length;v++)g(p,t.children[v],u.children[v])}function g(p,t,u){for(var v=t.mark,r=c(t),y=c(u),x=0;x<t.length;x++){var z=t[x],
w=z.id?y[z.id]:u[x];z.index=x;if(z.visible){if(!(w&&w.visible)){var B=h(t,x,v.$exit,u);z.transition=w?2:(u.push(B),1);w=B}f(p,z,w)}}for(x=0;x<u.length;x++){w=u[x];z=w.id?r[w.id]:t[x];if(!(z&&z.visible)&&w.visible){B=h(u,x,v.$enter,t);if(z)t[z.index]=B;else t.push(B);f(p,B,w)}}}function h(p,t,u,v){var r=pv.extend(p[t]),y=p.mark,x=y.root.scene,z=(u||o).$properties,w;if(v.target&&(w=v.target[v.length])){p=pv.extend(p);p.target=pv.extend(v.target);p.target[t]=w}var B={};for(u=0;u<z.length;u++)B[z[u].name]=
1;z=y.binds.optional.filter(function(C){return!(C.name in B)}).concat(z);y.context(p,t,function(){this.buildProperties(r,z);this.buildImplied(r)});y.root.scene=x;return r}function i(p){for(var t=0,u=0;t<p.length;t++){var v=p[t];if(v.transition!=1){p[u++]=v;if(v.transition==2)v.visible=false;v.children&&v.children.forEach(i)}}p.length=u}function j(){b.root.animatingCount--;if(s){var p=s;s=null;p()}}var k=this,l=pv.ease("cubic-in-out"),q=250,m,s,n={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,
outerRadius:1,radius:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},o=new pv.Transient;k.ease=function(p){return arguments.length?(l=typeof p=="function"?p:pv.ease(p),k):l};k.duration=function(p){return arguments.length?(q=Number(p),k):q};k.start=function(p){s=p;b.root.animatingCount++;if(b.parent){j();throw new Error("Animated partial rendering is not supported.");}try{b.$transition&&b.$transition.stop();b.$transition=
k;var t=pv.Mark.prototype.index,u=b.scene,v;b.scene=null;b.bind();b.build();v=b.scene;b.scene=u;pv.Mark.prototype.index=t;var r=Date.now(),y={};g(y,u,v)}catch(x){j();throw x;}m=setInterval(function(){for(var z=Math.max(0,Math.min(1,(Date.now()-r)/q)),w=l(z),B=y.head;B;B=B.next)B(w);if(z==1){i(b.scene);k.stop()}pv.Scene.updateAll(u)},24)};k.stop=function(){clearInterval(m);j()}};pv.Transient=function(b){pv.Mark.call(this);this.fillStyle(null).strokeStyle(null).textStyle(null);this.on=function(c){return b.on(c)}};
pv.Transient.prototype=pv.extend(pv.Mark);pv.simulation=function(b){return new pv.Simulation(b)};pv.Simulation=function(b){for(var c=0;c<b.length;c++)this.particle(b[c])};a=pv.Simulation.prototype;a.particle=function(b){b.next=this.particles;if(isNaN(b.px))b.px=b.x;if(isNaN(b.py))b.py=b.y;if(isNaN(b.fx))b.fx=0;if(isNaN(b.fy))b.fy=0;this.particles=b;return this};a.force=function(b){b.next=this.forces;this.forces=b;return this};a.constraint=function(b){b.next=this.constraints;this.constraints=b;return this};
a.stabilize=function(b){var c;arguments.length||(b=3);for(var d=0;d<b;d++){var f=new pv.Quadtree(this.particles);for(c=this.constraints;c;c=c.next)c.apply(this.particles,f)}for(c=this.particles;c;c=c.next){c.px=c.x;c.py=c.y}return this};
a.step=function(){var b;for(b=this.particles;b;b=b.next){var c=b.px,d=b.py;b.px=b.x;b.py=b.y;b.x+=b.vx=b.x-c+b.fx;b.y+=b.vy=b.y-d+b.fy}c=new pv.Quadtree(this.particles);for(b=this.constraints;b;b=b.next)b.apply(this.particles,c);for(b=this.particles;b;b=b.next)b.fx=b.fy=0;for(b=this.forces;b;b=b.next)b.apply(this.particles,c)};
pv.Quadtree=function(b){function c(l,q,m,s,n,o){if(!(isNaN(q.x)||isNaN(q.y)))if(l.leaf)if(l.p){if(!(Math.abs(l.p.x-q.x)+Math.abs(l.p.y-q.y)<0.01)){var p=l.p;l.p=null;d(l,p,m,s,n,o)}d(l,q,m,s,n,o)}else l.p=q;else d(l,q,m,s,n,o)}function d(l,q,m,s,n,o){var p=(m+n)*0.5,t=(s+o)*0.5,u=q.x>=p,v=q.y>=t;l.leaf=false;switch((v<<1)+u){case 0:l=l.c1||(l.c1=new pv.Quadtree.Node);break;case 1:l=l.c2||(l.c2=new pv.Quadtree.Node);break;case 2:l=l.c3||(l.c3=new pv.Quadtree.Node);break;case 3:l=l.c4||(l.c4=new pv.Quadtree.Node);
break}if(u)m=p;else n=p;if(v)s=t;else o=t;c(l,q,m,s,n,o)}var f,g=Number.POSITIVE_INFINITY,h=g,i=Number.NEGATIVE_INFINITY,j=i;for(f=b;f;f=f.next){if(f.x<g)g=f.x;if(f.y<h)h=f.y;if(f.x>i)i=f.x;if(f.y>j)j=f.y}f=i-g;var k=j-h;if(f>k)j=h+f;else i=g+k;this.xMin=g;this.yMin=h;this.xMax=i;this.yMax=j;this.root=new pv.Quadtree.Node;for(f=b;f;f=f.next)c(this.root,f,g,h,i,j)};pv.Quadtree.Node=function(){this.leaf=true;this.p=this.c4=this.c3=this.c2=this.c1=null};pv.Force={};
pv.Force.charge=function(b){function c(l){function q(n){c(n);l.cn+=n.cn;m+=n.cn*n.cx;s+=n.cn*n.cy}var m=0,s=0;l.cn=0;if(!l.leaf){l.c1&&q(l.c1);l.c2&&q(l.c2);l.c3&&q(l.c3);l.c4&&q(l.c4)}if(l.p){l.cn+=b;m+=b*l.p.x;s+=b*l.p.y}l.cx=m/l.cn;l.cy=s/l.cn}function d(l,q,m,s,n,o){var p=l.cx-q.x,t=l.cy-q.y,u=1/Math.sqrt(p*p+t*t);if(l.leaf&&l.p!=q||(n-m)*u<j){if(!(u<i)){if(u>g)u=g;l=l.cn*u*u*u;p=p*l;t=t*l;q.fx+=p;q.fy+=t}}else if(!l.leaf){var v=(m+n)*0.5,r=(s+o)*0.5;l.c1&&d(l.c1,q,m,s,v,r);l.c2&&d(l.c2,q,v,s,
n,r);l.c3&&d(l.c3,q,m,r,v,o);l.c4&&d(l.c4,q,v,r,n,o);if(!(u<i)){if(u>g)u=g;if(l.p&&l.p!=q){l=b*u*u*u;p=p*l;t=t*l;q.fx+=p;q.fy+=t}}}}var f=2,g=1/f,h=500,i=1/h,j=0.9,k={};arguments.length||(b=-40);k.constant=function(l){if(arguments.length){b=Number(l);return k}return b};k.domain=function(l,q){if(arguments.length){f=Number(l);g=1/f;h=Number(q);i=1/h;return k}return[f,h]};k.theta=function(l){if(arguments.length){j=Number(l);return k}return j};k.apply=function(l,q){c(q.root);for(l=l;l;l=l.next)d(q.root,
l,q.xMin,q.yMin,q.xMax,q.yMax)};return k};pv.Force.drag=function(b){var c={};arguments.length||(b=0.1);c.constant=function(d){if(arguments.length){b=d;return c}return b};c.apply=function(d){if(b)for(d=d;d;d=d.next){d.fx-=b*d.vx;d.fy-=b*d.vy}};return c};
pv.Force.spring=function(b){var c=0.1,d=20,f,g,h={};arguments.length||(b=0.1);h.links=function(i){if(arguments.length){f=i;g=i.map(function(j){return 1/Math.sqrt(Math.max(j.sourceNode.linkDegree,j.targetNode.linkDegree))});return h}return f};h.constant=function(i){if(arguments.length){b=Number(i);return h}return b};h.damping=function(i){if(arguments.length){c=Number(i);return h}return c};h.length=function(i){if(arguments.length){d=Number(i);return h}return d};h.apply=function(){for(var i=0;i<f.length;i++){var j=
f[i].sourceNode,k=f[i].targetNode,l=j.x-k.x,q=j.y-k.y,m=Math.sqrt(l*l+q*q),s=m?1/m:1;s=(b*g[i]*(m-d)+c*g[i]*(l*(j.vx-k.vx)+q*(j.vy-k.vy))*s)*s;l=-s*(m?l:0.01*(0.5-Math.random()));q=-s*(m?q:0.01*(0.5-Math.random()));j.fx+=l;j.fy+=q;k.fx-=l;k.fy-=q}};return h};pv.Constraint={};
pv.Constraint.collision=function(b){function c(l,q,m,s,n,o){if(!l.leaf){var p=(m+n)*0.5,t=(s+o)*0.5,u=t<j,v=p>g,r=p<i;if(t>h){l.c1&&v&&c(l.c1,q,m,s,p,t);l.c2&&r&&c(l.c2,q,p,s,n,t)}if(u){l.c3&&v&&c(l.c3,q,m,t,p,o);l.c4&&r&&c(l.c4,q,p,t,n,o)}}if(l.p&&l.p!=q){m=q.x-l.p.x;s=q.y-l.p.y;n=Math.sqrt(m*m+s*s);o=f+b(l.p);if(n<o){n=(n-o)/n*0.5;m*=n;s*=n;q.x-=m;q.y-=s;l.p.x+=m;l.p.y+=s}}}var d=1,f,g,h,i,j,k={};arguments.length||(f=10);k.repeat=function(l){if(arguments.length){d=Number(l);return k}return d};k.apply=
function(l,q){var m,s,n=-Infinity;for(m=l;m;m=m.next){s=b(m);if(s>n)n=s}for(var o=0;o<d;o++)for(m=l;m;m=m.next){s=(f=b(m))+n;g=m.x-s;i=m.x+s;h=m.y-s;j=m.y+s;c(q.root,m,q.xMin,q.yMin,q.xMax,q.yMax)}};return k};pv.Constraint.position=function(b){var c=1,d={};arguments.length||(b=function(f){return f.fix});d.alpha=function(f){if(arguments.length){c=Number(f);return d}return c};d.apply=function(f){for(f=f;f;f=f.next){var g=b(f);if(g){f.x+=(g.x-f.x)*c;f.y+=(g.y-f.y)*c;f.fx=f.fy=f.vx=f.vy=0}}};return d};
pv.Constraint.bound=function(){var b={},c,d;b.x=function(f,g){if(arguments.length){c={min:Math.min(f,g),max:Math.max(f,g)};return this}return c};b.y=function(f,g){if(arguments.length){d={min:Math.min(f,g),max:Math.max(f,g)};return this}return d};b.apply=function(f){if(c)for(var g=f;g;g=g.next)g.x=g.x<c.min?c.min:g.x>c.max?c.max:g.x;if(d)for(g=f;g;g=g.next)g.y=g.y<d.min?d.min:g.y>d.max?d.max:g.y};return b};pv.Layout=function(){pv.Panel.call(this)};pv.Layout.prototype=pv.extend(pv.Panel);
pv.Layout.prototype.property=pv.Mark.prototype.localProperty;
pv.Layout.Network=function(){pv.Layout.call(this);var b=this;this.$id=pv.id();(this.node=(new pv.Mark).data(function(){return b.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(c){return c.x}).top(function(c){return c.y})).parent=this;this.link=(new pv.Mark).extend(this.node).data(function(c){return[c.sourceNode,c.targetNode]}).fillStyle(null).lineWidth(function(c,d){return d.linkValue*1.5}).strokeStyle("rgba(0,0,0,.2)");this.link.add=function(c){return b.add(pv.Panel).data(function(){return b.links()}).add(c).extend(this)};
(this.label=(new pv.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(c){return c.nodeName||c.nodeValue}).textAngle(function(c){c=c.midAngle;return pv.Wedge.upright(c)?c:c+Math.PI}).textAlign(function(c){return pv.Wedge.upright(c.midAngle)?"left":"right"})).parent=this};
pv.Layout.Network.prototype=pv.extend(pv.Layout).property("nodes",function(b){return b.map(function(c,d){if(typeof c!="object")c={nodeValue:c};c.index=d;return c})}).property("links",function(b){return b.map(function(c){if(isNaN(c.linkValue))c.linkValue=isNaN(c.value)?1:c.value;return c})});pv.Layout.Network.prototype.reset=function(){this.$id=pv.id();return this};pv.Layout.Network.prototype.buildProperties=function(b,c){if((b.$id||0)<this.$id)pv.Layout.prototype.buildProperties.call(this,b,c)};
pv.Layout.Network.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);if(b.$id>=this.$id)return true;b.$id=this.$id;b.nodes.forEach(function(c){c.linkDegree=0});b.links.forEach(function(c){var d=c.linkValue;(c.sourceNode||(c.sourceNode=b.nodes[c.source])).linkDegree+=d;(c.targetNode||(c.targetNode=b.nodes[c.target])).linkDegree+=d})};pv.Layout.Hierarchy=function(){pv.Layout.Network.call(this);this.link.strokeStyle("#ccc")};pv.Layout.Hierarchy.prototype=pv.extend(pv.Layout.Network);
pv.Layout.Hierarchy.prototype.buildImplied=function(b){if(!b.links)b.links=pv.Layout.Hierarchy.links.call(this);pv.Layout.Network.prototype.buildImplied.call(this,b)};pv.Layout.Hierarchy.links=function(){return this.nodes().filter(function(b){return b.parentNode}).map(function(b){return{sourceNode:b,targetNode:b.parentNode,linkValue:1}})};
pv.Layout.Hierarchy.NodeLink={buildImplied:function(b){function c(n){return n.parentNode?n.depth*(m-q)+q:0}function d(n){return n.parentNode?(n.breadth-0.25)*2*Math.PI:0}function f(n){switch(i){case "left":return n.depth*k;case "right":return k-n.depth*k;case "top":return n.breadth*k;case "bottom":return k-n.breadth*k;case "radial":return k/2+c(n)*Math.cos(n.midAngle)}}function g(n){switch(i){case "left":return n.breadth*l;case "right":return l-n.breadth*l;case "top":return n.depth*l;case "bottom":return l-
n.depth*l;case "radial":return l/2+c(n)*Math.sin(n.midAngle)}}var h=b.nodes,i=b.orient,j=/^(top|bottom)$/.test(i),k=b.width,l=b.height;if(i=="radial"){var q=b.innerRadius,m=b.outerRadius;if(q==null)q=0;if(m==null)m=Math.min(k,l)/2}for(b=0;b<h.length;b++){var s=h[b];s.midAngle=i=="radial"?d(s):j?Math.PI/2:0;s.x=f(s);s.y=g(s);if(s.firstChild)s.midAngle+=Math.PI}}};
pv.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(b){return b.dx}).height(function(b){return b.dy}).innerRadius(function(b){return b.innerRadius}).outerRadius(function(b){return b.outerRadius}).startAngle(function(b){return b.startAngle}).angle(function(b){return b.angle});this.label.textAlign("center").left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2});delete this.link},buildImplied:function(b){function c(r,y){return(r+
y)/(1+y)}function d(r){switch(m){case "left":return c(r.minDepth,p)*n;case "right":return(1-c(r.maxDepth,p))*n;case "top":return r.minBreadth*n;case "bottom":return(1-r.maxBreadth)*n;case "radial":return n/2}}function f(r){switch(m){case "left":return r.minBreadth*o;case "right":return(1-r.maxBreadth)*o;case "top":return c(r.minDepth,p)*o;case "bottom":return(1-c(r.maxDepth,p))*o;case "radial":return o/2}}function g(r){switch(m){case "left":case "right":return(r.maxDepth-r.minDepth)/(1+p)*n;case "top":case "bottom":return(r.maxBreadth-
r.minBreadth)*n;case "radial":return r.parentNode?(r.innerRadius+r.outerRadius)*Math.cos(r.midAngle):0}}function h(r){switch(m){case "left":case "right":return(r.maxBreadth-r.minBreadth)*o;case "top":case "bottom":return(r.maxDepth-r.minDepth)/(1+p)*o;case "radial":return r.parentNode?(r.innerRadius+r.outerRadius)*Math.sin(r.midAngle):0}}function i(r){return Math.max(0,c(r.minDepth,p/2))*(u-t)+t}function j(r){return c(r.maxDepth,p/2)*(u-t)+t}function k(r){return(r.parentNode?r.minBreadth-0.25:0)*
2*Math.PI}function l(r){return(r.parentNode?r.maxBreadth-r.minBreadth:1)*2*Math.PI}var q=b.nodes,m=b.orient,s=/^(top|bottom)$/.test(m),n=b.width,o=b.height,p=-q[0].minDepth;if(m=="radial"){var t=b.innerRadius,u=b.outerRadius;if(t==null)t=0;if(t)p*=2;if(u==null)u=Math.min(n,o)/2}for(b=0;b<q.length;b++){var v=q[b];v.x=d(v);v.y=f(v);if(m=="radial"){v.innerRadius=i(v);v.outerRadius=j(v);v.startAngle=k(v);v.angle=l(v);v.midAngle=v.startAngle+v.angle/2}else v.midAngle=s?-Math.PI/2:0;v.dx=g(v);v.dy=h(v)}}};
pv.Layout.Grid=function(){pv.Layout.call(this);var b=this;(this.cell=(new pv.Mark).data(function(){return b.scene[b.index].$grid}).width(function(){return b.width()/b.cols()}).height(function(){return b.height()/b.rows()}).left(function(){return this.width()*(this.index%b.cols())}).top(function(){return this.height()*Math.floor(this.index/b.cols())})).parent=this};pv.Layout.Grid.prototype=pv.extend(pv.Layout).property("rows").property("cols");pv.Layout.Grid.prototype.defaults=(new pv.Layout.Grid).extend(pv.Layout.prototype.defaults).rows(1).cols(1);
pv.Layout.Grid.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=b.rows,d=b.cols;if(typeof d=="object")c=pv.transpose(d);if(typeof c=="object"){b.$grid=pv.blend(c);b.rows=c.length;b.cols=c[0]?c[0].length:0}else b.$grid=pv.repeat([b.data],c*d)};
pv.Layout.Stack=function(){function b(i){return function(){return f[i](this.parent.index,this.index)}}pv.Layout.call(this);var c=this,d=function(){return null},f={t:d,l:d,r:d,b:d,w:d,h:d},g,h=c.buildImplied;this.buildImplied=function(i){h.call(this,i);var j=i.layers,k=j.length,l,q=i.orient,m=/^(top|bottom)\b/.test(q),s=this.parent[m?"height":"width"](),n=[],o=[],p=[],t=pv.Mark.stack,u={parent:{parent:this}};t.unshift(null);g=[];for(var v=0;v<k;v++){p[v]=[];o[v]=[];u.parent.index=v;t[0]=j[v];g[v]=
this.$values.apply(u.parent,t);if(!v)l=g[v].length;t.unshift(null);for(var r=0;r<l;r++){t[0]=g[v][r];u.index=r;v||(n[r]=this.$x.apply(u,t));p[v][r]=this.$y.apply(u,t)}t.shift()}t.shift();switch(i.order){case "inside-out":var y=p.map(function(C){return pv.max.index(C)});u=pv.range(k).sort(function(C,A){return y[C]-y[A]});j=p.map(function(C){return pv.sum(C)});var x=t=0,z=[],w=[];for(v=0;v<k;v++){r=u[v];if(t<x){t+=j[r];z.push(r)}else{x+=j[r];w.push(r)}}j=w.reverse().concat(z);break;case "reverse":j=
pv.range(k-1,-1,-1);break;default:j=pv.range(k);break}switch(i.offset){case "silohouette":for(r=0;r<l;r++){for(v=u=0;v<k;v++)u+=p[v][r];o[j[0]][r]=(s-u)/2}break;case "wiggle":for(v=u=0;v<k;v++)u+=p[v][0];o[j[0]][0]=u=(s-u)/2;for(r=1;r<l;r++){t=s=0;x=n[r]-n[r-1];for(v=0;v<k;v++)s+=p[v][r];for(v=0;v<k;v++){z=(p[j[v]][r]-p[j[v]][r-1])/(2*x);for(i=0;i<v;i++)z+=(p[j[i]][r]-p[j[i]][r-1])/x;t+=z*p[j[v]][r]}o[j[0]][r]=u-=s?t/s*x:0}break;case "expand":for(r=0;r<l;r++){for(v=i=o[j[0]][r]=0;v<k;v++)i+=p[v][r];
if(i){i=s/i;for(v=0;v<k;v++)p[v][r]*=i}else{i=s/k;for(v=0;v<k;v++)p[v][r]=i}}break;default:for(r=0;r<l;r++)o[j[0]][r]=0;break}for(r=0;r<l;r++){u=o[j[0]][r];for(v=1;v<k;v++){u+=p[j[v-1]][r];o[j[v]][r]=u}}v=q.indexOf("-");k=m?"h":"w";m=v<0?m?"l":"b":q.charAt(v+1);q=q.charAt(0);for(var B in f)f[B]=d;f[m]=function(C,A){return n[A]};f[q]=function(C,A){return o[C][A]};f[k]=function(C,A){return p[C][A]}};this.layer=(new pv.Mark).data(function(){return g[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));
this.layer.add=function(i){return c.add(pv.Panel).data(function(){return c.layers()}).add(i).extend(this)}};pv.Layout.Stack.prototype=pv.extend(pv.Layout).property("orient",String).property("offset",String).property("order",String).property("layers");a=pv.Layout.Stack.prototype;a.defaults=(new pv.Layout.Stack).extend(pv.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]);a.$x=pv.Layout.Stack.prototype.$y=function(){return 0};a.x=function(b){this.$x=pv.functor(b);return this};
a.y=function(b){this.$y=pv.functor(b);return this};a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.Band=function(){function b(k){return function(){return f[k](this.index,this.parent.index)}}pv.Layout.call(this);var c=this,d=c.buildImplied,f,g,h=(new pv.Mark).data(function(){return g[this.parent.index]}).top(b("t")).left(b("l")).right(b("r")).bottom(b("b")).width(b("w")).height(b("h"));this.buildImplied=function(k){d.call(this,k);f=Object.create(pv.Layout.Band.$baseItemProps);g=[];var l=k.layers,q=l.length;if(q>0){var m=k.orient,s=/^(top|bottom)\b/.test(m),n=this.parent[s?"height":"width"]();
l=this._readData(l,g,k);var o=l.length;k.bandOrder==="reverse"&&l.reverse();if(k.order==="reverse"){g.reverse();for(var p=0;p<o;p++)l[p].items.reverse()}switch(k.layout){case "grouped":this._calcGrouped(l,q,k);break;case "stacked":this._calcStacked(l,q,n,k);break}this._bindItemProps(l,f,m,s)}};var i=this.item={end:this,add:function(k){return c.add(pv.Panel).data(function(){return c.layers()}).add(k).extend(h)},order:function(k){c.order(k);return this},w:function(k){c.$iw=pv.functor(k);return this},
h:function(k){c.$ih=pv.functor(k);return this},horizontalRatio:function(k){c.$ihorizRatio=pv.functor(k);return this},verticalMargin:function(k){c.$ivertiMargin=pv.functor(k);return this}},j=this.band={end:this,w:function(k){c.$bw=pv.functor(k);return this},x:function(k){c.$bx=pv.functor(k);return this},order:function(k){c.bandOrder(k);return this},differentialControl:function(k){c.$bDiffControl=pv.functor(k);return this}};this.band.item=i;this.item.band=j};
pv.Layout.Band.$baseItemProps=function(){var b=function(){return null};return{t:b,l:b,r:b,b:b,w:b,h:b}}();pv.Layout.Band.prototype=pv.extend(pv.Layout).property("orient",String).property("layout",String).property("layers").property("yZero",Number).property("verticalMode",String).property("horizontalMode",String).property("order",String).property("bandOrder",String);a=pv.Layout.Band.prototype;a.defaults=(new pv.Layout.Band).extend(pv.Layout.prototype.defaults).orient("bottom-left").layout("grouped").yZero(0).layers([[]]);
a.$bx=pv.Layout.Band.prototype.$bw=pv.Layout.Band.prototype.$bDiffControl=pv.Layout.Band.prototype.$iw=pv.Layout.Band.prototype.$ih=pv.Layout.Band.prototype.$ivertiMargin=pv.functor(0);a.$ihorizRatio=pv.functor(0.9);a.$values=pv.identity;a.values=function(b){this.$values=pv.functor(b);return this};
pv.Layout.prototype._readData=function(b,c,d){var f=b.length,g=[],h,i=pv.Mark.stack,j={parent:{parent:this}};i.unshift(null);for(var k=0;k<f;k++){j.parent.index=k;i[0]=b[k];var l=c[k]=this.$values.apply(j.parent,i);if(!k)h=l.length;i.unshift(null);for(var q=0;q<h;q++){i[0]=l[q];j.index=q;var m=g[q];m||(m=g[q]={horizRatio:this.$ihorizRatio.apply(j,i),vertiMargin:this.$ivertiMargin.apply(j,i),w:this.$bw.apply(j,i),x:this.$bx.apply(j,i),diffControl:this.$bDiffControl?this.$bDiffControl.apply(j,i):0,
items:[]});var s=this.$ih.apply(j,i);m.items[k]={y:d.yZero||0,x:0,w:this.$iw.apply(j,i),h:s!=null?Math.abs(s):s,dir:s<0?-1:1}}i.shift()}i.shift();return g};
pv.Layout.Band.prototype._calcGrouped=function(b,c,d){for(var f=0,g=b.length;f<g;f++){for(var h=b[f],i=h.items,j=h.w,k=h.horizRatio,l=0,q=0;q<c;q++)l+=i[q].w;if(c===1)k=1;else k>0&&k<=1||(k=1);if(j==null)h.w=l/k;else if(d.horizontalMode==="expand"){j=k*j;if(l){l=j/l;for(q=0;q<c;q++)i[q].w*=l}else{l=j/c;for(q=0;q<c;q++)i[q].w=l}l=j}q=l/k;h=h.x-q/2;k=c>1?(q-l)/(c-1):0;for(q=0;q<c;q++){l=i[q];l.x=h;h+=l.w+k;if(l.dir<0)l.y-=l.h}}};
pv.Layout.Band.prototype._calcStacked=function(b,c,d,f){var g=b.length,h;if(f.verticalMode==="expand")for(var i=0;i<g;i++){h=b[i].items;for(var j=null,k=0,l=0;l<c;l++){var q=h[l];q.dir=1;q=q.h;if(q!=null){k++;j+=q}}if(k)if(j){j=d/j;for(l=0;l<c;l++){q=h[l].h;if(q!=null)h[l].h=q*j}}else{j=d/k;for(l=0;l<c;l++){q=h[l].h;if(q!=null)h[l].h=j}}}d=c=f.yZero;for(i=0;i<g;i++){h=b[i];f=h.x;l=h.diffControl;q=l<0;j=h.vertiMargin>0?h.vertiMargin:0;h=h.items;k=this._layoutItemsOfDir(+1,q,h,j,f,d);var m;if(k.existsOtherDir)m=
this._layoutItemsOfDir(-1,q,h,j,f,d);if(l){if(Math.abs(l)===1){h=d;d=k.yOffset;if(m)d-=h-m.yOffset}}else d=c}};pv.Layout.Band.prototype._layoutItemsOfDir=function(b,c,d,f,g,h){for(var i=false,j=f/2,k=c?-b:b,l=0,q=d.length;l<q;l+=1){var m=d[c?q-l-1:l];if(m.dir===b){var s=m.h||0;if(k>0){m.y=h+j;h+=s}else{m.y=h-(s-j);h-=s}s=m.h-f;m.h=s>0?s:0;m.x=g-m.w/2}else i=true}return{existsOtherDir:i,yOffset:h}};
pv.Layout.Band.prototype._bindItemProps=function(b,c,d,f){var g=d.indexOf("-"),h=f?"h":"w",i=f?"w":"h";f=g<0?f?"l":"b":d.charAt(g+1);d=d.charAt(0);c[f]=function(j,k){return b[j].items[k].x};c[d]=function(j,k){return b[j].items[k].y};c[i]=function(j,k){return b[j].items[k].w};c[h]=function(j,k){return b[j].items[k].h||0}};
pv.Layout.Treemap=function(){pv.Layout.Hierarchy.call(this);this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(b){return b.dx}).height(function(b){return b.dy});this.label.visible(function(b){return!b.firstChild}).left(function(b){return b.x+b.dx/2}).top(function(b){return b.y+b.dy/2}).textAlign("center").textAngle(function(b){return b.dx>b.dy?0:-Math.PI/2});(this.leaf=(new pv.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(b){return!b.firstChild})).parent=
this;delete this.link};pv.Layout.Treemap.prototype=pv.extend(pv.Layout.Hierarchy).property("round",Boolean).property("paddingLeft",Number).property("paddingRight",Number).property("paddingTop",Number).property("paddingBottom",Number).property("mode",String).property("order",String);a=pv.Layout.Treemap.prototype;a.defaults=(new pv.Layout.Treemap).extend(pv.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending");a.padding=function(b){return this.paddingLeft(b).paddingRight(b).paddingTop(b).paddingBottom(b)};
a.$size=function(b){return Number(b.nodeValue)};a.size=function(b){this.$size=pv.functor(b);return this};
a.buildImplied=function(b){function c(o,p,t,u,v,r,y){for(var x=0,z=0;x<o.length;x++){var w=o[x];if(t){w.x=u+z;w.y=v;z+=w.dx=s(r*w.size/p);w.dy=y}else{w.x=u;w.y=v+z;w.dx=r;z+=w.dy=s(y*w.size/p)}}if(w)if(t)w.dx+=r-z;else w.dy+=y-z}function d(o,p){for(var t=-Infinity,u=Infinity,v=0,r=0;r<o.length;r++){var y=o[r].size;if(y<u)u=y;if(y>t)t=y;v+=y}v*=v;p*=p;return Math.max(p*t/v,v/(p*u))}function f(o,p){function t(C){var A=r==z,E=pv.sum(C,m),F=z?s(E/z):0;c(C,E,A,u,v,A?r:F,A?F:y);if(A){v+=F;y-=F}else{u+=
F;r-=F}z=Math.min(r,y);return A}var u=o.x+j,v=o.y+l,r=o.dx-j-k,y=o.dy-l-q;if(n!="squarify")c(o.childNodes,o.size,n=="slice"?true:n=="dice"?false:p&1,u,v,r,y);else{var x=[];p=Infinity;var z=Math.min(r,y),w=r*y/o.size;if(!(o.size<=0)){o.visitBefore(function(C){C.size*=w});for(o=o.childNodes.slice();o.length;){var B=o[o.length-1];if(B.size){x.push(B);w=d(x,z);if(w<=p){o.pop();p=w}else{x.pop();t(x);x.length=0;p=Infinity}}else o.pop()}if(t(x))for(p=0;p<x.length;p++)x[p].dy+=y;else for(p=0;p<x.length;p++)x[p].dx+=
r}}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var g=this,h=b.nodes[0],i=pv.Mark.stack,j=b.paddingLeft,k=b.paddingRight,l=b.paddingTop,q=b.paddingBottom,m=function(o){return o.size},s=b.round?Math.round:Number,n=b.mode;i.unshift(null);h.visitAfter(function(o,p){o.depth=p;o.x=o.y=o.dx=o.dy=0;o.size=o.firstChild?pv.sum(o.childNodes,function(t){return t.size}):g.$size.apply(g,(i[0]=o,i))});i.shift();switch(b.order){case "ascending":h.sort(function(o,p){return o.size-p.size});break;
case "descending":h.sort(function(o,p){return p.size-o.size});break;case "reverse":h.reverse();break}h.x=0;h.y=0;h.dx=b.width;h.dy=b.height;h.visitBefore(f)}};pv.Layout.Tree=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Tree.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String);pv.Layout.Tree.prototype.defaults=(new pv.Layout.Tree).extend(pv.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top");
pv.Layout.Tree.prototype.buildImplied=function(b){function c(r){var y,x,z;if(r.firstChild){y=r.firstChild;x=r.lastChild;for(var w=z=y;w;w=w.nextSibling){c(w);z=f(w,z)}j(r);x=0.5*(y.prelim+x.prelim);if(y=r.previousSibling){r.prelim=y.prelim+l(r.depth,true);r.mod=r.prelim-x}else r.prelim=x}else if(y=r.previousSibling)r.prelim=y.prelim+l(r.depth,true)}function d(r,y,x){r.breadth=r.prelim+y;y+=r.mod;for(r=r.firstChild;r;r=r.nextSibling)d(r,y,x)}function f(r,y){var x=r.previousSibling;if(x){var z=r,w=
r,B=x;x=r.parentNode.firstChild;var C=z.mod,A=w.mod,E=B.mod,F=x.mod;B=h(B);for(z=g(z);B&&z;){B=B;z=z;x=g(x);w=h(w);w.ancestor=r;var D=B.prelim+E-(z.prelim+C)+l(B.depth,false);if(D>0){i(k(B,r,y),r,D);C+=D;A+=D}E+=B.mod;C+=z.mod;F+=x.mod;A+=w.mod;B=h(B);z=g(z)}if(B&&!h(w)){w.thread=B;w.mod+=E-A}if(z&&!g(x)){x.thread=z;x.mod+=C-F;y=r}}return y}function g(r){return r.firstChild||r.thread}function h(r){return r.lastChild||r.thread}function i(r,y,x){var z=y.number-r.number;y.change-=x/z;y.shift+=x;r.change+=
x/z;y.prelim+=x;y.mod+=x}function j(r){var y=0,x=0;for(r=r.lastChild;r;r=r.previousSibling){r.prelim+=y;r.mod+=y;x+=r.change;y+=r.shift+x}}function k(r,y,x){return r.ancestor.parentNode==y.parentNode?r.ancestor:x}function l(r,y){return(y?1:t+1)/(n=="radial"?r:1)}function q(r){return n=="radial"?r.breadth/o:0}function m(r){switch(n){case "left":return r.depth;case "right":return u-r.depth;case "top":case "bottom":return r.breadth+u/2;case "radial":return u/2+r.depth*Math.cos(q(r))}}function s(r){switch(n){case "left":case "right":return r.breadth+
v/2;case "top":return r.depth;case "bottom":return v-r.depth;case "radial":return v/2+r.depth*Math.sin(q(r))}}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var n=b.orient,o=b.depth,p=b.breadth,t=b.group,u=b.width,v=b.height;b=b.nodes[0];b.visitAfter(function(r,y){r.ancestor=r;r.prelim=0;r.mod=0;r.change=0;r.shift=0;r.number=r.previousSibling?r.previousSibling.number+1:0;r.depth=y});c(b);d(b,-b.prelim,0);b.visitAfter(function(r){r.breadth*=p;r.depth*=o;r.midAngle=q(r);r.x=m(r);r.y=s(r);
if(r.firstChild)r.midAngle+=Math.PI;delete r.breadth;delete r.depth;delete r.ancestor;delete r.prelim;delete r.mod;delete r.change;delete r.shift;delete r.number;delete r.thread})}};pv.Layout.Indent=function(){pv.Layout.Hierarchy.call(this);this.link.interpolate("step-after")};pv.Layout.Indent.prototype=pv.extend(pv.Layout.Hierarchy).property("depth",Number).property("breadth",Number);pv.Layout.Indent.prototype.defaults=(new pv.Layout.Indent).extend(pv.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15);
pv.Layout.Indent.prototype.buildImplied=function(b){function c(i,j,k){i.x=g+k++*f;i.y=h+j++*d;i.midAngle=0;for(i=i.firstChild;i;i=i.nextSibling)j=c(i,j,k);return j}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var d=b.breadth,f=b.depth,g=0,h=0;c(b.nodes[0],1,1)}};pv.Layout.Pack=function(){pv.Layout.Hierarchy.call(this);this.node.shapeRadius(function(b){return b.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)");this.label.textAlign("center");delete this.link};
pv.Layout.Pack.prototype=pv.extend(pv.Layout.Hierarchy).property("spacing",Number).property("order",String);pv.Layout.Pack.prototype.defaults=(new pv.Layout.Pack).extend(pv.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending");pv.Layout.Pack.prototype.$radius=function(){return 1};pv.Layout.Pack.prototype.size=function(b){this.$radius=typeof b=="function"?function(){return Math.sqrt(b.apply(this,arguments))}:(b=Math.sqrt(b),function(){return b});return this};
pv.Layout.Pack.prototype.buildImplied=function(b){function c(m){var s=pv.Mark.stack;s.unshift(null);for(var n=0,o=m.length;n<o;n++){var p=m[n];if(!p.firstChild)p.radius=i.$radius.apply(i,(s[0]=p,s))}s.shift()}function d(m){var s=[];for(m=m.firstChild;m;m=m.nextSibling){if(m.firstChild)m.radius=d(m);m.n=m.p=m;s.push(m)}switch(b.order){case "ascending":s.sort(function(n,o){return n.radius-o.radius});break;case "descending":s.sort(function(n,o){return o.radius-n.radius});break;case "reverse":s.reverse();
break}return f(s)}function f(m){function s(D){t=Math.min(D.x-D.radius,t);u=Math.max(D.x+D.radius,u);v=Math.min(D.y-D.radius,v);r=Math.max(D.y+D.radius,r)}function n(D,G){var H=D.n;D.n=G;G.p=D;G.n=H;H.p=G}function o(D,G){D.n=G;G.p=D}function p(D,G){var H=G.x-D.x,I=G.y-D.y;D=D.radius+G.radius;return D*D-H*H-I*I>0.001}var t=Infinity,u=-Infinity,v=Infinity,r=-Infinity,y,x,z,w,B;y=m[0];y.x=-y.radius;y.y=0;s(y);if(m.length>1){x=m[1];x.x=x.radius;x.y=0;s(x);if(m.length>2){z=m[2];g(y,x,z);s(z);n(y,z);y.p=
z;n(z,x);x=y.n;for(var C=3;C<m.length;C++){g(y,x,z=m[C]);var A=0,E=1,F=1;for(w=x.n;w!=x;w=w.n,E++)if(p(w,z)){A=1;break}if(A==1)for(B=y.p;B!=w.p;B=B.p,F++)if(p(B,z)){if(F<E){A=-1;w=B}break}if(A==0){n(y,z);x=z;s(z)}else if(A>0){o(y,w);x=w;C--}else if(A<0){o(w,x);y=w;C--}}}}y=(t+u)/2;x=(v+r)/2;for(C=z=0;C<m.length;C++){w=m[C];w.x-=y;w.y-=x;z=Math.max(z,w.radius+Math.sqrt(w.x*w.x+w.y*w.y))}return z+b.spacing}function g(m,s,n){var o=s.radius+n.radius,p=m.radius+n.radius,t=s.x-m.x;s=s.y-m.y;var u=Math.sqrt(t*
t+s*s),v=(p*p+u*u-o*o)/(2*p*u);o=Math.acos(v);v=v*p;p=Math.sin(o)*p;t/=u;s/=u;n.x=m.x+v*t+p*s;n.y=m.y+v*s-p*t}function h(m,s,n,o){for(var p=m.firstChild;p;p=p.nextSibling){p.x+=m.x;p.y+=m.y;h(p,s,n,o)}m.x=s+o*m.x;m.y=n+o*m.y;m.radius*=o}if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var i=this,j=b.nodes,k=j[0];c(j);k.x=0;k.y=0;k.radius=d(k);j=this.width();var l=this.height(),q=1/Math.max(2*k.radius/j,2*k.radius/l);h(k,j/2,l/2,q)}};
pv.Layout.Force=function(){pv.Layout.Network.call(this);this.link.lineWidth(function(b,c){return Math.sqrt(c.linkValue)*1.5});this.label.textAlign("center")};
pv.Layout.Force.prototype=pv.extend(pv.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number);pv.Layout.Force.prototype.defaults=(new pv.Layout.Force).extend(pv.Layout.Network.prototype.defaults).dragConstant(0.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(0.9).springConstant(0.1).springDamping(0.3).springLength(20);
pv.Layout.Force.prototype.buildImplied=function(b){function c(q){return q.fix?1:q.vx*q.vx+q.vy*q.vy}if(pv.Layout.Network.prototype.buildImplied.call(this,b)){if(b=b.$force){b.next=this.binds.$force;this.binds.$force=b}}else{for(var d=this,f=b.nodes,g=b.links,h=b.iterations,i=b.width,j=b.height,k=0,l;k<f.length;k++){l=f[k];if(isNaN(l.x))l.x=i/2+40*Math.random()-20;if(isNaN(l.y))l.y=j/2+40*Math.random()-20}l=pv.simulation(f);l.force(pv.Force.drag(b.dragConstant));l.force(pv.Force.charge(b.chargeConstant).domain(b.chargeMinDistance,
b.chargeMaxDistance).theta(b.chargeTheta));l.force(pv.Force.spring(b.springConstant).damping(b.springDamping).length(b.springLength).links(g));l.constraint(pv.Constraint.position());b.bound&&l.constraint(pv.Constraint.bound().x(6,i-6).y(6,j-6));if(h==null){l.step();l.step();b.$force=this.binds.$force={next:this.binds.$force,nodes:f,min:1.0E-4*(g.length+1),sim:l};if(!this.$timer)this.$timer=setInterval(function(){for(var q=false,m=d.binds.$force;m;m=m.next)if(pv.max(m.nodes,c)>m.min){m.sim.step();
q=true}q&&d.render()},42)}else for(k=0;k<h;k++)l.step()}};pv.Layout.Cluster=function(){pv.Layout.Hierarchy.call(this);var b,c=this.buildImplied;this.buildImplied=function(d){c.call(this,d);b=/^(top|bottom)$/.test(d.orient)?"step-before":/^(left|right)$/.test(d.orient)?"step-after":"linear"};this.link.interpolate(function(){return b})};
pv.Layout.Cluster.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);pv.Layout.Cluster.prototype.defaults=(new pv.Layout.Cluster).extend(pv.Layout.Hierarchy.prototype.defaults).group(0).orient("top");
pv.Layout.Cluster.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=b.nodes[0],d=b.group,f,g,h=0,i=0.5-d/2,j=undefined;c.visitAfter(function(k){if(k.firstChild)k.depth=1+pv.max(k.childNodes,function(l){return l.depth});else{if(d&&j!=k.parentNode){j=k.parentNode;h+=d}h++;k.depth=0}});f=1/h;g=1/c.depth;j=undefined;c.visitAfter(function(k){if(k.firstChild)k.breadth=pv.mean(k.childNodes,function(l){return l.breadth});else{if(d&&j!=k.parentNode){j=k.parentNode;
i+=d}k.breadth=f*i++}k.depth=1-k.depth*g});c.visitAfter(function(k){k.minBreadth=k.firstChild?k.firstChild.minBreadth:k.breadth-f/2;k.maxBreadth=k.firstChild?k.lastChild.maxBreadth:k.breadth+f/2});c.visitBefore(function(k){k.minDepth=k.parentNode?k.parentNode.maxDepth:0;k.maxDepth=k.parentNode?k.depth+c.depth:k.minDepth+2*c.depth});c.minDepth=-g;pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Cluster.Fill=function(){pv.Layout.Cluster.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};
pv.Layout.Cluster.Fill.prototype=pv.extend(pv.Layout.Cluster);pv.Layout.Cluster.Fill.prototype.buildImplied=function(b){pv.Layout.Cluster.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Partition=function(){pv.Layout.Hierarchy.call(this)};pv.Layout.Partition.prototype=pv.extend(pv.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number);
pv.Layout.Partition.prototype.defaults=(new pv.Layout.Partition).extend(pv.Layout.Hierarchy.prototype.defaults).orient("top");pv.Layout.Partition.prototype.$size=function(){return 1};pv.Layout.Partition.prototype.size=function(b){this.$size=b;return this};
pv.Layout.Partition.prototype.buildImplied=function(b){if(!pv.Layout.Hierarchy.prototype.buildImplied.call(this,b)){var c=this,d=b.nodes[0],f=pv.Mark.stack,g=0;f.unshift(null);d.visitAfter(function(i,j){if(j>g)g=j;i.size=i.firstChild?pv.sum(i.childNodes,function(k){return k.size}):c.$size.apply(c,(f[0]=i,f))});f.shift();switch(b.order){case "ascending":d.sort(function(i,j){return i.size-j.size});break;case "descending":d.sort(function(i,j){return j.size-i.size});break}var h=1/g;d.minBreadth=0;d.breadth=
0.5;d.maxBreadth=1;d.visitBefore(function(i){for(var j=i.minBreadth,k=i.maxBreadth-j,l=i.firstChild;l;l=l.nextSibling){l.minBreadth=j;l.maxBreadth=j+=l.size/i.size*k;l.breadth=(j+l.minBreadth)/2}});d.visitAfter(function(i,j){i.minDepth=(j-1)*h;i.maxDepth=i.depth=j*h});pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,b)}};pv.Layout.Partition.Fill=function(){pv.Layout.Partition.call(this);pv.Layout.Hierarchy.Fill.constructor.call(this)};pv.Layout.Partition.Fill.prototype=pv.extend(pv.Layout.Partition);
pv.Layout.Partition.Fill.prototype.buildImplied=function(b){pv.Layout.Partition.prototype.buildImplied.call(this,b)||pv.Layout.Hierarchy.Fill.buildImplied.call(this,b)};pv.Layout.Arc=function(){pv.Layout.Network.call(this);var b,c,d,f=this.buildImplied;this.buildImplied=function(g){f.call(this,g);c=g.directed;b=g.orient=="radial"?"linear":"polar";d=g.orient=="right"||g.orient=="top"};this.link.data(function(g){var h=g.sourceNode;g=g.targetNode;return d!=(c||h.breadth<g.breadth)?[h,g]:[g,h]}).interpolate(function(){return b})};
pv.Layout.Arc.prototype=pv.extend(pv.Layout.Network).property("orient",String).property("directed",Boolean);pv.Layout.Arc.prototype.defaults=(new pv.Layout.Arc).extend(pv.Layout.Network.prototype.defaults).orient("bottom");pv.Layout.Arc.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Arc.prototype.buildImplied=function(b){function c(n){switch(h){case "top":return-Math.PI/2;case "bottom":return Math.PI/2;case "left":return Math.PI;case "right":return 0;case "radial":return(n-0.25)*2*Math.PI}}function d(n){switch(h){case "top":case "bottom":return n*k;case "left":return 0;case "right":return k;case "radial":return k/2+q*Math.cos(c(n))}}function f(n){switch(h){case "top":return 0;case "bottom":return l;case "left":case "right":return n*l;case "radial":return l/2+q*Math.sin(c(n))}}
if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var g=b.nodes,h=b.orient,i=this.$sort,j=pv.range(g.length),k=b.width,l=b.height,q=Math.min(k,l)/2;i&&j.sort(function(n,o){return i(g[n],g[o])});for(b=0;b<g.length;b++){var m=g[j[b]],s=m.breadth=(b+0.5)/g.length;m.x=d(s);m.y=f(s);m.midAngle=c(s)}}};
pv.Layout.Horizon=function(){pv.Layout.call(this);var b=this,c,d,f,g,h,i,j=this.buildImplied;this.buildImplied=function(k){j.call(this,k);c=k.bands;d=k.mode;f=Math.round((d=="color"?0.5:1)*k.height);g=k.backgroundStyle;h=pv.ramp(g,k.negativeStyle).domain(0,c);i=pv.ramp(g,k.positiveStyle).domain(0,c)};c=(new pv.Panel).data(function(){return pv.range(c*2)}).overflow("hidden").height(function(){return f}).top(function(k){return d=="color"?(k&1)*f:0}).fillStyle(function(k){return k?null:g});this.band=
(new pv.Mark).top(function(k,l){return d=="mirror"&&l&1?(l+1>>1)*f:null}).bottom(function(k,l){return d=="mirror"?l&1?null:(l+1>>1)*-f:(l&1||-1)*(l+1>>1)*f}).fillStyle(function(k,l){return(l&1?h:i)((l>>1)+1)});this.band.add=function(k){return b.add(pv.Panel).extend(c).add(k).extend(this)}};pv.Layout.Horizon.prototype=pv.extend(pv.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",pv.color).property("positiveStyle",pv.color).property("negativeStyle",pv.color);
pv.Layout.Horizon.prototype.defaults=(new pv.Layout.Horizon).extend(pv.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728");
pv.Layout.Rollup=function(){pv.Layout.Network.call(this);var b=this,c,d,f=b.buildImplied;this.buildImplied=function(g){f.call(this,g);c=g.$rollup.nodes;d=g.$rollup.links};this.node.data(function(){return c}).shapeSize(function(g){return g.nodes.length*20});this.link.interpolate("polar").eccentricity(0.8);this.link.add=function(g){return b.add(pv.Panel).data(function(){return d}).add(g).extend(this)}};pv.Layout.Rollup.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);
pv.Layout.Rollup.prototype.x=function(b){this.$x=pv.functor(b);return this};pv.Layout.Rollup.prototype.y=function(b){this.$y=pv.functor(b);return this};
pv.Layout.Rollup.prototype.buildImplied=function(b){function c(o){return i[o]+","+j[o]}if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var d=b.nodes,f=b.links,g=b.directed,h=d.length,i=[],j=[],k=0,l={},q={},m=pv.Mark.stack,s={parent:this};m.unshift(null);for(var n=0;n<h;n++){s.index=n;m[0]=d[n];i[n]=this.$x.apply(s,m);j[n]=this.$y.apply(s,m)}m.shift();for(n=0;n<d.length;n++){h=c(n);m=l[h];if(!m){m=l[h]=pv.extend(d[n]);m.index=k++;m.x=i[n];m.y=j[n];m.nodes=[]}m.nodes.push(d[n])}for(n=0;n<
f.length;n++){k=f[n].targetNode;d=l[c(f[n].sourceNode.index)];k=l[c(k.index)];h=!g&&d.index>k.index?k.index+","+d.index:d.index+","+k.index;(m=q[h])||(m=q[h]={sourceNode:d,targetNode:k,linkValue:0,links:[]});m.links.push(f[n]);m.linkValue+=f[n].linkValue}b.$rollup={nodes:pv.values(l),links:pv.values(q)}}};
pv.Layout.Matrix=function(){pv.Layout.Network.call(this);var b,c,d,f,g,h=this.buildImplied;this.buildImplied=function(i){h.call(this,i);b=i.nodes.length;c=i.width/b;d=i.height/b;f=i.$matrix.labels;g=i.$matrix.pairs};this.link.data(function(){return g}).left(function(){return c*(this.index%b)}).top(function(){return d*Math.floor(this.index/b)}).width(function(){return c}).height(function(){return d}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(i){return i.linkValue?"#555":"#eee"}).parent=
this;delete this.link.add;this.label.data(function(){return f}).left(function(){return this.index&1?c*((this.index>>1)+0.5):0}).top(function(){return this.index&1?0:d*((this.index>>1)+0.5)}).textMargin(4).textAlign(function(){return this.index&1?"left":"right"}).textAngle(function(){return this.index&1?-Math.PI/2:0});delete this.node};pv.Layout.Matrix.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean);pv.Layout.Matrix.prototype.sort=function(b){this.$sort=b;return this};
pv.Layout.Matrix.prototype.buildImplied=function(b){if(!pv.Layout.Network.prototype.buildImplied.call(this,b)){var c=b.nodes,d=b.links,f=this.$sort,g=c.length,h=pv.range(g),i=[],j=[],k={};b.$matrix={labels:i,pairs:j};f&&h.sort(function(n,o){return f(c[n],c[o])});for(var l=0;l<g;l++)for(var q=0;q<g;q++){var m=h[l],s=h[q];j.push(k[m+"."+s]={row:l,col:q,sourceNode:c[m],targetNode:c[s],linkValue:0})}for(l=0;l<g;l++){m=h[l];i.push(c[m],c[m])}for(l=0;l<d.length;l++){i=d[l];g=i.sourceNode.index;h=i.targetNode.index;
i=i.linkValue;k[g+"."+h].linkValue+=i;b.directed||(k[h+"."+g].linkValue+=i)}}};
pv.Layout.Bullet=function(){pv.Layout.call(this);var b=this,c=b.buildImplied,d=b.x=pv.Scale.linear(),f,g,h,i,j;this.buildImplied=function(k){c.call(this,j=k);f=k.orient;g=/^left|right$/.test(f);h=pv.ramp("#bbb","#eee").domain(0,Math.max(1,j.ranges.length-1));i=pv.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,j.measures.length-1))};(this.range=new pv.Mark).data(function(){return j.ranges}).reverse(true).left(function(){return f=="left"?0:null}).top(function(){return f=="top"?0:null}).right(function(){return f==
"right"?0:null}).bottom(function(){return f=="bottom"?0:null}).width(function(k){return g?d(k):null}).height(function(k){return g?null:d(k)}).fillStyle(function(){return h(this.index)}).antialias(false).parent=b;(this.measure=new pv.Mark).extend(this.range).data(function(){return j.measures}).left(function(){return f=="left"?0:g?null:this.parent.width()/3.25}).top(function(){return f=="top"?0:g?this.parent.height()/3.25:null}).right(function(){return f=="right"?0:g?null:this.parent.width()/3.25}).bottom(function(){return f==
"bottom"?0:g?this.parent.height()/3.25:null}).fillStyle(function(){return i(this.index)}).parent=b;(this.marker=new pv.Mark).data(function(){return j.markers}).left(function(k){return f=="left"?d(k):g?null:this.parent.width()/2}).top(function(k){return f=="top"?d(k):g?this.parent.height()/2:null}).right(function(k){return f=="right"?d(k):null}).bottom(function(k){return f=="bottom"?d(k):null}).strokeStyle("black").shape("bar").shapeAngle(function(){return g?0:Math.PI/2}).parent=b;(this.tick=new pv.Mark).data(function(){return d.ticks(7)}).left(function(k){return f==
"left"?d(k):null}).top(function(k){return f=="top"?d(k):null}).right(function(k){return f=="right"?d(k):g?null:-6}).bottom(function(k){return f=="bottom"?d(k):g?-8:null}).height(function(){return g?6:null}).width(function(){return g?null:6}).parent=b};pv.Layout.Bullet.prototype=pv.extend(pv.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("maximum",Number);pv.Layout.Bullet.prototype.defaults=(new pv.Layout.Bullet).extend(pv.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]);
pv.Layout.Bullet.prototype.buildImplied=function(b){pv.Layout.prototype.buildImplied.call(this,b);var c=this.parent[/^left|right$/.test(b.orient)?"width":"height"]();b.maximum=b.maximum||pv.max([].concat(b.ranges,b.markers,b.measures));this.x.domain(0,b.maximum).range(0,c)};pv.Behavior={};
pv.Behavior.drag=function(){function b(k,l){g=this.index;f=this.scene;var q=this.mouse();i=((h=k).fix=pv.vector(k.x,k.y)).minus(q);j={x:this.parent.width()-(k.dx||0),y:this.parent.height()-(k.dy||0)};f.mark.context(f,g,function(){this.render()});pv.Mark.dispatch("dragstart",f,g,l)}function c(k){if(f){f.mark.context(f,g,function(){var l=this.mouse();h.x=h.fix.x=Math.max(0,Math.min(i.x+l.x,j.x));h.y=h.fix.y=Math.max(0,Math.min(i.y+l.y,j.y));this.render()});pv.Mark.dispatch("drag",f,g,k)}}function d(k){if(f){h.fix=
null;f.mark.context(f,g,function(){this.render()});pv.Mark.dispatch("dragend",f,g,k);f=null}}var f,g,h,i,j;pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",d);return b};
pv.Behavior.point=function(b){function c(q,m){q=q[m];m={cost:Infinity};for(var s=(q.visible?q.children.length:0)-1;s>=0;s--){var n=q.children[s],o=n.mark,p;if(o.type=="panel"){o.scene=n;for(var t=n.length-1;t>=0;t--){o.index=t;p=c(n,t);if(p.cost<m.cost)m=p}delete o.scene;delete o.index}else if(o.$handlers.point){o=o.mouse();for(t=n.length-1;t>=0;t--){var u=n[t];p=o.x-u.left-(u.width||0)/2;u=o.y-u.top-(u.height||0)/2;var v=i*p*p+j*u*u;if(v<m.cost){m.distance=p*p+u*u;m.cost=v;m.scene=n;m.index=t}}}}return m}
function d(q){var m=c(this.scene,this.index);if(m.cost==Infinity||m.distance>l)m=null;if(g){if(m&&g.scene==m.scene&&g.index==m.index)return;pv.Mark.dispatch("unpoint",g.scene,g.index,q)}if(g=m){pv.Mark.dispatch("point",m.scene,m.index,q);if(!k&&this.type==="panel"){k=this;k.event("mouseout",function(){f.call(k.scene.$g,arguments[arguments.length-1])})}else pv.listen(this.root.canvas(),"mouseout",f)}}function f(q){if(g&&!pv.ancestor(this,q.relatedTarget)){pv.Mark.dispatch("unpoint",g.scene,g.index,
q);g=null}}var g,h=null,i=1,j=1,k=null,l=arguments.length?b*b:900;d.collapse=function(q){if(arguments.length){h=String(q);switch(h){case "y":i=1;j=0;break;case "x":i=0;j=1;break;default:j=i=1;break}return d}return h};return d};
pv.Behavior.select=function(){function b(j,k){g=this.index;f=this.scene;i=this.mouse();h=j;h.x=i.x;h.y=i.y;h.dx=h.dy=0;pv.Mark.dispatch("selectstart",f,g,k)}function c(j){if(f){f.mark.context(f,g,function(){var k=this.mouse();h.x=Math.max(0,Math.min(i.x,k.x));h.y=Math.max(0,Math.min(i.y,k.y));h.dx=Math.min(this.width(),Math.max(k.x,i.x))-h.x;h.dy=Math.min(this.height(),Math.max(k.y,i.y))-h.y;this.render()});pv.Mark.dispatch("select",f,g,j)}}function d(j){if(f){pv.Mark.dispatch("selectend",f,g,j);
f=null}}var f,g,h,i;pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",d);return b};
pv.Behavior.resize=function(b){function c(k,l){h=this.index;g=this.scene;j=this.mouse();i=k;switch(b){case "left":j.x=i.x+i.dx;break;case "right":j.x=i.x;break;case "top":j.y=i.y+i.dy;break;case "bottom":j.y=i.y;break}pv.Mark.dispatch("resizestart",g,h,l)}function d(k){if(g){g.mark.context(g,h,function(){var l=this.mouse();i.x=Math.max(0,Math.min(j.x,l.x));i.y=Math.max(0,Math.min(j.y,l.y));i.dx=Math.min(this.parent.width(),Math.max(l.x,j.x))-i.x;i.dy=Math.min(this.parent.height(),Math.max(l.y,j.y))-
i.y;this.render()});pv.Mark.dispatch("resize",g,h,k)}}function f(k){if(g){pv.Mark.dispatch("resizeend",g,h,k);g=null}}var g,h,i,j;pv.listen(window,"mousemove",d);pv.listen(window,"mouseup",f);return c};
pv.Behavior.pan=function(){function b(){g=this.index;f=this.scene;i=pv.vector(pv.event.pageX,pv.event.pageY);h=this.transform();j=1/(h.k*this.scale);if(k)k={x:(1-h.k)*this.width(),y:(1-h.k)*this.height()}}function c(l){if(f){f.mark.context(f,g,function(){var q=h.translate((pv.event.pageX-i.x)*j,(pv.event.pageY-i.y)*j);if(k){q.x=Math.max(k.x,Math.min(0,q.x));q.y=Math.max(k.y,Math.min(0,q.y))}this.transform(q).render()});pv.Mark.dispatch("pan",f,g,l)}}function d(){f=null}var f,g,h,i,j,k;b.bound=function(l){if(arguments.length){k=
Boolean(l);return this}return Boolean(k)};pv.listen(window,"mousemove",c);pv.listen(window,"mouseup",d);return b};
pv.Behavior.zoom=function(b){function c(f){var g=this.mouse(),h=pv.event.wheel*b;g=this.transform().translate(g.x,g.y).scale(h<0?1E3/(1E3-h):(1E3+h)/1E3).translate(-g.x,-g.y);if(d){g.k=Math.max(1,g.k);g.x=Math.max((1-g.k)*this.width(),Math.min(0,g.x));g.y=Math.max((1-g.k)*this.height(),Math.min(0,g.y))}this.transform(g).render();pv.Mark.dispatch("zoom",this.scene,this.index,f)}var d;arguments.length||(b=1/48);c.bound=function(f){if(arguments.length){d=Boolean(f);return this}return Boolean(d)};return c};
pv.Geo=function(){};
pv.Geo.projections={mercator:{project:function(b){return{x:b.lng/180,y:b.lat>85?1:b.lat<-85?-1:Math.log(Math.tan(Math.PI/4+pv.radians(b.lat)/2))/Math.PI}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(2*Math.atan(Math.exp(b.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(b){return{x:b.lng/180,y:Math.sin(pv.radians(b.lat))}},invert:function(b){return{lng:b.x*180,lat:pv.degrees(Math.asin(b.y))}}},sinusoidal:{project:function(b){return{x:pv.radians(b.lng)*Math.cos(pv.radians(b.lat))/Math.PI,
y:b.lat/90}},invert:function(b){return{lng:pv.degrees(b.x*Math.PI/Math.cos(b.y*Math.PI/2)),lat:b.y*90}}},aitoff:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);var d=Math.acos(Math.cos(b)*Math.cos(c/2));return{x:2*(d?Math.cos(b)*Math.sin(c/2)*d/Math.sin(d):0)/Math.PI,y:2*(d?Math.sin(b)*d/Math.sin(d):0)/Math.PI}},invert:function(b){var c=b.y*Math.PI/2;return{lng:pv.degrees(b.x*Math.PI/2/Math.cos(c)),lat:pv.degrees(c)}}},hammer:{project:function(b){var c=pv.radians(b.lng);b=pv.radians(b.lat);
var d=Math.sqrt(1+Math.cos(b)*Math.cos(c/2));return{x:2*Math.SQRT2*Math.cos(b)*Math.sin(c/2)/d/3,y:Math.SQRT2*Math.sin(b)/d/1.5}},invert:function(b){var c=b.x*3;b=b.y*1.5;var d=Math.sqrt(1-c*c/16-b*b/4);return{lng:pv.degrees(2*Math.atan2(d*c,2*(2*d*d-1))),lat:pv.degrees(Math.asin(d*b))}}},identity:{project:function(b){return{x:b.lng/180,y:b.lat/90}},invert:function(b){return{lng:b.x*180,lat:b.y*90}}}};
pv.Geo.scale=function(b){function c(n){if(!m||n.lng!=m.lng||n.lat!=m.lat){m=n;n=d(n);s={x:k(n.x),y:l(n.y)}}return s}function d(n){return j.project({lng:n.lng-q.lng,lat:n.lat})}function f(n){n=j.invert(n);n.lng+=q.lng;return n}var g={x:0,y:0},h={x:1,y:1},i=[],j=pv.Geo.projections.identity,k=pv.Scale.linear(-1,1).range(0,1),l=pv.Scale.linear(-1,1).range(1,0),q={lng:0,lat:0},m,s;c.x=function(n){return c(n).x};c.y=function(n){return c(n).y};c.ticks={lng:function(n){var o;if(i.length>1){var p=pv.Scale.linear();
if(n==undefined)n=10;o=p.domain(i,function(t){return t.lat}).ticks(n);n=p.domain(i,function(t){return t.lng}).ticks(n)}else{o=pv.range(-80,81,10);n=pv.range(-180,181,10)}return n.map(function(t){return o.map(function(u){return{lat:u,lng:t}})})},lat:function(n){return pv.transpose(c.ticks.lng(n))}};c.invert=function(n){return f({x:k.invert(n.x),y:l.invert(n.y)})};c.domain=function(n,o){if(arguments.length){i=n instanceof Array?arguments.length>1?pv.map(n,o):n:Array.prototype.slice.call(arguments);
if(i.length>1){var p=i.map(function(u){return u.lng}),t=i.map(function(u){return u.lat});q={lng:(pv.max(p)+pv.min(p))/2,lat:(pv.max(t)+pv.min(t))/2};p=i.map(d);k.domain(p,function(u){return u.x});l.domain(p,function(u){return u.y})}else{q={lng:0,lat:0};k.domain(-1,1);l.domain(-1,1)}m=null;return this}return i};c.range=function(n,o){if(arguments.length){if(typeof n=="object"){g={x:Number(n.x),y:Number(n.y)};h={x:Number(o.x),y:Number(o.y)}}else{g={x:0,y:0};h={x:Number(n),y:Number(o)}}k.range(g.x,h.x);
l.range(h.y,g.y);m=null;return this}return[g,h]};c.projection=function(n){if(arguments.length){j=typeof n=="string"?pv.Geo.projections[n]||pv.Geo.projections.identity:n;return this.domain(i)}return n};c.by=function(n){function o(){return c(n.apply(this,arguments))}for(var p in c)o[p]=c[p];return o};arguments.length&&c.projection(b);return c};
